var br=Object.defineProperty;var yr=(t,n,d)=>n in t?br(t,n,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[n]=d;var Qo=(t,n,d)=>(yr(t,typeof n!="symbol"?n+"":n,d),d);import{s as nl,a as jt,j as X,F as Kl}from"./marked.esm-dbrxtycE.js";import{r,R as it}from"./index-BMVQvedj.js";import{_ as Mr}from"./iframe-ni8xiI1Q.js";import{G as j,b as zo,i as Mo,r as Wl,c as Lo,C as V,g as ql,d as xr,e as Rr,w as zt,m as el,f as kr,h as Nl,I as xo,p as Sr,j as Tr,t as zr,k as Lr,l as Lt,o as Gl,n as Ul,q as Hr,s as Ro,v as ko,x as Dr,y as Er,z as $r,A as Fr,B as Ar,D as Vl,E as _t,F as Ir,H as Or,J as Bl,K as Pr,u as tl,L as Kr,M as Wr,T as Nr,N as Xl,O as Gr,P as Ur}from"./image-window-loader-hgJATaim.js";import{c as Ht,r as Dt,d as Vr}from"./throttle-7EuXLZa7.js";import{u as Br,f as Yl}from"./flatten-qRvRBp6y.js";import{G as Xr}from"./scrolling-data-grid-ta-GKPbC.js";const Y='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Yr=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}<rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${n}"/></svg>`},_r=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}<rect x="2" y="2" width="16" height="16" rx="4" fill="${d}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${n}"/></svg>`},jr=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${d}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${n}"/>
  </svg>`},qr=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${d}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${n}"/>
</svg>`},Zr=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${d}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${n}"
    />
</svg>`},Zl=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${d}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${n}"/>
</svg>
  `},Jr=t=>{const n=t.bgColor;return`${Y}
    <path stroke="${n}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${n}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${n}"/>
  </svg>
`},Qr=Zl,ei=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${d}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${n}"/>
</svg>`},ti=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${n}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${n}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${n}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${d}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${n}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${n}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${n}"/>
  </svg>`},oi=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${d}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${n}"/>
</svg>`},li=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <path fill="${n}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${d}"/>
  </svg>`},ni=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${d}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${n}"/>
  </svg>`},ri=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${d}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${n}"/>
</svg>`},ii=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${d}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${n}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${n}"/>
  </svg>`},ci=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${n}"/>
</svg>`},si=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${d}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${d}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${n}"/>
  </svg>`},ai=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <path fill="${n}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${d}"/>
</svg>`},ui=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${n}"/>
  </svg>`},di=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${n}"/>
  </svg>`},fi=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${n}"/>
</svg>`},hi=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${n}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${n}"/>
</svg>`},gi=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${d}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${n}"/>
  </svg>`},mi=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${n}"/>
</svg>`},vi=t=>{const n=t.fgColor,d=t.bgColor;return`
    ${Y}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${n}"/>
  </svg>`},Ci=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${d}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${n}"/>
</svg>`},wi=t=>{const n=t.fgColor,d=t.bgColor;return`${Y}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${d}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${n}"/>
</svg>`},pi=t=>{const n=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${t.bgColor}" stroke="${n}" stroke-width="2"/>
  </svg>`},bi=t=>{const n=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${t.bgColor}" stroke="${n}" stroke-width="2"/>
  </svg>
`},yi={headerRowID:Yr,headerNumber:jr,headerCode:_r,headerString:qr,headerBoolean:Zr,headerAudioUri:Qr,headerVideoUri:ei,headerEmoji:ti,headerImage:oi,headerUri:Zl,headerPhone:li,headerMarkdown:ni,headerDate:ri,headerTime:ii,headerEmail:ci,headerReference:si,headerIfThenElse:ai,headerSingleValue:ui,headerLookup:di,headerTextTemplate:fi,headerMath:hi,headerRollup:gi,headerJoinStrings:mi,headerSplitString:vi,headerGeoDistance:Ci,headerArray:wi,rowOwnerOverlay:pi,protectedColumnOverlay:bi,renameIcon:Jr},Mi=nl("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),xi=X("svg",{className:"button-icon",viewBox:"0 0 512 512",children:X("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})}),Ri=X("svg",{className:"button-icon",viewBox:"0 0 512 512",children:X("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})}),ki=X("svg",{className:"button-icon",viewBox:"0 0 512 512",children:X("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})}),Si=10,Ti=t=>{const{canvasRef:n,cellYOffset:d,rows:C,columns:k,searchInputRef:H,searchValue:P,searchResults:F,onSearchValueChange:E,getCellsForSelection:M,onSearchResultsChanged:v,showSearch:T=!1,onSearchClose:$}=t,[N]=r.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[O,be]=r.useState(""),ne=P??O,Fe=r.useCallback(z=>{be(z),E==null||E(z)},[E]),[x,p]=r.useState(),le=r.useRef(x);le.current=x,r.useEffect(()=>{F!==void 0&&(F.length>0?p(z=>({rowsSearched:C,results:F.length,selectedIndex:(z==null?void 0:z.selectedIndex)??-1})):p(void 0))},[C,F]);const ye=r.useRef();ye.current===void 0&&(ye.current=new AbortController);const Z=r.useRef(),[_,q]=r.useState([]),J=F??_,U=r.useCallback(()=>{Z.current!==void 0&&(window.cancelAnimationFrame(Z.current),Z.current=void 0,ye.current.abort())},[]),Re=r.useRef(d);Re.current=d;const wt=r.useCallback(z=>{const ee=new RegExp(z.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let re=Re.current,ze=Math.min(10,C),Oe=0;p(void 0),q([]);const st=[],Zt=async()=>{var Ge;if(M===void 0)return;const Do=performance.now(),$t=C-Oe;let at=M({x:0,y:re,width:k.length,height:Math.min(ze,$t,C-re)},ye.current.signal);typeof at=="function"&&(at=await at());let Jt=!1;for(const[fe,Le]of at.entries())for(const[Eo,_e]of Le.entries()){let je;switch(_e.kind){case j.Text:case j.Number:je=_e.displayData;break;case j.Uri:case j.Markdown:je=_e.data;break;case j.Boolean:je=typeof _e.data=="boolean"?_e.data.toString():void 0;break;case j.Image:case j.Bubble:je=_e.data.join("🐳");break;case j.Custom:je=_e.copyData;break}je!==void 0&&ee.test(je)&&(st.push([Eo,fe+re]),Jt=!0)}const Qt=performance.now();Jt&&q([...st]),Oe+=at.length,zo(Oe<=C);const Qe=((Ge=le.current)==null?void 0:Ge.selectedIndex)??-1;p({results:st.length,rowsSearched:Oe,selectedIndex:Qe}),v==null||v(st,Qe),re+ze>=C?re=0:re+=ze;const ut=Qt-Do,dt=Math.max(ut,1),ft=Si/dt;ze=Math.ceil(ze*ft),Oe<C&&st.length<1e3&&(Z.current=window.requestAnimationFrame(Zt))};U(),Z.current=window.requestAnimationFrame(Zt)},[U,k.length,M,v,C]),se=r.useCallback(()=>{var z;$==null||$(),p(void 0),q([]),v==null||v([],-1),U(),(z=n==null?void 0:n.current)==null||z.focus()},[U,n,$,v]),qt=r.useCallback(z=>{Fe(z.target.value),F===void 0&&(z.target.value===""?(p(void 0),q([]),U()):wt(z.target.value))},[wt,U,Fe,F]);r.useEffect(()=>{T&&H.current!==null&&(Fe(""),H.current.focus({preventScroll:!0}))},[T,H,Fe]);const ct=r.useCallback(z=>{var re;if((re=z==null?void 0:z.stopPropagation)==null||re.call(z),x===void 0)return;const ee=(x.selectedIndex+1)%x.results;p({...x,selectedIndex:ee}),v==null||v(J,ee)},[x,v,J]),Te=r.useCallback(z=>{var re;if((re=z==null?void 0:z.stopPropagation)==null||re.call(z),x===void 0)return;let ee=(x.selectedIndex-1)%x.results;ee<0&&(ee+=x.results),p({...x,selectedIndex:ee}),v==null||v(J,ee)},[v,J,x]),Ae=r.useCallback(z=>{(z.ctrlKey||z.metaKey)&&z.nativeEvent.code==="KeyF"||z.key==="Escape"?(se(),z.stopPropagation(),z.preventDefault()):z.key==="Enter"&&(z.shiftKey?Te():ct())},[se,ct,Te]);r.useEffect(()=>()=>{U()},[U]);const[Et,Ie]=r.useState(!1);r.useEffect(()=>{if(T)Ie(!0);else{const z=setTimeout(()=>Ie(!1),150);return()=>clearTimeout(z)}},[T]);const Ho=r.useMemo(()=>{if(!T&&!Et)return null;let z;x!==void 0&&(z=x.results>=1e3?"over 1000":`${x.results} result${x.results!==1?"s":""}`,x.selectedIndex>=0&&(z=`${x.selectedIndex+1} of ${z}`));const ee=Oe=>{Oe.stopPropagation()},ze={width:`${Math.floor(((x==null?void 0:x.rowsSearched)??0)/C*100)}%`};return jt(Mi,{className:T?"":"out",onMouseDown:ee,onMouseMove:ee,onMouseUp:ee,onClick:ee,children:[jt("div",{className:"gdg-search-bar-inner",children:[X("input",{id:N,"aria-hidden":!T,"data-testid":"search-input",ref:H,onChange:qt,value:ne,tabIndex:T?void 0:-1,onKeyDownCapture:Ae}),X("button",{"aria-label":"Previous Result","aria-hidden":!T,tabIndex:T?void 0:-1,onClick:Te,disabled:((x==null?void 0:x.results)??0)===0,children:xi}),X("button",{"aria-label":"Next Result","aria-hidden":!T,tabIndex:T?void 0:-1,onClick:ct,disabled:((x==null?void 0:x.results)??0)===0,children:Ri}),$!==void 0&&X("button",{"aria-label":"Close Search","aria-hidden":!T,"data-testid":"search-close-button",tabIndex:T?void 0:-1,onClick:se,children:ki})]}),x!==void 0?jt(Kl,{children:[X("div",{className:"gdg-search-status",children:X("div",{"data-testid":"search-result-area",children:z})}),X("div",{className:"gdg-search-progress",style:ze})]}):X("div",{className:"gdg-search-status",children:X("label",{htmlFor:N,children:"Type to search"})})]})},[T,Et,x,C,N,H,qt,ne,Ae,Te,ct,$,se]);return jt(Kl,{children:[X(Xr,{prelightCells:J,accessibilityHeight:t.accessibilityHeight,canvasRef:t.canvasRef,cellXOffset:t.cellXOffset,cellYOffset:t.cellYOffset,className:t.className,clientSize:t.clientSize,columns:t.columns,disabledRows:t.disabledRows,enableGroups:t.enableGroups,fillHandle:t.fillHandle,firstColAccessible:t.firstColAccessible,nonGrowWidth:t.nonGrowWidth,fixedShadowX:t.fixedShadowX,fixedShadowY:t.fixedShadowY,freezeColumns:t.freezeColumns,getCellContent:t.getCellContent,getCellRenderer:t.getCellRenderer,getGroupDetails:t.getGroupDetails,getRowThemeOverride:t.getRowThemeOverride,groupHeaderHeight:t.groupHeaderHeight,headerHeight:t.headerHeight,highlightRegions:t.highlightRegions,imageWindowLoader:t.imageWindowLoader,initialSize:t.initialSize,isFilling:t.isFilling,isFocused:t.isFocused,lockColumns:t.lockColumns,maxColumnWidth:t.maxColumnWidth,minColumnWidth:t.minColumnWidth,onHeaderMenuClick:t.onHeaderMenuClick,onMouseMove:t.onMouseMove,onVisibleRegionChanged:t.onVisibleRegionChanged,overscrollX:t.overscrollX,overscrollY:t.overscrollY,preventDiagonalScrolling:t.preventDiagonalScrolling,rightElement:t.rightElement,rightElementProps:t.rightElementProps,rowHeight:t.rowHeight,rows:t.rows,scrollRef:t.scrollRef,selection:t.selection,theme:t.theme,freezeTrailingRows:t.freezeTrailingRows,hasAppendRow:t.hasAppendRow,translateX:t.translateX,translateY:t.translateY,verticalBorder:t.verticalBorder,onColumnProposeMove:t.onColumnProposeMove,drawFocusRing:t.drawFocusRing,drawCell:t.drawCell,drawHeader:t.drawHeader,experimental:t.experimental,gridRef:t.gridRef,headerIcons:t.headerIcons,isDraggable:t.isDraggable,onCanvasBlur:t.onCanvasBlur,onCanvasFocused:t.onCanvasFocused,onCellFocused:t.onCellFocused,onColumnMoved:t.onColumnMoved,onColumnResize:t.onColumnResize,onColumnResizeEnd:t.onColumnResizeEnd,onColumnResizeStart:t.onColumnResizeStart,onContextMenu:t.onContextMenu,onDragEnd:t.onDragEnd,onDragLeave:t.onDragLeave,onDragOverCell:t.onDragOverCell,onDragStart:t.onDragStart,onDrop:t.onDrop,onItemHovered:t.onItemHovered,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onRowMoved:t.onRowMoved,smoothScrollX:t.smoothScrollX,smoothScrollY:t.smoothScrollY}),Ho]})},zi=Ti;class Li extends r.PureComponent{constructor(){super(...arguments);Qo(this,"wrapperRef",r.createRef());Qo(this,"clickOutside",d=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(d))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(d.target)){let C=d.target;for(;C!==null;){if(C.classList.contains("click-outside-ignore"))return;C=C.parentElement}this.props.onClickOutside()}})}componentDidMount(){document.addEventListener("touchend",this.clickOutside,!0),document.addEventListener("mousedown",this.clickOutside,!0),document.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){document.removeEventListener("touchend",this.clickOutside,!0),document.removeEventListener("mousedown",this.clickOutside,!0),document.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:d,isOutsideClick:C,...k}=this.props;return X("div",{...k,ref:this.wrapperRef,children:this.props.children})}}const Hi=()=>t=>Math.max(16,t.targetHeight-10),Di=nl("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[Hi(),"px"]}}),Ei=t=>{const{bounds:n,group:d,onClose:C,canvasBounds:k,onFinish:H}=t,[P,F]=it.useState(d);return X(Li,{style:{position:"absolute",left:n.x-k.left+1,top:n.y-k.top,width:n.width-2,height:n.height},className:"c181oggi",onClickOutside:C,children:X(Di,{targetHeight:n.height,"data-testid":"group-rename-input",value:P,onBlur:C,onFocus:E=>E.target.setSelectionRange(0,P.length),onChange:E=>F(E.target.value),onKeyDown:E=>{E.key==="Enter"?H(P):E.key==="Escape"&&C()},autoFocus:!0})})},ll=150;function $i(t,n,d,C){var H;const k=C(n);return((H=k==null?void 0:k.measure)==null?void 0:H.call(k,t,n,d))??ll}function Jl(t,n,d,C,k,H,P,F,E){let M=0;const v=k===void 0?[]:k.map($=>{const N=$i(t,$[C],n,E);return M=Math.max(M,N),N});if(v.length>5&&F){M=0;let $=0;for(const O of v)$+=O;const N=$/v.length;for(let O=0;O<v.length;O++)v[O]>=N*2?v[O]=0:M=Math.max(M,v[O])}M=Math.max(M,t.measureText(d.title).width+16+(d.icon===void 0?0:28));const T=Math.max(Math.ceil(H),Math.min(Math.floor(P),Math.ceil(M)));return{...d,width:T}}function Fi(t,n,d,C,k,H,P,F,E){const M=r.useRef(n),v=r.useRef(d),T=r.useRef(P);M.current=n,v.current=d,T.current=P;const[$,N]=r.useMemo(()=>{if(typeof window>"u")return[null,null];const x=document.createElement("canvas");return x.style.display="none",x.style.opacity="0",x.style.position="fixed",[x,x.getContext("2d",{alpha:!1})]},[]);r.useLayoutEffect(()=>($&&document.documentElement.append($),()=>{$==null||$.remove()}),[$]);const O=r.useRef({}),be=r.useRef(),[ne,Fe]=r.useState();return r.useLayoutEffect(()=>{const x=v.current;if(x===void 0||t.every(Mo))return;let p=Math.max(1,10-Math.floor(t.length/1e4)),le=0;p<M.current&&p>1&&(p--,le=1);const ye={x:0,y:0,width:t.length,height:Math.min(M.current,p)},Z={x:0,y:M.current-1,width:t.length,height:1};(async()=>{const q=x(ye,E.signal),J=le>0?x(Z,E.signal):void 0;let U;typeof q=="object"?U=q:U=await Wl(q),J!==void 0&&(typeof J=="object"?U=[...U,...J]:U=[...U,...await Wl(J)]),be.current=t,Fe(U)})()},[E.signal,t]),r.useMemo(()=>{let p=t.every(Mo)?t:N===null?t.map(_=>Mo(_)?_:{..._,width:ll}):(N.font=T.current.baseFontFull,t.map((_,q)=>{if(Mo(_))return _;if(O.current[_.id]!==void 0)return{..._,width:O.current[_.id]};if(ne===void 0||be.current!==t||_.id===void 0)return{..._,width:ll};const J=Jl(N,P,_,q,ne,k,H,!0,F);return O.current[_.id]=J.width,J})),le=0,ye=0;const Z=[];for(const[_,q]of p.entries())le+=q.width,q.grow!==void 0&&q.grow>0&&(ye+=q.grow,Z.push(_));if(le<C&&Z.length>0){const _=[...p],q=C-le;let J=q;for(let U=0;U<Z.length;U++){const Re=Z[U],wt=(p[Re].grow??0)/ye,se=U===Z.length-1?J:Math.min(J,Math.floor(q*wt));_[Re]={...p[Re],growOffset:se,width:p[Re].width+se},J-=se}p=_}return{sizedColumns:p,nonGrowWidth:le}},[C,t,N,ne,P,k,H,F])}function Ai(t,n){return t===void 0?!1:t.length>1&&t.startsWith("_")?Number.parseInt(t.slice(1))===n.keyCode:t.length===1&&t>="a"&&t<="z"?t.toUpperCase().codePointAt(0)===n.keyCode:t===n.key}function A(t,n,d){const C=Ql(t,n);return C&&(d.didMatch=!0),C}function Ql(t,n){if(t.length===0)return!1;if(t.includes("|")){const E=t.split("|");for(const M of E)if(Ql(M,n))return!0;return!1}let d=!1,C=!1,k=!1,H=!1;const P=t.split("+"),F=P.pop();if(!Ai(F,n))return!1;if(P[0]==="any")return!0;for(const E of P)switch(E){case"ctrl":d=!0;break;case"shift":C=!0;break;case"alt":k=!0;break;case"meta":H=!0;break;case"primary":Lo.value?H=!0:d=!0;break}return n.altKey===k&&n.ctrlKey===d&&n.shiftKey===C&&n.metaKey===H}function Ii(t,n,d,C,k,H){const P=it.useCallback((M,v,T,$)=>{var x;(H==="cell"||H==="multi-cell")&&M!==void 0&&(M={...M,range:{x:M.cell[0],y:M.cell[1],width:1,height:1}});const N=d==="mixed"&&(T||$==="drag"),O=C==="mixed"&&N,be=k==="mixed"&&N;let ne={current:M===void 0?void 0:{...M,rangeStack:$==="drag"?((x=t.current)==null?void 0:x.rangeStack)??[]:[]},columns:O?t.columns:V.empty(),rows:be?t.rows:V.empty()};T&&(H==="multi-rect"||H==="multi-cell")&&ne.current!==void 0&&t.current!==void 0&&(ne={...ne,current:{...ne.current,rangeStack:[...t.current.rangeStack,t.current.range]}}),n(ne,v)},[C,t,d,H,k,n]),F=it.useCallback((M,v,T)=>{M=M??t.rows,v!==void 0&&(M=M.add(v));let $;if(k==="exclusive"&&M.length>0)$={current:void 0,columns:V.empty(),rows:M};else{const N=T&&d==="mixed",O=T&&C==="mixed";$={current:N?t.current:void 0,columns:O?t.columns:V.empty(),rows:M}}n($,!1)},[C,t,d,k,n]),E=it.useCallback((M,v,T)=>{M=M??t.columns,v!==void 0&&(M=M.add(v));let $;if(C==="exclusive"&&M.length>0)$={current:void 0,rows:V.empty(),columns:M};else{const N=T&&d==="mixed",O=T&&k==="mixed";$={current:N?t.current:void 0,rows:O?t.rows:V.empty(),columns:M}}n($,!1)},[C,t,d,k,n]);return[P,F,E]}function Oi(t,n,d,C,k){const H=r.useCallback(M=>{if(t===!0){const v=[];for(let T=M.y;T<M.y+M.height;T++){const $=[];for(let N=M.x;N<M.x+M.width;N++)N<0||T>=k?$.push({kind:j.Loading,allowOverlay:!1}):$.push(n([N,T]));v.push($)}return v}return(t==null?void 0:t(M,C.signal))??[]},[C.signal,n,t,k]),P=t!==void 0?H:void 0,F=r.useCallback(M=>{if(P===void 0)return[];const v={...M,x:M.x-d};if(v.x<0){v.x=0,v.width--;const T=P(v,C.signal);return typeof T=="function"?async()=>(await T()).map($=>[{kind:j.Loading,allowOverlay:!1},...$]):T.map($=>[{kind:j.Loading,allowOverlay:!1},...$])}return P(v,C.signal)},[C.signal,P,d]);return[t!==void 0?F:void 0,P]}function _l(t){return typeof t=="string"?t:`${t}px`}const Pi=()=>t=>t.innerWidth,Ki=()=>t=>t.innerHeight,Wi=nl("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[Pi()],"w2q57ts-1":[Ki()]}}),Ni=t=>{const{inWidth:n,inHeight:d,children:C,...k}=t;return X(Wi,{innerHeight:_l(d),innerWidth:_l(n),...k,children:C})},Gi=2,Ui=1300;function Vi(t,n,d){const C=it.useRef(0),[k,H]=t??[0,0];it.useEffect(()=>{if(k===0&&H===0){C.current=0;return}let P=!1,F=0;const E=M=>{var v;if(!P){if(F===0)F=M;else{const T=M-F;C.current=Math.min(1,C.current+T/Ui);const $=C.current**1.618*T*Gi;(v=n.current)==null||v.scrollBy(k*$,H*$),F=M,d==null||d()}window.requestAnimationFrame(E)}};return window.requestAnimationFrame(E),()=>{P=!0}},[n,k,H,d])}function Bi({rowHeight:t,headerHeight:n,groupHeaderHeight:d,theme:C,overscrollX:k,overscrollY:H,scaleToRem:P,remSize:F}){const[E,M,v,T,$,N]=it.useMemo(()=>{if(!P||F===16)return[t,n,d,C,k,H];const O=F/16,be=t,ne=ql();return[typeof be=="number"?be*O:Fe=>Math.ceil(be(Fe)*O),Math.ceil(n*O),Math.ceil(d*O),{...C,headerIconSize:((C==null?void 0:C.headerIconSize)??ne.headerIconSize)*O,cellHorizontalPadding:((C==null?void 0:C.cellHorizontalPadding)??ne.cellHorizontalPadding)*O,cellVerticalPadding:((C==null?void 0:C.cellVerticalPadding)??ne.cellVerticalPadding)*O},Math.ceil((k??0)*O),Math.ceil((H??0)*O)]},[d,n,k,H,F,t,P,C]);return{rowHeight:E,headerHeight:M,groupHeaderHeight:v,theme:T,overscrollX:$,overscrollY:N}}const rt={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function I(t,n){return t===!0?n:t===!1?"":t}function jl(t){const n=Lo.value;return{activateCell:I(t.activateCell," |Enter|shift+Enter"),clear:I(t.clear,"any+Escape"),closeOverlay:I(t.closeOverlay,"any+Escape"),acceptOverlayDown:I(t.acceptOverlayDown,"Enter"),acceptOverlayUp:I(t.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:I(t.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:I(t.acceptOverlayRight,"Tab"),copy:t.copy,cut:t.cut,delete:I(t.delete,n?"Backspace|Delete":"Delete"),downFill:I(t.downFill,"primary+_68"),scrollToSelectedCell:I(t.scrollToSelectedCell,"primary+Enter"),goDownCell:I(t.goDownCell,"ArrowDown"),goDownCellRetainSelection:I(t.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:I(t.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:I(t.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:I(t.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:I(t.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:I(t.goUpCell,"ArrowUp"),goUpCellRetainSelection:I(t.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:I(t.goToFirstCell,"primary+Home"),goToFirstColumn:I(t.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:I(t.goToFirstRow,"primary+ArrowUp"),goToLastCell:I(t.goToLastCell,"primary+End"),goToLastColumn:I(t.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:I(t.goToLastRow,"primary+ArrowDown"),goToNextPage:I(t.goToNextPage,"PageDown"),goToPreviousPage:I(t.goToPreviousPage,"PageUp"),paste:t.paste,rightFill:I(t.rightFill,"primary+_82"),search:I(t.search,"primary+f"),selectAll:I(t.selectAll,"primary+a"),selectColumn:I(t.selectColumn,"ctrl+ "),selectGrowDown:I(t.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:I(t.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:I(t.selectGrowRight,"shift+ArrowRight"),selectGrowUp:I(t.selectGrowUp,"shift+ArrowUp"),selectRow:I(t.selectRow,"shift+ "),selectToFirstCell:I(t.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:I(t.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:I(t.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:I(t.selectToLastCell,"primary+shift+End"),selectToLastColumn:I(t.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:I(t.selectToLastRow,"primary+shift+ArrowDown")}}function Xi(t){const n=xr(t);return it.useMemo(()=>{if(n===void 0)return jl(rt);const d={...n,goToNextPage:(n==null?void 0:n.goToNextPage)??(n==null?void 0:n.pageDown)??rt.goToNextPage,goToPreviousPage:(n==null?void 0:n.goToPreviousPage)??(n==null?void 0:n.pageUp)??rt.goToPreviousPage,goToFirstCell:(n==null?void 0:n.goToFirstCell)??(n==null?void 0:n.first)??rt.goToFirstCell,goToLastCell:(n==null?void 0:n.goToLastCell)??(n==null?void 0:n.last)??rt.goToLastCell,selectToFirstCell:(n==null?void 0:n.selectToFirstCell)??(n==null?void 0:n.first)??rt.selectToFirstCell,selectToLastCell:(n==null?void 0:n.selectToLastCell)??(n==null?void 0:n.last)??rt.selectToLastCell};return jl({...rt,...d})},[n])}const Yi=r.lazy(async()=>await Mr(()=>import("./data-grid-overlay-editor-hmiBYkvZ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url));let _i=0;function ji(t){return Br(Yl(Yl(t).filter(n=>n.span!==void 0).map(n=>{var d,C;return Dt((((d=n.span)==null?void 0:d[0])??0)+1,(((C=n.span)==null?void 0:C[1])??0)+1)})))}function So(t,n){return t===void 0||n===0||t.columns.length===0&&t.current===void 0?t:{current:t.current===void 0?void 0:{cell:[t.current.cell[0]+n,t.current.cell[1]],range:{...t.current.range,x:t.current.range.x+n},rangeStack:t.current.rangeStack.map(d=>({...d,x:d.x+n}))},rows:t.rows,columns:t.columns.offset(n)}}const ol={kind:j.Loading,allowOverlay:!1},To={columns:V.empty(),rows:V.empty(),current:void 0},qi=(t,n)=>{var Ol,Pl;const[d,C]=r.useState(To),[k,H]=r.useState(),P=r.useRef(null),F=r.useRef(null),[E,M]=r.useState(),v=r.useRef(null),T=r.useRef(),$=typeof window>"u"?null:window,{imageEditorOverride:N,getRowThemeOverride:O,markdownDivCreateNode:be,width:ne,height:Fe,columns:x,rows:p,getCellContent:le,onCellClicked:ye,onCellActivated:Z,onFillPattern:_,onFinishedEditing:q,coercePasteValue:J,drawHeader:U,drawCell:Re,editorBloom:wt,onHeaderClicked:se,onColumnProposeMove:qt,spanRangeBehavior:ct="default",onGroupHeaderClicked:Te,onCellContextMenu:Ae,className:Et,onHeaderContextMenu:Ie,getCellsForSelection:Ho,onGroupHeaderContextMenu:z,onGroupHeaderRenamed:ee,onCellEdited:re,onCellsEdited:ze,onSearchResultsChanged:Oe,searchResults:st,onSearchValueChange:Zt,searchValue:Do,onKeyDown:$t,onKeyUp:at,keybindings:Jt,editOnType:Qt=!0,onRowAppended:Qe,onColumnMoved:ut,validateCell:dt,highlightRegions:ft,rangeSelect:Ge="rect",columnSelect:fe="multi",rowSelect:Le="multi",rangeSelectionBlending:Eo="exclusive",columnSelectionBlending:_e="exclusive",rowSelectionBlending:je="exclusive",onDelete:$o,onDragStart:eo,onMouseMove:to,onPaste:ht,copyHeaders:rl=!1,freezeColumns:qe=0,cellActivationBehavior:Fo="second-click",rowSelectionMode:Ao="auto",onHeaderMenuClick:oo,getGroupDetails:lo,onSearchClose:Io,onItemHovered:no,onSelectionCleared:et,showSearch:en,onVisibleRegionChanged:ro,gridSelection:gt,onGridSelectionChange:Oo,minColumnWidth:tn=50,maxColumnWidth:on=500,maxColumnAutoWidth:ln,provideEditor:nn,trailingRowOptions:W,freezeTrailingRows:Ze=0,allowedFillDirections:il="orthogonal",scrollOffsetX:Ft,scrollOffsetY:Ue,verticalBorder:pt,onDragOverCell:rn,onDrop:cn,onColumnResize:At,onColumnResizeEnd:It,onColumnResizeStart:Ot,customRenderers:io,fillHandle:sn,drawFocusRing:an,experimental:ae,fixedShadowX:un,fixedShadowY:dn,headerIcons:fn,imageWindowLoader:hn,initialSize:gn,isDraggable:mn,onDragLeave:vn,onRowMoved:Pt,overscrollX:Cn,overscrollY:wn,preventDiagonalScrolling:pn,rightElement:bn,rightElementProps:yn,trapFocus:cl=!1,smoothScrollX:Mn,smoothScrollY:xn,scaleToRem:Rn=!1,rowHeight:kn=34,headerHeight:sl=36,groupHeaderHeight:Sn=sl,theme:Tn,isOutsideClick:zn,renderers:Po}=t,he=typeof t.rowMarkers=="string"?void 0:t.rowMarkers,Pe=(he==null?void 0:he.kind)??t.rowMarkers??"none",Ln=(he==null?void 0:he.width)??t.rowMarkerWidth,al=(he==null?void 0:he.startIndex)??t.rowMarkerStartIndex??1,ul=(he==null?void 0:he.theme)??t.rowMarkerTheme,co=(he==null?void 0:he.checkboxStyle)??"square",bt=Math.max(tn,20),so=Math.max(on,bt),Hn=Math.max(ln??so,bt),dl=r.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),Dn=r.useMemo(()=>Number.parseFloat(dl.fontSize),[dl]),{rowHeight:He,headerHeight:Ko,groupHeaderHeight:fl,theme:hl,overscrollX:En,overscrollY:$n}=Bi({groupHeaderHeight:Sn,headerHeight:sl,overscrollX:Cn,overscrollY:wn,remSize:Dn,rowHeight:kn,scaleToRem:Rn,theme:Tn}),tt=Xi(Jt),yt=Ln??(p>1e4?48:p>1e3?44:p>100?36:32),Ve=Pe!=="none",s=Ve?1:0,Q=Qe!==void 0,Kt=(W==null?void 0:W.sticky)===!0,[Fn,gl]=r.useState(!1),An=en??Fn,In=r.useCallback(()=>{Io!==void 0?Io():gl(!1)},[Io]),u=r.useMemo(()=>gt===void 0?void 0:So(gt,s),[gt,s])??d,Me=r.useRef();Me.current===void 0&&(Me.current=new AbortController),r.useEffect(()=>()=>Me==null?void 0:Me.current.abort(),[]);const[ce,On]=Oi(Ho,le,s,Me.current,p),Pn=r.useCallback((e,l,o)=>{if(dt===void 0)return!0;const i=[e[0]-s,e[1]];return dt==null?void 0:dt(i,l,o)},[s,dt]),ao=r.useRef(gt),De=r.useCallback((e,l)=>{l&&(e=Rr(e,ce,s,ct,Me.current)),Oo!==void 0?(ao.current=So(e,-s),Oo(ao.current)):C(e)},[Oo,ce,s,ct]),Mt=zt(At,r.useCallback((e,l,o,i)=>{At==null||At(x[o-s],l,o-s,i)},[At,s,x])),Kn=zt(It,r.useCallback((e,l,o,i)=>{It==null||It(x[o-s],l,o-s,i)},[It,s,x])),Wn=zt(Ot,r.useCallback((e,l,o,i)=>{Ot==null||Ot(x[o-s],l,o-s,i)},[Ot,s,x])),Nn=zt(U,r.useCallback((e,l)=>(U==null?void 0:U({...e,columnIndex:e.columnIndex-s},l))??!1,[U,s])),Gn=zt(Re,r.useCallback((e,l)=>(Re==null?void 0:Re({...e,col:e.col-s},l))??!1,[Re,s])),ot=r.useCallback(e=>{if($o!==void 0){const l=$o(So(e,-s));return typeof l=="boolean"?l:So(l,s)}return!0},[$o,s]),[ge,me,ie]=Ii(u,De,Eo,_e,je,Ge),ve=r.useMemo(()=>el(ql(),hl),[hl]),[Wo,Un]=r.useState([0,0,0]),ml=r.useMemo(()=>{if(Po===void 0)return{};const e={};for(const l of Po)e[l.kind]=l;return e},[Po]),Ce=r.useCallback(e=>e.kind!==j.Custom?ml[e.kind]:io==null?void 0:io.find(l=>l.isMatch(e)),[io,ml]);let{sizedColumns:ke,nonGrowWidth:vl}=Fi(x,p,On,Wo[0]-(s===0?0:yt)-Wo[2],bt,Hn,ve,Ce,Me.current);Pe!=="none"&&(vl+=yt);const No=r.useMemo(()=>ke.some(e=>e.group!==void 0),[ke]),Wt=No?Ko+fl:Ko,Cl=u.rows.length,wl=Pe==="none"?void 0:Cl===0?!1:Cl===p?!0:void 0,G=r.useMemo(()=>Pe==="none"?ke:[{title:"",width:yt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:ul,rowMarker:co,rowMarkerChecked:wl},...ke],[Pe,ke,yt,ul,co,wl]),[pl,bl]=r.useMemo(()=>[Ue!==void 0&&typeof He=="number"?Math.floor(Ue/He):0,Ue!==void 0&&typeof He=="number"?-(Ue%He):0],[Ue,He]),we=r.useRef({height:1,width:1,x:0,y:0}),Vn=r.useMemo(()=>({x:we.current.x,y:pl,width:we.current.width??1,height:we.current.height??1,ty:bl}),[bl,pl]),Nt=r.useRef(!1),[Je,yl,uo]=kr(Vn);we.current=Je;const Ml=(Je.height??1)>1;r.useLayoutEffect(()=>{if(Ue!==void 0&&v.current!==null&&Ml){if(v.current.scrollTop===Ue)return;v.current.scrollTop=Ue,v.current.scrollTop!==Ue&&uo(),Nt.current=!0}},[Ue,Ml,uo]);const xl=(Je.width??1)>1;r.useLayoutEffect(()=>{if(Ft!==void 0&&v.current!==null&&xl){if(v.current.scrollLeft===Ft)return;v.current.scrollLeft=Ft,v.current.scrollLeft!==Ft&&uo(),Nt.current=!0}},[Ft,xl,uo]);const Bn=Je.x+s,fo=Je.y,xe=r.useRef(null),pe=r.useCallback(e=>{var l;e===!0?(l=xe.current)==null||l.focus():window.requestAnimationFrame(()=>{var o;(o=xe.current)==null||o.focus()})},[]),ue=Q?p+1:p,Ee=r.useCallback(e=>{const l=s===0?e:e.map(i=>({...i,location:[i.location[0]-s,i.location[1]]})),o=ze==null?void 0:ze(l);if(o!==!0)for(const i of l)re==null||re(i.location,i.value);return o},[re,ze,s]),[mt,Go]=r.useState(),ho=u.current!==void 0&&u.current.range.width*u.current.range.height>1?u.current.range:void 0,Xn=r.useMemo(()=>{if((ft===void 0||ft.length===0)&&ho===void 0&&mt===void 0)return;const e=[];if(ft!==void 0)for(const l of ft){const o=G.length-l.range.x-s;o>0&&e.push({color:l.color,range:{...l.range,x:l.range.x+s,width:Math.min(o,l.range.width)},style:l.style})}return mt!==void 0&&e.push({color:Nl(ve.accentColor,0),range:mt,style:"dashed"}),ho!==void 0&&e.push({color:Nl(ve.accentColor,.5),range:ho,style:"solid-outline"}),e.length>0?e:void 0},[mt,ho,ft,G.length,ve.accentColor,s]),Rl=r.useRef(G);Rl.current=G;const Se=r.useCallback(([e,l],o=!1)=>{var h,a,f,m,g,b,y;const i=Q&&l===ue-1;if(e===0&&Ve)return i?ol:{kind:xo.Marker,allowOverlay:!1,checkboxStyle:co,checked:(u==null?void 0:u.rows.hasIndex(l))===!0,markerKind:Pe==="clickable-number"?"number":Pe,row:al+l,drawHandle:Pt!==void 0,cursor:Pe==="clickable-number"?"pointer":void 0};if(i){const S=e===s?(W==null?void 0:W.hint)??"":"",L=Rl.current[e];if(((h=L==null?void 0:L.trailingRowOptions)==null?void 0:h.disabled)===!0)return ol;{const K=((a=L==null?void 0:L.trailingRowOptions)==null?void 0:a.hint)??S,D=((f=L==null?void 0:L.trailingRowOptions)==null?void 0:f.addIcon)??(W==null?void 0:W.addIcon);return{kind:xo.NewRow,hint:K,allowOverlay:!1,icon:D}}}else{const w=e-s;if(o||(ae==null?void 0:ae.strict)===!0){const L=we.current,K=L.x>w||w>L.x+L.width||L.y>l||l>L.y+L.height||l>=Vo.current,D=w===((g=(m=L.extras)==null?void 0:m.selected)==null?void 0:g[0])&&l===((b=L.extras)==null?void 0:b.selected[1]);let R=!1;if(((y=L.extras)==null?void 0:y.freezeRegions)!==void 0){for(const B of L.extras.freezeRegions)if(Sr(B,w,l)){R=!0;break}}if(K&&!D&&!R)return ol}let S=le([w,l]);return s!==0&&S.span!==void 0&&(S={...S,span:[S.span[0]+s,S.span[1]+s]}),S}},[Q,ue,Ve,co,u==null?void 0:u.rows,Pe,al,Pt,s,W==null?void 0:W.hint,W==null?void 0:W.addIcon,ae==null?void 0:ae.strict,le]),Uo=r.useCallback(e=>{let l=(lo==null?void 0:lo(e))??{name:e};return ee!==void 0&&e!==""&&(l={icon:l.icon,name:l.name,overrideTheme:l.overrideTheme,actions:[...l.actions??[],{title:"Rename",icon:"renameIcon",onClick:o=>Xo({group:l.name,bounds:o.bounds})}]}),l},[lo,ee]),go=r.useCallback(e=>{var f;const[l,o]=e.cell,i=G[l],c=(i==null?void 0:i.group)!==void 0?(f=Uo(i.group))==null?void 0:f.overrideTheme:void 0,h=i==null?void 0:i.themeOverride,a=O==null?void 0:O(o);H({...e,theme:el(ve,c,h,a,e.content.themeOverride)})},[O,G,Uo,ve]),xt=r.useCallback((e,l,o)=>{var a;if(u.current===void 0)return;const[i,c]=u.current.cell,h=Se([i,c]);if(h.kind!==j.Boolean&&h.allowOverlay){let f=h;if(o!==void 0)switch(f.kind){case j.Number:{const m=Tr(()=>o==="-"?-0:Number.parseFloat(o),0);f={...f,data:Number.isNaN(m)?0:m};break}case j.Text:case j.Markdown:case j.Uri:f={...f,data:o};break}go({target:e,content:f,initialValue:o,cell:[i,c],highlight:o===void 0,forceEditMode:o!==void 0})}else h.kind===j.Boolean&&l&&h.readonly!==!0&&(Ee([{location:u.current.cell,value:{...h,data:zr(h.data)}}]),(a=xe.current)==null||a.damage([{cell:u.current.cell}]))},[Se,u,Ee,go]),kl=r.useCallback((e,l)=>{var c;const o=(c=xe.current)==null?void 0:c.getBounds(e,l);if(o===void 0||v.current===null)return;const i=Se([e,l]);i.allowOverlay&&go({target:o,content:i,initialValue:void 0,highlight:!0,cell:[e,l],forceEditMode:!0})},[Se,go]),te=r.useCallback((e,l,o="both",i=0,c=0,h=void 0)=>{if(v.current!==null){const a=xe.current,f=F.current,m=typeof e!="number"?e.unit==="cell"?e.amount:void 0:e,g=typeof l!="number"?l.unit==="cell"?l.amount:void 0:l,b=typeof e!="number"&&e.unit==="px"?e.amount:void 0,y=typeof l!="number"&&l.unit==="px"?l.amount:void 0;if(a!==null&&f!==null){let w={x:0,y:0,width:0,height:0},S=0,L=0;if((m!==void 0||g!==void 0)&&(w=a.getBounds((m??0)+s,g??0)??w,w.width===0||w.height===0))return;const K=f.getBoundingClientRect(),D=K.width/f.offsetWidth;if(b!==void 0&&(w={...w,x:b-K.left-v.current.scrollLeft,width:1}),y!==void 0&&(w={...w,y:y+K.top-v.current.scrollTop,height:1}),w!==void 0){const R={x:w.x-i,y:w.y-c,width:w.width+2*i,height:w.height+2*c};let B=0;for(let Jo=0;Jo<qe;Jo++)B+=ke[Jo].width;let de=0;const oe=Ze+(Kt?1:0);oe>0&&(de=Lr(ue,oe,He));let We=B*D+K.left+s*yt*D,Xe=K.right,Ne=K.top+Wt*D,Ye=K.bottom-de*D;const bo=w.width+i*2;switch(h==null?void 0:h.hAlign){case"start":Xe=We+bo;break;case"end":We=Xe-bo;break;case"center":We=Math.floor((We+Xe)/2)-bo/2,Xe=We+bo;break}const yo=w.height+c*2;switch(h==null?void 0:h.vAlign){case"start":Ye=Ne+yo;break;case"end":Ne=Ye-yo;break;case"center":Ne=Math.floor((Ne+Ye)/2)-yo/2,Ye=Ne+yo;break}We>R.x?S=R.x-We:Xe<R.x+R.width&&(S=R.x+R.width-Xe),Ne>R.y?L=R.y-Ne:Ye<R.y+R.height&&(L=R.y+R.height-Ye),o==="vertical"||typeof e=="number"&&e<qe?S=0:(o==="horizontal"||typeof l=="number"&&l>=ue-oe)&&(L=0),(S!==0||L!==0)&&(D!==1&&(S/=D,L/=D),v.current.scrollTo(S+v.current.scrollLeft,L+v.current.scrollTop))}}}},[s,Ze,yt,Wt,qe,ke,ue,Kt,He]),Sl=r.useRef(kl),Tl=r.useRef(le),Vo=r.useRef(p);Sl.current=kl,Tl.current=le,Vo.current=p;const Rt=r.useCallback(async(e,l=!0)=>{var m;const o=G[e];if(((m=o==null?void 0:o.trailingRowOptions)==null?void 0:m.disabled)===!0)return;const i=Qe==null?void 0:Qe();let c,h=!0;i!==void 0&&(c=await i,c==="top"&&(h=!1),typeof c=="number"&&(h=!1));let a=0;const f=()=>{if(Vo.current<=p){a<500&&window.setTimeout(f,a),a=50+a*2;return}const g=typeof c=="number"?c:h?p:0;po.current(e-s,g),ge({cell:[e,g],range:{x:e,y:g,width:1,height:1}},!1,!1,"edit");const b=Tl.current([e-s,g]);b.allowOverlay&&ko(b)&&b.readonly!==!0&&l&&window.setTimeout(()=>{Sl.current(e,g)},0)};f()},[G,Qe,s,p,ge]),mo=r.useCallback(e=>{var o,i;const l=((i=(o=ke[e])==null?void 0:o.trailingRowOptions)==null?void 0:i.targetColumn)??(W==null?void 0:W.targetColumn);if(typeof l=="number")return l+(Ve?1:0);if(typeof l=="object"){const c=x.indexOf(l);if(c>=0)return c+(Ve?1:0)}},[ke,x,Ve,W==null?void 0:W.targetColumn]),lt=r.useRef(),kt=r.useRef(),Gt=r.useCallback((e,l)=>{var c;const[o,i]=l;return el(ve,(c=G[o])==null?void 0:c.themeOverride,O==null?void 0:O(i),e.themeOverride)},[O,G,ve]),Ut=r.useCallback(e=>{var b,y,w;const l=Lo.value?e.metaKey:e.ctrlKey,o=l&&Le==="multi",i=l&&fe==="multi",[c,h]=e.location,a=u.columns,f=u.rows,[m,g]=((b=u.current)==null?void 0:b.cell)??[];if(e.kind==="cell"){if(kt.current=void 0,vt.current=[c,h],c===0&&Ve){if(Q===!0&&h===p||Pe==="number"||Le==="none")return;const S=Se(e.location);if(S.kind!==xo.Marker)return;if(Pt!==void 0){const D=Ce(S);zo((D==null?void 0:D.kind)===xo.Marker);const R=(y=D==null?void 0:D.onClick)==null?void 0:y.call(D,{...e,cell:S,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,theme:Gt(S,e.location),preventDefault:()=>{}});if(R===void 0||R.checked===S.checked)return}H(void 0),pe();const L=f.hasIndex(h),K=lt.current;if(Le==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&K!==void 0&&f.hasIndex(K)){const D=[Math.min(K,h),Math.max(K,h)+1];o||Ao==="multi"?me(void 0,D,!0):me(V.fromSingleSelection(D),void 0,o)}else o||e.isTouch||Ao==="multi"?L?me(f.remove(h),void 0,!0):(me(void 0,h,!0),lt.current=h):L&&f.length===1?me(V.empty(),void 0,l):(me(V.fromSingleSelection(h),void 0,l),lt.current=h)}else if(c>=s&&Q&&h===p){const S=mo(c);Rt(S??c)}else if(m!==c||g!==h){const S=Se(e.location),L=Ce(S);if((L==null?void 0:L.onSelect)!==void 0){let R=!1;if(L.onSelect({...e,cell:S,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,preventDefault:()=>R=!0,theme:Gt(S,e.location)}),R)return}const K=Kt&&h===p,D=Kt&&u!==void 0&&((w=u.current)==null?void 0:w.cell[1])===p;if((e.shiftKey||e.isLongTouch===!0)&&m!==void 0&&g!==void 0&&u.current!==void 0&&!D){if(K)return;const R=Math.min(c,m),B=Math.max(c,m),de=Math.min(h,g),oe=Math.max(h,g);ge({...u.current,range:{x:R,y:de,width:B-R+1,height:oe-de+1}},!0,l,"click"),lt.current=void 0,pe()}else ge({cell:[c,h],range:{x:c,y:h,width:1,height:1}},!0,l,"click"),lt.current=void 0,H(void 0),pe()}}else if(e.kind==="header")if(vt.current=[c,h],H(void 0),Ve&&c===0)lt.current=void 0,kt.current=void 0,Le==="multi"&&(f.length!==p?me(V.fromSingleSelection([0,p]),void 0,l):me(V.empty(),void 0,l),pe());else{const S=kt.current;if(fe==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&S!==void 0&&a.hasIndex(S)){const L=[Math.min(S,c),Math.max(S,c)+1];i?ie(void 0,L,l):ie(V.fromSingleSelection(L),void 0,l)}else i?(a.hasIndex(c)?ie(a.remove(c),void 0,l):ie(void 0,c,l),kt.current=c):fe!=="none"&&(ie(V.fromSingleSelection(c),void 0,l),kt.current=c);lt.current=void 0,pe()}else e.kind===Lt?vt.current=[c,h]:e.kind===Gl&&!e.isMaybeScrollbar&&(De(To,!1),H(void 0),pe(),et==null||et(),lt.current=void 0,kt.current=void 0)},[Rt,fe,pe,Ce,mo,Se,u,Ve,Kt,et,Pt,s,Pe,Le,Ao,p,ge,De,ie,me,Q,Gt]),Vt=r.useRef(!1),vt=r.useRef(),zl=r.useRef(Je),$e=r.useRef(),Yn=r.useCallback(e=>{if(St.current=!1,zl.current=we.current,e.button!==0&&e.button!==1){$e.current=void 0;return}const l=performance.now();$e.current={button:e.button,time:l,location:e.location},(e==null?void 0:e.kind)==="header"&&(Vt.current=!0);const o=e.kind==="cell"&&e.isFillHandle;!o&&e.kind!=="cell"&&e.isEdge||(M({previousSelection:u,fillHandle:o}),vt.current=void 0,!e.isTouch&&e.button===0&&!o?Ut(e):!e.isTouch&&e.button===1&&(vt.current=e.location))},[u,Ut]),[Bo,Xo]=r.useState(),Ll=r.useCallback(e=>{if(e.kind!==Lt||fe!=="multi")return;const l=Lo.value?e.metaKey:e.ctrlKey,[o]=e.location,i=u.columns;if(o<s)return;const c=G[o];let h=o,a=o;for(let f=o-1;f>=s&&Ul(c.group,G[f].group);f--)h--;for(let f=o+1;f<G.length&&Ul(c.group,G[f].group);f++)a++;if(pe(),l)if(i.hasAll([h,a+1])){let f=i;for(let m=h;m<=a;m++)f=f.remove(m);ie(f,void 0,l)}else ie(void 0,[h,a+1],l);else ie(V.fromSingleSelection([h,a+1]),void 0,l)},[fe,pe,u.columns,G,s,ie]),St=r.useRef(!1),vo=r.useCallback(async e=>{if(ce!==void 0&&Mt!==void 0){const l=we.current.y,o=we.current.height;let i=ce({x:e,y:l,width:1,height:Math.min(o,p-l)},Me.current.signal);typeof i!="object"&&(i=await i());const c=ke[e-s],a=document.createElement("canvas").getContext("2d",{alpha:!1});if(a!==null){a.font=ve.baseFontFull;const f=Jl(a,ve,c,0,i,bt,so,!1,Ce);Mt==null||Mt(c,f.width,e,f.width)}}},[ke,ce,so,ve,bt,Mt,s,p,Ce]),[_n,Yo]=r.useState(),Tt=r.useCallback(async(e,l)=>{var f,m;const o=(f=e.current)==null?void 0:f.range;if(o===void 0||ce===void 0||l.current===void 0)return;const i=l.current.range;if(_!==void 0){let g=!1;if(_({fillDestination:{...i,x:i.x-s},patternSource:{...o,x:o.x-s},preventDefault:()=>g=!0}),g)return}let c=ce(o,Me.current.signal);typeof c!="object"&&(c=await c());const h=c,a=[];for(let g=0;g<i.width;g++)for(let b=0;b<i.height;b++){const y=[i.x+g,i.y+b];if(Hr(y,o))continue;const w=h[b%o.height][g%o.width];Ro(w)||!ko(w)||a.push({location:y,value:{...w}})}Ee(a),(m=xe.current)==null||m.damage(a.map(g=>({cell:g.location})))},[ce,Ee,_,s]),Hl=r.useCallback(()=>{if(u.current===void 0||u.current.range.width<=1)return;const e={...u,current:{...u.current,range:{...u.current.range,width:1}}};Tt(e,u)},[Tt,u]),Dl=r.useCallback(()=>{if(u.current===void 0||u.current.range.height<=1)return;const e={...u,current:{...u.current,range:{...u.current.range,height:1}}};Tt(e,u)},[Tt,u]),jn=r.useCallback((e,l)=>{var b,y;const o=E;if(M(void 0),Go(void 0),Yo(void 0),Vt.current=!1,l)return;if((o==null?void 0:o.fillHandle)===!0&&u.current!==void 0&&((b=o.previousSelection)==null?void 0:b.current)!==void 0){if(mt===void 0)return;const w={...u,current:{...u.current,range:Dr(o.previousSelection.current.range,mt)}};Tt(o.previousSelection,w),De(w,!0);return}const[i,c]=e.location,[h,a]=vt.current??[],f=()=>{St.current=!0},m=w=>{var L,K,D;const S=w.isTouch||h===i&&a===c;if(S&&(ye==null||ye([i-s,c],{...w,preventDefault:f})),w.button===1)return!St.current;if(!St.current){const R=Se(e.location),B=Ce(R);if(B!==void 0&&B.onClick!==void 0&&S){const oe=B.onClick({...w,cell:R,posX:w.localEventX,posY:w.localEventY,bounds:w.bounds,theme:Gt(R,e.location),preventDefault:f});oe!==void 0&&!Ro(oe)&&_t(oe)&&(Ee([{location:w.location,value:oe}]),(L=xe.current)==null||L.damage([{cell:w.location}]))}if(St.current||u.current===void 0)return!1;let de=!1;switch(R.activationBehaviorOverride??Fo){case"double-click":case"second-click":{if(((D=(K=o==null?void 0:o.previousSelection)==null?void 0:K.current)==null?void 0:D.cell)===void 0)break;const[oe,We]=u.current.cell,[Xe,Ne]=o.previousSelection.current.cell;de=i===oe&&i===Xe&&c===We&&c===Ne&&(w.isDoubleClick===!0||Fo==="second-click");break}case"single-click":{de=!0;break}}if(de)return Z==null||Z([i-s,c]),xt(w.bounds,!1),!0}return!1},g=e.location[0]-s;if(e.isTouch){const w=we.current,S=zl.current;if(w.x!==S.x||w.y!==S.y)return;if(e.isLongTouch===!0){if(e.kind==="cell"&&Er((y=u.current)==null?void 0:y.cell,e.location)){Ae==null||Ae([g,e.location[1]],{...e,preventDefault:f});return}else if(e.kind==="header"&&u.columns.hasIndex(i)){Ie==null||Ie(g,{...e,preventDefault:f});return}else if(e.kind===Lt){if(g<0)return;z==null||z(g,{...e,preventDefault:f});return}}e.kind==="cell"?m(e)||Ut(e):e.kind===Lt?Te==null||Te(g,{...e,preventDefault:f}):(e.kind===$r&&(se==null||se(g,{...e,preventDefault:f})),Ut(e));return}if(e.kind==="header"){if(g<0)return;e.isEdge?e.isDoubleClick===!0&&vo(i):e.button===0&&i===h&&c===a&&(se==null||se(g,{...e,preventDefault:f}))}if(e.kind===Lt){if(g<0)return;e.button===0&&i===h&&c===a&&(Te==null||Te(g,{...e,preventDefault:f}),St.current||Ll(e))}e.kind==="cell"&&(e.button===0||e.button===1)&&m(e),vt.current=void 0},[E,u,s,mt,Tt,De,ye,Se,Ce,Fo,Gt,Ee,Z,xt,Ae,Ie,z,Ut,Te,se,vo,Ll]),qn=r.useCallback(e=>{const l={...e,location:[e.location[0]-s,e.location[1]]};to==null||to(l),E!==void 0&&e.buttons===0&&(M(void 0),Go(void 0),Yo(void 0),Vt.current=!1),Yo(o=>{var i;return Vt.current?[e.scrollEdge[0],0]:e.scrollEdge[0]===(o==null?void 0:o[0])&&e.scrollEdge[1]===o[1]?o:E===void 0||(((i=$e.current)==null?void 0:i.location[0])??0)<s?void 0:e.scrollEdge})},[E,to,s]),Zn=r.useCallback((e,l)=>{oo==null||oo(e-s,l)},[oo,s]),Be=(Ol=u==null?void 0:u.current)==null?void 0:Ol.cell,Jn=r.useCallback((e,l,o,i,c,h)=>{Nt.current=!1;let a=Be;a!==void 0&&(a=[a[0]-s,a[1]]);const f=qe===0?void 0:{x:0,y:e.y,width:qe,height:e.height},m=[];f!==void 0&&m.push(f),Ze>0&&(m.push({x:e.x-s,y:p-Ze,width:e.width,height:Ze}),qe>0&&m.push({x:0,y:p-Ze,width:qe,height:Ze}));const g={x:e.x-s,y:e.y,width:e.width,height:Q&&e.y+e.height>=p?e.height-1:e.height,tx:c,ty:h,extras:{selected:a,freezeRegion:f,freezeRegions:m}};we.current=g,yl(g),Un([l,o,i]),ro==null||ro(g,g.tx,g.ty,g.extras)},[Be,s,Q,p,qe,Ze,yl,ro]),Qn=zt(ut,r.useCallback((e,l)=>{ut==null||ut(e-s,l-s),fe!=="none"&&ie(V.fromSingleSelection(l),void 0,!0)},[fe,ut,s,ie])),_o=r.useRef(!1),er=r.useCallback(e=>{if(e.location[0]===0&&s>0){e.preventDefault();return}eo==null||eo({...e,location:[e.location[0]-s,e.location[1]]}),e.defaultPrevented()||(_o.current=!0),M(void 0)},[eo,s]),tr=r.useCallback(()=>{_o.current=!1},[]),jo=r.useRef(),qo=r.useCallback(e=>{var l,o,i;if(!Fr(e,jo.current)&&(jo.current=e,!(((l=$e==null?void 0:$e.current)==null?void 0:l.button)!==void 0&&$e.current.button>=1))){if(e.buttons!==0&&E!==void 0&&((o=$e.current)==null?void 0:o.location[0])===0&&e.location[0]===0&&s===1&&Le==="multi"&&E.previousSelection&&!E.previousSelection.rows.hasIndex($e.current.location[1])&&u.rows.hasIndex($e.current.location[1])){const c=Math.min($e.current.location[1],e.location[1]),h=Math.max($e.current.location[1],e.location[1])+1;me(V.fromSingleSelection([c,h]),void 0,!1)}if(e.buttons!==0&&E!==void 0&&u.current!==void 0&&!_o.current&&!Vt.current&&(Ge==="rect"||Ge==="multi-rect")){const[c,h]=u.current.cell;let[a,f]=e.location;if(f<0&&(f=we.current.y),E.fillHandle===!0&&((i=E.previousSelection)==null?void 0:i.current)!==void 0){const m=E.previousSelection.current.range;f=Math.min(f,Q?p-1:p);const g=Ar(m,a,f,il);Go(g)}else{if(Q&&h===p)return;if(Q&&f===p)if(e.kind===Gl)f--;else return;a=Math.max(a,s);const b=a-c,y=f-h,w={x:b>=0?c:a,y:y>=0?h:f,width:Math.abs(b)+1,height:Math.abs(y)+1};ge({...u.current,range:w},!0,!1,"drag")}}no==null||no({...e,location:[e.location[0]-s,e.location[1]]})}},[il,E,s,Le,u,Ge,no,me,Q,p,ge]),or=r.useCallback(()=>{var a,f;const e=jo.current;if(e===void 0)return;const[l,o]=e.scrollEdge;let[i,c]=e.location;const h=we.current;l===-1?i=((f=(a=h.extras)==null?void 0:a.freezeRegion)==null?void 0:f.x)??h.x:l===1&&(i=h.x+h.width),o===-1?c=Math.max(0,h.y):o===1&&(c=Math.min(p-1,h.y+h.height)),i=Ht(i,0,G.length-1),c=Ht(c,0,p-1),qo({...e,location:[i,c]})},[G.length,qo,p]);Vi(_n,v,or);const Ke=r.useCallback(e=>{if(u.current===void 0)return;const[l,o]=e,[i,c]=u.current.cell,h=u.current.range;let a=h.x,f=h.x+h.width,m=h.y,g=h.y+h.height;if(o!==0)switch(o){case 2:{g=p,m=c,te(0,g,"vertical");break}case-2:{m=0,g=c+1,te(0,m,"vertical");break}case 1:{m<c?(m++,te(0,m,"vertical")):(g=Math.min(p,g+1),te(0,g,"vertical"));break}case-1:{g>c+1?(g--,te(0,g,"vertical")):(m=Math.max(0,m-1),te(0,m,"vertical"));break}default:Vl()}if(l!==0)if(l===2)f=G.length,a=i,te(f-1-s,0,"horizontal");else if(l===-2)a=s,f=i+1,te(a-s,0,"horizontal");else{let b=[];if(ce!==void 0){const y=ce({x:a,y:m,width:f-a-s,height:g-m},Me.current.signal);typeof y=="object"&&(b=ji(y))}if(l===1){let y=!1;if(a<i){if(b.length>0){const w=Dt(a+1,i+1).find(S=>!b.includes(S-s));w!==void 0&&(a=w,y=!0)}else a++,y=!0;y&&te(a,0,"horizontal")}y||(f=Math.min(G.length,f+1),te(f-1-s,0,"horizontal"))}else if(l===-1){let y=!1;if(f>i+1){if(b.length>0){const w=Dt(f-1,i,-1).find(S=>!b.includes(S-s));w!==void 0&&(f=w,y=!0)}else f--,y=!0;y&&te(f-s,0,"horizontal")}y||(a=Math.max(s,a-1),te(a-s,0,"horizontal"))}else Vl()}ge({cell:u.current.cell,range:{x:a,y:m,width:f-a,height:g-m}},!0,!1,"keyboard-select")},[ce,u,G.length,s,p,te,ge]),nt=r.useCallback((e,l,o,i)=>{const c=ue-(o?0:1);if(e=Ht(e,s,ke.length-1+s),l=Ht(l,0,c),e===(Be==null?void 0:Be[0])&&l===(Be==null?void 0:Be[1]))return!1;if(i&&u.current!==void 0){const h=[...u.current.rangeStack];(u.current.range.width>1||u.current.range.height>1)&&h.push(u.current.range),De({...u,current:{cell:[e,l],range:{x:e,y:l,width:1,height:1},rangeStack:h}},!0)}else ge({cell:[e,l],range:{x:e,y:l,width:1,height:1}},!0,!1,"keyboard-nav");return T.current!==void 0&&T.current[0]===e&&T.current[1]===l&&(T.current=void 0),te(e-s,l),!0},[ue,s,ke.length,Be,u,te,De,ge]),lr=r.useCallback((e,l)=>{(k==null?void 0:k.cell)!==void 0&&e!==void 0&&_t(e)&&(Ee([{location:k.cell,value:e}]),window.requestAnimationFrame(()=>{var c;(c=xe.current)==null||c.damage([{cell:k.cell}])})),pe(!0),H(void 0);const[o,i]=l;if(u.current!==void 0&&(o!==0||i!==0)){const c=u.current.cell[1]===ue-1&&e!==void 0;nt(Ht(u.current.cell[0]+o,0,G.length-1),Ht(u.current.cell[1]+i,0,ue-1),c,!1)}q==null||q(e,l)},[k==null?void 0:k.cell,pe,u,q,Ee,ue,nt,G.length]),nr=r.useMemo(()=>`gdg-overlay-${_i++}`,[]),Ct=r.useCallback(e=>{var o,i,c,h;pe();const l=[];for(let a=e.x;a<e.x+e.width;a++)for(let f=e.y;f<e.y+e.height;f++){const m=le([a-s,f]);if(!m.allowOverlay&&m.kind!==j.Boolean)continue;let g;if(m.kind===j.Custom){const b=Ce(m),y=(o=b==null?void 0:b.provideEditor)==null?void 0:o.call(b,m);(b==null?void 0:b.onDelete)!==void 0?g=b.onDelete(m):Ir(y)&&(g=(i=y==null?void 0:y.deletedValue)==null?void 0:i.call(y,m))}else if(_t(m)&&m.allowOverlay||m.kind===j.Boolean){const b=Ce(m);g=(c=b==null?void 0:b.onDelete)==null?void 0:c.call(b,m)}g!==void 0&&!Ro(g)&&_t(g)&&l.push({location:[a,f],value:g})}Ee(l),(h=xe.current)==null||h.damage(l.map(a=>({cell:a.location})))},[pe,le,Ce,Ee,s]),Bt=k!==void 0,El=r.useCallback(e=>{var S,L;const l=()=>{e.stopPropagation(),e.preventDefault()},o={didMatch:!1},{bounds:i}=e,c=u.columns,h=u.rows,a=tt;if(!Bt&&A(a.clear,e,o))De(To,!1),et==null||et();else if(!Bt&&A(a.selectAll,e,o))De({columns:V.empty(),rows:V.empty(),current:{cell:((S=u.current)==null?void 0:S.cell)??[s,0],range:{x:s,y:0,width:x.length,height:p},rangeStack:[]}},!1);else if(A(a.search,e,o))(L=P==null?void 0:P.current)==null||L.focus({preventScroll:!0}),gl(!0);else if(A(a.delete,e,o)){const K=(ot==null?void 0:ot(u))??!0;if(K!==!1){const D=K===!0?u:K;if(D.current!==void 0){Ct(D.current.range);for(const R of D.current.rangeStack)Ct(R)}for(const R of D.rows)Ct({x:s,y:R,width:x.length,height:1});for(const R of D.columns)Ct({x:R,y:0,width:1,height:p})}}if(o.didMatch)return l(),!0;if(u.current===void 0)return!1;let[f,m]=u.current.cell,g=!1,b=!1;A(a.scrollToSelectedCell,e,o)?po.current(f-s,m):fe!=="none"&&A(a.selectColumn,e,o)?c.hasIndex(f)?ie(c.remove(f),void 0,!0):fe==="single"?ie(V.fromSingleSelection(f),void 0,!0):ie(void 0,f,!0):Le!=="none"&&A(a.selectRow,e,o)?h.hasIndex(m)?me(h.remove(m),void 0,!0):Le==="single"?me(V.fromSingleSelection(m),void 0,!0):me(void 0,m,!0):!Bt&&i!==void 0&&A(a.activateCell,e,o)?m===p&&Q?window.setTimeout(()=>{const K=mo(f);Rt(K??f)},0):(Z==null||Z([f-s,m]),xt(i,!0)):u.current.range.height>1&&A(a.downFill,e,o)?Dl():u.current.range.width>1&&A(a.rightFill,e,o)?Hl():A(a.goToNextPage,e,o)?m+=Math.max(1,we.current.height-4):A(a.goToPreviousPage,e,o)?m-=Math.max(1,we.current.height-4):A(a.goToFirstCell,e,o)?(H(void 0),m=0,f=0):A(a.goToLastCell,e,o)?(H(void 0),m=Number.MAX_SAFE_INTEGER,f=Number.MAX_SAFE_INTEGER):A(a.selectToFirstCell,e,o)?(H(void 0),Ke([-2,-2])):A(a.selectToLastCell,e,o)?(H(void 0),Ke([2,2])):Bt?(A(a.closeOverlay,e,o)&&H(void 0),A(a.acceptOverlayDown,e,o)&&(H(void 0),m++),A(a.acceptOverlayUp,e,o)&&(H(void 0),m--),A(a.acceptOverlayLeft,e,o)&&(H(void 0),f--),A(a.acceptOverlayRight,e,o)&&(H(void 0),f++)):(A(a.goDownCell,e,o)?m+=1:A(a.goUpCell,e,o)?m-=1:A(a.goRightCell,e,o)?f+=1:A(a.goLeftCell,e,o)?f-=1:A(a.goDownCellRetainSelection,e,o)?(m+=1,g=!0):A(a.goUpCellRetainSelection,e,o)?(m-=1,g=!0):A(a.goRightCellRetainSelection,e,o)?(f+=1,g=!0):A(a.goLeftCellRetainSelection,e,o)?(f-=1,g=!0):A(a.goToLastRow,e,o)?m=p-1:A(a.goToFirstRow,e,o)?m=Number.MIN_SAFE_INTEGER:A(a.goToLastColumn,e,o)?f=Number.MAX_SAFE_INTEGER:A(a.goToFirstColumn,e,o)?f=Number.MIN_SAFE_INTEGER:(Ge==="rect"||Ge==="multi-rect")&&(A(a.selectGrowDown,e,o)?Ke([0,1]):A(a.selectGrowUp,e,o)?Ke([0,-1]):A(a.selectGrowRight,e,o)?Ke([1,0]):A(a.selectGrowLeft,e,o)?Ke([-1,0]):A(a.selectToLastRow,e,o)?Ke([0,2]):A(a.selectToFirstRow,e,o)?Ke([0,-2]):A(a.selectToLastColumn,e,o)?Ke([2,0]):A(a.selectToFirstColumn,e,o)&&Ke([-2,0])),b=o.didMatch);const y=nt(f,m,!1,g),w=o.didMatch;return w&&(y||!b||cl)&&l(),w},[Bt,u,tt,fe,Le,Ge,s,p,nt,De,et,x.length,ot,cl,Ct,ie,me,Q,mo,Rt,Z,xt,Dl,Hl,Ke]),Xt=r.useCallback(e=>{let l=!1;if($t!==void 0&&$t({...e,cancel:()=>{l=!0}}),l||El(e)||u.current===void 0)return;const[o,i]=u.current.cell,c=we.current;if(Qt&&!e.metaKey&&!e.ctrlKey&&u.current!==void 0&&e.key.length===1&&/[ -~]/g.test(e.key)&&e.bounds!==void 0&&ko(le([o-s,Math.max(0,Math.min(i,p-1))]))){if((!Q||i!==p)&&(c.y>i||i>c.y+c.height||c.x>o||o>c.x+c.width))return;xt(e.bounds,!0,e.key),e.stopPropagation(),e.preventDefault()}},[Qt,$t,El,u,le,s,p,Q,xt]),rr=r.useCallback((e,l)=>{const o=e.location[0]-s;if(e.kind==="header"&&(Ie==null||Ie(o,{...e,preventDefault:l})),e.kind===Lt){if(o<0)return;z==null||z(o,{...e,preventDefault:l})}if(e.kind==="cell"){const[i,c]=e.location;Ae==null||Ae([o,c],{...e,preventDefault:l}),Or(u,e.location)||nt(i,c,!1,!1)}},[u,Ae,z,Ie,s,nt]),Zo=r.useCallback(async e=>{var a,f,m;if(!tt.paste)return;function l(g,b,y,w){var L,K;const S=typeof y=="object"?(y==null?void 0:y.join(`
`))??"":(y==null?void 0:y.toString())??"";if(!Ro(g)&&ko(g)&&g.readonly!==!0){const D=J==null?void 0:J(S,g);if(D!==void 0&&_t(D))return{location:b,value:D};const R=Ce(g);if(R===void 0)return;if(R.kind===j.Custom){zo(g.kind===j.Custom);const B=(L=R.onPaste)==null?void 0:L.call(R,S,g.data);return B===void 0?void 0:{location:b,value:{...g,data:B}}}else{const B=(K=R.onPaste)==null?void 0:K.call(R,S,g,{formatted:w,formattedString:typeof w=="string"?w:w==null?void 0:w.join(`
`),rawValue:y});return B===void 0?void 0:(zo(B.kind===g.kind),{location:b,value:B})}}}const o=u.columns,i=u.rows,c=((a=v.current)==null?void 0:a.contains(document.activeElement))===!0||((f=F.current)==null?void 0:f.contains(document.activeElement))===!0;let h;if(u.current!==void 0?h=[u.current.range.x,u.current.range.y]:o.length===1?h=[o.first()??0,0]:i.length===1&&(h=[s,i.first()??0]),c&&h!==void 0){let g,b;const y="text/plain",w="text/html";if(navigator.clipboard.read!==void 0){const D=await navigator.clipboard.read();for(const R of D){if(R.types.includes(w)){const de=await(await R.getType(w)).text(),oe=Bl(de);if(oe!==void 0){g=oe;break}}R.types.includes(y)&&(b=await(await R.getType(y)).text())}}else if(navigator.clipboard.readText!==void 0)b=await navigator.clipboard.readText();else if(e!==void 0&&(e==null?void 0:e.clipboardData)!==null){if(e.clipboardData.types.includes(w)){const D=e.clipboardData.getData(w);g=Bl(D)}g===void 0&&e.clipboardData.types.includes(y)&&(b=e.clipboardData.getData(y))}else return;const[S,L]=h,K=[];do{if(ht===void 0){const D=Se(h),R=b??(g==null?void 0:g.map(de=>de.map(oe=>oe.rawValue).join("	")).join("	"))??"",B=l(D,h,R,void 0);B!==void 0&&K.push(B);break}if(g===void 0){if(b===void 0)return;g=Pr(b)}if(ht===!1||typeof ht=="function"&&(ht==null?void 0:ht([h[0]-s,h[1]],g.map(D=>D.map(R=>{var B;return((B=R.rawValue)==null?void 0:B.toString())??""}))))!==!0)return;for(const[D,R]of g.entries()){if(D+L>=p)break;for(const[B,de]of R.entries()){const oe=[B+S,D+L],[We,Xe]=oe;if(We>=G.length||Xe>=ue)continue;const Ne=Se(oe),Ye=l(Ne,oe,de.rawValue,de.formatted);Ye!==void 0&&K.push(Ye)}}}while(!1);Ee(K),(m=xe.current)==null||m.damage(K.map(D=>({cell:D.location})))}},[J,Ce,Se,u,tt.paste,G.length,Ee,ue,ht,s,p]);tl("paste",Zo,$,!1,!0);const Yt=r.useCallback(async(e,l)=>{var a,f;if(!tt.copy)return;const o=l===!0||((a=v.current)==null?void 0:a.contains(document.activeElement))===!0||((f=F.current)==null?void 0:f.contains(document.activeElement))===!0,i=u.columns,c=u.rows,h=(m,g)=>{if(!rl)Xl(m,g,e);else{const b=g.map(y=>({kind:j.Text,data:x[y].title,displayData:x[y].title,allowOverlay:!1}));Xl([b,...m],g,e)}};if(o&&ce!==void 0){if(u.current!==void 0){let m=ce(u.current.range,Me.current.signal);typeof m!="object"&&(m=await m()),h(m,Dt(u.current.range.x-s,u.current.range.x+u.current.range.width-s))}else if(c!==void 0&&c.length>0){const g=[...c].map(b=>{const y=ce({x:s,y:b,width:x.length,height:1},Me.current.signal);return typeof y=="object"?y[0]:y().then(w=>w[0])});if(g.some(b=>b instanceof Promise)){const b=await Promise.all(g);h(b,Dt(x.length))}else h(g,Dt(x.length))}else if(i.length>0){const m=[],g=[];for(const b of i){let y=ce({x:b,y:0,width:1,height:p},Me.current.signal);typeof y!="object"&&(y=await y()),m.push(y),g.push(b-s)}if(m.length===1)h(m[0],g);else{const b=m.reduce((y,w)=>y.map((S,L)=>[...S,...w[L]]));h(b,g)}}}},[x,ce,u,tt.copy,s,p,rl]);tl("copy",Yt,$,!1,!1);const ir=r.useCallback(async e=>{var o,i;if(!(!tt.cut||!(((o=v.current)==null?void 0:o.contains(document.activeElement))===!0||((i=F.current)==null?void 0:i.contains(document.activeElement))===!0))&&(await Yt(e),u.current!==void 0)){let c={current:{cell:u.current.cell,range:u.current.range,rangeStack:[]},rows:V.empty(),columns:V.empty()};const h=ot==null?void 0:ot(c);if(h===!1||(c=h===!0?c:h,c.current===void 0))return;Ct(c.current.range)}},[Ct,u,tt.cut,Yt,ot]);tl("cut",ir,$,!1,!1);const cr=r.useCallback((e,l)=>{if(Oe!==void 0){s!==0&&(e=e.map(c=>[c[0]-s,c[1]])),Oe(e,l);return}if(e.length===0||l===-1)return;const[o,i]=e[l];T.current!==void 0&&T.current[0]===o&&T.current[1]===i||(T.current=[o,i],nt(o,i,!1,!1))},[Oe,s,nt]),[Co,wo]=((Pl=gt==null?void 0:gt.current)==null?void 0:Pl.cell)??[],po=r.useRef(te);po.current=te,r.useLayoutEffect(()=>{var e,l,o,i;!Nt.current&&Co!==void 0&&wo!==void 0&&(Co!==((l=(e=ao.current)==null?void 0:e.current)==null?void 0:l.cell[0])||wo!==((i=(o=ao.current)==null?void 0:o.current)==null?void 0:i.cell[1]))&&po.current(Co,wo),Nt.current=!1},[Co,wo]);const $l=u.current!==void 0&&(u.current.cell[0]>=G.length||u.current.cell[1]>=ue);r.useLayoutEffect(()=>{$l&&De(To,!1)},[$l,De]);const sr=r.useMemo(()=>Q===!0&&(W==null?void 0:W.tint)===!0?V.fromSingleSelection(ue-1):V.empty(),[ue,Q,W==null?void 0:W.tint]),ar=r.useCallback(e=>typeof pt=="boolean"?pt:(pt==null?void 0:pt(e-s))??!0,[s,pt]),ur=r.useMemo(()=>{if(Bo===void 0||F.current===null)return null;const{bounds:e,group:l}=Bo,o=F.current.getBoundingClientRect();return X(Ei,{bounds:e,group:l,canvasBounds:o,onClose:()=>Xo(void 0),onFinish:i=>{Xo(void 0),ee==null||ee(l,i)}})},[ee,Bo]),dr=Math.min(G.length,qe+(Ve?1:0));r.useImperativeHandle(n,()=>({appendRow:(e,l)=>Rt(e+s,l),updateCells:e=>{var l;return s!==0&&(e=e.map(o=>({cell:[o.cell[0]+s,o.cell[1]]}))),(l=xe.current)==null?void 0:l.damage(e)},getBounds:(e,l)=>{var o;if(!((F==null?void 0:F.current)===null||(v==null?void 0:v.current)===null)){if(e===void 0&&l===void 0){const i=F.current.getBoundingClientRect(),c=i.width/v.current.clientWidth;return{x:i.x-v.current.scrollLeft*c,y:i.y-v.current.scrollTop*c,width:v.current.scrollWidth*c,height:v.current.scrollHeight*c}}return(o=xe.current)==null?void 0:o.getBounds((e??0)+s,l)}},focus:()=>{var e;return(e=xe.current)==null?void 0:e.focus()},emit:async e=>{switch(e){case"delete":Xt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Xt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Xt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Yt(void 0,!0);break;case"paste":await Zo();break}},scrollTo:te,remeasureColumns:e=>{for(const l of e)vo(l+s)}}),[Rt,vo,Yt,Xt,Zo,s,te]);const[Fl,Al]=Be??[],fr=r.useCallback(e=>{const[l,o]=e;if(o===-1){fe!=="none"&&(ie(V.fromSingleSelection(l),void 0,!1),pe());return}Fl===l&&Al===o||(ge({cell:e,range:{x:l,y:o,width:1,height:1}},!0,!1,"keyboard-nav"),te(l,o))},[fe,pe,te,Fl,Al,ge,ie]),[hr,gr]=r.useState(!1),Il=r.useRef(Vr(e=>{gr(e)},5)),mr=r.useCallback(()=>{Il.current(!0),u.current===void 0&&u.columns.length===0&&u.rows.length===0&&E===void 0&&ge({cell:[s,fo],range:{x:s,y:fo,width:1,height:1}},!0,!1,"keyboard-select")},[fo,u,E,s,ge]),vr=r.useCallback(()=>{Il.current(!1)},[]),[Cr,wr]=r.useMemo(()=>{let e;const l=(ae==null?void 0:ae.scrollbarWidthOverride)??Kr(),o=p+(Q?1:0);if(typeof He=="number")e=Wt+o*He;else{let c=0;const h=Math.min(o,10);for(let a=0;a<h;a++)c+=He(a);c=Math.floor(c/h),e=Wt+o*c}e+=l;const i=G.reduce((c,h)=>h.width+c,0)+l;return[`${Math.min(1e5,i)}px`,`${Math.min(1e5,e)}px`]},[G,ae==null?void 0:ae.scrollbarWidthOverride,He,p,Q,Wt]),pr=r.useMemo(()=>Wr(ve),[ve]);return X(Nr.Provider,{value:ve,children:jt(Ni,{style:pr,className:Et,inWidth:ne??Cr,inHeight:Fe??wr,children:[X(zi,{fillHandle:sn,drawFocusRing:an,experimental:ae,fixedShadowX:un,fixedShadowY:dn,getRowThemeOverride:O,headerIcons:fn,imageWindowLoader:hn,initialSize:gn,isDraggable:mn,onDragLeave:vn,onRowMoved:Pt,overscrollX:En,overscrollY:$n,preventDiagonalScrolling:pn,rightElement:bn,rightElementProps:yn,smoothScrollX:Mn,smoothScrollY:xn,className:Et,enableGroups:No,onCanvasFocused:mr,onCanvasBlur:vr,canvasRef:F,onContextMenu:rr,theme:ve,cellXOffset:Bn,cellYOffset:fo,accessibilityHeight:Je.height,onDragEnd:tr,columns:G,nonGrowWidth:vl,drawHeader:Nn,onColumnProposeMove:qt,drawCell:Gn,disabledRows:sr,freezeColumns:dr,lockColumns:s,firstColAccessible:s===0,getCellContent:Se,minColumnWidth:bt,maxColumnWidth:so,searchInputRef:P,showSearch:An,onSearchClose:In,highlightRegions:Xn,getCellsForSelection:ce,getGroupDetails:Uo,headerHeight:Ko,isFocused:hr,groupHeaderHeight:No?fl:0,freezeTrailingRows:Ze+(Q&&(W==null?void 0:W.sticky)===!0?1:0),hasAppendRow:Q,onColumnResize:Mt,onColumnResizeEnd:Kn,onColumnResizeStart:Wn,onCellFocused:fr,onColumnMoved:Qn,onDragStart:er,onHeaderMenuClick:Zn,onItemHovered:qo,isFilling:(E==null?void 0:E.fillHandle)===!0,onMouseMove:qn,onKeyDown:Xt,onKeyUp:at,onMouseDown:Yn,onMouseUp:jn,onDragOverCell:rn,onDrop:cn,onSearchResultsChanged:cr,onVisibleRegionChanged:Jn,clientSize:Wo,rowHeight:He,searchResults:st,searchValue:Do,onSearchValueChange:Zt,rows:ue,scrollRef:v,selection:u,translateX:Je.tx,translateY:Je.ty,verticalBorder:ar,gridRef:xe,getCellRenderer:Ce}),ur,k!==void 0&&X(r.Suspense,{fallback:null,children:X(Yi,{...k,validateCell:Pn,bloom:wt,id:nr,getCellRenderer:Ce,className:(ae==null?void 0:ae.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:nn,imageEditorOverride:N,onFinishEditing:lr,markdownDivCreateNode:be,isOutsideClick:zn})})]})})},Zi=r.forwardRef(qi),Ji=(t,n)=>{const d=r.useMemo(()=>({...yi,...t.headerIcons}),[t.headerIcons]),C=r.useMemo(()=>t.imageWindowLoader??new Gr,[t.imageWindowLoader]);return X(Zi,{...t,renderers:Ur,headerIcons:d,ref:n,imageWindowLoader:C})},sc=r.forwardRef(Ji);export{Li as C,sc as D,rt as k};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./data-grid-overlay-editor-hmiBYkvZ.js","./marked.esm-dbrxtycE.js","./index-BMVQvedj.js","./index-wocATsGp.js","./image-window-loader-hgJATaim.js","./throttle-7EuXLZa7.js","./_baseIteratee-WTHxv43n.js","./iframe-ni8xiI1Q.js","./image-window-loader-1jHxuE_X.css","./flatten-qRvRBp6y.js","./scrolling-data-grid-ta-GKPbC.js","./scrolling-data-grid-dE2iz8sf.css","./data-grid-overlay-editor-EbzU9_4i.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}