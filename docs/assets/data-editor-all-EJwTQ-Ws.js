var Ss=Object.defineProperty;var Ms=(e,t,n)=>t in e?Ss(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Oe=(e,t,n)=>(Ms(e,typeof t!="symbol"?t+"":t,n),n);import{r as l,R as Yt}from"./index-BMVQvedj.js";import{_ as ml}from"./iframe-l9ryaD9P.js";import{h as Rs,d as wl,j as Es,v as Is,_ as Ds,g as Fs,c as fn,r as io,t as Hs}from"./throttle-7EuXLZa7.js";import{u as Ts,f as $i}from"./flatten-qRvRBp6y.js";import{s as on,b as As}from"./marked.esm-dbrxtycE.js";function yl(e="This should not happen"){throw new Error(e)}function tn(e,t="Assertion failed"){if(!e)return yl(t)}function Jo(e,t){return yl(t??"Hell froze over")}function zs(e,t){try{return e()}catch{return t}}const Ni=Object.prototype.hasOwnProperty;function Io(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Io(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Ni.call(e,n)&&++o&&!Ni.call(t,n)||!(n in t)||!Io(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Er=null,wi=void 0;var j;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(j||(j={}));var Xi;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(Xi||(Xi={}));var Ir;(function(e){e.Triangle="triangle",e.Dots="dots"})(Ir||(Ir={}));function xr(e){return"width"in e&&typeof e.width=="number"}async function Yi(e){return typeof e=="object"?e:await e()}function So(e){return!(e.kind===j.Loading||e.kind===j.Bubble||e.kind===j.RowID||e.kind===j.Protected||e.kind===j.Drilldown)}function su(e){return!(e.kind===j.Loading||e.kind===j.Bubble||e.kind===j.RowID||e.kind===j.Protected||e.kind===j.Drilldown||e.kind===j.Boolean||e.kind===j.Image||e.kind===j.Custom)}function Mo(e){return e.kind===sn.Marker||e.kind===sn.NewRow}function Go(e){if(!So(e)||e.kind===j.Image)return!1;if(e.kind===j.Text||e.kind===j.Number||e.kind===j.Markdown||e.kind===j.Uri||e.kind===j.Custom||e.kind===j.Boolean)return e.readonly!==!0;Jo(e,"A cell was passed with an invalid kind")}function Bs(e){return Rs(e,"editor")}function di(e){return!(e.readonly??!1)}var sn;(function(e){e.NewRow="new-row",e.Marker="marker"})(sn||(sn={}));function Ls(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let Ki;const Tn=class Tn{constructor(t){Oe(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Tn(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Ls([...this.items,n]);return new Tn(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,a]of n.entries()){const[s,c]=a;if(s<=r&&o<=c){const u=[];s<o&&u.push([s,o]),r<c&&u.push([r,c]),n.splice(i,1,...u)}}return new Tn(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Oe(Tn,"empty",()=>Ki??(Ki=new Tn([]))),Oe(Tn,"fromSingleSelection",t=>Tn.empty().add(t));let nt=Tn;const Ps=on("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Lt(e,t,n,o,r=!1){const i=l.useRef();i.current=t,l.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const a=n,s=c=>{var u;(u=i.current)==null||u.call(a,c)};return a.addEventListener(e,s,{passive:o,capture:r}),()=>{a.removeEventListener(e,s,{capture:r})}},[e,n,o,r])}function xo(e,t){return e===void 0?void 0:t}const Os=Math.PI;function Ui(e){return e*Os/180}const bl=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),vl=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},pl=(e,t,n)=>Math.min(e,t-n*2),Cl=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,yi=e=>{const t=e.fgColor??"currentColor";return l.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),l.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},Ws=e=>{const t=e.fgColor??"currentColor";return l.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function $s(e,t,n){const[o,r]=l.useState(e),i=l.useRef(!0);l.useEffect(()=>()=>{i.current=!1},[]);const a=l.useRef(wl(s=>{i.current&&r(s)},n));return l.useLayoutEffect(()=>{i.current&&a.current(()=>e())},t),o}const Ns="֑-߿יִ-﷽ﹰ-ﻼ",Xs="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",Ys=new RegExp("^[^"+Xs+"]*["+Ns+"]");function bi(e){return Ys.test(e)?"rtl":"not-rtl"}let kr;function ui(){if(typeof document>"u")return 0;if(kr!==void 0)return kr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),kr=n-o,kr}const ro=Symbol();function Ks(e){const t=l.useRef([ro,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=l.useState(e),[,r]=l.useState(),i=l.useCallback(s=>{const c=t.current[0];c!==ro&&(s=typeof s=="function"?s(c):s,s===c)||(c!==ro&&r({}),o(u=>typeof s=="function"?s(c===ro?u:c):s),t.current[0]=ro)},[]),a=l.useCallback(()=>{t.current[0]=ro,r({})},[]);return[t.current[0]===ro?n:t.current[0],i,a]}function xl(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function Us(e){const t=l.useRef(e);return Io(e,t.current)||(t.current=e),t.current}const _s=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(s=>s!=="");if(i.length===0)return null;const a=i.length>1;return l.createElement(Ps,{"data-testid":"GDG-default-image-overlay-editor"},l.createElement(Es.Carousel,{showArrows:a,showThumbs:!1,swipeable:a,emulateTouch:a,infiniteLoop:a},i.map(s=>{const c=(r==null?void 0:r(s))??l.createElement("img",{draggable:!1,src:s});return l.createElement("div",{className:"gdg-centering-container",key:s},c)})),n&&o&&l.createElement("button",{className:"gdg-edit-icon",onClick:o},l.createElement(yi,null)))},Vs=on("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class Gs extends Yt.PureComponent{constructor(){super(...arguments);Oe(this,"targetElement",null);Oe(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,a=As(r),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let c=i==null?void 0:i(a);if(c===void 0){const f=document.createElement("template");f.innerHTML=a,c=f.content}n.append(c);const u=n.getElementsByTagName("a");for(const f of u)f.target="_blank",f.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Yt.createElement(Vs,{ref:this.containerRefHook})}}const qs=on("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),js=on("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),Zs=on("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let _i=0;const Tr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:a,...s}=e,{onChange:c,className:u}=s,f=l.useRef(null),m=n??"";tn(c!==void 0,"GrowingEntry must be a controlled input area");const[w]=l.useState(()=>"input-box-"+(_i=(_i+1)%1e7));l.useEffect(()=>{const h=f.current;if(h===null||h.disabled)return;const y=m.toString().length;h.focus(),h.setSelectionRange(r?0:y,y)},[]),l.useLayoutEffect(()=>{var h;if(a!==void 0){const y=typeof a=="number"?[a,null]:a;(h=f.current)==null||h.setSelectionRange(y[0],y[1])}},[a]);const g=l.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return l.createElement(Zs,{className:"gdg-growing-entry"},l.createElement(js,{className:u},m+`
`),l.createElement(qs,{...s,className:(u??"")+" gdg-input",id:w,ref:f,onKeyDown:g,value:m,placeholder:t,dir:"auto"}))},ni={};let Un=null;function Js(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Do(e){const t=e.toLowerCase().trim();if(ni[t]!==void 0)return ni[t];Un=Un||Js(),Un.style.color="#000",Un.style.color=t;const n=getComputedStyle(Un).color;Un.style.color="#fff",Un.style.color=t;const o=getComputedStyle(Un).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),ni[t]=r,r}function lo(e,t){const[n,o,r]=Do(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const Vi=new Map;function Gi(e,t){const n=`${e}-${t}`,o=Vi.get(n);if(o!==void 0)return o;const r=nn(e,t);return Vi.set(n,r),r}function nn(e,t){if(t===void 0)return e;const[n,o,r,i]=Do(e);if(i===1)return e;const[a,s,c,u]=Do(t),f=i+u*(1-i),m=(i*n+u*a*(1-i))/f,w=(i*o+u*s*(1-i))/f,g=(i*r+u*c*(1-i))/f;return`rgba(${m}, ${w}, ${g}, ${f})`}function au(e,t,n){if(n<=0)return e;if(n>=1)return t;const o=[...Do(e)];o[0]=o[0]*o[3],o[1]=o[1]*o[3],o[2]=o[2]*o[3];const r=[...Do(t)];r[0]=r[0]*r[3],r[1]=r[1]*r[3],r[2]=r[2]*r[3];const i=n,a=1-n,s=o[3]*a+r[3]*i,c=Math.floor((o[0]*a+r[0]*i)/s),u=Math.floor((o[1]*a+r[1]*i)/s),f=Math.floor((o[2]*a+r[2]*i)/s);return`rgba(${c}, ${u}, ${f}, ${s})`}function cu(e){if(e==="transparent")return 0;function t(i){const a=i/255;return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}const[n,o,r]=Do(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function Qs(e,t){return Yt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked})),[e,t])}function ea(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(qo(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function Qo(e,t){return(e??"")===(t??"")}function ta(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function kl(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function qo(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Sl(e){return[e.x+e.width-1,e.y+e.height-1]}function qi(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,a=n.y+n.height-1,[s,c]=e;if(c<i||c>a)return!1;if(t.span===void 0)return s>=o&&s<=r;const[u,f]=t.span;return u>=o&&u<=r||f>=o&&u<=r||u<o&&f>r}function na(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&qi(e,t,i)&&r++;for(const a of n.current.rangeStack)qi(e,t,a)&&r++;return r}function Ml(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,a)=>({...i,sticky:e[a].sticky})),n=o}return n}function Fo(e,t){let n=0;const o=Ml(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function so(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function fi(e,t,n,o,r){const i=Ml(e,o),a=[];for(const u of i)if(u.sticky)a.push(u);else break;if(a.length>0)for(const u of a)n-=u.width;let s=t,c=r??0;for(;c<=n&&s<i.length;)c+=i[s].width,s++;for(let u=t;u<s;u++){const f=i[u];f.sticky||a.push(f)}return a}function oa(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function ra(e,t,n,o,r,i,a,s,c,u){const f=o+r;if(n&&e<=r)return-2;if(e<=f)return-1;let m=t;for(let h=0;h<u;h++){const y=i-1-h,b=typeof a=="number"?a:a(y);if(m-=b,e>=m)return y}const w=i-u,g=e-(c??0);if(typeof a=="number"){const h=Math.floor((g-f)/a)+s;return h>=w?void 0:h}else{let h=f;for(let y=s;y<w;y++){const b=a(y);if(g<=h+b)return y;h+=b}return}}let Rr=0,jo={};const ia=typeof window>"u";async function la(){var e;ia||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Rr=0,jo={},Is())}la();function Rl(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Ho(e,t,n,o="middle"){const r=Rl(e,t,o,n);let i=jo[r];return i===void 0&&(i=t.measureText(e),jo[r]=i,Rr++),Rr>1e4&&(jo={},Rr=0),i}function El(e,t){const n=Rl(e,void 0,"middle",t);return jo[n]}function qn(e,t){return typeof t!="string"&&(t=t.baseFontFull),sa(e,t)}function ji(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Zi=[];function sa(e,t){for(const i of Zi)if(i.key===t)return i.val;const n=ji(e,"alphabetic"),r=-(ji(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Zi.push({key:t,val:r}),r}function aa(e,t,n,o,r,i){const{ctx:a,rect:s,theme:c}=e;let u=Number.MAX_SAFE_INTEGER;const f=500;if(t!==void 0&&(u=n-t,u<f)){const m=1-u/f;a.globalAlpha=m,a.fillStyle=c.bgSearchResult,a.fillRect(s.x+1,s.y+1,s.width-(r?2:1),s.height-(i?2:1)),a.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return u<f}function tr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},a=n??r.textDark;return a!==i.fillStyle&&(o.fillStyle=a,i.fillStyle=a),i}function du(e,t,n){const{rect:o,ctx:r,theme:i}=e;r.fillStyle=i.textDark,xn({ctx:r,rect:o,theme:i},t,n)}function Il(e,t,n,o,r,i,a,s,c){c==="right"?e.fillText(t,n+r-(s.cellHorizontalPadding+.5),o+i/2+a):c==="center"?e.fillText(t,n+r/2,o+i/2+a):e.fillText(t,n+s.cellHorizontalPadding+.5,o+i/2+a)}function Dl(e,t){const n=Ho("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function ca(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function da(e,t,n,o,r,i,a,s,c,u){const f=s.baseFontFull,m=Ds(e,t,f,r-s.cellHorizontalPadding*2,u??!1),w=Dl(e,f),g=s.lineHeight*w,h=w+g*(m.length-1),y=h+s.cellVerticalPadding>i;y&&(e.save(),e.rect(n,o,r,i),e.clip());const b=o+i/2-h/2;let S=Math.max(o+s.cellVerticalPadding,b);for(const C of m)if(Il(e,C,n,S,r,w,a,s,c),S+=g,S>o+i)break;y&&e.restore()}function xn(e,t,n,o,r){const{ctx:i,rect:a,theme:s}=e,{x:c,y:u,width:f,height:m}=a;o=o??!1,o||(t=ca(t,f));const w=qn(i,s),g=bi(t)==="rtl";if(n===void 0&&g&&(n="right"),g&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?da(i,t,c,u,f,m,w,s,n,r):Il(i,t,c,u,f,m,w,s,n),h&&(i.textAlign="start"),g&&(i.direction="inherit")}}function kn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function ua(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function fa(e,t,n){const o=function(s,c){const u=c.x-s.x,f=c.y-s.y,m=Math.sqrt(u*u+f*f),w=u/m,g=f/m;return{x:u,y:c.y-s.y,len:m,nx:w,ny:g,ang:Math.atan2(g,w)}};let r;const i=t.length;let a=t[i-1];for(let s=0;s<i;s++){let c=t[s%i];const u=t[(s+1)%i],f=o(c,a),m=o(c,u),w=f.nx*m.ny-f.ny*m.nx,g=f.nx*m.nx-f.ny*-m.ny;let h=Math.asin(w<-1?-1:w>1?1:w),y=1,b=!1;g<0?h<0?h=Math.PI+h:(h=Math.PI-h,y=-1,b=!0):h>0&&(y=-1,b=!0),r=c.radius!==void 0?c.radius:n;const S=h/2;let C=Math.abs(Math.cos(S)*r/Math.sin(S)),x;C>Math.min(f.len/2,m.len/2)?(C=Math.min(f.len/2,m.len/2),x=Math.abs(C*Math.sin(S)/Math.cos(S))):x=r;let X=c.x+m.nx*C,Y=c.y+m.ny*C;X+=-m.ny*x*y,Y+=m.nx*x*y,e.arc(X,Y,x,f.ang+Math.PI/2*y,m.ang-Math.PI/2*y,b),a=c,c=u}e.closePath()}function hi(e,t,n,o,r,i,a,s,c,u,f,m,w,g,h){const y={x:0,y:i+u,width:0,height:0};if(e>=g.length||t>=f||t<-2||e<0)return y;const b=i-r;if(e>=m){const S=a>e?-1:1,C=Fo(g);y.x+=C+c;for(let x=a;x!==e;x+=S)y.x+=g[S===1?x:x-1].width*S}else for(let S=0;S<e;S++)y.x+=g[S].width;if(y.width=g[e].width+1,t===-1)y.y=r,y.height=b;else if(t===-2){y.y=0,y.height=r;let S=e;const C=g[e].group,x=g[e].sticky;for(;S>0&&Qo(g[S-1].group,C)&&g[S-1].sticky===x;){const Y=g[S-1];y.x-=Y.width,y.width+=Y.width,S--}let X=e;for(;X+1<g.length&&Qo(g[X+1].group,C)&&g[X+1].sticky===x;){const Y=g[X+1];y.width+=Y.width,X++}if(!x){const Y=Fo(g),H=y.x-Y;H<0&&(y.x-=H,y.width+=H),y.x+y.width>n&&(y.width=n-y.x)}}else if(t>=f-w){let S=f-t;for(y.y=o;S>0;){const C=t+S-1;y.height=typeof h=="number"?h:h(C),y.y-=y.height,S--}y.height+=1}else{const S=s>t?-1:1;if(typeof h=="number"){const C=t-s;y.y+=C*h}else for(let C=s;C!==t;C+=S)y.y+=h(C)*S;y.height=(typeof h=="number"?h:h(t))+1}return y}const vi=1<<21;function hn(e,t){return(t+2)*vi+e}function Fl(e){return e%vi}function pi(e){return Math.floor(e/vi)-2}function Ci(e){const t=Fl(e),n=pi(e);return[t,n]}class Hl{constructor(){Oe(this,"visibleWindow",{x:0,y:0,width:0,height:0});Oe(this,"freezeCols",0);Oe(this,"freezeRows",[]);Oe(this,"isInWindow",t=>{const n=Fl(t),o=pi(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,a=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&a})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Io(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class ha extends Hl{constructor(){super(...arguments);Oe(this,"cache",new Map);Oe(this,"setValue",(n,o)=>{this.cache.set(hn(n[0],n[1]),o)});Oe(this,"getValue",n=>this.cache.get(hn(n[0],n[1])));Oe(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Zo{constructor(t=[]){Oe(this,"cells");this.cells=new Set(t.map(n=>hn(n[0],n[1])))}add(t){this.cells.add(hn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(hn(t[0],t[1]))}remove(t){this.cells.delete(hn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(pi(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(hn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Ci(t)}}function ga(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const Tl={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4};function Al(){return Tl}const zl=Yt.createContext(Tl);function uu(){return Yt.useContext(zl)}function Gn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=nn(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const gi=150;function ma(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??gi}function Bl(e,t,n,o,r,i,a,s,c){let u=0;const f=r===void 0?[]:r.map(w=>{const g=ma(e,w[o],t,c);return u=Math.max(u,g),g});if(f.length>5&&s){u=0;let w=0;for(const h of f)w+=h;const g=w/f.length;for(let h=0;h<f.length;h++)f[h]>=g*2?f[h]=0:u=Math.max(u,f[h])}u=Math.max(u,e.measureText(n.title).width+16+(n.icon===void 0?0:28));const m=Math.max(Math.ceil(i),Math.min(Math.floor(a),Math.ceil(u)));return{...n,width:m}}function wa(e,t,n,o,r,i,a,s,c){const u=l.useRef(t),f=l.useRef(n),m=l.useRef(a);u.current=t,f.current=n,m.current=a;const[w,g]=l.useMemo(()=>{if(typeof window>"u")return[null,null];const C=document.createElement("canvas");return C.style.display="none",C.style.opacity="0",C.style.position="fixed",[C,C.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>(w&&document.documentElement.append(w),()=>{w==null||w.remove()}),[w]);const h=l.useRef({}),y=l.useRef(),[b,S]=l.useState();return l.useLayoutEffect(()=>{const C=f.current;if(C===void 0||e.every(xr))return;let x=Math.max(1,10-Math.floor(e.length/1e4)),X=0;x<u.current&&x>1&&(x--,X=1);const Y={x:0,y:0,width:e.length,height:Math.min(u.current,x)},H={x:0,y:u.current-1,width:e.length,height:1};(async()=>{const _=C(Y,c.signal),M=X>0?C(H,c.signal):void 0;let W;typeof _=="object"?W=_:W=await Yi(_),M!==void 0&&(typeof M=="object"?W=[...W,...M]:W=[...W,...await Yi(M)]),y.current=e,S(W)})()},[c.signal,e]),l.useMemo(()=>{let x=e.every(xr)?e:g===null?e.map(T=>xr(T)?T:{...T,width:gi}):(g.font=m.current.baseFontFull,e.map((T,_)=>{if(xr(T))return T;if(h.current[T.id]!==void 0)return{...T,width:h.current[T.id]};if(b===void 0||y.current!==e||T.id===void 0)return{...T,width:gi};const M=Bl(g,a,T,_,b,r,i,!0,s);return h.current[T.id]=M.width,M})),X=0,Y=0;const H=[];for(const[T,_]of x.entries())X+=_.width,_.grow!==void 0&&_.grow>0&&(Y+=_.grow,H.push(T));if(X<o&&H.length>0){const T=[...x],_=o-X;let M=_;for(let W=0;W<H.length;W++){const L=H[W],A=(x[L].grow??0)/Y,E=W===H.length-1?M:Math.min(M,Math.floor(_*A));T[L]={...x[L],growOffset:E,width:x[L].width+E},M-=E}x=T}return{sizedColumns:x,nonGrowWidth:X}},[o,e,g,b,a,r,i,s])}const lt='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',ya=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${lt}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},ba=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${lt}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},va=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},pa=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Ca=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Ll=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},xa=e=>{const t=e.bgColor;return`${lt}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},ka=Ll,Sa=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Ma=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${lt}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Ra=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},Ea=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${lt}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},Ia=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${lt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Da=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Fa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${lt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},Ha=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},Ta=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${lt}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},Aa=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},za=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${lt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},Ba=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${lt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},La=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},Pa=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},Oa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${lt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},Wa=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},$a=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${lt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},Na=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},Xa=e=>{const t=e.fgColor,n=e.bgColor;return`${lt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},Ya=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},Ka=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},Ua={headerRowID:ya,headerNumber:va,headerCode:ba,headerString:pa,headerBoolean:Ca,headerAudioUri:ka,headerVideoUri:Sa,headerEmoji:Ma,headerImage:Ra,headerUri:Ll,headerPhone:Ea,headerMarkdown:Ia,headerDate:Da,headerTime:Fa,headerEmail:Ha,headerReference:Ta,headerIfThenElse:Aa,headerSingleValue:za,headerLookup:Ba,headerTextTemplate:La,headerMath:Pa,headerRollup:Oa,headerJoinStrings:Wa,headerSplitString:$a,headerGeoDistance:Na,headerArray:Xa,rowOwnerOverlay:Ya,protectedColumnOverlay:Ka,renameIcon:xa};function _a(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Va{constructor(t,n){Oe(this,"onSettled");Oe(this,"spriteMap",new Map);Oe(this,"headerIcons");Oe(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,a,s,c=1){const[u,f]=_a(n,s),m=a*Math.ceil(window.devicePixelRatio),w=`${u}_${f}_${m}_${t}`;let g=this.spriteMap.get(w);if(g===void 0){const h=this.headerIcons[t];if(h===void 0)return;g=document.createElement("canvas");const y=g.getContext("2d");if(y===null)return;const b=new Image;b.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:f,bgColor:u}))}`,this.spriteMap.set(w,g);const S=b.decode();if(S===void 0)return;this.inFlight++,S.then(()=>{y.drawImage(b,0,0,m,m)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(g,0,0,m,m,r,i,a,a),c<1&&(o.globalAlpha=1)}}function Pl(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function Ar(e,t,n,o,r,i,a,s,c){s=s??t;let u=t,f=e;const m=o-i;let w=!1;for(;u<n&&f<m;){const g=r(f);if(u+g>s&&c(u,f,g,!1,a&&f===o-1)===!0){w=!0;break}u+=g,f++}if(!w){u=n;for(let g=0;g<i;g++){f=o-1-g;const h=r(f);u-=h,c(u,f,h,!0,a&&f===o-1)}}}function jn(e,t,n,o,r,i){let a=0,s=0;const c=r+o;for(const u of e){const f=u.sticky?s:a+n;if(i(u,f,c,u.sticky?0:s,t)===!0)break;a+=u.width,s+=u.sticky?u.width:0}}function Ol(e,t,n,o,r){let i=0,a=0;for(let s=0;s<e.length;s++){const c=e[s];let u=s+1,f=c.width;for(c.sticky&&(a+=f);u<e.length&&Qo(e[u].group,c.group)&&e[u].sticky===e[s].sticky;){const y=e[u];f+=y.width,u++,s++,y.sticky&&(a+=y.width)}const m=c.sticky?0:n,w=i+m,g=c.sticky?0:Math.max(0,a-w),h=Math.min(f-g,t-(w+g));r([c.sourceIndex,e[u-1].sourceIndex],c.group??"",w+g,0,h,o),i+=f}}function Wl(e,t,n,o,r,i,a){var w;const[s,c]=e;let u,f;const m=((w=a.find(g=>!g.sticky))==null?void 0:w.sourceIndex)??0;if(c>m){const g=Math.max(s,m);let h=t,y=o;for(let b=i.sourceIndex-1;b>=g;b--)h-=a[b].width,y+=a[b].width;for(let b=i.sourceIndex+1;b<=c;b++)y+=a[b].width;f={x:h,y:n,width:y,height:r}}if(m>s){const g=Math.min(c,m-1);let h=t,y=o;for(let b=i.sourceIndex-1;b>=s;b--)h-=a[b].width,y+=a[b].width;for(let b=i.sourceIndex+1;b<=g;b++)y+=a[b].width;u={x:h,y:n,width:y,height:r}}return[u,f]}function Ga(e,t,n,o){if(o==="any")return $l(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),kl([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,a=n-e.y+1,s=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:a,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return c===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===a?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function er(e,t,n,o,r,i,a,s){return e<=r+a&&r<=e+n&&t<=i+s&&i<=t+o}function Eo(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function $l(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function qa(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function ja(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,a=t+4,s=n+4,c=r-e.x,u=e.x+e.width-a,f=i-e.y,m=e.y+e.height-s,w=c>0?e.x+Math.floor(c/o)*o:e.x,g=u>0?e.x+e.width-Math.floor(u/o)*o:e.x+e.width,h=f>0?e.y+Math.floor(f/o)*o:e.y,y=m>0?e.y+e.height-Math.floor(m/o)*o:e.y+e.height;return{x:w,y:h,width:g-w,height:y-h}}function Za(e,t,n,o,r){const[i,a,s,c]=t,[u,f,m,w]=r,{x:g,y:h,width:y,height:b}=e,S=[];if(y<=0||b<=0)return S;const C=g+y,x=h+b,X=g<i,Y=h<a,H=g+y>s,T=h+b>c,_=g>=i&&g<s||C>i&&C<=s||g<i&&C>s,M=h>=a&&h<c||x>a&&x<=c||h<a&&x>c;if(_&&M){const L=Math.max(g,i),A=Math.max(h,a),E=Math.min(C,s),R=Math.min(x,c);S.push({rect:{x:L,y:A,width:E-L,height:R-A},clip:{x:u,y:f,width:m-u+1,height:w-f+1}})}if(X&&Y){const L=g,A=h,E=Math.min(C,i),R=Math.min(x,a);S.push({rect:{x:L,y:A,width:E-L,height:R-A},clip:{x:0,y:0,width:u+1,height:f+1}})}if(Y&&_){const L=Math.max(g,i),A=h,E=Math.min(C,s),R=Math.min(x,a);S.push({rect:{x:L,y:A,width:E-L,height:R-A},clip:{x:u,y:0,width:m-u+1,height:f+1}})}if(Y&&H){const L=Math.max(g,s),A=h,E=C,R=Math.min(x,a);S.push({rect:{x:L,y:A,width:E-L,height:R-A},clip:{x:m,y:0,width:n-m+1,height:f+1}})}if(X&&M){const L=g,A=Math.max(h,a),E=Math.min(C,i),R=Math.min(x,c);S.push({rect:{x:L,y:A,width:E-L,height:R-A},clip:{x:0,y:f,width:u+1,height:w-f+1}})}if(H&&M){const L=Math.max(g,s),A=Math.max(h,a),E=C,R=Math.min(x,c);S.push({rect:{x:L,y:A,width:E-L,height:R-A},clip:{x:m,y:f,width:n-m+1,height:w-f+1}})}if(X&&T){const L=g,A=Math.max(h,c),E=Math.min(C,i),R=x;S.push({rect:{x:L,y:A,width:E-L,height:R-A},clip:{x:0,y:w,width:u+1,height:o-w+1}})}if(T&&_){const L=Math.max(g,i),A=Math.max(h,c),E=Math.min(C,s),R=x;S.push({rect:{x:L,y:A,width:E-L,height:R-A},clip:{x:u,y:w,width:m-u+1,height:o-w+1}})}if(H&&T){const L=Math.max(g,s),A=Math.max(h,c),E=C,R=x;S.push({rect:{x:L,y:A,width:E-L,height:R-A},clip:{x:m,y:w,width:n-m+1,height:o-w+1}})}return S}const Ja={kind:j.Loading,allowOverlay:!1};function Ji(e,t,n,o,r,i,a,s,c,u,f,m,w,g,h,y,b,S,C,x,X,Y,H,T,_,M,W,L,A,E,R,le,te,ne,Se){let De=(x==null?void 0:x.size)??Number.MAX_SAFE_INTEGER;const Q=performance.now();let U=E.baseFontFull;e.font=U;const me={ctx:e},oe=[0,0],Ce=b>0?so(c,b,u):0;let we,V;const Ee=Pl(C);return jn(t,s,i,a,r,(Me,Ze,Qe,ut,et)=>{const Fe=Math.max(0,ut-Ze),Ke=Ze+Fe,xe=r+1,ft=Me.width-Fe,st=o-r-1;if(C.length>0){let We=!1;for(let ze=0;ze<C.length;ze++){const Be=C[ze];if(er(Ke,xe,ft,st,Be.x,Be.y,Be.width,Be.height)){We=!0;break}}if(!We)return}const Ge=()=>{e.save(),e.beginPath(),e.rect(Ke,xe,ft,st),e.clip()},q=X.columns.hasIndex(Me.sourceIndex),Pe=m(Me.group??"").overrideTheme,Re=Me.themeOverride===void 0&&Pe===void 0?E:Gn(E,Pe,Me.themeOverride),Ie=Re.baseFontFull;Ie!==U&&(U=Ie,e.font=Ie),Ge();let ge;return Ar(et,Qe,o,c,u,b,S,Ee,(We,ze,Be,ce,ve)=>{var qt,yt,zt;if(ze<0||(oe[0]=Me.sourceIndex,oe[1]=ze,x!==void 0&&!x.has(oe)))return;if(C.length>0){let Ye=!1;for(let bt=0;bt<C.length;bt++){const ot=C[bt];if(er(Ze,We,Me.width,Be,ot.x,ot.y,ot.width,ot.height)){Ye=!0;break}}if(!Ye)return}const Je=X.rows.hasIndex(ze),$e=g.hasIndex(ze),Xe=ze<c?f(oe):Ja;let at=Ze,qe=Me.width,He=!1,ht=!1;if(Xe.span!==void 0){const[Ye,bt]=Xe.span,ot=`${ze},${Ye},${bt},${Me.sticky}`;if(V===void 0&&(V=new Set),V.has(ot)){De--;return}else{const Pt=Wl(Xe.span,Ze,We,Me.width,Be,Me,n),It=Me.sticky?Pt[0]:Pt[1];if(!Me.sticky&&Pt[0]!==void 0&&(ht=!0),It!==void 0){at=It.x,qe=It.width,V.add(ot),e.restore(),ge=void 0,e.save(),e.beginPath();const jt=Math.max(0,ut-It.x);e.rect(It.x+jt,We,It.width-jt,Be),we===void 0&&(we=[]),we.push({x:It.x+jt,y:We,width:It.width-jt,height:Be}),e.clip(),He=!0}}}const gt=w==null?void 0:w(ze),Kt=ve&&((qt=Me.trailingRowOptions)==null?void 0:qt.themeOverride)!==void 0?(yt=Me.trailingRowOptions)==null?void 0:yt.themeOverride:void 0,dt=Xe.themeOverride===void 0&&gt===void 0&&Kt===void 0?Re:Gn(Re,gt,Kt,Xe.themeOverride);e.beginPath();const kt=ta(oe,Xe,X);let St=na(oe,Xe,X,y);const An=Xe.span!==void 0&&X.columns.some(Ye=>Xe.span!==void 0&&Ye>=Xe.span[0]&&Ye<=Xe.span[1]);kt&&!h&&y?St=0:kt&&y&&(St=Math.max(St,1)),An&&St++,kt||(Je&&St++,q&&!ve&&St++);const zn=Xe.kind===j.Protected?dt.bgCellMedium:dt.bgCell;let rt;if((ce||zn!==E.bgCell)&&(rt=nn(zn,rt)),St>0||$e){$e&&(rt=nn(dt.bgHeader,rt));for(let Ye=0;Ye<St;Ye++)rt=nn(dt.accentLight,rt)}else if(Y!==void 0){for(const Ye of Y)if(Ye[0]===Me.sourceIndex&&Ye[1]===ze){rt=nn(dt.bgSearchResult,rt);break}}if(H!==void 0)for(let Ye=0;Ye<H.length;Ye++){const bt=H[Ye],ot=bt.range;bt.style!=="solid-outline"&&ot.x<=Me.sourceIndex&&Me.sourceIndex<ot.x+ot.width&&ot.y<=ze&&ze<ot.y+ot.height&&(rt=nn(bt.color,rt))}let Sn=!1;if(x!==void 0){const Ye=We+1,ot=(ce?Ye+Be-1:Math.min(Ye+Be-1,o-Ce))-Ye;(ot!==Be-1||at+1<=ut)&&(Sn=!0,e.save(),e.beginPath(),e.rect(at+1,Ye,qe-1,ot),e.clip()),rt=rt===void 0?dt.bgCell:nn(rt,dt.bgCell)}const Le=Me.sourceIndex===n.length-1,je=ze===c-1;rt!==void 0&&(e.fillStyle=rt,ge!==void 0&&(ge.fillStyle=rt),x!==void 0?e.fillRect(at+1,We+1,qe-(Le?2:1),Be-(je?2:1)):e.fillRect(at,We,qe,Be)),Xe.style==="faded"&&(e.globalAlpha=.6);let At;for(let Ye=0;Ye<M.length;Ye++){const bt=M[Ye];if(bt.item[0]===Me.sourceIndex&&bt.item[1]===ze){At=bt;break}}if(qe>Se&&!ht){const Ye=dt.baseFontFull;Ye!==U&&(e.font=Ye,U=Ye),ge=Nl(e,Xe,Me.sourceIndex,ze,Le,je,at,We,qe,Be,St>0,dt,rt??dt.bgCell,T,_,(At==null?void 0:At.hoverAmount)??0,W,A,Q,L,ge,R,le,te,ne)}return Sn&&e.restore(),Xe.style==="faded"&&(e.globalAlpha=1),De--,He&&(e.restore(),(zt=ge==null?void 0:ge.deprep)==null||zt.call(ge,me),ge=void 0,Ge(),U=Ie,e.font=Ie),De<=0}),e.restore(),De<=0}),we}const Ko=[0,0],Uo={x:0,y:0,width:0,height:0},oi=[void 0,()=>{}];let mi=!1;function Qa(){mi=!0}function Nl(e,t,n,o,r,i,a,s,c,u,f,m,w,g,h,y,b,S,C,x,X,Y,H,T,_){var le,te;let M,W;b!==void 0&&b[0][0]===n&&b[0][1]===o&&(M=b[1][0],W=b[1][1]);let L;Ko[0]=n,Ko[1]=o,Uo.x=a,Uo.y=s,Uo.width=c,Uo.height=u,oi[0]=H.getValue(Ko),oi[1]=ne=>H.setValue(Ko,ne),mi=!1;const A={ctx:e,theme:m,col:n,row:o,cell:t,rect:Uo,highlighted:f,cellFillColor:w,hoverAmount:y,frameTime:C,hoverX:M,drawState:oi,hoverY:W,imageLoader:g,spriteManager:h,hyperWrapping:S,overrideCursor:M!==void 0?_:void 0,requestAnimationFrame:Qa},E=aa(A,t.lastUpdated,C,X,r,i),R=T(t);if(R!==void 0){(X==null?void 0:X.renderer)!==R&&((le=X==null?void 0:X.deprep)==null||le.call(X,A),X=void 0);const ne=(te=R.drawPrep)==null?void 0:te.call(R,A,X);x!==void 0&&!Mo(A.cell)?x(A,()=>R.draw(A,t)):R.draw(A,t),L=ne===void 0?void 0:{deprep:ne==null?void 0:ne.deprep,fillStyle:ne==null?void 0:ne.fillStyle,font:ne==null?void 0:ne.font,renderer:R}}return(E||mi)&&(Y==null||Y(Ko)),L}function xi(e,t,n,o,r,i,a,s,c=-20,u=-20,f=32,m="center",w="square"){const g=Math.floor(r+a/2),h=w==="circle"?1e4:t.roundingRadius??4;let y=pl(f,a,t.cellVerticalPadding),b=y/2;const S=vl(m,o,i,t.cellHorizontalPadding,y),C=bl(S,g,y),x=Cl(o+c,r+u,C);switch(n){case!0:{e.beginPath(),kn(e,S-y/2,g-y/2,y,y,h),w==="circle"&&(b*=.8,y*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(S-b+y/4.23,g-b+y/1.97),e.lineTo(S-b+y/2.42,g-b+y/1.44),e.lineTo(S-b+y/1.29,g-b+y/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Er:case!1:{e.beginPath(),kn(e,S-y/2+.5,g-y/2+.5,y-1,y-1,h),e.lineWidth=1,e.strokeStyle=x?t.textDark:t.textMedium,e.stroke();break}case wi:{e.beginPath(),kn(e,S-y/2,g-y/2,y,y,h),e.fillStyle=x?t.textMedium:t.textLight,e.fill(),w==="circle"&&(b*=.8,y*=.8),e.beginPath(),e.moveTo(S-y/3,g),e.lineTo(S+y/3,g),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:Jo()}}function ec(e,t,n,o,r,i,a,s,c,u,f,m,w,g,h,y,b,S,C){const x=a+s;if(x<=0)return;e.fillStyle=m.bgHeader,e.fillRect(0,0,r,x);const[X,Y]=(o==null?void 0:o[0])??[],H=m.headerFontFull;e.font=H,jn(t,0,i,0,x,(T,_,M,W)=>{var me;if(b!==void 0&&!b.has([T.sourceIndex,-1]))return;const L=Math.max(0,W-_);e.save(),e.beginPath(),e.rect(_+L,s,T.width-L,a),e.clip();const A=y(T.group??"").overrideTheme,E=T.themeOverride===void 0&&A===void 0?m:Gn(m,A,T.themeOverride);E.bgHeader!==m.bgHeader&&(e.fillStyle=E.bgHeader,e.fill()),E!==m&&(e.font=E.baseFontFull);const R=f.columns.hasIndex(T.sourceIndex),le=c!==void 0||u,te=!le&&Y===-1&&X===T.sourceIndex,ne=le?0:((me=g.find(oe=>oe.item[0]===T.sourceIndex&&oe.item[1]===-1))==null?void 0:me.hoverAmount)??0,Se=(f==null?void 0:f.current)!==void 0&&f.current.cell[0]===T.sourceIndex,De=R?E.accentColor:Se?E.bgHeaderHasFocus:E.bgHeader,Q=n?s:0,U=T.sourceIndex===0?0:1;R?(e.fillStyle=De,e.fillRect(_+U,Q,T.width-U,a)):(Se||ne>0)&&(e.beginPath(),e.rect(_+U,Q,T.width-U,a),Se&&(e.fillStyle=E.bgHeaderHasFocus,e.fill()),ne>0&&(e.globalAlpha=ne,e.fillStyle=E.bgHeaderHovered,e.fill(),e.globalAlpha=1)),Kl(e,_,Q,T.width,a,T,R,E,te,Se,ne,w,S,C),e.restore()}),n&&tc(e,t,r,i,s,o,m,w,g,h,y,b)}function tc(e,t,n,o,r,i,a,s,c,u,f,m){const[g,h]=(i==null?void 0:i[0])??[];let y=0;Ol(t,n,o,r,(b,S,C,x,X,Y)=>{if(m!==void 0&&!m.hasItemInRectangle({x:b[0],y:-2,width:b[1]-b[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(C,x,X,Y),e.clip();const H=f(S),T=(H==null?void 0:H.overrideTheme)===void 0?a:Gn(a,H.overrideTheme),_=h===-2&&g!==void 0&&g>=b[0]&&g<=b[1],M=_?T.bgHeaderHovered:T.bgHeader;if(M!==a.bgHeader&&(e.fillStyle=M,e.fill()),e.fillStyle=T.textGroupHeader??T.textHeader,H!==void 0){let W=C;if(H.icon!==void 0&&(s.drawSprite(H.icon,"normal",e,W+8,(r-20)/2,20,T),W+=26),e.fillText(H.name,W+8,r/2+qn(e,a.headerFontFull)),H.actions!==void 0&&_){const L=Xl({x:C,y:x,width:X,height:Y},H.actions);e.beginPath();const A=L[0].x-10,E=C+X-A;e.rect(A,0,E,r);const R=e.createLinearGradient(A,0,A+E,0),le=lo(M,0);R.addColorStop(0,le),R.addColorStop(10/E,M),R.addColorStop(1,M),e.fillStyle=R,e.fill(),e.globalAlpha=.6;const[te,ne]=(i==null?void 0:i[1])??[-1,-1];for(let Se=0;Se<H.actions.length;Se++){const De=H.actions[Se],Q=L[Se],U=Eo(Q,te+C,ne);U&&(e.globalAlpha=1),s.drawSprite(De.icon,"normal",e,Q.x+Q.width/2-10,Q.y+Q.height/2-10,20,T),U&&(e.globalAlpha=.6)}e.globalAlpha=1}}C!==0&&u(b[0])&&(e.beginPath(),e.moveTo(C+.5,0),e.lineTo(C+.5,r),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()),e.restore(),y=C+X}),e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()}const ko=30;function nc(e,t,n,o,r){return r?{x:e,y:t,width:ko,height:Math.min(ko,o)}:{x:e+n-ko,y:Math.max(t,t+o/2-ko/2),width:ko,height:Math.min(ko,o)}}function Xl(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,a=26;for(let s=0;s<t.length;s++)n.push({x:o,y:r,width:a,height:i}),o+=26;return n}function _o(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function Yl(e,t,n,o,r,i,a,s){var S;const c=a.cellHorizontalPadding,u=a.headerIconSize,f=nc(n,o,r,i,!1);let m=n+c;const w=t.icon===void 0?void 0:{x:m,y:o+(i-u)/2,width:u,height:u},g=w===void 0||t.overlayIcon===void 0?void 0:{x:w.x+9,y:w.y+6,width:18,height:18};w!==void 0&&(m+=Math.ceil(u*1.3));const h={x:m,y:o,width:r-m,height:i};let y;if(t.indicatorIcon!==void 0){const C=e===void 0?((S=El(t.title,a.headerFontFull))==null?void 0:S.width)??0:Ho(t.title,e,a.headerFontFull).width;h.width=C,m+=C+c,y={x:m,y:o+(i-u)/2,width:u,height:u}}const b=n+r/2;return{menuBounds:_o(f,b,s),iconBounds:_o(w,b,s),iconOverlayBounds:_o(g,b,s),textBounds:_o(h,b,s),indicatorIconBounds:_o(y,b,s)}}function Qi(e,t,n,o,r,i,a,s,c,u,f,m,w,g){if(i.rowMarker!==void 0){const b=i.rowMarkerChecked;b!==!0&&(e.globalAlpha=u),xi(e,s,b,t,n,o,r,!1,void 0,void 0,18,"center",i.rowMarker),b!==!0&&(e.globalAlpha=1);return}const h=a?s.textHeaderSelected:s.textHeader,y=i.hasMenu===!0&&(c||m&&a)&&g.menuBounds!==void 0;if(i.icon!==void 0&&g.iconBounds!==void 0){let b=a?"selected":"normal";i.style==="highlight"&&(b=a?"selected":"special"),f.drawSprite(i.icon,b,e,g.iconBounds.x,g.iconBounds.y,g.iconBounds.width,s),i.overlayIcon!==void 0&&g.iconOverlayBounds!==void 0&&f.drawSprite(i.overlayIcon,a?"selected":"special",e,g.iconOverlayBounds.x,g.iconOverlayBounds.y,g.iconOverlayBounds.width,s)}if(y&&o>35){const S=w?35:o-35,C=w?35*.7:o-35*.7,x=S/o,X=C/o,Y=e.createLinearGradient(t,0,t+o,0),H=lo(h,0);Y.addColorStop(w?1:0,h),Y.addColorStop(x,h),Y.addColorStop(X,H),Y.addColorStop(w?0:1,H),e.fillStyle=Y}else e.fillStyle=h;if(w&&(e.textAlign="right"),g.textBounds!==void 0&&e.fillText(i.title,w?g.textBounds.x+g.textBounds.width:g.textBounds.x,n+r/2+qn(e,s.headerFontFull)),w&&(e.textAlign="left"),i.indicatorIcon!==void 0&&g.indicatorIconBounds!==void 0&&(!y||!er(g.menuBounds.x,g.menuBounds.y,g.menuBounds.width,g.menuBounds.height,g.indicatorIconBounds.x,g.indicatorIconBounds.y,g.indicatorIconBounds.width,g.indicatorIconBounds.height))){let b=a?"selected":"normal";i.style==="highlight"&&(b=a?"selected":"special"),f.drawSprite(i.indicatorIcon,b,e,g.indicatorIconBounds.x,g.indicatorIconBounds.y,g.indicatorIconBounds.width,s)}if(y&&g.menuBounds!==void 0){const b=g.menuBounds;if(i.menuIcon===void 0||i.menuIcon===Ir.Triangle){e.beginPath();const S=b.x+b.width/2-5.5,C=b.y+b.height/2-3;fa(e,[{x:S,y:C},{x:S+11,y:C},{x:S+5.5,y:C+6}],1),e.fillStyle=h,e.fill()}else if(i.menuIcon===Ir.Dots){e.beginPath();const S=b.x+b.width/2,C=b.y+b.height/2;ua(e,S,C),e.fillStyle=h,e.fill()}else{const S=b.x+(b.width-s.headerIconSize)/2,C=b.y+(b.height-s.headerIconSize)/2;f.drawSprite(i.menuIcon,"normal",e,S,C,s.headerIconSize,s)}}}function Kl(e,t,n,o,r,i,a,s,c,u,f,m,w,g){const h=bi(i.title)==="rtl",y=Yl(e,i,t,n,o,r,s,h);w!==void 0?w({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:a,hoverAmount:f,isHovered:c,hasSelectedCell:u,spriteManager:m,menuBounds:(y==null?void 0:y.menuBounds)??{x:0,y:0,height:0,width:0}},()=>Qi(e,t,n,o,r,i,a,s,c,f,m,g,h,y)):Qi(e,t,n,o,r,i,a,s,c,f,m,g,h,y)}function oc(e,t,n,o,r,i,a,s,c,u,f,m,w,g,h,y,b,S,C){if(S!==void 0||t[t.length-1]!==n[t.length-1])return;const x=Pl(b);jn(t,c,a,s,i,(X,Y,H,T,_)=>{if(X!==t[t.length-1])return;Y+=X.width;const M=Math.max(Y,T);M>o||(e.save(),e.beginPath(),e.rect(M,i+1,1e4,r-i-1),e.clip(),Ar(_,H,r,u,f,h,y,x,(W,L,A,E)=>{if(!E&&b.length>0&&!b.some(Se=>er(Y,W,1e4,A,Se.x,Se.y,Se.width,Se.height)))return;const R=w.hasIndex(L),le=g.hasIndex(L);e.beginPath();const te=m==null?void 0:m(L),ne=te===void 0?C:Gn(C,te);ne.bgCell!==C.bgCell&&(e.fillStyle=ne.bgCell,e.fillRect(Y,W,1e4,A)),le&&(e.fillStyle=ne.bgHeader,e.fillRect(Y,W,1e4,A)),R&&(e.fillStyle=ne.accentLight,e.fillRect(Y,W,1e4,A))}),e.restore())})}function rc(e,t,n,o,r,i,a,s,c){let u=!1;for(const h of t)if(!h.sticky){u=a(h.sourceIndex);break}const f=c.horizontalBorderColor??c.borderColor,m=c.borderColor,w=u?Fo(t):0;let g;if(w!==0&&(g=Gi(m,c.bgCell),e.beginPath(),e.moveTo(w+.5,0),e.lineTo(w+.5,o),e.strokeStyle=g,e.stroke()),r>0){const h=m===f&&g!==void 0?g:Gi(f,c.bgCell),y=so(i,r,s);e.beginPath(),e.moveTo(0,o-y+.5),e.lineTo(n,o-y+.5),e.strokeStyle=h,e.stroke()}}const Ul=(e,t,n)=>{let o=0,r=t,i=0,a=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),r=Math.max(r,s.x+s.width+1),i=Math.min(i,s.y-1),a=Math.max(a,s.y+s.height+1)}return{minX:o,maxX:r,minY:i,maxY:a}};function ic(e,t,n,o,r,i,a,s,c,u,f,m,w,g,h){var A;const y=h.bgCell,{minX:b,maxX:S,minY:C,maxY:x}=Ul(s,i,a),X=[],Y=a-so(g,w,u);let H=c,T=n,_=0;for(;H+r<Y;){const E=H+r,R=u(T);if(E>=C&&E<=x-1){const le=f==null?void 0:f(T),te=le==null?void 0:le.bgCell;te!==void 0&&te!==y&&T>=g-w&&X.push({x:b,y:E,w:S-b,h:R,color:te})}H+=R,T<g-w&&(_=H),T++}let M=0;const W=Math.min(Y,x)-_;if(W>0)for(let E=0;E<t.length;E++){const R=t[E];if(R.width===0)continue;const le=R.sticky?M:M+o,te=(A=R.themeOverride)==null?void 0:A.bgCell;te!==void 0&&te!==y&&le>=b&&le<=S&&m(E+1)&&X.push({x:le,y:_,w:R.width,h:W,color:te}),M+=R.width}if(X.length===0)return;let L;e.beginPath();for(let E=X.length-1;E>=0;E--){const R=X[E];L===void 0?L=R.color:R.color!==L&&(e.fillStyle=L,e.fill(),e.beginPath(),L=R.color),e.rect(R.x,R.y,R.w,R.h)}L!==void 0&&(e.fillStyle=L,e.fill()),e.beginPath()}function el(e,t,n,o,r,i,a,s,c,u,f,m,w,g,h,y,b,S=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,a);for(const A of c)e.rect(A.x+1,A.y+1,A.width-1,A.height-1);e.clip("evenodd")}const C=b.horizontalBorderColor??b.borderColor,x=b.borderColor,{minX:X,maxX:Y,minY:H,maxY:T}=Ul(s,i,a),_=[];e.beginPath();let M=.5;for(let A=0;A<t.length;A++){const E=t[A];if(E.width===0)continue;M+=E.width;const R=E.sticky?M:M+o;R>=X&&R<=Y&&g(A+1)&&_.push({x1:R,y1:Math.max(u,H),x2:R,y2:Math.min(a,T),color:x})}let W=a+.5;for(let A=y-h;A<y;A++){const E=m(A);W-=E,_.push({x1:X,y1:W,x2:Y,y2:W,color:C})}if(S!==!0){let A=f+.5,E=n;const R=W;for(;A+r<R;){const le=A+r;if(le>=H&&le<=T-1){const te=w==null?void 0:w(E);_.push({x1:X,y1:le,x2:Y,y2:le,color:(te==null?void 0:te.horizontalBorderColor)??(te==null?void 0:te.borderColor)??C})}A+=m(E),E++}}const L=Fs(_,A=>A.color);for(const A of Object.keys(L)){e.strokeStyle=A;for(const E of L[A])e.moveTo(E.x1,E.y1),e.lineTo(E.x2,E.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function lc(e,t,n,o,r,i,a,s,c,u,f,m,w,g,h,y,b,S,C){const x=[];e.imageSmoothingEnabled=!1;const X=Math.min(r.cellYOffset,a),Y=Math.max(r.cellYOffset,a);let H=0;if(typeof S=="number")H+=(Y-X)*S;else for(let R=X;R<Y;R++)H+=S(R);a>r.cellYOffset&&(H=-H),H+=c-r.translateY;const T=Math.min(r.cellXOffset,i),_=Math.max(r.cellXOffset,i);let M=0;for(let R=T;R<_;R++)M+=y[R].width;i>r.cellXOffset&&(M=-M),M+=s-r.translateX;const W=Fo(b);if(M!==0&&H!==0)return{regions:[]};const L=u>0?so(w,u,S):0,A=f-W-Math.abs(M),E=m-g-L-Math.abs(H)-1;if(A>150&&E>150){const R={sx:0,sy:0,sw:f*h,sh:m*h,dx:0,dy:0,dw:f*h,dh:m*h};if(H>0?(R.sy=(g+1)*h,R.sh=E*h,R.dy=(H+g+1)*h,R.dh=E*h,x.push({x:0,y:g,width:f,height:H+1})):H<0&&(R.sy=(-H+g+1)*h,R.sh=E*h,R.dy=(g+1)*h,R.dh=E*h,x.push({x:0,y:m+H-L,width:f,height:-H+L})),M>0?(R.sx=W*h,R.sw=A*h,R.dx=(M+W)*h,R.dw=A*h,x.push({x:W-1,y:0,width:M+2,height:m})):M<0&&(R.sx=(W-M)*h,R.sw=A*h,R.dx=W*h,R.dw=A*h,x.push({x:f+M,y:0,width:-M,height:m})),e.setTransform(1,0,0,1,0,0),C){if(W>0&&M!==0&&H===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const le=W*h,te=m*h;e.drawImage(t,0,0,le,te,0,0,le,te)}if(L>0&&M===0&&H!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const le=(m-L)*h,te=f*h,ne=L*h;e.drawImage(t,0,le,te,ne,0,le,te,ne)}}e.drawImage(t,R.sx,R.sy,R.sw,R.sh,R.dx,R.dy,R.dw,R.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:x}}function sc(e,t,n,o,r,i,a,s,c,u){const f=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||jn(c,n,o,r,s,(m,w,g,h)=>{if(m.sourceIndex===u){const y=Math.max(w,h)+1;return f.push({x:y,y:0,width:i-y,height:a}),!0}}),f}function ac(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Io(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:a,...s}=r,{width:c,...u}=i;if(!Io(s,u))return!1;n=o}return n===void 0?!0:n}return!0}function tl(e,t,n,o,r,i,a,s,c,u,f,m,w,g,h,y){const b=h==null?void 0:h.filter(T=>T.style!=="no-outline");if(b===void 0||b.length===0)return;const S=Fo(s),C=so(g,w,m),x=[c,0,s.length,g-w],X=[S,0,t,n-C],Y=b.map(T=>{const _=T.range,M=T.style??"dashed";return Za(_,x,t,n,X).map(W=>{const L=W.rect,A=hi(L.x,L.y,t,n,f,u+f,o,r,i,a,g,c,w,s,m),E=L.width===1&&L.height===1?A:hi(L.x+L.width-1,L.y+L.height-1,t,n,f,u+f,o,r,i,a,g,c,w,s,m);return L.x+L.width>=s.length&&(E.width-=1),L.y+L.height>=g&&(E.height-=1),{color:T.color,style:M,clip:W.clip,rect:ja({x:A.x,y:A.y,width:E.x+E.width-A.x,height:E.y+E.height-A.y},t,n,8)}})}),H=()=>{e.lineWidth=1;let T=!1;for(const _ of Y)for(const M of _)if((M==null?void 0:M.rect)!==void 0&&er(0,0,t,n,M.rect.x,M.rect.y,M.rect.width,M.rect.height)){const W=T,L=!qa(M.clip,M.rect);L&&(e.save(),e.rect(M.clip.x,M.clip.y,M.clip.width,M.clip.height),e.clip()),M.style==="dashed"&&!T?(e.setLineDash([5,3]),T=!0):(M.style==="solid"||M.style==="solid-outline")&&T&&(e.setLineDash([]),T=!1),e.strokeStyle=M.style==="solid-outline"?nn(nn(M.color,y.borderColor),y.bgCell):lo(M.color,1),e.strokeRect(M.rect.x+.5,M.rect.y+.5,M.rect.width-1,M.rect.height-1),L&&(e.restore(),T=W)}T&&e.setLineDash([])};return H(),H}function nl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function ri(e,t,n,o,r,i,a,s,c,u,f,m,w,g,h,y,b){if(f.current===void 0)return;const S=f.current.range,C=f.current.cell,x=[S.x+S.width-1,S.y+S.height-1];if(C[1]>=b&&x[1]>=b||!a.some(R=>R.sourceIndex===C[0]||R.sourceIndex===x[0]))return;const[Y,H]=f.current.cell,T=w(f.current.cell),_=T.span??[Y,Y],M=H>=b-g,W=g>0&&!M?so(b,g,m)-1:0,L=x[1];let A;if(jn(a,o,r,i,u,(R,le,te,ne,Se)=>{if(R.sticky&&Y>R.sourceIndex)return;const De=R.sourceIndex<_[0],Q=R.sourceIndex>_[1],U=R.sourceIndex===x[0];if(!(!U&&(De||Q)))return Ar(Se,te,n,b,m,g,h,void 0,(me,oe,Ce)=>{if(oe!==H&&oe!==L)return;let we=le,V=R.width;if(T.span!==void 0){const Me=Wl(T.span,le,me,R.width,Ce,R,s),Ze=R.sticky?Me[0]:Me[1];Ze!==void 0&&(we=Ze.x,V=Ze.width)}return oe===L&&U&&y&&(A=()=>{var Me;ne>we&&!R.sticky&&(e.beginPath(),e.rect(ne,0,t-ne,n),e.clip()),e.beginPath(),e.rect(we+V-4,me+Ce-4,4,4),e.fillStyle=((Me=R.themeOverride)==null?void 0:Me.accentColor)??c.accentColor,e.fill()}),A!==void 0}),A!==void 0}),A===void 0)return;const E=()=>{e.save(),e.beginPath(),e.rect(0,u,t,n-u-W),e.clip(),A==null||A(),e.restore()};return E(),E}function cc(e,t,n,o,r,i,a,s,c){c===void 0||c.size===0||(e.beginPath(),Ol(t,n,i,o,(u,f,m,w,g,h)=>{c.hasItemInRectangle({x:u[0],y:-2,width:u[1]-u[0]+1,height:1})&&e.rect(m,w,g,h)}),jn(t,s,i,a,r,(u,f,m,w)=>{const g=Math.max(0,w-f),h=f+g+1,y=u.width-g-1;c.has([u.sourceIndex,-1])&&e.rect(h,o,y,r-o)}),e.clip())}function dc(e,t,n,o,r,i,a,s,c,u){let f=0;return jn(e,i,o,r,n,(m,w,g,h,y)=>(Ar(y,g,t,a,s,c,u,void 0,(b,S,C,x)=>{x||(f=Math.max(S,f))}),!0)),f}function ol(e,t){var Le;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:a,cellYOffset:s,translateX:c,translateY:u,mappedColumns:f,enableGroups:m,freezeColumns:w,dragAndDropState:g,theme:h,drawFocus:y,headerHeight:b,groupHeaderHeight:S,disabledRows:C,rowHeight:x,verticalBorder:X,overrideCursor:Y,isResizing:H,selection:T,fillHandle:_,freezeTrailingRows:M,rows:W,getCellContent:L,getGroupDetails:A,getRowThemeOverride:E,isFocused:R,drawHeaderCallback:le,prelightCells:te,drawCellCallback:ne,highlightRegions:Se,resizeCol:De,imageLoader:Q,lastBlitData:U,hoverValues:me,hyperWrapping:oe,hoverInfo:Ce,spriteManager:we,maxScaleFactor:V,hasAppendRow:Ee,touchMode:Me,enqueue:Ze,renderStateProvider:Qe,getCellRenderer:ut,renderStrategy:et,bufferACtx:Fe,bufferBCtx:Ke,damage:xe,minimumCellWidth:ft,resizeIndicator:st}=e;if(r===0||i===0)return;const Ge=et==="double-buffer",q=Math.min(V,Math.ceil(window.devicePixelRatio??1)),Pe=et!=="direct"&&ac(e,t),Re=n.canvas;(Re.width!==r*q||Re.height!==i*q)&&(Re.width=r*q,Re.height=i*q,Re.style.width=r+"px",Re.style.height=i+"px");const Ie=o.canvas,ge=m?S+b:b,We=ge+1;(Ie.width!==r*q||Ie.height!==We*q)&&(Ie.width=r*q,Ie.height=We*q,Ie.style.width=r+"px",Ie.style.height=We+"px");const ze=Fe.canvas,Be=Ke.canvas;Ge&&(ze.width!==r*q||ze.height!==i*q)&&(ze.width=r*q,ze.height=i*q,U.current!==void 0&&(U.current.aBufferScroll=void 0)),Ge&&(Be.width!==r*q||Be.height!==i*q)&&(Be.width=r*q,Be.height=i*q,U.current!==void 0&&(U.current.bBufferScroll=void 0));const ce=U.current;if(Pe===!0&&a===(ce==null?void 0:ce.cellXOffset)&&s===(ce==null?void 0:ce.cellYOffset)&&c===(ce==null?void 0:ce.translateX)&&u===(ce==null?void 0:ce.translateY))return;let ve=null;Ge&&(ve=n);const Je=o;let $e;Ge?xe!==void 0?$e=(ce==null?void 0:ce.lastBuffer)==="b"?Ke:Fe:$e=(ce==null?void 0:ce.lastBuffer)==="b"?Fe:Ke:$e=n;const Xe=$e.canvas,at=Ge?Xe===ze?Be:ze:Re,qe=typeof x=="number"?()=>x:x;Je.save(),$e.save(),Je.beginPath(),$e.beginPath(),Je.textBaseline="middle",$e.textBaseline="middle",q!==1&&(Je.scale(q,q),$e.scale(q,q));const He=fi(f,a,r,g,c);let ht=[];const gt=y&&((Le=T.current)==null?void 0:Le.cell[1])===s&&u===0;let Kt=!1;if(Se!==void 0){for(const je of Se)if(je.style!=="no-outline"&&je.range.y===s&&u===0){Kt=!0;break}}const dt=()=>{ec(Je,He,m,Ce,r,c,b,S,g,H,T,h,we,me,X,A,xe,le,Me),el(Je,He,s,c,u,r,i,void 0,void 0,S,ge,qe,E,X,M,W,h,!0),Je.beginPath(),Je.moveTo(0,We-.5),Je.lineTo(r,We-.5),Je.strokeStyle=nn(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),Je.stroke(),Kt&&tl(Je,r,i,a,s,c,u,f,w,b,S,x,M,W,Se,h),gt&&ri(Je,r,i,s,c,u,He,f,h,ge,T,qe,L,M,Ee,_,W)};if(xe!==void 0){const je=He[He.length-1].sourceIndex+1,At=xe.hasItemInRegion([{x:a,y:-2,width:je,height:2},{x:a,y:s,width:je,height:300},{x:0,y:s,width:w,height:300},{x:0,y:-2,width:w,height:2},{x:a,y:W-M,width:je,height:M,when:M>0}]),qt=yt=>{Ji(yt,He,f,i,ge,c,u,s,W,qe,L,A,E,C,R,y,M,Ee,ht,xe,T,te,Se,Q,we,me,Ce,ne,oe,h,Ze,Qe,ut,Y,ft);const zt=T.current;_&&y&&zt!==void 0&&xe.has(Sl(zt.range))&&ri(yt,r,i,s,c,u,He,f,h,ge,T,qe,L,M,Ee,_,W)};At&&(qt($e),ve!==null&&(ve.save(),ve.scale(q,q),ve.textBaseline="middle",qt(ve),ve.restore()),xe.hasHeader()&&(cc(Je,He,r,S,ge,c,u,s,xe),dt())),$e.restore(),Je.restore();return}if((Pe!==!0||a!==(ce==null?void 0:ce.cellXOffset)||c!==(ce==null?void 0:ce.translateX)||gt!==(ce==null?void 0:ce.mustDrawFocusOnHeader)||Kt!==(ce==null?void 0:ce.mustDrawHighlightRingsOnHeader))&&dt(),Pe===!0){tn(at!==void 0&&ce!==void 0);const{regions:je}=lc($e,at,at===ze?ce.aBufferScroll:ce.bBufferScroll,at===ze?ce.bBufferScroll:ce.aBufferScroll,ce,a,s,c,u,M,r,i,W,ge,q,f,He,x,Ge);ht=je}else Pe!==!1&&(tn(ce!==void 0),ht=sc(ce,a,s,c,u,r,i,ge,He,Pe));rc($e,He,r,i,M,W,X,qe,h);const kt=tl($e,r,i,a,s,c,u,f,w,b,S,x,M,W,Se,h),St=y?ri($e,r,i,s,c,u,He,f,h,ge,T,qe,L,M,Ee,_,W):void 0;if($e.fillStyle=h.bgCell,ht.length>0){$e.beginPath();for(const je of ht)$e.rect(je.x,je.y,je.width,je.height);$e.clip(),$e.fill(),$e.beginPath()}else $e.fillRect(0,0,r,i);const An=Ji($e,He,f,i,ge,c,u,s,W,qe,L,A,E,C,R,y,M,Ee,ht,xe,T,te,Se,Q,we,me,Ce,ne,oe,h,Ze,Qe,ut,Y,ft);oc($e,He,f,r,i,ge,c,u,s,W,qe,E,T.rows,C,M,Ee,ht,xe,h),ic($e,He,s,c,u,r,i,ht,ge,qe,E,X,M,W,h),el($e,He,s,c,u,r,i,ht,An,S,ge,qe,E,X,M,W,h),kt==null||kt(),St==null||St(),H&&st!=="none"&&jn(He,0,c,0,ge,(je,At)=>je.sourceIndex===De?(nl(Je,At+je.width,0,ge+1,nn(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),st==="full"&&nl($e,At+je.width,ge,i,nn(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),ve!==null&&(ve.fillStyle=h.bgCell,ve.fillRect(0,0,r,i),ve.drawImage($e.canvas,0,0));const zn=dc(He,i,ge,c,u,s,W,qe,M,Ee);Q==null||Q.setWindow({x:a,y:s,width:He.length,height:zn-s},w,Array.from({length:M},(je,At)=>W-1-At));const rt=ce!==void 0&&(a!==ce.cellXOffset||c!==ce.translateX),Sn=ce!==void 0&&(s!==ce.cellYOffset||u!==ce.translateY);U.current={cellXOffset:a,cellYOffset:s,translateX:c,translateY:u,mustDrawFocusOnHeader:gt,mustDrawHighlightRingsOnHeader:Kt,lastBuffer:Ge?Xe===ze?"a":"b":void 0,aBufferScroll:Xe===ze?[rt,Sn]:ce==null?void 0:ce.aBufferScroll,bBufferScroll:Xe===Be?[rt,Sn]:ce==null?void 0:ce.bBufferScroll},$e.restore(),Je.restore()}const uc=80;function fc(e){const t=e-1;return t*t*t+1}class hc{constructor(t){Oe(this,"callback");Oe(this,"currentHoveredItem");Oe(this,"leavingItems",[]);Oe(this,"lastAnimationTime");Oe(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>qo(o.item,t.item))||this.leavingItems.push(t)});Oe(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>qo(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Oe(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Oe(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Oe(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:fc(t.hoverAmount)})));Oe(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/uc;for(const i of this.leavingItems)i.hoverAmount=fn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=fn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Oe(this,"setHovered",t=>{var n;if(!qo((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class gc{constructor(t){Oe(this,"fn");Oe(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function ki(e){return new gc(e)}const mc=ki(()=>window.navigator.userAgent.includes("Firefox")),Dr=ki(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Fr=ki(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function wc(e){const t=l.useRef([]),n=l.useRef(0),o=l.useRef(e);o.current=e;const r=l.useCallback(()=>{const i=()=>window.requestAnimationFrame(a),a=()=>{const s=t.current.map(Ci);t.current=[],o.current(new Zo(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:a)},[]);return l.useCallback(i=>{t.current.length===0&&r();const a=hn(i[0],i[1]);t.current.includes(a)||t.current.push(a)},[r])}const Vn="header",en="group-header",Hr="out-of-bounds";var Ro;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Ro||(Ro={}));function _l(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const rl=6,yc=(e,t)=>{if(e.kind===j.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},bc=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:a,cellYOffset:s,headerHeight:c,fillHandle:u=!1,groupHeaderHeight:f,rowHeight:m,rows:w,getCellContent:g,getRowThemeOverride:h,onHeaderMenuClick:y,onHeaderIndicatorClick:b,enableGroups:S,isFilling:C,onCanvasFocused:x,onCanvasBlur:X,isFocused:Y,selection:H,freezeColumns:T,onContextMenu:_,freezeTrailingRows:M,fixedShadowX:W=!0,fixedShadowY:L=!0,drawFocusRing:A,onMouseDown:E,onMouseUp:R,onMouseMoveRaw:le,onMouseMove:te,onItemHovered:ne,dragAndDropState:Se,firstColAccessible:De,onKeyDown:Q,onKeyUp:U,highlightRegions:me,canvasRef:oe,onDragStart:Ce,onDragEnd:we,eventTargetRef:V,isResizing:Ee,resizeColumn:Me,isDragging:Ze,isDraggable:Qe=!1,allowResize:ut,disabledRows:et,hasAppendRow:Fe,getGroupDetails:Ke,theme:xe,prelightCells:ft,headerIcons:st,verticalBorder:Ge,drawCell:q,drawHeader:Pe,onCellFocused:Re,onDragOverCell:Ie,onDrop:ge,onDragLeave:We,imageWindowLoader:ze,smoothScrollX:Be=!1,smoothScrollY:ce=!1,experimental:ve,getCellRenderer:Je,resizeIndicator:$e="full"}=e,Xe=e.translateX??0,at=e.translateY??0,qe=Math.max(T,Math.min(i.length-1,a)),He=l.useRef(null),ht=l.useRef(window),gt=ht.current,Kt=ze,dt=l.useRef(),[kt,St]=l.useState(!1),An=l.useRef([]),zn=l.useRef(),[rt,Sn]=l.useState(),[Le,je]=l.useState(),At=l.useRef(null),[qt,yt]=l.useState(),[zt,Ye]=l.useState(!1),bt=l.useRef(zt);bt.current=zt;const ot=l.useMemo(()=>new Va(st,()=>{ao.current=void 0,Jn.current()}),[st]),Pt=S?f+c:c,It=l.useRef(-1),jt=((ve==null?void 0:ve.enableFirefoxRescaling)??!1)&&mc.value,To=((ve==null?void 0:ve.enableSafariRescaling)??!1)&&Dr.value;l.useLayoutEffect(()=>{window.devicePixelRatio===1||!jt&&!To||(It.current!==-1&&St(!0),window.clearTimeout(It.current),It.current=window.setTimeout(()=>{St(!1),It.current=-1},200))},[s,qe,Xe,at,jt,To]);const mt=Qs(i,T),Mt=W?Fo(mt,Se):0,Rt=l.useCallback((k,$,Z)=>{const se=k.getBoundingClientRect();if($>=mt.length||Z>=w)return;const G=se.width/n,re=hi($,Z,n,o,f,Pt,qe,s,Xe,at,w,T,M,mt,m);return G!==1&&(re.x*=G,re.y*=G,re.width*=G,re.height*=G),re.x+=se.x,re.y+=se.y,re},[n,o,f,Pt,qe,s,Xe,at,w,T,M,mt,m]),Ft=l.useCallback((k,$,Z,se)=>{const G=k.getBoundingClientRect(),re=G.width/n,de=($-G.left)/re,he=(Z-G.top)/re,ue=5,wt=fi(mt,qe,n,void 0,Xe);let fe=0,Ue=0;se instanceof MouseEvent&&(fe=se.button,Ue=se.buttons);const Ne=oa(de,wt,Xe),ae=ra(he,o,S,c,f,w,m,s,at,M),vt=(se==null?void 0:se.shiftKey)===!0,Vt=(se==null?void 0:se.ctrlKey)===!0,_e=(se==null?void 0:se.metaKey)===!0,an=se!==void 0&&!(se instanceof MouseEvent)||(se==null?void 0:se.pointerType)==="touch",Gt=[de<0?-1:n<de?1:0,he<Pt?-1:o<he?1:0];let pt;if(Ne===-1||he<0||de<0||ae===void 0||de>n||he>o){const tt=de>n?1:de<0?-1:0,$t=he>o?1:he<0?-1:0;let Jt=tt*2,Nn=$t*2;tt===0&&(Jt=Ne===-1?Ro.EndPadding:Ro.Center),$t===0&&(Nn=ae===void 0?Ro.EndPadding:Ro.Center);let bn=!1;if(Ne===-1&&ae===-1){const Et=Rt(k,mt.length-1,-1);tn(Et!==void 0),bn=$<Et.x+Et.width+ue}const Xn=de>n&&de<n+ui()||he>o&&he<o+ui();pt={kind:Hr,location:[Ne!==-1?Ne:de<0?0:mt.length-1,ae??w-1],region:[Jt,Nn],shiftKey:vt,ctrlKey:Vt,metaKey:_e,isEdge:bn,isTouch:an,button:fe,buttons:Ue,scrollEdge:Gt,isMaybeScrollbar:Xn}}else if(ae<=-1){let tt=Rt(k,Ne,ae);tn(tt!==void 0);let $t=tt!==void 0&&tt.x+tt.width-$<=ue;const Jt=Ne-1;$-tt.x<=ue&&Jt>=0?($t=!0,tt=Rt(k,Jt,ae),tn(tt!==void 0),pt={kind:S&&ae===-2?en:Vn,location:[Jt,ae],bounds:tt,group:mt[Jt].group??"",isEdge:$t,shiftKey:vt,ctrlKey:Vt,metaKey:_e,isTouch:an,localEventX:$-tt.x,localEventY:Z-tt.y,button:fe,buttons:Ue,scrollEdge:Gt}):pt={kind:S&&ae===-2?en:Vn,group:mt[Ne].group??"",location:[Ne,ae],bounds:tt,isEdge:$t,shiftKey:vt,ctrlKey:Vt,metaKey:_e,isTouch:an,localEventX:$-tt.x,localEventY:Z-tt.y,button:fe,buttons:Ue,scrollEdge:Gt}}else{const tt=Rt(k,Ne,ae);tn(tt!==void 0);const $t=tt!==void 0&&tt.x+tt.width-$<ue;let Jt=!1;if(u&&H.current!==void 0){const Nn=Sl(H.current.range),bn=Rt(k,Nn[0],Nn[1]);if(bn!==void 0){const Xn=bn.x+bn.width-2,Et=bn.y+bn.height-2;Jt=Math.abs(Xn-$)<rl&&Math.abs(Et-Z)<rl}}pt={kind:"cell",location:[Ne,ae],bounds:tt,isEdge:$t,shiftKey:vt,ctrlKey:Vt,isFillHandle:Jt,metaKey:_e,isTouch:an,localEventX:$-tt.x,localEventY:Z-tt.y,button:fe,buttons:Ue,scrollEdge:Gt}}return pt},[n,mt,qe,Xe,o,S,c,f,w,m,s,at,M,Rt,u,H,Pt]),[Mn]=rt??[],nr=l.useRef(()=>{}),Bn=l.useRef(rt);Bn.current=rt;const[Rn,En]=l.useMemo(()=>{const k=document.createElement("canvas"),$=document.createElement("canvas");return k.style.display="none",k.style.opacity="0",k.style.position="fixed",$.style.display="none",$.style.opacity="0",$.style.position="fixed",[k.getContext("2d",{alpha:!1}),$.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>{if(!(Rn===null||En===null))return document.documentElement.append(Rn.canvas),document.documentElement.append(En.canvas),()=>{Rn.canvas.remove(),En.canvas.remove()}},[Rn,En]);const gn=l.useMemo(()=>new ha,[]),or=jt&&kt?1:To&&kt?2:5,rr=(ve==null?void 0:ve.disableMinimumCellWidth)===!0?1:10,ao=l.useRef(),co=l.useRef(null),uo=l.useRef(null),Zn=l.useCallback(()=>{var de;const k=He.current,$=At.current;if(k===null||$===null||(co.current===null&&(co.current=k.getContext("2d",{alpha:!1}),k.width=0,k.height=0),uo.current===null&&(uo.current=$.getContext("2d",{alpha:!1}),$.width=0,$.height=0),co.current===null||uo.current===null||Rn===null||En===null))return;let Z=!1;const se=he=>{Z=!0,yt(he)},G=ao.current,re={headerCanvasCtx:uo.current,canvasCtx:co.current,bufferACtx:Rn,bufferBCtx:En,width:n,height:o,cellXOffset:qe,cellYOffset:s,translateX:Math.round(Xe),translateY:Math.round(at),mappedColumns:mt,enableGroups:S,freezeColumns:T,dragAndDropState:Se,theme:xe,headerHeight:c,groupHeaderHeight:f,disabledRows:et??nt.empty(),rowHeight:m,verticalBorder:Ge,isResizing:Ee,resizeCol:Me,isFocused:Y,selection:H,fillHandle:u,drawCellCallback:q,hasAppendRow:Fe,overrideCursor:se,maxScaleFactor:or,freezeTrailingRows:M,rows:w,drawFocus:A,getCellContent:g,getGroupDetails:Ke??(he=>({name:he})),getRowThemeOverride:h,drawHeaderCallback:Pe,prelightCells:ft,highlightRegions:me,imageLoader:Kt,lastBlitData:zn,damage:dt.current,hoverValues:An.current,hoverInfo:Bn.current,spriteManager:ot,scrolling:kt,hyperWrapping:(ve==null?void 0:ve.hyperWrapping)??!1,touchMode:zt,enqueue:nr.current,renderStateProvider:gn,renderStrategy:(ve==null?void 0:ve.renderStrategy)??(Dr.value?"double-buffer":"single-buffer"),getCellRenderer:Je,minimumCellWidth:rr,resizeIndicator:$e};re.damage===void 0?(ao.current=re,ol(re,G)):ol(re,void 0),!Z&&(re.damage===void 0||re.damage.has((de=Bn==null?void 0:Bn.current)==null?void 0:de[0]))&&yt(void 0)},[Rn,En,n,o,qe,s,Xe,at,mt,S,T,Se,xe,c,f,et,m,Ge,Ee,Fe,Me,Y,H,u,M,w,A,or,g,Ke,h,q,Pe,ft,me,Kt,ot,kt,ve==null?void 0:ve.hyperWrapping,ve==null?void 0:ve.renderStrategy,zt,gn,Je,rr,$e]),Jn=l.useRef(Zn);l.useLayoutEffect(()=>{Zn(),Jn.current=Zn},[Zn]),l.useLayoutEffect(()=>{(async()=>{var $;(($=document==null?void 0:document.fonts)==null?void 0:$.ready)!==void 0&&(await document.fonts.ready,ao.current=void 0,Jn.current())})()},[]);const Ln=l.useCallback(k=>{dt.current=k,Jn.current(),dt.current=void 0},[]),zr=wc(Ln);nr.current=zr;const ir=l.useCallback(k=>{Ln(new Zo(k.map($=>$.cell)))},[Ln]);Kt.setCallback(Ln);const[lr,Br]=l.useState(!1),[fo,Pn]=Mn??[],Ao=fo!==void 0&&Pn===-1,Lr=fo!==void 0&&Pn===-2;let Ht=!1,_t=!1,ho=qt;if(ho===void 0&&fo!==void 0&&Pn!==void 0&&Pn>-1&&Pn<w){const k=g([fo,Pn],!0);Ht=k.kind===sn.NewRow||k.kind===sn.Marker&&k.markerKind!=="number",_t=k.kind===j.Boolean&&di(k),ho=k.cursor}const zo=Ze?"grabbing":(Le??!1)||Ee?"col-resize":lr||C?"crosshair":ho!==void 0?ho:Ao||Ht||_t||Lr?"pointer":"default",On=l.useMemo(()=>({contain:"strict",display:"block",cursor:zo}),[zo]),In=l.useRef("default"),Wn=V==null?void 0:V.current;Wn!=null&&In.current!==On.cursor&&(Wn.style.cursor=In.current=On.cursor);const $n=l.useCallback((k,$,Z,se)=>{if(Ke===void 0)return;const G=Ke(k);if(G.actions!==void 0){const re=Xl($,G.actions);for(const[de,he]of re.entries())if(Eo(he,Z+$.x,se+he.y))return G.actions[de]}},[Ke]),Dn=l.useCallback((k,$,Z,se)=>{const G=mt[$];if(!Ze&&!Ee&&!(Le??!1)){const re=Rt(k,$,-1);tn(re!==void 0);const de=Yl(void 0,G,re.x,re.y,re.width,re.height,xe,bi(G.title)==="rtl");if(G.hasMenu===!0&&de.menuBounds!==void 0&&Eo(de.menuBounds,Z,se))return{area:"menu",bounds:de.menuBounds};if(G.indicatorIcon!==void 0&&de.indicatorIconBounds!==void 0&&Eo(de.indicatorIconBounds,Z,se))return{area:"indicator",bounds:de.indicatorIconBounds}}},[mt,Rt,Le,Ze,Ee,xe]),Bo=l.useRef(0),Tt=l.useRef(),Qn=l.useRef(!1),Lo=l.useCallback(k=>{const $=He.current,Z=V==null?void 0:V.current;if($===null||k.target!==$&&k.target!==Z)return;Qn.current=!0;let se,G;if(k instanceof MouseEvent?(se=k.clientX,G=k.clientY):(se=k.touches[0].clientX,G=k.touches[0].clientY),k.target===Z&&Z!==null){const de=Z.getBoundingClientRect();if(se>de.right||G>de.bottom)return}const re=Ft($,se,G,k);Tt.current=re.location,re.isTouch&&(Bo.current=Date.now()),bt.current!==re.isTouch&&Ye(re.isTouch),!(re.kind===Vn&&Dn($,re.location[0],se,G)!==void 0)&&(re.kind===en&&$n(re.group,re.bounds,re.localEventX,re.localEventY)!==void 0||(E==null||E(re),!re.isTouch&&Qe!==!0&&Qe!==re.kind&&re.button<3&&re.button!==1&&k.preventDefault()))},[V,Qe,Ft,$n,Dn,E]);Lt("touchstart",Lo,gt,!1),Lt("mousedown",Lo,gt,!1);const Po=l.useRef(0),sr=l.useCallback(k=>{var Ue,Ne;const $=Po.current;Po.current=Date.now();const Z=He.current;if(Qn.current=!1,R===void 0||Z===null)return;const se=V==null?void 0:V.current,G=k.target!==Z&&k.target!==se;let re,de,he=!0;if(k instanceof MouseEvent){if(re=k.clientX,de=k.clientY,he=k.button<3,k.pointerType==="touch")return}else re=k.changedTouches[0].clientX,de=k.changedTouches[0].clientY;let ue=Ft(Z,re,de,k);ue.isTouch&&Bo.current!==0&&Date.now()-Bo.current>500&&(ue={...ue,isLongTouch:!0}),$!==0&&Date.now()-$<(ue.isTouch?1e3:500)&&(ue={...ue,isDoubleClick:!0}),bt.current!==ue.isTouch&&Ye(ue.isTouch),!G&&k.cancelable&&he&&k.preventDefault();const[wt]=ue.location,fe=Dn(Z,wt,re,de);if(ue.kind===Vn&&fe!==void 0){(ue.button!==0||((Ue=Tt.current)==null?void 0:Ue[0])!==wt||((Ne=Tt.current)==null?void 0:Ne[1])!==-1)&&R(ue,!0);return}else if(ue.kind===en){const ae=$n(ue.group,ue.bounds,ue.localEventX,ue.localEventY);if(ae!==void 0){ue.button===0&&ae.onClick(ue);return}}R(ue,G)},[R,V,Ft,Dn,$n]);Lt("mouseup",sr,gt,!1),Lt("touchend",sr,gt,!1);const Or=l.useCallback(k=>{var wt,fe;const $=He.current;if($===null)return;const Z=V==null?void 0:V.current,se=k.target!==$&&k.target!==Z;let G,re,de=!0;k instanceof MouseEvent?(G=k.clientX,re=k.clientY,de=k.button<3):(G=k.changedTouches[0].clientX,re=k.changedTouches[0].clientY);const he=Ft($,G,re,k);bt.current!==he.isTouch&&Ye(he.isTouch),!se&&k.cancelable&&de&&k.preventDefault();const[ue]=he.location;if(he.kind===Vn){const Ue=Dn($,ue,G,re);Ue!==void 0&&he.button===0&&((wt=Tt.current)==null?void 0:wt[0])===ue&&((fe=Tt.current)==null?void 0:fe[1])===-1&&(Ue.area==="menu"?y==null||y(ue,Ue.bounds):Ue.area==="indicator"&&(b==null||b(ue,Ue.bounds)))}else if(he.kind===en){const Ue=$n(he.group,he.bounds,he.localEventX,he.localEventY);Ue!==void 0&&he.button===0&&Ue.onClick(he)}},[V,Ft,Dn,y,b,$n]);Lt("click",Or,gt,!1);const mn=l.useCallback(k=>{const $=He.current,Z=V==null?void 0:V.current;if($===null||k.target!==$&&k.target!==Z||_===void 0)return;const se=Ft($,k.clientX,k.clientY,k);_(se,()=>{k.cancelable&&k.preventDefault()})},[V,Ft,_]);Lt("contextmenu",mn,(V==null?void 0:V.current)??null,!1);const Fn=l.useCallback(k=>{dt.current=new Zo(k.map($=>$.item)),An.current=k,Jn.current(),dt.current=void 0},[]),Zt=l.useMemo(()=>new hc(Fn),[Fn]),F=l.useRef(Zt);F.current=Zt,l.useLayoutEffect(()=>{const k=F.current;if(Mn===void 0||Mn[1]<0){k.setHovered(Mn);return}const $=g(Mn,!0),Z=Je($),se=Z===void 0&&$.kind===j.Custom||(Z==null?void 0:Z.needsHover)!==void 0&&(typeof Z.needsHover=="boolean"?Z.needsHover:Z.needsHover($));k.setHovered(se?Mn:void 0)},[g,Je,Mn]);const ct=l.useRef(),eo=l.useCallback(k=>{var he;const $=He.current;if($===null)return;const Z=V==null?void 0:V.current,se=k.target!==$&&k.target!==Z,G=Ft($,k.clientX,k.clientY,k);if(G.kind!=="out-of-bounds"&&se&&!Qn.current&&!G.isTouch)return;const re=(ue,wt)=>{Sn(fe=>fe===ue||(fe==null?void 0:fe[0][0])===(ue==null?void 0:ue[0][0])&&(fe==null?void 0:fe[0][1])===(ue==null?void 0:ue[0][1])&&((fe==null?void 0:fe[1][0])===(ue==null?void 0:ue[1][0])&&(fe==null?void 0:fe[1][1])===(ue==null?void 0:ue[1][1])||!wt)?fe:ue)};if(!_l(G,ct.current))yt(void 0),ne==null||ne(G),re(G.kind===Hr?void 0:[G.location,[G.localEventX,G.localEventY]],!0),ct.current=G;else if(G.kind==="cell"||G.kind===Vn||G.kind===en){let ue=!1,wt=!0;if(G.kind==="cell"){const Ue=g(G.location);wt=((he=Je(Ue))==null?void 0:he.needsHoverPosition)??Ue.kind===j.Custom,ue=wt}else G.kind===en&&(ue=!0);const fe=[G.location,[G.localEventX,G.localEventY]];re(fe,wt),Bn.current=fe,ue&&Ln(new Zo([G.location]))}const de=G.location[0]>=(De?0:1);je(G.kind===Vn&&G.isEdge&&de&&ut===!0),Br(G.kind==="cell"&&G.isFillHandle),le==null||le(k),te(G)},[V,Ft,De,ut,le,te,ne,g,Je,Ln]);Lt("mousemove",eo,gt,!0);const Wr=l.useCallback(k=>{const $=He.current;if($===null)return;let Z,se;H.current!==void 0&&(Z=Rt($,H.current.cell[0],H.current.cell[1]),se=H.current.cell),Q==null||Q({bounds:Z,stopPropagation:()=>k.stopPropagation(),preventDefault:()=>k.preventDefault(),cancel:()=>{},ctrlKey:k.ctrlKey,metaKey:k.metaKey,shiftKey:k.shiftKey,altKey:k.altKey,key:k.key,keyCode:k.keyCode,rawEvent:k,location:se})},[Q,H,Rt]),ar=l.useCallback(k=>{const $=He.current;if($===null)return;let Z,se;H.current!==void 0&&(Z=Rt($,H.current.cell[0],H.current.cell[1]),se=H.current.cell),U==null||U({bounds:Z,stopPropagation:()=>k.stopPropagation(),preventDefault:()=>k.preventDefault(),cancel:()=>{},ctrlKey:k.ctrlKey,metaKey:k.metaKey,shiftKey:k.shiftKey,altKey:k.altKey,key:k.key,keyCode:k.keyCode,rawEvent:k,location:se})},[U,H,Rt]),$r=l.useCallback(k=>{if(He.current=k,oe!==void 0&&(oe.current=k),k===null)ht.current=window;else{const $=k.getRootNode();$===document&&(ht.current=window),ht.current=$}},[oe]),Nr=l.useCallback(k=>{const $=He.current;if($===null||Qe===!1||Ee){k.preventDefault();return}let Z,se;const G=Ft($,k.clientX,k.clientY);if(Qe!==!0&&G.kind!==Qe){k.preventDefault();return}const re=(Ue,Ne)=>{Z=Ue,se=Ne};let de,he,ue;const wt=(Ue,Ne,ae)=>{de=Ue,he=Ne,ue=ae};let fe=!1;if(Ce==null||Ce({...G,setData:re,setDragImage:wt,preventDefault:()=>fe=!0,defaultPrevented:()=>fe}),!fe&&Z!==void 0&&se!==void 0&&k.dataTransfer!==null)if(k.dataTransfer.setData(Z,se),k.dataTransfer.effectAllowed="copyLink",de!==void 0&&he!==void 0&&ue!==void 0)k.dataTransfer.setDragImage(de,he,ue);else{const[Ue,Ne]=G.location;if(Ne!==void 0){const ae=document.createElement("canvas"),vt=Rt($,Ue,Ne);tn(vt!==void 0);const Vt=Math.ceil(window.devicePixelRatio??1);ae.width=vt.width*Vt,ae.height=vt.height*Vt;const _e=ae.getContext("2d");_e!==null&&(_e.scale(Vt,Vt),_e.textBaseline="middle",Ne===-1?(_e.font=xe.headerFontFull,_e.fillStyle=xe.bgHeader,_e.fillRect(0,0,ae.width,ae.height),Kl(_e,0,0,vt.width,vt.height,mt[Ue],!1,xe,!1,!1,0,ot,Pe,!1)):(_e.font=xe.baseFontFull,_e.fillStyle=xe.bgCell,_e.fillRect(0,0,ae.width,ae.height),Nl(_e,g([Ue,Ne]),0,Ne,!1,!1,0,0,vt.width,vt.height,!1,xe,xe.bgCell,Kt,ot,1,void 0,!1,0,void 0,void 0,void 0,gn,Je,()=>{}))),ae.style.left="-100%",ae.style.position="absolute",ae.style.width=`${vt.width}px`,ae.style.height=`${vt.height}px`,document.body.append(ae),k.dataTransfer.setDragImage(ae,vt.width/2,vt.height/2),window.setTimeout(()=>{ae.remove()},0)}}else k.preventDefault()},[Qe,Ee,Ft,Ce,Rt,xe,mt,ot,Pe,g,Kt,gn,Je]);Lt("dragstart",Nr,(V==null?void 0:V.current)??null,!1,!1);const cr=l.useRef(),B=l.useCallback(k=>{const $=He.current;if(ge!==void 0&&k.preventDefault(),$===null||Ie===void 0)return;const Z=Ft($,k.clientX,k.clientY),[se,G]=Z.location,re=se-(De?0:1),[de,he]=cr.current??[];(de!==re||he!==G)&&(cr.current=[re,G],Ie([re,G],k.dataTransfer))},[De,Ft,Ie,ge]);Lt("dragover",B,(V==null?void 0:V.current)??null,!1,!1);const Ot=l.useCallback(()=>{cr.current=void 0,we==null||we()},[we]);Lt("dragend",Ot,(V==null?void 0:V.current)??null,!1,!1);const Dt=l.useCallback(k=>{const $=He.current;if($===null||ge===void 0)return;k.preventDefault();const Z=Ft($,k.clientX,k.clientY),[se,G]=Z.location,re=se-(De?0:1);ge([re,G],k.dataTransfer)},[De,Ft,ge]);Lt("drop",Dt,(V==null?void 0:V.current)??null,!1,!1);const Xr=l.useCallback(()=>{We==null||We()},[We]);Lt("dragleave",Xr,(V==null?void 0:V.current)??null,!1,!1);const dr=l.useRef(H);dr.current=H;const Hn=l.useRef(null),Wt=l.useCallback(k=>{var $;He.current===null||!He.current.contains(document.activeElement)||(k===null&&dr.current.current!==void 0?($=oe==null?void 0:oe.current)==null||$.focus({preventScroll:!0}):k!==null&&k.focus({preventScroll:!0}),Hn.current=k)},[oe]);l.useImperativeHandle(t,()=>({focus:()=>{var $;const k=Hn.current;k===null||!document.contains(k)?($=oe==null?void 0:oe.current)==null||$.focus({preventScroll:!0}):k.focus({preventScroll:!0})},getBounds:(k,$)=>{if(!(oe===void 0||oe.current===null))return Rt(oe.current,k??0,$??-1)},damage:ir}),[oe,ir,Rt]);const wn=l.useRef(),Yr=$s(()=>{var he,ue,wt;if(n<50||(ve==null?void 0:ve.disableAccessibilityTree)===!0)return null;let k=fi(mt,qe,n,Se,Xe);const $=De?0:-1;!De&&((he=k[0])==null?void 0:he.sourceIndex)===0&&(k=k.slice(1));const[Z,se]=((ue=H.current)==null?void 0:ue.cell)??[],G=(wt=H.current)==null?void 0:wt.range,re=k.map(fe=>fe.sourceIndex),de=io(s,Math.min(w,s+r));return Z!==void 0&&se!==void 0&&!(re.includes(Z)&&de.includes(se))&&Wt(null),l.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":w+1,"aria-multiselectable":"true","aria-colcount":mt.length+$},l.createElement("thead",{role:"rowgroup"},l.createElement("tr",{role:"row","aria-rowindex":1},k.map(fe=>l.createElement("th",{role:"columnheader","aria-selected":H.columns.hasIndex(fe.sourceIndex),"aria-colindex":fe.sourceIndex+1+$,tabIndex:-1,onFocus:Ue=>{if(Ue.target!==Hn.current)return Re==null?void 0:Re([fe.sourceIndex,-1])},key:fe.sourceIndex},fe.title)))),l.createElement("tbody",{role:"rowgroup"},de.map(fe=>l.createElement("tr",{role:"row","aria-selected":H.rows.hasIndex(fe),key:fe,"aria-rowindex":fe+2},k.map(Ue=>{const Ne=Ue.sourceIndex,ae=hn(Ne,fe),vt=Z===Ne&&se===fe,Vt=G!==void 0&&Ne>=G.x&&Ne<G.x+G.width&&fe>=G.y&&fe<G.y+G.height,_e=`glide-cell-${Ne}-${fe}`,an=[Ne,fe],Gt=g(an,!0);return l.createElement("td",{key:ae,role:"gridcell","aria-colindex":Ne+1+$,"aria-selected":Vt,"aria-readonly":Mo(Gt)||!Go(Gt),id:_e,"data-testid":_e,onClick:()=>{const pt=oe==null?void 0:oe.current;if(pt!=null)return Q==null?void 0:Q({bounds:Rt(pt,Ne,fe),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:an})},onFocusCapture:pt=>{var tt,$t;if(!(pt.target===Hn.current||((tt=wn.current)==null?void 0:tt[0])===Ne&&(($t=wn.current)==null?void 0:$t[1])===fe))return wn.current=an,Re==null?void 0:Re(an)},ref:vt?Wt:void 0,tabIndex:-1},yc(Gt,Je))})))))},[n,mt,qe,Se,Xe,w,s,r,H,Wt,g,oe,Q,Rt,Re],200),go=T===0||!W?0:qe>T?1:fn(-Xe/100,0,1),Kr=-s*32+at,mo=L?fn(-Kr/100,0,1):0,yn=l.useMemo(()=>{if(!go&&!mo)return null;const k={position:"absolute",top:0,left:Mt,width:n-Mt,height:o,opacity:go,pointerEvents:"none",transition:Be?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},$={position:"absolute",top:Pt,left:0,width:n,height:o,opacity:mo,pointerEvents:"none",transition:ce?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return l.createElement(l.Fragment,null,go>0&&l.createElement("div",{id:"shadow-x",style:k}),mo>0&&l.createElement("div",{id:"shadow-y",style:$}))},[go,mo,Mt,n,Be,Pt,o,ce]),Bt=l.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return l.createElement(l.Fragment,null,l.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Wr,onKeyUp:ar,onFocus:x,onBlur:X,ref:$r,style:On},Yr),l.createElement("canvas",{ref:At,style:Bt}),yn)},vc=l.memo(l.forwardRef(bc));function Vo(e,t,n,o){return fn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const pc=e=>{const[t,n]=l.useState(),[o,r]=l.useState(),[i,a]=l.useState(),[s,c]=l.useState(),[u,f]=l.useState(!1),[m,w]=l.useState(),[g,h]=l.useState(),[y,b]=l.useState(),[S,C]=l.useState(!1),[x,X]=l.useState(),{onHeaderMenuClick:Y,onHeaderIndicatorClick:H,getCellContent:T,onColumnMoved:_,onColumnResize:M,onColumnResizeStart:W,onColumnResizeEnd:L,gridRef:A,maxColumnWidth:E,minColumnWidth:R,onRowMoved:le,lockColumns:te,onColumnProposeMove:ne,onMouseDown:Se,onMouseUp:De,onItemHovered:Q,onDragStart:U,canvasRef:me}=e,oe=(M??L??W)!==void 0,{columns:Ce,selection:we}=e,V=we.columns,Ee=l.useCallback(q=>{const[Pe,Re]=q.location;i!==void 0&&s!==Pe&&Pe>=te?(f(!0),c(Pe)):g!==void 0&&Re!==void 0?(C(!0),b(Math.max(0,Re))):o===void 0&&!u&&!S&&(Q==null||Q(q))},[i,g,s,Q,te,o,u,S]),Me=_!==void 0,Ze=l.useCallback(q=>{var Pe;if(q.button===0){const[Re,Ie]=q.location;if(q.kind==="out-of-bounds"&&q.isEdge&&oe){const ge=(Pe=A==null?void 0:A.current)==null?void 0:Pe.getBounds(Ce.length-1,-1);ge!==void 0&&(n(ge.x),r(Ce.length-1))}else if(q.kind==="header"&&Re>=te){const ge=me==null?void 0:me.current;if(q.isEdge&&oe&&ge){n(q.bounds.x),r(Re);const ze=ge.getBoundingClientRect().width/ge.offsetWidth,Be=q.bounds.width/ze;W==null||W(Ce[Re],Be,Re,Be+(Ce[Re].growOffset??0))}else q.kind==="header"&&Me&&(w(q.bounds.x),a(Re))}else q.kind==="cell"&&te>0&&Re===0&&Ie!==void 0&&le!==void 0&&(X(q.bounds.y),h(Ie))}Se==null||Se(q)},[Se,oe,te,le,A,Ce,Me,W,me]),Qe=l.useCallback((q,Pe)=>{u||S||Y==null||Y(q,Pe)},[u,S,Y]),ut=l.useCallback((q,Pe)=>{u||S||H==null||H(q,Pe)},[u,S,H]),et=l.useRef(-1),Fe=l.useCallback(()=>{et.current=-1,h(void 0),b(void 0),X(void 0),C(!1),a(void 0),c(void 0),w(void 0),f(!1),r(void 0),n(void 0)},[]),Ke=l.useCallback((q,Pe)=>{if(q.button===0){if(o!==void 0){if((V==null?void 0:V.hasIndex(o))===!0)for(const Ie of V){if(Ie===o)continue;const ge=Ce[Ie],We=Vo(ge,et.current,R,E);M==null||M(ge,We,Ie,We+(ge.growOffset??0))}const Re=Vo(Ce[o],et.current,R,E);if(L==null||L(Ce[o],Re,o,Re+(Ce[o].growOffset??0)),V.hasIndex(o))for(const Ie of V){if(Ie===o)continue;const ge=Ce[Ie],We=Vo(ge,et.current,R,E);L==null||L(ge,We,Ie,We+(ge.growOffset??0))}}Fe(),i!==void 0&&s!==void 0&&(_==null||_(i,s)),g!==void 0&&y!==void 0&&(le==null||le(g,y))}De==null||De(q,Pe)},[De,o,i,s,g,y,V,L,Ce,R,E,M,_,le,Fe]),xe=l.useMemo(()=>{if(!(i===void 0||s===void 0)&&i!==s&&(ne==null?void 0:ne(i,s))!==!1)return{src:i,dest:s}},[i,s,ne]),ft=l.useCallback(q=>{const Pe=me==null?void 0:me.current;if(i!==void 0&&m!==void 0)Math.abs(q.clientX-m)>20&&f(!0);else if(g!==void 0&&x!==void 0)Math.abs(q.clientY-x)>20&&C(!0);else if(o!==void 0&&t!==void 0&&Pe){const Ie=Pe.getBoundingClientRect().width/Pe.offsetWidth,ge=(q.clientX-t)/Ie,We=Ce[o],ze=Vo(We,ge,R,E);if(M==null||M(We,ze,o,ze+(We.growOffset??0)),et.current=ge,(V==null?void 0:V.first())===o)for(const Be of V){if(Be===o)continue;const ce=Ce[Be],ve=Vo(ce,et.current,R,E);M==null||M(ce,ve,Be,ve+(ce.growOffset??0))}}},[i,m,g,x,o,t,Ce,R,E,M,V,me]),st=l.useCallback((q,Pe)=>{if(g===void 0||y===void 0)return T(q,Pe);let[Re,Ie]=q;return Ie===y?Ie=g:(Ie>y&&(Ie-=1),Ie>=g&&(Ie+=1)),T([Re,Ie],Pe)},[g,y,T]),Ge=l.useCallback(q=>{U==null||U(q),q.defaultPrevented()||Fe()},[Fe,U]);return l.createElement(vc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:st,isResizing:o!==void 0,onHeaderMenuClick:Qe,onHeaderIndicatorClick:ut,isDragging:u,onItemHovered:Ee,onDragStart:Ge,onMouseDown:Ze,allowResize:oe,onMouseUp:Ke,dragAndDropState:xe,onMouseMoveRaw:ft,ref:A})},Cc=pc;function xc(e){const t=l.useRef(null),[n,o]=l.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return l.useLayoutEffect(()=>{const r=a=>{for(const s of a){const{width:c,height:u}=s&&s.contentRect||{};o(f=>f.width===c&&f.height===u?f:{width:c,height:u})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const kc=(e,t,n)=>{const o=l.useRef(null),r=l.useRef(null),i=l.useRef(null),a=l.useRef(0),s=l.useRef(t);s.current=t;const c=n.current;l.useEffect(()=>{const u=()=>{var w,g;if(r.current===!1&&c!==null){const h=[c.scrollLeft,c.scrollTop];if(((w=i.current)==null?void 0:w[0])===h[0]&&((g=i.current)==null?void 0:g[1])===h[1])if(a.current>10){i.current=null,r.current=null;return}else a.current++;else a.current=0,s.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(u,8.333333333333334)}},f=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},m=w=>{w.touches.length===0&&(r.current=!1,a.current=0,o.current=window.setTimeout(u,8.333333333333334))};if(e&&c!==null){const w=c;return w.addEventListener("touchstart",f),w.addEventListener("touchend",m),()=>{w.removeEventListener("touchstart",f),w.removeEventListener("touchend",m),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},Sc=kc,Mc=()=>e=>e.isSafari?"scroll":"auto",Rc=on("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Mc()]}});function Ec(e){const[t,n]=l.useState(!1),o=typeof window>"u"?null:window,r=l.useRef(0);return Lt("touchstart",l.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Lt("touchend",l.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const Ic=e=>{var oe,Ce;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:a,className:s,preventDiagonalScrolling:c=!1,paddingBottom:u=0,paddingRight:f=0,rightElement:m,rightElementProps:w,kineticScrollPerfHack:g=!1,scrollRef:h,initialSize:y}=e,b=[],S=(w==null?void 0:w.sticky)??!1,C=(w==null?void 0:w.fill)??!1,x=l.useRef(0),X=l.useRef(0),Y=l.useRef(null),H=typeof window>"u"?1:window.devicePixelRatio,T=l.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),_=l.useRef(null),M=Ec(200),[W,L]=l.useState(!0),A=l.useRef(0);l.useLayoutEffect(()=>{if(!W||M||T.current.lockDirection===void 0)return;const we=Y.current;if(we===null)return;const[V,Ee]=T.current.lockDirection;V!==void 0?we.scrollLeft=V:Ee!==void 0&&(we.scrollTop=Ee),T.current.lockDirection=void 0},[M,W]);const E=l.useCallback((we,V)=>{var Ge;const Ee=Y.current;if(Ee===null)return;V=V??Ee.scrollTop,we=we??Ee.scrollLeft;const Me=T.current.scrollTop,Ze=T.current.scrollLeft,Qe=we-Ze,ut=V-Me;M&&Qe!==0&&ut!==0&&(Math.abs(Qe)>3||Math.abs(ut)>3)&&c&&T.current.lockDirection===void 0&&(T.current.lockDirection=Math.abs(Qe)<Math.abs(ut)?[Ze,void 0]:[void 0,Me]);const et=T.current.lockDirection;we=(et==null?void 0:et[0])??we,V=(et==null?void 0:et[1])??V,T.current.scrollLeft=we,T.current.scrollTop=V;const Fe=Ee.clientWidth,Ke=Ee.clientHeight,xe=V,ft=X.current-xe,st=Ee.scrollHeight-Ke;if(X.current=xe,st>0&&(Math.abs(ft)>2e3||xe===0||xe===st)&&o>Ee.scrollHeight+5){const q=xe/st,Pe=(o-Ke)*q;x.current=Pe-xe}et!==void 0&&(window.clearTimeout(A.current),L(!1),A.current=window.setTimeout(()=>L(!0),200)),i({x:we,y:xe+x.current,width:Fe-f,height:Ke-u,paddingRight:((Ge=_.current)==null?void 0:Ge.clientWidth)??0})},[u,f,o,i,c,M]);Sc(g&&Dr.value,E,Y);const R=l.useRef(E);R.current=E;const le=l.useRef(),te=l.useRef(!1);l.useLayoutEffect(()=>{te.current?E():te.current=!0},[E,u,f]);const ne=l.useCallback(we=>{Y.current=we,h!==void 0&&(h.current=we)},[h]);let Se=0,De=0;for(b.push(l.createElement("div",{key:Se++,style:{width:r,height:0}}));De<o;){const we=Math.min(5e6,o-De);b.push(l.createElement("div",{key:Se++,style:{width:0,height:we}})),De+=we}const{ref:Q,width:U,height:me}=xc(y);return typeof window<"u"&&(((oe=le.current)==null?void 0:oe.height)!==me||((Ce=le.current)==null?void 0:Ce.width)!==U)&&(window.setTimeout(()=>R.current(),0),le.current={width:U,height:me}),(U??0)===0||(me??0)===0?l.createElement("div",{ref:Q}):l.createElement("div",{ref:Q},l.createElement(Rc,{isSafari:Dr.value},l.createElement("div",{className:"dvn-underlay"},t),l.createElement("div",{ref:ne,style:le.current,draggable:a,onDragStart:we=>{a||(we.stopPropagation(),we.preventDefault())},className:"dvn-scroller "+(s??""),onScroll:()=>E()},l.createElement("div",{className:"dvn-scroll-inner"+(m===void 0?" dvn-hidden":"")},l.createElement("div",{className:"dvn-stack"},b),m!==void 0&&l.createElement(l.Fragment,null,!C&&l.createElement("div",{className:"dvn-spacer"}),l.createElement("div",{ref:_,style:{height:me,maxHeight:n-Math.ceil(H%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:f,flexGrow:C?1:void 0,right:S?f??0:void 0,pointerEvents:"auto"}},m))))))},Dc=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:a,freezeColumns:s,experimental:c,nonGrowWidth:u,clientSize:f,className:m,onVisibleRegionChanged:w,scrollRef:g,preventDiagonalScrolling:h,rightElement:y,rightElementProps:b,overscrollX:S,overscrollY:C,initialSize:x,smoothScrollX:X=!1,smoothScrollY:Y=!1,isDraggable:H}=e,{paddingRight:T,paddingBottom:_}=c??{},[M,W]=f,L=l.useRef(),A=l.useRef(),E=l.useRef(),R=l.useRef(),le=u+Math.max(0,S??0);let te=a?r+i:r;if(typeof o=="number")te+=n*o;else for(let Q=0;Q<n;Q++)te+=o(Q);C!==void 0&&(te+=C);const ne=l.useRef(),Se=l.useCallback(()=>{var ut,et;if(ne.current===void 0)return;const Q={...ne.current};let U=0,me=Q.x<0?-Q.x:0,oe=0,Ce=0;Q.x=Q.x<0?0:Q.x;let we=0;for(let Fe=0;Fe<s;Fe++)we+=t[Fe].width;for(const Fe of t){const Ke=U-we;if(Q.x>=Ke+Fe.width)U+=Fe.width,Ce++,oe++;else if(Q.x>Ke)U+=Fe.width,X?me+=Ke-Q.x:Ce++,oe++;else if(Q.x+Q.width>Ke)U+=Fe.width,oe++;else break}let V=0,Ee=0,Me=0;if(typeof o=="number")Y?(Ee=Math.floor(Q.y/o),V=Ee*o-Q.y):Ee=Math.ceil(Q.y/o),Me=Math.ceil(Q.height/o)+Ee,V<0&&Me++;else{let Fe=0;for(let Ke=0;Ke<n;Ke++){const xe=o(Ke),ft=Fe+(Y?0:xe/2);if(Q.y>=Fe+xe)Fe+=xe,Ee++,Me++;else if(Q.y>ft)Fe+=xe,Y?V+=ft-Q.y:Ee++,Me++;else if(Q.y+Q.height>xe/2+Fe)Fe+=xe,Me++;else break}}const Ze={x:Ce,y:Ee,width:oe-Ce,height:Me-Ee},Qe=L.current;(Qe===void 0||Qe.y!==Ze.y||Qe.x!==Ze.x||Qe.height!==Ze.height||Qe.width!==Ze.width||A.current!==me||E.current!==V||Q.width!==((ut=R.current)==null?void 0:ut[0])||Q.height!==((et=R.current)==null?void 0:et[1]))&&(w==null||w({x:Ce,y:Ee,width:oe-Ce,height:Me-Ee},Q.width,Q.height,Q.paddingRight??0,me,V),L.current=Ze,A.current=me,E.current=V,R.current=[Q.width,Q.height])},[t,o,n,w,s,X,Y]),De=l.useCallback(Q=>{ne.current=Q,Se()},[Se]);return l.useEffect(()=>{Se()},[Se]),l.createElement(Ic,{scrollRef:g,className:m,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:H===!0||typeof H=="string",scrollWidth:le+(T??0),scrollHeight:te+(_??0),clientHeight:W,rightElement:y,paddingBottom:_,paddingRight:T,rightElementProps:b,update:De,initialSize:x},l.createElement(Cc,{eventTargetRef:g,width:M,height:W,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},Fc=Dc,Hc=on("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),Tc=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Ac=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),zc=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Bc=10,Lc=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:a,searchResults:s,onSearchValueChange:c,getCellsForSelection:u,onSearchResultsChanged:f,showSearch:m=!1,onSearchClose:w}=e,[g]=l.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,y]=l.useState(""),b=a??h,S=l.useCallback(U=>{y(U),c==null||c(U)},[c]),[C,x]=l.useState(),X=l.useRef(C);X.current=C,l.useEffect(()=>{s!==void 0&&(s.length>0?x(U=>({rowsSearched:o,results:s.length,selectedIndex:(U==null?void 0:U.selectedIndex)??-1})):x(void 0))},[o,s]);const Y=l.useRef();Y.current===void 0&&(Y.current=new AbortController);const H=l.useRef(),[T,_]=l.useState([]),M=s??T,W=l.useCallback(()=>{H.current!==void 0&&(window.cancelAnimationFrame(H.current),H.current=void 0,Y.current.abort())},[]),L=l.useRef(n);L.current=n;const A=l.useCallback(U=>{const me=new RegExp(U.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let oe=L.current,Ce=Math.min(10,o),we=0;x(void 0),_([]);const V=[],Ee=async()=>{var st;if(u===void 0)return;const Me=performance.now(),Ze=o-we;let Qe=u({x:0,y:oe,width:r.length,height:Math.min(Ce,Ze,o-oe)},Y.current.signal);typeof Qe=="function"&&(Qe=await Qe());let ut=!1;for(const[Ge,q]of Qe.entries())for(const[Pe,Re]of q.entries()){let Ie;switch(Re.kind){case j.Text:case j.Number:Ie=Re.displayData;break;case j.Uri:case j.Markdown:Ie=Re.data;break;case j.Boolean:Ie=typeof Re.data=="boolean"?Re.data.toString():void 0;break;case j.Image:case j.Bubble:Ie=Re.data.join("🐳");break;case j.Custom:Ie=Re.copyData;break}Ie!==void 0&&me.test(Ie)&&(V.push([Pe,Ge+oe]),ut=!0)}const et=performance.now();ut&&_([...V]),we+=Qe.length,tn(we<=o);const Fe=((st=X.current)==null?void 0:st.selectedIndex)??-1;x({results:V.length,rowsSearched:we,selectedIndex:Fe}),f==null||f(V,Fe),oe+Ce>=o?oe=0:oe+=Ce;const Ke=et-Me,xe=Math.max(Ke,1),ft=Bc/xe;Ce=Math.ceil(Ce*ft),we<o&&V.length<1e3&&(H.current=window.requestAnimationFrame(Ee))};W(),H.current=window.requestAnimationFrame(Ee)},[W,r.length,u,f,o]),E=l.useCallback(()=>{var U;w==null||w(),x(void 0),_([]),f==null||f([],-1),W(),(U=t==null?void 0:t.current)==null||U.focus()},[W,t,w,f]),R=l.useCallback(U=>{S(U.target.value),s===void 0&&(U.target.value===""?(x(void 0),_([]),W()):A(U.target.value))},[A,W,S,s]);l.useEffect(()=>{m&&i.current!==null&&(S(""),i.current.focus({preventScroll:!0}))},[m,i,S]);const le=l.useCallback(U=>{var oe;if((oe=U==null?void 0:U.stopPropagation)==null||oe.call(U),C===void 0)return;const me=(C.selectedIndex+1)%C.results;x({...C,selectedIndex:me}),f==null||f(M,me)},[C,f,M]),te=l.useCallback(U=>{var oe;if((oe=U==null?void 0:U.stopPropagation)==null||oe.call(U),C===void 0)return;let me=(C.selectedIndex-1)%C.results;me<0&&(me+=C.results),x({...C,selectedIndex:me}),f==null||f(M,me)},[f,M,C]),ne=l.useCallback(U=>{(U.ctrlKey||U.metaKey)&&U.nativeEvent.code==="KeyF"||U.key==="Escape"?(E(),U.stopPropagation(),U.preventDefault()):U.key==="Enter"&&(U.shiftKey?te():le())},[E,le,te]);l.useEffect(()=>()=>{W()},[W]);const[Se,De]=l.useState(!1);l.useEffect(()=>{if(m)De(!0);else{const U=setTimeout(()=>De(!1),150);return()=>clearTimeout(U)}},[m]);const Q=l.useMemo(()=>{if(!m&&!Se)return null;let U;C!==void 0&&(U=C.results>=1e3?"over 1000":`${C.results} result${C.results!==1?"s":""}`,C.selectedIndex>=0&&(U=`${C.selectedIndex+1} of ${U}`));const me=we=>{we.stopPropagation()},Ce={width:`${Math.floor(((C==null?void 0:C.rowsSearched)??0)/o*100)}%`};return l.createElement(Hc,{className:m?"":"out",onMouseDown:me,onMouseMove:me,onMouseUp:me,onClick:me},l.createElement("div",{className:"gdg-search-bar-inner"},l.createElement("input",{id:g,"aria-hidden":!m,"data-testid":"search-input",ref:i,onChange:R,value:b,tabIndex:m?void 0:-1,onKeyDownCapture:ne}),l.createElement("button",{"aria-label":"Previous Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:te,disabled:((C==null?void 0:C.results)??0)===0},Tc),l.createElement("button",{"aria-label":"Next Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:le,disabled:((C==null?void 0:C.results)??0)===0},Ac),w!==void 0&&l.createElement("button",{"aria-label":"Close Search","aria-hidden":!m,"data-testid":"search-close-button",tabIndex:m?void 0:-1,onClick:E},zc)),C!==void 0?l.createElement(l.Fragment,null,l.createElement("div",{className:"gdg-search-status"},l.createElement("div",{"data-testid":"search-result-area"},U)),l.createElement("div",{className:"gdg-search-progress",style:Ce})):l.createElement("div",{className:"gdg-search-status"},l.createElement("label",{htmlFor:g},"Type to search")))},[m,Se,C,o,g,i,R,b,ne,te,le,w,E]);return l.createElement(l.Fragment,null,l.createElement(Fc,{prelightCells:M,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),Q)},Pc=Lc;class Oc extends l.PureComponent{constructor(){super(...arguments);Oe(this,"wrapperRef",l.createRef());Oe(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){document.addEventListener("touchend",this.clickOutside,!0),document.addEventListener("mousedown",this.clickOutside,!0),document.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){document.removeEventListener("touchend",this.clickOutside,!0),document.removeEventListener("mousedown",this.clickOutside,!0),document.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,...r}=this.props;return l.createElement("div",{...r,ref:this.wrapperRef},this.props.children)}}const Wc=()=>e=>Math.max(16,e.targetHeight-10),$c=on("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[Wc(),"px"]}}),Nc=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[a,s]=Yt.useState(n);return Yt.createElement(Oc,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},Yt.createElement($c,{targetHeight:t.height,"data-testid":"group-rename-input",value:a,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,a.length),onChange:c=>s(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(a):c.key==="Escape"&&o()},autoFocus:!0}))};function Xc(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Te(e,t,n){const o=Vl(e,t);return o&&(n.didMatch=!0),o}function Vl(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const u of c)if(Vl(u,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const a=e.split("+"),s=a.pop();if(!Xc(s,t))return!1;if(a[0]==="any")return!0;for(const c of a)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":Fr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function Yc(e,t,n,o,r,i){const a=Yt.useCallback((u,f,m,w)=>{var C;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}});const g=n==="mixed"&&(m||w==="drag"),h=o==="mixed"&&g,y=r==="mixed"&&g;let b={current:u===void 0?void 0:{...u,rangeStack:w==="drag"?((C=e.current)==null?void 0:C.rangeStack)??[]:[]},columns:h?e.columns:nt.empty(),rows:y?e.rows:nt.empty()};m&&(i==="multi-rect"||i==="multi-cell")&&b.current!==void 0&&e.current!==void 0&&(b={...b,current:{...b.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(b,f)},[o,e,n,i,r,t]),s=Yt.useCallback((u,f,m)=>{u=u??e.rows,f!==void 0&&(u=u.add(f));let w;if(r==="exclusive"&&u.length>0)w={current:void 0,columns:nt.empty(),rows:u};else{const g=m&&n==="mixed",h=m&&o==="mixed";w={current:g?e.current:void 0,columns:h?e.columns:nt.empty(),rows:u}}t(w,!1)},[o,e,n,r,t]),c=Yt.useCallback((u,f,m)=>{u=u??e.columns,f!==void 0&&(u=u.add(f));let w;if(o==="exclusive"&&u.length>0)w={current:void 0,rows:nt.empty(),columns:u};else{const g=m&&n==="mixed",h=m&&r==="mixed";w={current:g?e.current:void 0,rows:h?e.rows:nt.empty(),columns:u}}t(w,!1)},[o,e,n,r,t]);return[a,s,c]}function Kc(e,t,n,o,r){const i=l.useCallback(u=>{if(e===!0){const f=[];for(let m=u.y;m<u.y+u.height;m++){const w=[];for(let g=u.x;g<u.x+u.width;g++)g<0||m>=r?w.push({kind:j.Loading,allowOverlay:!1}):w.push(t([g,m]));f.push(w)}return f}return(e==null?void 0:e(u,o.signal))??[]},[o.signal,t,e,r]),a=e!==void 0?i:void 0,s=l.useCallback(u=>{if(a===void 0)return[];const f={...u,x:u.x-n};if(f.x<0){f.x=0,f.width--;const m=a(f,o.signal);return typeof m=="function"?async()=>(await m()).map(w=>[{kind:j.Loading,allowOverlay:!1},...w]):m.map(w=>[{kind:j.Loading,allowOverlay:!1},...w])}return a(f,o.signal)},[o.signal,a,n]);return[e!==void 0?s:void 0,a]}function Uc(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case j.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===wi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case j.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case j.Image:case j.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case j.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case j.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case j.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case j.Markdown:case j.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case j.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case j.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case j.Protected:return{formatted:"************",rawValue:"",format:"string"};default:Jo()}}function _c(e,t){return e.map((o,r)=>{const i=t[r];return o.map(a=>a.span!==void 0&&a.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:Uc(a))})}function il(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function Vc(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(a=>il(a,!0)).join(",")):r.push(il(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function ii(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function ll(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function Gc(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function qc(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${ii(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((a,s)=>`<li gdg-raw-value=${ll(r.rawValue[s])}>`+ii(a)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${ll(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${ii(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function jc(e,t){const n=_c(e,t),o=Vc(n),r=qc(n);return{textPlain:o,textHtml:r}}function sl(e){var a;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const c=s.cloneNode(!0),f=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,m=(f==null?void 0:f.children.length)===1&&f.children[0].nodeName==="FONT",w=c.querySelectorAll("br");for(const y of w)y.replaceWith(`
`);const g=c.getAttribute("gdg-raw-value"),h=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((a=c.querySelector("a"))==null?void 0:a.getAttribute("href"))??"",formatted:c.textContent??"",format:h});else if(c.querySelector("ol")!==null){const y=c.querySelectorAll("li");i==null||i.push({rawValue:[...y].map(b=>b.getAttribute("gdg-raw-value")??""),formatted:[...y].map(b=>b.textContent??""),format:"string-array"})}else if(g!==null)i==null||i.push({rawValue:Gc(g),formatted:c.textContent??"",format:h});else{let y=c.textContent??"";m&&(y=y.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:y??"",formatted:y??"",format:h})}}}return i!==void 0&&r.push(i),r}function Zc(e,t,n,o,r){var s;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let a=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(s=e.current)==null?void 0:s.range,u=[];if(c.width>2){const w=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof w=="function")return i;u.push(...w);const g=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof g=="function")return i;u.push(...g)}else{const w=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof w=="function")return i;u.push(...w)}let f=c.x-n,m=c.x+c.width-1-n;for(const w of u)for(const g of w)g.span!==void 0&&(f=Math.min(g.span[0],f),m=Math.max(g.span[1],m));f===c.x-n&&m===c.x+c.width-1-n?a=!0:e={current:{cell:e.current.cell??[0,0],range:{x:f+n,y:c.y,width:m-f+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!a);return e}function al(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Jc(e){let t;(function(s){s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let a=0;for(const s of e){switch(i){case t.None:s==="	"||s===`
`?(o.push(e.slice(r,a)),r=a+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(i=t.inString);break;case t.inString:s==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:s==='"'?i=t.inString:((s==="	"||s===`
`)&&(o.push(al(e.slice(r,a))),r=a+1,s===`
`&&(n.push(o),o=[])),i=t.None);break}a++}return r<e.length&&o.push(al(e.slice(r,e.length))),n.push(o),n.map(s=>s.map(c=>({rawValue:c,formatted:c,format:"string"})))}function cl(e,t,n){var s;const o=jc(e,t),r=c=>{var u;(u=window.navigator.clipboard)==null||u.writeText(c)},i=(c,u)=>{var f;return((f=window.navigator.clipboard)==null?void 0:f.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([u],{type:"text/html"})})]),!0)},a=(c,u)=>{var f,m;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(f=n==null?void 0:n.clipboardData)==null||f.setData("text/plain",c),(m=n==null?void 0:n.clipboardData)==null||m.setData("text/html",u)}catch{i(c,u)||r(c)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?a(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function Gl(e){return e!==!0}function dl(e){return typeof e=="string"?e:`${e}px`}const Qc=()=>e=>e.innerWidth,ed=()=>e=>e.innerHeight,td=on("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[Qc()],"wmyidgi-1":[ed()]}}),nd=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return l.createElement(td,{innerHeight:dl(n),innerWidth:dl(t),...r},o)},od=2,rd=1300;function id(e,t,n){const o=Yt.useRef(0),[r,i]=e??[0,0];Yt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let a=!1,s=0;const c=u=>{var f;if(!a){if(s===0)s=u;else{const m=u-s;o.current=Math.min(1,o.current+m/rd);const w=o.current**1.618*m*od;(f=t.current)==null||f.scrollBy(r*w,i*w),s=u,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{a=!0}},[t,r,i,n])}function ld({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:a,remSize:s}){const[c,u,f,m,w,g]=Yt.useMemo(()=>{if(!a||s===16)return[e,t,n,o,r,i];const h=s/16,y=e,b=Al();return[typeof y=="number"?y*h:S=>Math.ceil(y(S)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??b.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??b.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??b.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,s,e,a,o]);return{rowHeight:c,headerHeight:u,groupHeaderHeight:f,theme:m,overscrollX:w,overscrollY:g}}const _n={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Ae(e,t){return e===!0?t:e===!1?"":e}function ul(e){const t=Fr.value;return{activateCell:Ae(e.activateCell," |Enter|shift+Enter"),clear:Ae(e.clear,"any+Escape"),closeOverlay:Ae(e.closeOverlay,"any+Escape"),acceptOverlayDown:Ae(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Ae(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Ae(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Ae(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Ae(e.delete,t?"Backspace|Delete":"Delete"),downFill:Ae(e.downFill,"primary+_68"),scrollToSelectedCell:Ae(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Ae(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Ae(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Ae(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Ae(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Ae(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Ae(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Ae(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Ae(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Ae(e.goToFirstCell,"primary+Home"),goToFirstColumn:Ae(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Ae(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Ae(e.goToLastCell,"primary+End"),goToLastColumn:Ae(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Ae(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Ae(e.goToNextPage,"PageDown"),goToPreviousPage:Ae(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Ae(e.rightFill,"primary+_82"),search:Ae(e.search,"primary+f"),selectAll:Ae(e.selectAll,"primary+a"),selectColumn:Ae(e.selectColumn,"ctrl+ "),selectGrowDown:Ae(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Ae(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Ae(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Ae(e.selectGrowUp,"shift+ArrowUp"),selectRow:Ae(e.selectRow,"shift+ "),selectToFirstCell:Ae(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Ae(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Ae(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Ae(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Ae(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Ae(e.selectToLastRow,"primary+shift+ArrowDown")}}function sd(e){const t=Us(e);return Yt.useMemo(()=>{if(t===void 0)return ul(_n);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??_n.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??_n.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??_n.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??_n.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??_n.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??_n.selectToLastCell};return ul({..._n,...n})},[t])}const ad=l.lazy(async()=>await ml(()=>import("./data-grid-overlay-editor-5vHjCG5w.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url));let cd=0;function dd(e){return Ts($i($i(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return io((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Sr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const li={kind:j.Loading,allowOverlay:!1},Mr={columns:nt.empty(),rows:nt.empty(),current:void 0},ud=(e,t)=>{var Pi,Oi,Wi;const[n,o]=l.useState(Mr),[r,i]=l.useState(),a=l.useRef(null),s=l.useRef(null),[c,u]=l.useState(),f=l.useRef(null),m=l.useRef(),w=typeof window>"u"?null:window,{imageEditorOverride:g,getRowThemeOverride:h,markdownDivCreateNode:y,width:b,height:S,columns:C,rows:x,getCellContent:X,onCellClicked:Y,onCellActivated:H,onFillPattern:T,onFinishedEditing:_,coercePasteValue:M,drawHeader:W,drawCell:L,editorBloom:A,onHeaderClicked:E,onColumnProposeMove:R,spanRangeBehavior:le="default",onGroupHeaderClicked:te,onCellContextMenu:ne,className:Se,onHeaderContextMenu:De,getCellsForSelection:Q,onGroupHeaderContextMenu:U,onGroupHeaderRenamed:me,onCellEdited:oe,onCellsEdited:Ce,onSearchResultsChanged:we,searchResults:V,onSearchValueChange:Ee,searchValue:Me,onKeyDown:Ze,onKeyUp:Qe,keybindings:ut,editOnType:et=!0,onRowAppended:Fe,onColumnMoved:Ke,validateCell:xe,highlightRegions:ft,rangeSelect:st="rect",columnSelect:Ge="multi",rowSelect:q="multi",rangeSelectionBlending:Pe="exclusive",columnSelectionBlending:Re="exclusive",rowSelectionBlending:Ie="exclusive",onDelete:ge,onDragStart:We,onMouseMove:ze,onPaste:Be,copyHeaders:ce=!1,freezeColumns:ve=0,cellActivationBehavior:Je="second-click",rowSelectionMode:$e="auto",onHeaderMenuClick:Xe,onHeaderIndicatorClick:at,getGroupDetails:qe,onSearchClose:He,onItemHovered:ht,onSelectionCleared:gt,showSearch:Kt,onVisibleRegionChanged:dt,gridSelection:kt,onGridSelectionChange:St,minColumnWidth:An=50,maxColumnWidth:zn=500,maxColumnAutoWidth:rt,provideEditor:Sn,trailingRowOptions:Le,freezeTrailingRows:je=0,allowedFillDirections:At="orthogonal",scrollOffsetX:qt,scrollOffsetY:yt,verticalBorder:zt,onDragOverCell:Ye,onDrop:bt,onColumnResize:ot,onColumnResizeEnd:Pt,onColumnResizeStart:It,customRenderers:jt,fillHandle:To,drawFocusRing:mt=!0,experimental:Mt,fixedShadowX:Rt,fixedShadowY:Ft,headerIcons:Mn,imageWindowLoader:nr,initialSize:Bn,isDraggable:Rn,onDragLeave:En,onRowMoved:gn,overscrollX:or,overscrollY:rr,preventDiagonalScrolling:ao,rightElement:co,rightElementProps:uo,trapFocus:Zn=!1,smoothScrollX:Jn,smoothScrollY:Ln,scaleToRem:zr=!1,rowHeight:ir=34,headerHeight:lr=36,groupHeaderHeight:Br=lr,theme:fo,isOutsideClick:Pn,renderers:Ao,resizeIndicator:Lr}=e,Ht=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,_t=(Ht==null?void 0:Ht.kind)??e.rowMarkers??"none",ho=(Ht==null?void 0:Ht.width)??e.rowMarkerWidth,Pr=(Ht==null?void 0:Ht.startIndex)??e.rowMarkerStartIndex??1,zo=(Ht==null?void 0:Ht.theme)??e.rowMarkerTheme,On=(Ht==null?void 0:Ht.checkboxStyle)??"square",In=Math.max(An,20),Wn=Math.max(zn,In),$n=Math.max(rt??Wn,In),Dn=l.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),Bo=l.useMemo(()=>Number.parseFloat(Dn.fontSize),[Dn]),{rowHeight:Tt,headerHeight:Qn,groupHeaderHeight:Lo,theme:Po,overscrollX:sr,overscrollY:Or}=ld({groupHeaderHeight:Br,headerHeight:lr,overscrollX:or,overscrollY:rr,remSize:Bo,rowHeight:ir,scaleToRem:zr,theme:fo}),mn=sd(ut),Fn=ho??(x>1e4?48:x>1e3?44:x>100?36:32),Zt=_t!=="none",F=Zt?1:0,ct=Fe!==void 0,eo=(Le==null?void 0:Le.sticky)===!0,[Wr,ar]=l.useState(!1),$r=Kt??Wr,Nr=l.useCallback(()=>{He!==void 0?He():ar(!1)},[He]),B=l.useMemo(()=>kt===void 0?void 0:Sr(kt,F),[kt,F])??n,Ot=l.useRef();Ot.current===void 0&&(Ot.current=new AbortController),l.useEffect(()=>()=>Ot==null?void 0:Ot.current.abort(),[]);const[Dt,Xr]=Kc(Q,X,F,Ot.current,x),dr=l.useCallback((d,p,v)=>{if(xe===void 0)return!0;const I=[d[0]-F,d[1]];return xe==null?void 0:xe(I,p,v)},[F,xe]),Hn=l.useRef(kt),Wt=l.useCallback((d,p)=>{p&&(d=Zc(d,Dt,F,le,Ot.current)),St!==void 0?(Hn.current=Sr(d,-F),St(Hn.current)):o(d)},[St,Dt,F,le]),wn=xo(ot,l.useCallback((d,p,v,I)=>{ot==null||ot(C[v-F],p,v-F,I)},[ot,F,C])),Yr=xo(Pt,l.useCallback((d,p,v,I)=>{Pt==null||Pt(C[v-F],p,v-F,I)},[Pt,F,C])),go=xo(It,l.useCallback((d,p,v,I)=>{It==null||It(C[v-F],p,v-F,I)},[It,F,C])),Kr=xo(W,l.useCallback((d,p)=>(W==null?void 0:W({...d,columnIndex:d.columnIndex-F},p))??!1,[W,F])),mo=xo(L,l.useCallback((d,p)=>(L==null?void 0:L({...d,col:d.col-F},p))??!1,[L,F])),yn=l.useCallback(d=>{if(ge!==void 0){const p=ge(Sr(d,-F));return typeof p=="boolean"?p:Sr(p,F)}return!0},[ge,F]),[Bt,k,$]=Yc(B,Wt,Pe,Re,Ie,st),Z=l.useMemo(()=>Gn(Al(),Po),[Po]),[se,G]=l.useState([0,0,0]),re=l.useMemo(()=>{if(Ao===void 0)return{};const d={};for(const p of Ao)d[p.kind]=p;return d},[Ao]),de=l.useCallback(d=>d.kind!==j.Custom?re[d.kind]:jt==null?void 0:jt.find(p=>p.isMatch(d)),[jt,re]);let{sizedColumns:he,nonGrowWidth:ue}=wa(C,x,Xr,se[0]-(F===0?0:Fn)-se[2],In,$n,Z,de,Ot.current);_t!=="none"&&(ue+=Fn);const wt=l.useMemo(()=>he.some(d=>d.group!==void 0),[he]),fe=wt?Qn+Lo:Qn,Ue=B.rows.length,Ne=_t==="none"?void 0:Ue===0?!1:Ue===x?!0:void 0,ae=l.useMemo(()=>_t==="none"?he:[{title:"",width:Fn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:zo,rowMarker:On,rowMarkerChecked:Ne},...he],[_t,he,Fn,zo,On,Ne]),[vt,Vt]=l.useMemo(()=>[yt!==void 0&&typeof Tt=="number"?Math.floor(yt/Tt):0,yt!==void 0&&typeof Tt=="number"?-(yt%Tt):0],[yt,Tt]),_e=l.useRef({height:1,width:1,x:0,y:0}),an=l.useMemo(()=>({x:_e.current.x,y:vt,width:_e.current.width??1,height:_e.current.height??1,ty:Vt}),[Vt,vt]),Gt=l.useRef(!1),[pt,tt,$t]=Ks(an);_e.current=pt;const Jt=(pt.height??1)>1;l.useLayoutEffect(()=>{if(yt!==void 0&&f.current!==null&&Jt){if(f.current.scrollTop===yt)return;f.current.scrollTop=yt,f.current.scrollTop!==yt&&$t(),Gt.current=!0}},[yt,Jt,$t]);const Nn=(pt.width??1)>1;l.useLayoutEffect(()=>{if(qt!==void 0&&f.current!==null&&Nn){if(f.current.scrollLeft===qt)return;f.current.scrollLeft=qt,f.current.scrollLeft!==qt&&$t(),Gt.current=!0}},[qt,Nn,$t]);const bn=pt.x+F,Xn=pt.y,Et=l.useRef(null),Ut=l.useCallback(d=>{var p;d===!0?(p=Et.current)==null||p.focus():window.requestAnimationFrame(()=>{var v;(v=Et.current)==null||v.focus()})},[]),Nt=ct?x+1:x,rn=l.useCallback(d=>{const p=F===0?d:d.map(I=>({...I,location:[I.location[0]-F,I.location[1]]})),v=Ce==null?void 0:Ce(p);if(v!==!0)for(const I of p)oe==null||oe(I.location,I.value);return v},[oe,Ce,F]),[to,Ur]=l.useState(),ur=B.current!==void 0&&B.current.range.width*B.current.range.height>1?B.current.range:void 0,wo=mt?(Pi=B.current)==null?void 0:Pi.cell:void 0,fr=wo==null?void 0:wo[0],hr=wo==null?void 0:wo[1],ql=l.useMemo(()=>{if((ft===void 0||ft.length===0)&&(ur??fr??hr??to)===void 0)return;const d=[];if(ft!==void 0)for(const p of ft){const v=ae.length-p.range.x-F;v>0&&d.push({color:p.color,range:{...p.range,x:p.range.x+F,width:Math.min(v,p.range.width)},style:p.style})}return to!==void 0&&d.push({color:lo(Z.accentColor,0),range:to,style:"dashed"}),ur!==void 0&&d.push({color:lo(Z.accentColor,.5),range:ur,style:"solid-outline"}),fr!==void 0&&hr!==void 0&&d.push({color:Z.accentColor,range:{x:fr,y:hr,width:1,height:1},style:"solid-outline"}),d.length>0?d:void 0},[to,ur,fr,hr,ft,ae.length,Z.accentColor,F]),Si=l.useRef(ae);Si.current=ae;const Qt=l.useCallback(([d,p],v=!1)=>{var O,z,P,K,N,ee,ie;const I=ct&&p===Nt-1;if(d===0&&Zt)return I?li:{kind:sn.Marker,allowOverlay:!1,checkboxStyle:On,checked:(B==null?void 0:B.rows.hasIndex(p))===!0,markerKind:_t==="clickable-number"?"number":_t,row:Pr+p,drawHandle:gn!==void 0,cursor:_t==="clickable-number"?"pointer":void 0};if(I){const be=d===F?(Le==null?void 0:Le.hint)??"":"",pe=Si.current[d];if(((O=pe==null?void 0:pe.trailingRowOptions)==null?void 0:O.disabled)===!0)return li;{const Ve=((z=pe==null?void 0:pe.trailingRowOptions)==null?void 0:z.hint)??be,ke=((P=pe==null?void 0:pe.trailingRowOptions)==null?void 0:P.addIcon)??(Le==null?void 0:Le.addIcon);return{kind:sn.NewRow,hint:Ve,allowOverlay:!1,icon:ke}}}else{const J=d-F;if(v||(Mt==null?void 0:Mt.strict)===!0){const pe=_e.current,Ve=pe.x>J||J>pe.x+pe.width||pe.y>p||p>pe.y+pe.height||p>=Vr.current,ke=J===((N=(K=pe.extras)==null?void 0:K.selected)==null?void 0:N[0])&&p===((ee=pe.extras)==null?void 0:ee.selected[1]);let ye=!1;if(((ie=pe.extras)==null?void 0:ie.freezeRegions)!==void 0){for(const it of pe.extras.freezeRegions)if(Eo(it,J,p)){ye=!0;break}}if(Ve&&!ke&&!ye)return li}let be=X([J,p]);return F!==0&&be.span!==void 0&&(be={...be,span:[be.span[0]+F,be.span[1]+F]}),be}},[ct,Nt,Zt,On,B==null?void 0:B.rows,_t,Pr,gn,F,Le==null?void 0:Le.hint,Le==null?void 0:Le.addIcon,Mt==null?void 0:Mt.strict,X]),_r=l.useCallback(d=>{let p=(qe==null?void 0:qe(d))??{name:d};return me!==void 0&&d!==""&&(p={icon:p.icon,name:p.name,overrideTheme:p.overrideTheme,actions:[...p.actions??[],{title:"Rename",icon:"renameIcon",onClick:v=>qr({group:p.name,bounds:v.bounds})}]}),p},[qe,me]),gr=l.useCallback(d=>{var P;const[p,v]=d.cell,I=ae[p],D=(I==null?void 0:I.group)!==void 0?(P=_r(I.group))==null?void 0:P.overrideTheme:void 0,O=I==null?void 0:I.themeOverride,z=h==null?void 0:h(v);i({...d,theme:Gn(Z,D,O,z,d.content.themeOverride)})},[h,ae,_r,Z]),yo=l.useCallback((d,p,v)=>{var z;if(B.current===void 0)return;const[I,D]=B.current.cell,O=Qt([I,D]);if(O.kind!==j.Boolean&&O.allowOverlay){let P=O;if(v!==void 0)switch(P.kind){case j.Number:{const K=zs(()=>v==="-"?-0:Number.parseFloat(v),0);P={...P,data:Number.isNaN(K)?0:K};break}case j.Text:case j.Markdown:case j.Uri:P={...P,data:v};break}gr({target:d,content:P,initialValue:v,cell:[I,D],highlight:v===void 0,forceEditMode:v!==void 0})}else O.kind===j.Boolean&&p&&O.readonly!==!0&&(rn([{location:B.current.cell,value:{...O,data:Gl(O.data)}}]),(z=Et.current)==null||z.damage([{cell:B.current.cell}]))},[Qt,B,rn,gr]),Mi=l.useCallback((d,p)=>{var D;const v=(D=Et.current)==null?void 0:D.getBounds(d,p);if(v===void 0||f.current===null)return;const I=Qt([d,p]);I.allowOverlay&&gr({target:v,content:I,initialValue:void 0,highlight:!0,cell:[d,p],forceEditMode:!0})},[Qt,gr]),Ct=l.useCallback((d,p,v="both",I=0,D=0,O=void 0)=>{if(f.current!==null){const z=Et.current,P=s.current,K=typeof d!="number"?d.unit==="cell"?d.amount:void 0:d,N=typeof p!="number"?p.unit==="cell"?p.amount:void 0:p,ee=typeof d!="number"&&d.unit==="px"?d.amount:void 0,ie=typeof p!="number"&&p.unit==="px"?p.amount:void 0;if(z!==null&&P!==null){let J={x:0,y:0,width:0,height:0},be=0,pe=0;if((K!==void 0||N!==void 0)&&(J=z.getBounds((K??0)+F,N??0)??J,J.width===0||J.height===0))return;const Ve=P.getBoundingClientRect(),ke=Ve.width/P.offsetWidth;if(ee!==void 0&&(J={...J,x:ee-Ve.left-f.current.scrollLeft,width:1}),ie!==void 0&&(J={...J,y:ie+Ve.top-f.current.scrollTop,height:1}),J!==void 0){const ye={x:J.x-I,y:J.y-D,width:J.width+2*I,height:J.height+2*D};let it=0;for(let ti=0;ti<ve;ti++)it+=he[ti].width;let Xt=0;const xt=je+(eo?1:0);xt>0&&(Xt=so(Nt,xt,Tt));let dn=it*ke+Ve.left+F*Fn*ke,pn=Ve.right,un=Ve.top+fe*ke,Cn=Ve.bottom-Xt*ke;const pr=J.width+I*2;switch(O==null?void 0:O.hAlign){case"start":pn=dn+pr;break;case"end":dn=pn-pr;break;case"center":dn=Math.floor((dn+pn)/2)-pr/2,pn=dn+pr;break}const Cr=J.height+D*2;switch(O==null?void 0:O.vAlign){case"start":Cn=un+Cr;break;case"end":un=Cn-Cr;break;case"center":un=Math.floor((un+Cn)/2)-Cr/2,Cn=un+Cr;break}dn>ye.x?be=ye.x-dn:pn<ye.x+ye.width&&(be=ye.x+ye.width-pn),un>ye.y?pe=ye.y-un:Cn<ye.y+ye.height&&(pe=ye.y+ye.height-Cn),v==="vertical"||typeof d=="number"&&d<ve?be=0:(v==="horizontal"||typeof p=="number"&&p>=Nt-xt)&&(pe=0),(be!==0||pe!==0)&&(ke!==1&&(be/=ke,pe/=ke),f.current.scrollTo(be+f.current.scrollLeft,pe+f.current.scrollTop))}}}},[F,je,Fn,fe,ve,he,Nt,eo,Tt]),Ri=l.useRef(Mi),Ei=l.useRef(X),Vr=l.useRef(x);Ri.current=Mi,Ei.current=X,Vr.current=x;const bo=l.useCallback(async(d,p=!0)=>{var K;const v=ae[d];if(((K=v==null?void 0:v.trailingRowOptions)==null?void 0:K.disabled)===!0)return;const I=Fe==null?void 0:Fe();let D,O=!0;I!==void 0&&(D=await I,D==="top"&&(O=!1),typeof D=="number"&&(O=!1));let z=0;const P=()=>{if(Vr.current<=x){z<500&&window.setTimeout(P,z),z=50+z*2;return}const N=typeof D=="number"?D:O?x:0;vr.current(d-F,N),Bt({cell:[d,N],range:{x:d,y:N,width:1,height:1}},!1,!1,"edit");const ee=Ei.current([d-F,N]);ee.allowOverlay&&Go(ee)&&ee.readonly!==!0&&p&&window.setTimeout(()=>{Ri.current(d,N)},0)};P()},[ae,Fe,F,x,Bt]),mr=l.useCallback(d=>{var v,I;const p=((I=(v=he[d])==null?void 0:v.trailingRowOptions)==null?void 0:I.targetColumn)??(Le==null?void 0:Le.targetColumn);if(typeof p=="number")return p+(Zt?1:0);if(typeof p=="object"){const D=C.indexOf(p);if(D>=0)return D+(Zt?1:0)}},[he,C,Zt,Le==null?void 0:Le.targetColumn]),Yn=l.useRef(),vo=l.useRef(),Oo=l.useCallback((d,p)=>{var D;const[v,I]=p;return Gn(Z,(D=ae[v])==null?void 0:D.themeOverride,h==null?void 0:h(I),d.themeOverride)},[h,ae,Z]),Wo=l.useCallback(d=>{var ee,ie,J;const p=Fr.value?d.metaKey:d.ctrlKey,v=p&&q==="multi",I=p&&Ge==="multi",[D,O]=d.location,z=B.columns,P=B.rows,[K,N]=((ee=B.current)==null?void 0:ee.cell)??[];if(d.kind==="cell"){if(vo.current=void 0,no.current=[D,O],D===0&&Zt){if(ct===!0&&O===x||_t==="number"||q==="none")return;const be=Qt(d.location);if(be.kind!==sn.Marker)return;if(gn!==void 0){const ke=de(be);tn((ke==null?void 0:ke.kind)===sn.Marker);const ye=(ie=ke==null?void 0:ke.onClick)==null?void 0:ie.call(ke,{...d,cell:be,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,theme:Oo(be,d.location),preventDefault:()=>{}});if(ye===void 0||ye.checked===be.checked)return}i(void 0),Ut();const pe=P.hasIndex(O),Ve=Yn.current;if(q==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&Ve!==void 0&&P.hasIndex(Ve)){const ke=[Math.min(Ve,O),Math.max(Ve,O)+1];v||$e==="multi"?k(void 0,ke,!0):k(nt.fromSingleSelection(ke),void 0,v)}else v||d.isTouch||$e==="multi"?pe?k(P.remove(O),void 0,!0):(k(void 0,O,!0),Yn.current=O):pe&&P.length===1?k(nt.empty(),void 0,p):(k(nt.fromSingleSelection(O),void 0,p),Yn.current=O)}else if(D>=F&&ct&&O===x){const be=mr(D);bo(be??D)}else if(K!==D||N!==O){const be=Qt(d.location),pe=de(be);if((pe==null?void 0:pe.onSelect)!==void 0){let ye=!1;if(pe.onSelect({...d,cell:be,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,preventDefault:()=>ye=!0,theme:Oo(be,d.location)}),ye)return}const Ve=eo&&O===x,ke=eo&&B!==void 0&&((J=B.current)==null?void 0:J.cell[1])===x;if((d.shiftKey||d.isLongTouch===!0)&&K!==void 0&&N!==void 0&&B.current!==void 0&&!ke){if(Ve)return;const ye=Math.min(D,K),it=Math.max(D,K),Xt=Math.min(O,N),xt=Math.max(O,N);Bt({...B.current,range:{x:ye,y:Xt,width:it-ye+1,height:xt-Xt+1}},!0,p,"click"),Yn.current=void 0,Ut()}else Bt({cell:[D,O],range:{x:D,y:O,width:1,height:1}},!0,p,"click"),Yn.current=void 0,i(void 0),Ut()}}else if(d.kind==="header")if(no.current=[D,O],i(void 0),Zt&&D===0)Yn.current=void 0,vo.current=void 0,q==="multi"&&(P.length!==x?k(nt.fromSingleSelection([0,x]),void 0,p):k(nt.empty(),void 0,p),Ut());else{const be=vo.current;if(Ge==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&be!==void 0&&z.hasIndex(be)){const pe=[Math.min(be,D),Math.max(be,D)+1];I?$(void 0,pe,p):$(nt.fromSingleSelection(pe),void 0,p)}else I?(z.hasIndex(D)?$(z.remove(D),void 0,p):$(void 0,D,p),vo.current=D):Ge!=="none"&&($(nt.fromSingleSelection(D),void 0,p),vo.current=D);Yn.current=void 0,Ut()}else d.kind===en?no.current=[D,O]:d.kind===Hr&&!d.isMaybeScrollbar&&(Wt(Mr,!1),i(void 0),Ut(),gt==null||gt(),Yn.current=void 0,vo.current=void 0)},[bo,Ge,Ut,de,mr,Qt,B,Zt,eo,gt,gn,F,_t,q,$e,x,Bt,Wt,$,k,ct,Oo]),$o=l.useRef(!1),no=l.useRef(),Ii=l.useRef(pt),ln=l.useRef(),jl=l.useCallback(d=>{if(po.current=!1,Ii.current=_e.current,d.button!==0&&d.button!==1){ln.current=void 0;return}const p=performance.now();ln.current={button:d.button,time:p,location:d.location},(d==null?void 0:d.kind)==="header"&&($o.current=!0);const v=d.kind==="cell"&&d.isFillHandle;!v&&d.kind!=="cell"&&d.isEdge||(u({previousSelection:B,fillHandle:v}),no.current=void 0,!d.isTouch&&d.button===0&&!v?Wo(d):!d.isTouch&&d.button===1&&(no.current=d.location))},[B,Wo]),[Gr,qr]=l.useState(),Di=l.useCallback(d=>{if(d.kind!==en||Ge!=="multi")return;const p=Fr.value?d.metaKey:d.ctrlKey,[v]=d.location,I=B.columns;if(v<F)return;const D=ae[v];let O=v,z=v;for(let P=v-1;P>=F&&Qo(D.group,ae[P].group);P--)O--;for(let P=v+1;P<ae.length&&Qo(D.group,ae[P].group);P++)z++;if(Ut(),p)if(I.hasAll([O,z+1])){let P=I;for(let K=O;K<=z;K++)P=P.remove(K);$(P,void 0,p)}else $(void 0,[O,z+1],p);else $(nt.fromSingleSelection([O,z+1]),void 0,p)},[Ge,Ut,B.columns,ae,F,$]),po=l.useRef(!1),wr=l.useCallback(async d=>{if(Dt!==void 0&&wn!==void 0){const p=_e.current.y,v=_e.current.height;let I=Dt({x:d,y:p,width:1,height:Math.min(v,x-p)},Ot.current.signal);typeof I!="object"&&(I=await I());const D=he[d-F],z=document.createElement("canvas").getContext("2d",{alpha:!1});if(z!==null){z.font=Z.baseFontFull;const P=Bl(z,Z,D,0,I,In,Wn,!1,de);wn==null||wn(D,P.width,d,P.width)}}},[he,Dt,Wn,Z,In,wn,F,x,de]),[Zl,jr]=l.useState(),Co=l.useCallback(async(d,p)=>{var P,K;const v=(P=d.current)==null?void 0:P.range;if(v===void 0||Dt===void 0||p.current===void 0)return;const I=p.current.range;if(T!==void 0){let N=!1;if(T({fillDestination:{...I,x:I.x-F},patternSource:{...v,x:v.x-F},preventDefault:()=>N=!0}),N)return}let D=Dt(v,Ot.current.signal);typeof D!="object"&&(D=await D());const O=D,z=[];for(let N=0;N<I.width;N++)for(let ee=0;ee<I.height;ee++){const ie=[I.x+N,I.y+ee];if(kl(ie,v))continue;const J=O[ee%v.height][N%v.width];Mo(J)||!Go(J)||z.push({location:ie,value:{...J}})}rn(z),(K=Et.current)==null||K.damage(z.map(N=>({cell:N.location})))},[Dt,rn,T,F]),Fi=l.useCallback(()=>{if(B.current===void 0||B.current.range.width<=1)return;const d={...B,current:{...B.current,range:{...B.current.range,width:1}}};Co(d,B)},[Co,B]),Hi=l.useCallback(()=>{if(B.current===void 0||B.current.range.height<=1)return;const d={...B,current:{...B.current,range:{...B.current.range,height:1}}};Co(d,B)},[Co,B]),Jl=l.useCallback((d,p)=>{var ee,ie;const v=c;if(u(void 0),Ur(void 0),jr(void 0),$o.current=!1,p)return;if((v==null?void 0:v.fillHandle)===!0&&B.current!==void 0&&((ee=v.previousSelection)==null?void 0:ee.current)!==void 0){if(to===void 0)return;const J={...B,current:{...B.current,range:$l(v.previousSelection.current.range,to)}};Co(v.previousSelection,J),Wt(J,!0);return}const[I,D]=d.location,[O,z]=no.current??[],P=()=>{po.current=!0},K=J=>{var pe,Ve,ke;const be=J.isTouch||O===I&&z===D;if(be&&(Y==null||Y([I-F,D],{...J,preventDefault:P})),J.button===1)return!po.current;if(!po.current){const ye=Qt(d.location),it=de(ye);if(it!==void 0&&it.onClick!==void 0&&be){const xt=it.onClick({...J,cell:ye,posX:J.localEventX,posY:J.localEventY,bounds:J.bounds,theme:Oo(ye,d.location),preventDefault:P});xt!==void 0&&!Mo(xt)&&So(xt)&&(rn([{location:J.location,value:xt}]),(pe=Et.current)==null||pe.damage([{cell:J.location}]))}if(po.current||B.current===void 0)return!1;let Xt=!1;switch(ye.activationBehaviorOverride??Je){case"double-click":case"second-click":{if(((ke=(Ve=v==null?void 0:v.previousSelection)==null?void 0:Ve.current)==null?void 0:ke.cell)===void 0)break;const[xt,dn]=B.current.cell,[pn,un]=v.previousSelection.current.cell;Xt=I===xt&&I===pn&&D===dn&&D===un&&(J.isDoubleClick===!0||Je==="second-click");break}case"single-click":{Xt=!0;break}}if(Xt)return H==null||H([I-F,D]),yo(J.bounds,!1),!0}return!1},N=d.location[0]-F;if(d.isTouch){const J=_e.current,be=Ii.current;if(J.x!==be.x||J.y!==be.y)return;if(d.isLongTouch===!0){if(d.kind==="cell"&&qo((ie=B.current)==null?void 0:ie.cell,d.location)){ne==null||ne([N,d.location[1]],{...d,preventDefault:P});return}else if(d.kind==="header"&&B.columns.hasIndex(I)){De==null||De(N,{...d,preventDefault:P});return}else if(d.kind===en){if(N<0)return;U==null||U(N,{...d,preventDefault:P});return}}d.kind==="cell"?K(d)||Wo(d):d.kind===en?te==null||te(N,{...d,preventDefault:P}):(d.kind===Vn&&(E==null||E(N,{...d,preventDefault:P})),Wo(d));return}if(d.kind==="header"){if(N<0)return;d.isEdge?d.isDoubleClick===!0&&wr(I):d.button===0&&I===O&&D===z&&(E==null||E(N,{...d,preventDefault:P}))}if(d.kind===en){if(N<0)return;d.button===0&&I===O&&D===z&&(te==null||te(N,{...d,preventDefault:P}),po.current||Di(d))}d.kind==="cell"&&(d.button===0||d.button===1)&&K(d),no.current=void 0},[c,B,F,to,Co,Wt,Y,Qt,de,Je,Oo,rn,H,yo,ne,De,U,Wo,te,E,wr,Di]),Ql=l.useCallback(d=>{const p={...d,location:[d.location[0]-F,d.location[1]]};ze==null||ze(p),c!==void 0&&d.buttons===0&&(u(void 0),Ur(void 0),jr(void 0),$o.current=!1),jr(v=>{var I;return $o.current?[d.scrollEdge[0],0]:d.scrollEdge[0]===(v==null?void 0:v[0])&&d.scrollEdge[1]===v[1]?v:c===void 0||(((I=ln.current)==null?void 0:I.location[0])??0)<F?void 0:d.scrollEdge})},[c,ze,F]),es=l.useCallback((d,p)=>{Xe==null||Xe(d-F,p)},[Xe,F]),ts=l.useCallback((d,p)=>{at==null||at(d-F,p)},[at,F]),vn=(Oi=B==null?void 0:B.current)==null?void 0:Oi.cell,ns=l.useCallback((d,p,v,I,D,O)=>{Gt.current=!1;let z=vn;z!==void 0&&(z=[z[0]-F,z[1]]);const P=ve===0?void 0:{x:0,y:d.y,width:ve,height:d.height},K=[];P!==void 0&&K.push(P),je>0&&(K.push({x:d.x-F,y:x-je,width:d.width,height:je}),ve>0&&K.push({x:0,y:x-je,width:ve,height:je}));const N={x:d.x-F,y:d.y,width:d.width,height:ct&&d.y+d.height>=x?d.height-1:d.height,tx:D,ty:O,extras:{selected:z,freezeRegion:P,freezeRegions:K}};_e.current=N,tt(N),G([p,v,I]),dt==null||dt(N,N.tx,N.ty,N.extras)},[vn,F,ct,x,ve,je,tt,dt]),os=xo(Ke,l.useCallback((d,p)=>{Ke==null||Ke(d-F,p-F),Ge!=="none"&&$(nt.fromSingleSelection(p),void 0,!0)},[Ge,Ke,F,$])),Zr=l.useRef(!1),rs=l.useCallback(d=>{if(d.location[0]===0&&F>0){d.preventDefault();return}We==null||We({...d,location:[d.location[0]-F,d.location[1]]}),d.defaultPrevented()||(Zr.current=!0),u(void 0)},[We,F]),is=l.useCallback(()=>{Zr.current=!1},[]),Jr=l.useRef(),Qr=l.useCallback(d=>{var p,v,I;if(!_l(d,Jr.current)&&(Jr.current=d,!(((p=ln==null?void 0:ln.current)==null?void 0:p.button)!==void 0&&ln.current.button>=1))){if(d.buttons!==0&&c!==void 0&&((v=ln.current)==null?void 0:v.location[0])===0&&d.location[0]===0&&F===1&&q==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(ln.current.location[1])&&B.rows.hasIndex(ln.current.location[1])){const D=Math.min(ln.current.location[1],d.location[1]),O=Math.max(ln.current.location[1],d.location[1])+1;k(nt.fromSingleSelection([D,O]),void 0,!1)}if(d.buttons!==0&&c!==void 0&&B.current!==void 0&&!Zr.current&&!$o.current&&(st==="rect"||st==="multi-rect")){const[D,O]=B.current.cell;let[z,P]=d.location;if(P<0&&(P=_e.current.y),c.fillHandle===!0&&((I=c.previousSelection)==null?void 0:I.current)!==void 0){const K=c.previousSelection.current.range;P=Math.min(P,ct?x-1:x);const N=Ga(K,z,P,At);Ur(N)}else{if(ct&&O===x)return;if(ct&&P===x)if(d.kind===Hr)P--;else return;z=Math.max(z,F);const ee=z-D,ie=P-O,J={x:ee>=0?D:z,y:ie>=0?O:P,width:Math.abs(ee)+1,height:Math.abs(ie)+1};Bt({...B.current,range:J},!0,!1,"drag")}}ht==null||ht({...d,location:[d.location[0]-F,d.location[1]]})}},[At,c,F,q,B,st,ht,k,ct,x,Bt]),ls=l.useCallback(()=>{var z,P;const d=Jr.current;if(d===void 0)return;const[p,v]=d.scrollEdge;let[I,D]=d.location;const O=_e.current;p===-1?I=((P=(z=O.extras)==null?void 0:z.freezeRegion)==null?void 0:P.x)??O.x:p===1&&(I=O.x+O.width),v===-1?D=Math.max(0,O.y):v===1&&(D=Math.min(x-1,O.y+O.height)),I=fn(I,0,ae.length-1),D=fn(D,0,x-1),Qr({...d,location:[I,D]})},[ae.length,Qr,x]);id(Zl,f,ls);const cn=l.useCallback(d=>{if(B.current===void 0)return;const[p,v]=d,[I,D]=B.current.cell,O=B.current.range;let z=O.x,P=O.x+O.width,K=O.y,N=O.y+O.height;if(v!==0)switch(v){case 2:{N=x,K=D,Ct(0,N,"vertical");break}case-2:{K=0,N=D+1,Ct(0,K,"vertical");break}case 1:{K<D?(K++,Ct(0,K,"vertical")):(N=Math.min(x,N+1),Ct(0,N,"vertical"));break}case-1:{N>D+1?(N--,Ct(0,N,"vertical")):(K=Math.max(0,K-1),Ct(0,K,"vertical"));break}default:Jo()}if(p!==0)if(p===2)P=ae.length,z=I,Ct(P-1-F,0,"horizontal");else if(p===-2)z=F,P=I+1,Ct(z-F,0,"horizontal");else{let ee=[];if(Dt!==void 0){const ie=Dt({x:z,y:K,width:P-z-F,height:N-K},Ot.current.signal);typeof ie=="object"&&(ee=dd(ie))}if(p===1){let ie=!1;if(z<I){if(ee.length>0){const J=io(z+1,I+1).find(be=>!ee.includes(be-F));J!==void 0&&(z=J,ie=!0)}else z++,ie=!0;ie&&Ct(z,0,"horizontal")}ie||(P=Math.min(ae.length,P+1),Ct(P-1-F,0,"horizontal"))}else if(p===-1){let ie=!1;if(P>I+1){if(ee.length>0){const J=io(P-1,I,-1).find(be=>!ee.includes(be-F));J!==void 0&&(P=J,ie=!0)}else P--,ie=!0;ie&&Ct(P-F,0,"horizontal")}ie||(z=Math.max(F,z-1),Ct(z-F,0,"horizontal"))}else Jo()}Bt({cell:B.current.cell,range:{x:z,y:K,width:P-z,height:N-K}},!0,!1,"keyboard-select")},[Dt,B,ae.length,F,x,Ct,Bt]),Kn=l.useCallback((d,p,v,I)=>{const D=Nt-(v?0:1);if(d=fn(d,F,he.length-1+F),p=fn(p,0,D),d===(vn==null?void 0:vn[0])&&p===(vn==null?void 0:vn[1]))return!1;if(I&&B.current!==void 0){const O=[...B.current.rangeStack];(B.current.range.width>1||B.current.range.height>1)&&O.push(B.current.range),Wt({...B,current:{cell:[d,p],range:{x:d,y:p,width:1,height:1},rangeStack:O}},!0)}else Bt({cell:[d,p],range:{x:d,y:p,width:1,height:1}},!0,!1,"keyboard-nav");return m.current!==void 0&&m.current[0]===d&&m.current[1]===p&&(m.current=void 0),Ct(d-F,p),!0},[Nt,F,he.length,vn,B,Ct,Wt,Bt]),ss=l.useCallback((d,p)=>{(r==null?void 0:r.cell)!==void 0&&d!==void 0&&So(d)&&(rn([{location:r.cell,value:d}]),window.requestAnimationFrame(()=>{var D;(D=Et.current)==null||D.damage([{cell:r.cell}])})),Ut(!0),i(void 0);const[v,I]=p;if(B.current!==void 0&&(v!==0||I!==0)){const D=B.current.cell[1]===Nt-1&&d!==void 0;Kn(fn(B.current.cell[0]+v,0,ae.length-1),fn(B.current.cell[1]+I,0,Nt-1),D,!1)}_==null||_(d,p)},[r==null?void 0:r.cell,Ut,B,_,rn,Nt,Kn,ae.length]),as=l.useMemo(()=>`gdg-overlay-${cd++}`,[]),oo=l.useCallback(d=>{var v,I,D,O;Ut();const p=[];for(let z=d.x;z<d.x+d.width;z++)for(let P=d.y;P<d.y+d.height;P++){const K=X([z-F,P]);if(!K.allowOverlay&&K.kind!==j.Boolean)continue;let N;if(K.kind===j.Custom){const ee=de(K),ie=(v=ee==null?void 0:ee.provideEditor)==null?void 0:v.call(ee,K);(ee==null?void 0:ee.onDelete)!==void 0?N=ee.onDelete(K):Bs(ie)&&(N=(I=ie==null?void 0:ie.deletedValue)==null?void 0:I.call(ie,K))}else if(So(K)&&K.allowOverlay||K.kind===j.Boolean){const ee=de(K);N=(D=ee==null?void 0:ee.onDelete)==null?void 0:D.call(ee,K)}N!==void 0&&!Mo(N)&&So(N)&&p.push({location:[z,P],value:N})}rn(p),(O=Et.current)==null||O.damage(p.map(z=>({cell:z.location})))},[Ut,X,de,rn,F]),No=r!==void 0,Ti=l.useCallback(d=>{var be,pe;const p=()=>{d.stopPropagation(),d.preventDefault()},v={didMatch:!1},{bounds:I}=d,D=B.columns,O=B.rows,z=mn;if(!No&&Te(z.clear,d,v))Wt(Mr,!1),gt==null||gt();else if(!No&&Te(z.selectAll,d,v))Wt({columns:nt.empty(),rows:nt.empty(),current:{cell:((be=B.current)==null?void 0:be.cell)??[F,0],range:{x:F,y:0,width:C.length,height:x},rangeStack:[]}},!1);else if(Te(z.search,d,v))(pe=a==null?void 0:a.current)==null||pe.focus({preventScroll:!0}),ar(!0);else if(Te(z.delete,d,v)){const Ve=(yn==null?void 0:yn(B))??!0;if(Ve!==!1){const ke=Ve===!0?B:Ve;if(ke.current!==void 0){oo(ke.current.range);for(const ye of ke.current.rangeStack)oo(ye)}for(const ye of ke.rows)oo({x:F,y:ye,width:C.length,height:1});for(const ye of ke.columns)oo({x:ye,y:0,width:1,height:x})}}if(v.didMatch)return p(),!0;if(B.current===void 0)return!1;let[P,K]=B.current.cell,N=!1,ee=!1;Te(z.scrollToSelectedCell,d,v)?vr.current(P-F,K):Ge!=="none"&&Te(z.selectColumn,d,v)?D.hasIndex(P)?$(D.remove(P),void 0,!0):Ge==="single"?$(nt.fromSingleSelection(P),void 0,!0):$(void 0,P,!0):q!=="none"&&Te(z.selectRow,d,v)?O.hasIndex(K)?k(O.remove(K),void 0,!0):q==="single"?k(nt.fromSingleSelection(K),void 0,!0):k(void 0,K,!0):!No&&I!==void 0&&Te(z.activateCell,d,v)?K===x&&ct?window.setTimeout(()=>{const Ve=mr(P);bo(Ve??P)},0):(H==null||H([P-F,K]),yo(I,!0)):B.current.range.height>1&&Te(z.downFill,d,v)?Hi():B.current.range.width>1&&Te(z.rightFill,d,v)?Fi():Te(z.goToNextPage,d,v)?K+=Math.max(1,_e.current.height-4):Te(z.goToPreviousPage,d,v)?K-=Math.max(1,_e.current.height-4):Te(z.goToFirstCell,d,v)?(i(void 0),K=0,P=0):Te(z.goToLastCell,d,v)?(i(void 0),K=Number.MAX_SAFE_INTEGER,P=Number.MAX_SAFE_INTEGER):Te(z.selectToFirstCell,d,v)?(i(void 0),cn([-2,-2])):Te(z.selectToLastCell,d,v)?(i(void 0),cn([2,2])):No?(Te(z.closeOverlay,d,v)&&i(void 0),Te(z.acceptOverlayDown,d,v)&&(i(void 0),K++),Te(z.acceptOverlayUp,d,v)&&(i(void 0),K--),Te(z.acceptOverlayLeft,d,v)&&(i(void 0),P--),Te(z.acceptOverlayRight,d,v)&&(i(void 0),P++)):(Te(z.goDownCell,d,v)?K+=1:Te(z.goUpCell,d,v)?K-=1:Te(z.goRightCell,d,v)?P+=1:Te(z.goLeftCell,d,v)?P-=1:Te(z.goDownCellRetainSelection,d,v)?(K+=1,N=!0):Te(z.goUpCellRetainSelection,d,v)?(K-=1,N=!0):Te(z.goRightCellRetainSelection,d,v)?(P+=1,N=!0):Te(z.goLeftCellRetainSelection,d,v)?(P-=1,N=!0):Te(z.goToLastRow,d,v)?K=x-1:Te(z.goToFirstRow,d,v)?K=Number.MIN_SAFE_INTEGER:Te(z.goToLastColumn,d,v)?P=Number.MAX_SAFE_INTEGER:Te(z.goToFirstColumn,d,v)?P=Number.MIN_SAFE_INTEGER:(st==="rect"||st==="multi-rect")&&(Te(z.selectGrowDown,d,v)?cn([0,1]):Te(z.selectGrowUp,d,v)?cn([0,-1]):Te(z.selectGrowRight,d,v)?cn([1,0]):Te(z.selectGrowLeft,d,v)?cn([-1,0]):Te(z.selectToLastRow,d,v)?cn([0,2]):Te(z.selectToFirstRow,d,v)?cn([0,-2]):Te(z.selectToLastColumn,d,v)?cn([2,0]):Te(z.selectToFirstColumn,d,v)&&cn([-2,0])),ee=v.didMatch);const ie=Kn(P,K,!1,N),J=v.didMatch;return J&&(ie||!ee||Zn)&&p(),J},[No,B,mn,Ge,q,st,F,x,Kn,Wt,gt,C.length,yn,Zn,oo,$,k,ct,mr,bo,H,yo,Hi,Fi,cn]),Xo=l.useCallback(d=>{let p=!1;if(Ze!==void 0&&Ze({...d,cancel:()=>{p=!0}}),p||Ti(d)||B.current===void 0)return;const[v,I]=B.current.cell,D=_e.current;if(et&&!d.metaKey&&!d.ctrlKey&&B.current!==void 0&&d.key.length===1&&/[ -~]/g.test(d.key)&&d.bounds!==void 0&&Go(X([v-F,Math.max(0,Math.min(I,x-1))]))){if((!ct||I!==x)&&(D.y>I||I>D.y+D.height||D.x>v||v>D.x+D.width))return;yo(d.bounds,!0,d.key),d.stopPropagation(),d.preventDefault()}},[et,Ze,Ti,B,X,F,x,ct,yo]),cs=l.useCallback((d,p)=>{const v=d.location[0]-F;if(d.kind==="header"&&(De==null||De(v,{...d,preventDefault:p})),d.kind===en){if(v<0)return;U==null||U(v,{...d,preventDefault:p})}if(d.kind==="cell"){const[I,D]=d.location;ne==null||ne([v,D],{...d,preventDefault:p}),ea(B,d.location)||Kn(I,D,!1,!1)}},[B,ne,U,De,F,Kn]),ei=l.useCallback(async d=>{var z,P,K;if(!mn.paste)return;function p(N,ee,ie,J){var pe,Ve;const be=typeof ie=="object"?(ie==null?void 0:ie.join(`
`))??"":(ie==null?void 0:ie.toString())??"";if(!Mo(N)&&Go(N)&&N.readonly!==!0){const ke=M==null?void 0:M(be,N);if(ke!==void 0&&So(ke))return{location:ee,value:ke};const ye=de(N);if(ye===void 0)return;if(ye.kind===j.Custom){tn(N.kind===j.Custom);const it=(pe=ye.onPaste)==null?void 0:pe.call(ye,be,N.data);return it===void 0?void 0:{location:ee,value:{...N,data:it}}}else{const it=(Ve=ye.onPaste)==null?void 0:Ve.call(ye,be,N,{formatted:J,formattedString:typeof J=="string"?J:J==null?void 0:J.join(`
`),rawValue:ie});return it===void 0?void 0:(tn(it.kind===N.kind),{location:ee,value:it})}}}const v=B.columns,I=B.rows,D=((z=f.current)==null?void 0:z.contains(document.activeElement))===!0||((P=s.current)==null?void 0:P.contains(document.activeElement))===!0;let O;if(B.current!==void 0?O=[B.current.range.x,B.current.range.y]:v.length===1?O=[v.first()??0,0]:I.length===1&&(O=[F,I.first()??0]),D&&O!==void 0){let N,ee;const ie="text/plain",J="text/html";if(navigator.clipboard.read!==void 0){const ke=await navigator.clipboard.read();for(const ye of ke){if(ye.types.includes(J)){const Xt=await(await ye.getType(J)).text(),xt=sl(Xt);if(xt!==void 0){N=xt;break}}ye.types.includes(ie)&&(ee=await(await ye.getType(ie)).text())}}else if(navigator.clipboard.readText!==void 0)ee=await navigator.clipboard.readText();else if(d!==void 0&&(d==null?void 0:d.clipboardData)!==null){if(d.clipboardData.types.includes(J)){const ke=d.clipboardData.getData(J);N=sl(ke)}N===void 0&&d.clipboardData.types.includes(ie)&&(ee=d.clipboardData.getData(ie))}else return;const[be,pe]=O,Ve=[];do{if(Be===void 0){const ke=Qt(O),ye=ee??(N==null?void 0:N.map(Xt=>Xt.map(xt=>xt.rawValue).join("	")).join("	"))??"",it=p(ke,O,ye,void 0);it!==void 0&&Ve.push(it);break}if(N===void 0){if(ee===void 0)return;N=Jc(ee)}if(Be===!1||typeof Be=="function"&&(Be==null?void 0:Be([O[0]-F,O[1]],N.map(ke=>ke.map(ye=>{var it;return((it=ye.rawValue)==null?void 0:it.toString())??""}))))!==!0)return;for(const[ke,ye]of N.entries()){if(ke+pe>=x)break;for(const[it,Xt]of ye.entries()){const xt=[it+be,ke+pe],[dn,pn]=xt;if(dn>=ae.length||pn>=Nt)continue;const un=Qt(xt),Cn=p(un,xt,Xt.rawValue,Xt.formatted);Cn!==void 0&&Ve.push(Cn)}}}while(!1);rn(Ve),(K=Et.current)==null||K.damage(Ve.map(ke=>({cell:ke.location})))}},[M,de,Qt,B,mn.paste,ae.length,rn,Nt,Be,F,x]);Lt("paste",ei,w,!1,!0);const Yo=l.useCallback(async(d,p)=>{var z,P;if(!mn.copy)return;const v=p===!0||((z=f.current)==null?void 0:z.contains(document.activeElement))===!0||((P=s.current)==null?void 0:P.contains(document.activeElement))===!0,I=B.columns,D=B.rows,O=(K,N)=>{if(!ce)cl(K,N,d);else{const ee=N.map(ie=>({kind:j.Text,data:C[ie].title,displayData:C[ie].title,allowOverlay:!1}));cl([ee,...K],N,d)}};if(v&&Dt!==void 0){if(B.current!==void 0){let K=Dt(B.current.range,Ot.current.signal);typeof K!="object"&&(K=await K()),O(K,io(B.current.range.x-F,B.current.range.x+B.current.range.width-F))}else if(D!==void 0&&D.length>0){const N=[...D].map(ee=>{const ie=Dt({x:F,y:ee,width:C.length,height:1},Ot.current.signal);return typeof ie=="object"?ie[0]:ie().then(J=>J[0])});if(N.some(ee=>ee instanceof Promise)){const ee=await Promise.all(N);O(ee,io(C.length))}else O(N,io(C.length))}else if(I.length>0){const K=[],N=[];for(const ee of I){let ie=Dt({x:ee,y:0,width:1,height:x},Ot.current.signal);typeof ie!="object"&&(ie=await ie()),K.push(ie),N.push(ee-F)}if(K.length===1)O(K[0],N);else{const ee=K.reduce((ie,J)=>ie.map((be,pe)=>[...be,...J[pe]]));O(ee,N)}}}},[C,Dt,B,mn.copy,F,x,ce]);Lt("copy",Yo,w,!1,!1);const ds=l.useCallback(async d=>{var v,I;if(!(!mn.cut||!(((v=f.current)==null?void 0:v.contains(document.activeElement))===!0||((I=s.current)==null?void 0:I.contains(document.activeElement))===!0))&&(await Yo(d),B.current!==void 0)){let D={current:{cell:B.current.cell,range:B.current.range,rangeStack:[]},rows:nt.empty(),columns:nt.empty()};const O=yn==null?void 0:yn(D);if(O===!1||(D=O===!0?D:O,D.current===void 0))return;oo(D.current.range)}},[oo,B,mn.cut,Yo,yn]);Lt("cut",ds,w,!1,!1);const us=l.useCallback((d,p)=>{if(we!==void 0){F!==0&&(d=d.map(D=>[D[0]-F,D[1]])),we(d,p);return}if(d.length===0||p===-1)return;const[v,I]=d[p];m.current!==void 0&&m.current[0]===v&&m.current[1]===I||(m.current=[v,I],Kn(v,I,!1,!1))},[we,F,Kn]),[yr,br]=((Wi=kt==null?void 0:kt.current)==null?void 0:Wi.cell)??[],vr=l.useRef(Ct);vr.current=Ct,l.useLayoutEffect(()=>{var d,p,v,I;!Gt.current&&yr!==void 0&&br!==void 0&&(yr!==((p=(d=Hn.current)==null?void 0:d.current)==null?void 0:p.cell[0])||br!==((I=(v=Hn.current)==null?void 0:v.current)==null?void 0:I.cell[1]))&&vr.current(yr,br),Gt.current=!1},[yr,br]);const Ai=B.current!==void 0&&(B.current.cell[0]>=ae.length||B.current.cell[1]>=Nt);l.useLayoutEffect(()=>{Ai&&Wt(Mr,!1)},[Ai,Wt]);const fs=l.useMemo(()=>ct===!0&&(Le==null?void 0:Le.tint)===!0?nt.fromSingleSelection(Nt-1):nt.empty(),[Nt,ct,Le==null?void 0:Le.tint]),hs=l.useCallback(d=>typeof zt=="boolean"?zt:(zt==null?void 0:zt(d-F))??!0,[F,zt]),gs=l.useMemo(()=>{if(Gr===void 0||s.current===null)return null;const{bounds:d,group:p}=Gr,v=s.current.getBoundingClientRect();return l.createElement(Nc,{bounds:d,group:p,canvasBounds:v,onClose:()=>qr(void 0),onFinish:I=>{qr(void 0),me==null||me(p,I)}})},[me,Gr]),ms=Math.min(ae.length,ve+(Zt?1:0));l.useImperativeHandle(t,()=>({appendRow:(d,p)=>bo(d+F,p),updateCells:d=>{var p;return F!==0&&(d=d.map(v=>({cell:[v.cell[0]+F,v.cell[1]]}))),(p=Et.current)==null?void 0:p.damage(d)},getBounds:(d,p)=>{var v;if(!((s==null?void 0:s.current)===null||(f==null?void 0:f.current)===null)){if(d===void 0&&p===void 0){const I=s.current.getBoundingClientRect(),D=I.width/f.current.clientWidth;return{x:I.x-f.current.scrollLeft*D,y:I.y-f.current.scrollTop*D,width:f.current.scrollWidth*D,height:f.current.scrollHeight*D}}return(v=Et.current)==null?void 0:v.getBounds((d??0)+F,p)}},focus:()=>{var d;return(d=Et.current)==null?void 0:d.focus()},emit:async d=>{switch(d){case"delete":Xo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Xo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Xo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Yo(void 0,!0);break;case"paste":await ei();break}},scrollTo:Ct,remeasureColumns:d=>{for(const p of d)wr(p+F)}}),[bo,wr,Yo,Xo,ei,F,Ct]);const[zi,Bi]=vn??[],ws=l.useCallback(d=>{const[p,v]=d;if(v===-1){Ge!=="none"&&($(nt.fromSingleSelection(p),void 0,!1),Ut());return}zi===p&&Bi===v||(Bt({cell:d,range:{x:p,y:v,width:1,height:1}},!0,!1,"keyboard-nav"),Ct(p,v))},[Ge,Ut,Ct,zi,Bi,Bt,$]),[ys,bs]=l.useState(!1),Li=l.useRef(wl(d=>{bs(d)},5)),vs=l.useCallback(()=>{Li.current(!0),B.current===void 0&&B.columns.length===0&&B.rows.length===0&&c===void 0&&Bt({cell:[F,Xn],range:{x:F,y:Xn,width:1,height:1}},!0,!1,"keyboard-select")},[Xn,B,c,F,Bt]),ps=l.useCallback(()=>{Li.current(!1)},[]),[Cs,xs]=l.useMemo(()=>{let d;const p=(Mt==null?void 0:Mt.scrollbarWidthOverride)??ui(),v=x+(ct?1:0);if(typeof Tt=="number")d=fe+v*Tt;else{let D=0;const O=Math.min(v,10);for(let z=0;z<O;z++)D+=Tt(z);D=Math.floor(D/O),d=fe+v*D}d+=p;const I=ae.reduce((D,O)=>O.width+D,0)+p;return[`${Math.min(1e5,I)}px`,`${Math.min(1e5,d)}px`]},[ae,Mt==null?void 0:Mt.scrollbarWidthOverride,Tt,x,ct,fe]),ks=l.useMemo(()=>ga(Z),[Z]);return l.createElement(zl.Provider,{value:Z},l.createElement(nd,{style:ks,className:Se,inWidth:b??Cs,inHeight:S??xs},l.createElement(Pc,{fillHandle:To,drawFocusRing:mt,experimental:Mt,fixedShadowX:Rt,fixedShadowY:Ft,getRowThemeOverride:h,headerIcons:Mn,imageWindowLoader:nr,initialSize:Bn,isDraggable:Rn,onDragLeave:En,onRowMoved:gn,overscrollX:sr,overscrollY:Or,preventDiagonalScrolling:ao,rightElement:co,rightElementProps:uo,smoothScrollX:Jn,smoothScrollY:Ln,className:Se,enableGroups:wt,onCanvasFocused:vs,onCanvasBlur:ps,canvasRef:s,onContextMenu:cs,theme:Z,cellXOffset:bn,cellYOffset:Xn,accessibilityHeight:pt.height,onDragEnd:is,columns:ae,nonGrowWidth:ue,drawHeader:Kr,onColumnProposeMove:R,drawCell:mo,disabledRows:fs,freezeColumns:ms,lockColumns:F,firstColAccessible:F===0,getCellContent:Qt,minColumnWidth:In,maxColumnWidth:Wn,searchInputRef:a,showSearch:$r,onSearchClose:Nr,highlightRegions:ql,getCellsForSelection:Dt,getGroupDetails:_r,headerHeight:Qn,isFocused:ys,groupHeaderHeight:wt?Lo:0,freezeTrailingRows:je+(ct&&(Le==null?void 0:Le.sticky)===!0?1:0),hasAppendRow:ct,onColumnResize:wn,onColumnResizeEnd:Yr,onColumnResizeStart:go,onCellFocused:ws,onColumnMoved:os,onDragStart:rs,onHeaderMenuClick:es,onHeaderIndicatorClick:ts,onItemHovered:Qr,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:Ql,onKeyDown:Xo,onKeyUp:Qe,onMouseDown:jl,onMouseUp:Jl,onDragOverCell:Ye,onDrop:bt,onSearchResultsChanged:us,onVisibleRegionChanged:ns,clientSize:se,rowHeight:Tt,searchResults:V,searchValue:Me,onSearchValueChange:Ee,rows:Nt,scrollRef:f,selection:B,translateX:pt.tx,translateY:pt.ty,verticalBorder:hs,gridRef:Et,getCellRenderer:de,resizeIndicator:Lr}),gs,r!==void 0&&l.createElement(l.Suspense,{fallback:null},l.createElement(ad,{...r,validateCell:dr,bloom:A,id:as,getCellRenderer:de,className:(Mt==null?void 0:Mt.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Sn,imageEditorOverride:g,onFinishEditing:ss,markdownDivCreateNode:y,isOutsideClick:Pn}))))},fd=l.forwardRef(ud),fl=20,hd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:j.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>gd(e,e.cell.data,di(e.cell),e.cell.maxSize??fl),onDelete:e=>({...e,data:!1}),onClick:e=>{const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:a,height:s,x:c,y:u}=r,f=t.maxSize??fl,m=Math.floor(r.y+s/2),w=pl(f,s,i.cellVerticalPadding),g=vl(t.contentAlign??"center",c,a,i.cellHorizontalPadding,w),h=bl(g,m,w),y=Cl(c+n,u+o,h);if(di(t)&&y)return{...t,data:Gl(t.data)}},onPaste:(e,t)=>{let n=Er;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=wi),n===t.data?void 0:{...t,data:n}}};function gd(e,t,n,o){if(!n&&t===Er)return;const{ctx:r,hoverAmount:i,theme:a,rect:s,highlighted:c,hoverX:u,hoverY:f,cell:{contentAlign:m}}=e,{x:w,y:g,width:h,height:y}=s,b=.35;let S=n?1-b+b*i:.4;t===Er&&(S*=i),S!==0&&(r.globalAlpha=S,xi(r,a,t,w,g,h,y,c,u,f,o,m),r.globalAlpha=1)}const md=on("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),wd=e=>{const{bubbles:t}=e;return l.createElement(md,null,t.map((n,o)=>l.createElement("div",{key:o,className:"boe-bubble"},n)),l.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},yd=wd,bd={getAccessibilityString:e=>xl(e.data),kind:j.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r).width+o+20,0)+2*n.cellHorizontalPadding-4,draw:e=>pd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return l.createElement(yd,{bubbles:t.data})},onPaste:()=>{}},vd=4;function pd(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:a,y:s,width:c,height:u}=n,f=20,m=8,w=vd;let g=a+o.cellHorizontalPadding;const h=[];for(const y of t){if(g>a+c)break;const b=Ho(y,r,o.baseFontFull).width;h.push({x:g,width:b}),g+=b+m*2+w}r.beginPath();for(const y of h)kn(r,y.x,s+(u-f)/2,y.width+m*2,f,o.roundingRadius??f/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[y,b]of h.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[y],b.x+m,s+u/2+qn(r,o))}const Cd=on("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),xd=e=>{const{drilldowns:t}=e;return l.createElement(Cd,null,t.map((n,o)=>l.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&l.createElement("img",{src:n.img}),l.createElement("div",null,n.text))))},kd=xd,Sd={getAccessibilityString:e=>xl(e.data.map(t=>t.text)),kind:j.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+20+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Ed(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return l.createElement(kd,{drilldowns:t.data})},onPaste:()=>{}},Md=4,si={};function Rd(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,a=n-i*2,s=4,c=n*r,u=o+i,f=o*3,m=(f+i*2)*r,w=`${e},${t},${r},${n}`;if(si[w]!==void 0)return{el:si[w],height:c,width:m,middleWidth:s*r,sideWidth:u*r,padding:i*r,dpr:r};const g=document.createElement("canvas"),h=g.getContext("2d");return h===null?null:(g.width=m,g.height=c,h.scale(r,r),si[w]=g,h.beginPath(),kn(h,i,i,f,a,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),kn(h,i+.5,i+.5,f,a,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:g,height:c,width:m,sideWidth:u*r,middleWidth:o*r,padding:i*r,dpr:r})}function Ed(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:a,row:s}=e,{x:c,width:u}=n,f=o.baseFontFull,m=Dl(r,f),w=Math.min(n.height,Math.max(16,Math.ceil(m*o.lineHeight)*2)),g=Math.floor(n.y+(n.height-w)/2),h=w-10,y=8,b=Md;let S=c+o.cellHorizontalPadding;const C=o.roundingRadius??6,x=Rd(o.bgCell,o.drilldownBorder,w,C),X=[];for(const Y of t){if(S>c+u)break;const T=Ho(Y.text,r,f).width;let _=0;Y.img!==void 0&&i.loadOrGetImage(Y.img,a,s)!==void 0&&(_=h-8+4);const M=T+_+y*2;X.push({x:S,width:M}),S+=M+b}if(x!==null){const{el:Y,height:H,middleWidth:T,sideWidth:_,width:M,dpr:W,padding:L}=x,A=_/W,E=L/W;for(const R of X){const le=Math.floor(R.x),te=Math.floor(R.width),ne=te-(A-E)*2;r.imageSmoothingEnabled=!1,r.drawImage(Y,0,0,_,H,le-E,g,A,w),ne>0&&r.drawImage(Y,_,0,T,H,le+(A-E),g,ne,w),r.drawImage(Y,M-_,0,_,H,le+te-(A-E),g,A,w),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[Y,H]of X.entries()){const T=t[Y];let _=H.x+y;if(T.img!==void 0){const M=i.loadOrGetImage(T.img,a,s);if(M!==void 0){const W=h-8;let L=0,A=0,E=M.width,R=M.height;E>R?(L+=(E-R)/2,E=R):R>E&&(A+=(R-E)/2,R=E),r.beginPath(),kn(r,_,g+w/2-W/2,W,W,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(M,L,A,E,R,_,g+w/2-W/2,W,W),r.restore(),_+=W+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(T.text,_,g+w/2+qn(r,o))}}const Id={getAccessibilityString:e=>e.data.join(", "),kind:j.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Dd(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??_s;return l.createElement(r,{urls:t.data,canWrite:t.readonly!==!1,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},ai=4;function Dd(e,t,n,o){const{rect:r,col:i,row:a,theme:s,ctx:c,imageLoader:u}=e,{x:f,y:m,height:w,width:g}=r,h=w-s.cellVerticalPadding*2,y=[];let b=0;for(let C=0;C<t.length;C++){const x=t[C];if(x.length===0)continue;const X=u.loadOrGetImage(x,i,a);if(X!==void 0){y[C]=X;const Y=X.width*(h/X.height);b+=Y+ai}}if(b===0)return;b-=ai;let S=f+s.cellHorizontalPadding;o==="right"?S=Math.floor(f+g-s.cellHorizontalPadding-b):o==="center"&&(S=Math.floor(f+g/2-b/2));for(const C of y){if(C===void 0)continue;const x=C.width*(h/C.height);n>0&&(c.beginPath(),kn(c,S,m+s.cellVerticalPadding,x,h,n),c.save(),c.clip()),c.drawImage(C,S,m+s.cellVerticalPadding,x,h),n>0&&c.restore(),S+=x+ai}}function Fd(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Hd={getAccessibilityString:()=>"",kind:j.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:a}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(Fd(n,o)*t.skeletonWidthVariability));const c=a.cellHorizontalPadding,u=t.skeletonHeight??Math.min(18,i.height-2*a.cellVerticalPadding);kn(r,i.x+c,i.y+(i.height-u)/2,s,u,a.roundingRadius??3),r.fillStyle=lo(a.textDark,.1),r.fill()},onPaste:()=>{}},Td=()=>e=>e.targetWidth,hl=on("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[Td(),"px"]}}),Ad=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:a,validatedSelection:s}=e,c=t.data,u=t.readonly===!0,[f,m]=l.useState(c===""||o),w=l.useCallback(()=>{m(h=>!h)},[]),g=c?"gdg-ml-6":"";return f?l.createElement(hl,{targetWidth:i.width-20},l.createElement(Tr,{autoFocus:!0,highlight:!1,validatedSelection:s,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),l.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${g}`,onClick:()=>a(t)},l.createElement(Ws,null))):l.createElement(hl,{targetWidth:i.width},l.createElement(Gs,{contents:c,createNode:r}),!u&&l.createElement(l.Fragment,null,l.createElement("div",{className:"spacer"}),l.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${g}`,onClick:w},l.createElement(yi,null))),l.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},zd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:tr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>xn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:a,validatedSelection:s}=e;return l.createElement(Ad,{onFinish:r,targetRect:o,value:n,validatedSelection:s,onChange:c=>t({...n,data:c.target.value}),forceEditMode:a,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Bd={getAccessibilityString:e=>e.row.toString(),kind:sn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Ld,measure:()=>44,draw:e=>Od(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:a}=t,s=n.drawHandle?7+(i-7)/2:i/2,c=a/2;if(Math.abs(o-s)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Ld(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=Pd,n.textAlign="center",i}function Pd(e){const{ctx:t}=e;t.textAlign="start"}function Od(e,t,n,o,r,i){const{ctx:a,rect:s,hoverAmount:c,theme:u}=e,{x:f,y:m,width:w,height:g}=s,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){a.globalAlpha=h;const y=7*(n?c:1);if(xi(a,u,n,r?f+y:f,m,r?w-y:w,g,!0,void 0,void 0,18,"center",i),r){a.globalAlpha=c,a.beginPath();for(const b of[3,6])for(const S of[-5,-1,3])a.rect(f+b,m+g/2+S,2,2);a.fillStyle=u.textLight,a.fill(),a.beginPath()}a.globalAlpha=1}if(o==="number"||o==="both"&&!n){const y=t.toString(),b=u.markerFontFull,S=f+w/2;o==="both"&&c!==0&&(a.globalAlpha=1-c),a.fillStyle=u.textLight,a.font=b,a.fillText(y,S,m+g/2+qn(a,b)),c!==0&&(a.globalAlpha=1)}}const Wd={getAccessibilityString:()=>"",kind:sn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>$d(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function $d(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:a,spriteManager:s}=e,{x:c,y:u,width:f,height:m}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,u+1,f,m-2),o.fillStyle=a.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const w=t!=="";let g=0;if(n!==void 0){const y=m-8,b=c+8/2,S=u+8/2;s.drawSprite(n,"normal",o,b,S,y,a,w?1:i),g=y}else{g=24;const h=12,y=w?h:i*h,b=w?0:(1-i)*h*.5,S=a.cellHorizontalPadding+4;y>0&&(o.moveTo(c+S+b,u+m/2),o.lineTo(c+S+b+y,u+m/2),o.moveTo(c+S+b+y*.5,u+m/2-y*.5),o.lineTo(c+S+b+y*.5,u+m/2+y*.5),o.lineWidth=2,o.strokeStyle=a.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=a.textMedium,o.fillText(t,g+c+a.cellHorizontalPadding+.5,u+m/2+qn(o,a)),o.beginPath()}const Nd=l.lazy(async()=>await ml(()=>import("./number-overlay-editor-3ljU3NGx.js"),__vite__mapDeps([8,1,3,9]),import.meta.url)),Xd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Number,needsHover:!1,needsHoverPosition:!1,useLabel:!0,drawPrep:tr,draw:e=>xn(e,e.cell.displayData,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return l.createElement(l.Suspense,{fallback:null},l.createElement(Nd,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},Yd={getAccessibilityString:()=>"",measure:()=>108,kind:j.Protected,needsHover:!1,needsHoverPosition:!1,draw:Kd,onPaste:()=>{}};function Kd(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:a}=o;t.beginPath();const s=2.5;let c=r+n.cellHorizontalPadding+s;const u=i+a/2,f=Math.cos(Ui(30))*s,m=Math.sin(Ui(30))*s;for(let w=0;w<12;w++)t.moveTo(c,u-s),t.lineTo(c,u+s),t.moveTo(c+f,u-m),t.lineTo(c-f,u+m),t.moveTo(c-f,u-m),t.lineTo(c+f,u+m),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const Ud={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>tr(e,t,e.theme.textLight),draw:e=>xn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return Yt.createElement(Tr,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},_d={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:tr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:a,overrideCursor:s}=e,{displayData:c,contentAlign:u,hoverEffect:f,allowWrapping:m}=t;if(f===!0&&n>0){r.textBaseline="alphabetic";const w=a.cellHorizontalPadding,g=a.cellVerticalPadding,h=Ho(c,r,a.baseFontFull,"alphabetic"),y=i.height-g,b=Math.min(y,h.actualBoundingBoxAscent*2.5);r.beginPath(),kn(r,i.x+w/2,i.y+(i.height-b)/2+1,h.width+w*3,b-1,a.roundingRadius??4),r.globalAlpha=n,r.fillStyle=lo(a.textDark,.1),r.fill(),r.globalAlpha=1,r.fillStyle=a.textDark,r.textBaseline="middle",s==null||s("text")}xn(e,c,u,m,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return l.createElement(Tr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:a=>o({...r,data:a.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Vd=on("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),Gd=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:a}=e,[s,c]=l.useState(!r&&(t===""||o)),u=l.useCallback(()=>{c(!0)},[]);return s?l.createElement(Tr,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):l.createElement(Vd,null,l.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},a),!r&&l.createElement("div",{className:"gdg-edit-icon",onClick:u},l.createElement(yi,null)),l.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},qd=Gd;function gl(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,a=e.width,s=e.actualBoundingBoxAscent;return o==="right"?r=t.width-a-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-a/2),{x:r,y:i,width:a,height:s}}const jd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:tr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:a,ctx:s}=e,c=t.displayData??t.data,u=t.hoverEffect===!0;if(o!==void 0&&u&&r!==void 0&&i!==void 0){const f=Ho(c,s,n.baseFontFull),m=gl(f,a,n,t.contentAlign),{x:w,y:g,width:h,height:y}=m;if(r>=w-4&&r<=w-4+h+8&&i>=g-4&&i<=g-4+y+8){const b=qn(s,n.baseFontFull);o("pointer");const S=5,C=g-b;s.beginPath(),s.moveTo(a.x+w,Math.floor(a.y+C+y+S)+.5),s.lineTo(a.x+w+h,Math.floor(a.y+C+y+S)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,xn({...e,rect:{...a,x:a.x-1}},c,t.contentAlign),xn({...e,rect:{...a,x:a.x-2}},c,t.contentAlign),xn({...e,rect:{...a,x:a.x+1}},c,t.contentAlign),xn({...e,rect:{...a,x:a.x+2}},c,t.contentAlign),s.restore()}}s.fillStyle=u?n.linkColor:n.textDark,xn(e,c,t.contentAlign)},onClick:e=>{const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,a=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return;const s=El(a,i.baseFontFull);if(s===void 0)return;const c=gl(s,n,i,t.contentAlign);Eo({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)&&t.onClickUri(e)},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return l.createElement(qd,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:a=>n({...o,data:a.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Zd=[Bd,Wd,hd,bd,Sd,Id,Hd,zd,Xd,Yd,Ud,_d,jd],ci=[];class Jd extends Hl{constructor(){super(...arguments);Oe(this,"imageLoaded",()=>{});Oe(this,"loadedLocations",[]);Oe(this,"cache",{});Oe(this,"sendLoaded",Hs(()=>{this.imageLoaded(new Zo(this.loadedLocations)),this.loadedLocations=[]},20));Oe(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let a=0;a<r.cells.length;a++){const s=r.cells[a];if(this.isInWindow(s)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let a=!1;const s=ci.pop()??new Image;let c=!1;const u={img:void 0,cells:[hn(o,r)],url:n,cancel:()=>{c||(c=!0,ci.length<12?ci.unshift(s):a||(s.src=""))}},f=new Promise(m=>s.addEventListener("load",()=>m(null)));requestAnimationFrame(async()=>{try{s.src=n,await f,await s.decode();const m=this.cache[i];if(m!==void 0&&!c){m.img=s;for(const w of m.cells)this.loadedLocations.push(Ci(w));a=!0,this.sendLoaded()}}catch{u.cancel()}}),this.cache[i]=u}loadOrGetImage(n,o,r){const i=n,a=this.cache[i];if(a!==void 0){const s=hn(o,r);return a.cells.includes(s)||a.cells.push(s),a.img}else this.loadImage(n,o,r,i)}}const Qd=Jd,eu=(e,t)=>{const n=l.useMemo(()=>({...Ua,...e.headerIcons}),[e.headerIcons]),o=l.useMemo(()=>e.imageWindowLoader??new Qd,[e.imageWindowLoader]);return l.createElement(fd,{...e,renderers:Zd,headerIcons:n,ref:t,imageWindowLoader:o})},fu=l.forwardRef(eu);export{Oc as C,fu as D,j as G,zl as T,Tr as a,nn as b,cu as c,du as d,su as e,So as f,qn as g,Xi as h,au as i,Mo as j,Bs as k,ga as l,Ho as m,Do as p,kn as r,uu as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./data-grid-overlay-editor-5vHjCG5w.js","./index-BMVQvedj.js","./index-wocATsGp.js","./marked.esm-dbrxtycE.js","./iframe-l9ryaD9P.js","./throttle-7EuXLZa7.js","./_baseIteratee-WTHxv43n.js","./flatten-qRvRBp6y.js","./number-overlay-editor-3ljU3NGx.js","./react-number-format.es-2Vaki8Uh.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}