var Kl=Object.defineProperty;var Nl=(t,o,l)=>o in t?Kl(t,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[o]=l;var fn=(t,o,l)=>(Nl(t,typeof o!="symbol"?o+"":o,l),l);import{s as mn,a as to,j as Y,F as or}from"./marked.esm-dbrxtycE.js";import{r as i,R as ye}from"./index-BMVQvedj.js";import{_ as Wl}from"./iframe-UFWDJmcQ.js";import{G as Z,b as Po,i as Eo,r as nr,c as Ko,C as X,g as hr,d as Ul,w as Rt,e as Bl,m as hn,f as Vl,h as rr,I as Io,p as Xl,j as Yl,t as _l,k as jl,l as At,o as lr,n as ir,q as ql,s as $o,v as Fo,x as Zl,y as Jl,z as Ql,A as ei,B as ti,D as sr,E as eo,F as oi,H as ni,J as cr,K as ri,u as gn,L as li,M as ii,T as si,N as ar,O as ci,P as ai}from"./image-window-loader-2Fr7t2ou.js";import{c as Mt,r as Gt,d as ui}from"./throttle-7EuXLZa7.js";import{u as di,f as ur}from"./flatten-qRvRBp6y.js";import{G as fi}from"./scrolling-data-grid-By3ovTFU.js";const _='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',hi=t=>{const o=t.fgColor,l=t.bgColor;return`
    ${_}<rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},gi=t=>{const o=t.fgColor,l=t.bgColor;return`
    ${_}<rect x="2" y="2" width="16" height="16" rx="4" fill="${l}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},vi=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},mi=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},Ci=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${l}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},gr=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},wi=t=>{const o=t.bgColor;return`${_}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},pi=gr,bi=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},yi=t=>{const o=t.fgColor,l=t.bgColor;return`
    ${_}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},xi=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},Mi=t=>{const o=t.fgColor,l=t.bgColor;return`
    ${_}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${l}"/>
  </svg>`},Ri=t=>{const o=t.fgColor,l=t.bgColor;return`
    ${_}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},ki=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},Si=t=>{const o=t.fgColor,l=t.bgColor;return`
    ${_}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},zi=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},Ti=t=>{const o=t.fgColor,l=t.bgColor;return`
    ${_}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${l}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${l}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},Li=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${l}"/>
</svg>`},Hi=t=>{const o=t.fgColor,l=t.bgColor;return`
    ${_}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},Di=t=>{const o=t.fgColor,l=t.bgColor;return`
    ${_}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},Ei=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},Ii=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},$i=t=>{const o=t.fgColor,l=t.bgColor;return`
    ${_}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},Fi=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},Ai=t=>{const o=t.fgColor,l=t.bgColor;return`
    ${_}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},Gi=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},Oi=t=>{const o=t.fgColor,l=t.bgColor;return`${_}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},Pi=t=>{const o=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${t.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},Ki=t=>{const o=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${t.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},Ni={headerRowID:hi,headerNumber:vi,headerCode:gi,headerString:mi,headerBoolean:Ci,headerAudioUri:pi,headerVideoUri:bi,headerEmoji:yi,headerImage:xi,headerUri:gr,headerPhone:Mi,headerMarkdown:Ri,headerDate:ki,headerTime:Si,headerEmail:zi,headerReference:Ti,headerIfThenElse:Li,headerSingleValue:Hi,headerLookup:Di,headerTextTemplate:Ei,headerMath:Ii,headerRollup:$i,headerJoinStrings:Fi,headerSplitString:Ai,headerGeoDistance:Gi,headerArray:Oi,rowOwnerOverlay:Pi,protectedColumnOverlay:Ki,renameIcon:wi},Wi=mn("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),Ui=Y("svg",{className:"button-icon",viewBox:"0 0 512 512",children:Y("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})}),Bi=Y("svg",{className:"button-icon",viewBox:"0 0 512 512",children:Y("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})}),Vi=Y("svg",{className:"button-icon",viewBox:"0 0 512 512",children:Y("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})}),Xi=10,Yi=t=>{const{canvasRef:o,cellYOffset:l,rows:d,columns:w,searchInputRef:M,searchValue:b,searchResults:D,onSearchValueChange:z,getCellsForSelection:p,onSearchResultsChanged:C,showSearch:S=!1,onSearchClose:F}=t,[W]=i.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[K,xe]=i.useState(""),ie=b??K,Ae=i.useCallback(E=>{xe(E),z==null||z(E)},[z]),[k,B]=i.useState(),le=i.useRef(k);le.current=k,i.useEffect(()=>{D!==void 0&&(D.length>0?B(E=>({rowsSearched:d,results:D.length,selectedIndex:(E==null?void 0:E.selectedIndex)??-1})):B(void 0))},[d,D]);const Me=i.useRef();Me.current===void 0&&(Me.current=new AbortController);const Q=i.useRef(),[j,J]=i.useState([]),ee=D??j,V=i.useCallback(()=>{Q.current!==void 0&&(window.cancelAnimationFrame(Q.current),Q.current=void 0,Me.current.abort())},[]),Se=i.useRef(l);Se.current=l;const kt=i.useCallback(E=>{const oe=new RegExp(E.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let se=Se.current,He=Math.min(10,d),Pe=0;B(void 0),J([]);const ft=[],no=async()=>{var Ve;if(p===void 0)return;const Uo=performance.now(),Pt=d-Pe;let ht=p({x:0,y:se,width:w.length,height:Math.min(He,Pt,d-se)},Me.current.signal);typeof ht=="function"&&(ht=await ht());let ro=!1;for(const[ge,De]of ht.entries())for(const[Bo,Ze]of De.entries()){let Je;switch(Ze.kind){case Z.Text:case Z.Number:Je=Ze.displayData;break;case Z.Uri:case Z.Markdown:Je=Ze.data;break;case Z.Boolean:Je=typeof Ze.data=="boolean"?Ze.data.toString():void 0;break;case Z.Image:case Z.Bubble:Je=Ze.data.join("🐳");break;case Z.Custom:Je=Ze.copyData;break}Je!==void 0&&oe.test(Je)&&(ft.push([Bo,ge+se]),ro=!0)}const lo=performance.now();ro&&J([...ft]),Pe+=ht.length,Po(Pe<=d);const nt=((Ve=le.current)==null?void 0:Ve.selectedIndex)??-1;B({results:ft.length,rowsSearched:Pe,selectedIndex:nt}),C==null||C(ft,nt),se+He>=d?se=0:se+=He;const gt=lo-Uo,vt=Math.max(gt,1),mt=Xi/vt;He=Math.ceil(He*mt),Pe<d&&ft.length<1e3&&(Q.current=window.requestAnimationFrame(no))};V(),Q.current=window.requestAnimationFrame(no)},[V,w.length,p,C,d]),ue=i.useCallback(()=>{var E;F==null||F(),B(void 0),J([]),C==null||C([],-1),V(),(E=o==null?void 0:o.current)==null||E.focus()},[V,o,F,C]),oo=i.useCallback(E=>{Ae(E.target.value),D===void 0&&(E.target.value===""?(B(void 0),J([]),V()):kt(E.target.value))},[kt,V,Ae,D]);i.useEffect(()=>{S&&M.current!==null&&(Ae(""),M.current.focus({preventScroll:!0}))},[S,M,Ae]);const dt=i.useCallback(E=>{var se;if((se=E==null?void 0:E.stopPropagation)==null||se.call(E),k===void 0)return;const oe=(k.selectedIndex+1)%k.results;B({...k,selectedIndex:oe}),C==null||C(ee,oe)},[k,C,ee]),Le=i.useCallback(E=>{var se;if((se=E==null?void 0:E.stopPropagation)==null||se.call(E),k===void 0)return;let oe=(k.selectedIndex-1)%k.results;oe<0&&(oe+=k.results),B({...k,selectedIndex:oe}),C==null||C(ee,oe)},[C,ee,k]),Ge=i.useCallback(E=>{(E.ctrlKey||E.metaKey)&&E.nativeEvent.code==="KeyF"||E.key==="Escape"?(ue(),E.stopPropagation(),E.preventDefault()):E.key==="Enter"&&(E.shiftKey?Le():dt())},[ue,dt,Le]);i.useEffect(()=>()=>{V()},[V]);const[Ot,Oe]=i.useState(!1);i.useEffect(()=>{if(S)Oe(!0);else{const E=setTimeout(()=>Oe(!1),150);return()=>clearTimeout(E)}},[S]);const Wo=i.useMemo(()=>{if(!S&&!Ot)return null;let E;k!==void 0&&(E=k.results>=1e3?"over 1000":`${k.results} result${k.results!==1?"s":""}`,k.selectedIndex>=0&&(E=`${k.selectedIndex+1} of ${E}`));const oe=Pe=>{Pe.stopPropagation()},He={width:`${Math.floor(((k==null?void 0:k.rowsSearched)??0)/d*100)}%`};return to(Wi,{className:S?"":"out",onMouseDown:oe,onMouseMove:oe,onMouseUp:oe,onClick:oe,children:[to("div",{className:"gdg-search-bar-inner",children:[Y("input",{id:W,"aria-hidden":!S,"data-testid":"search-input",ref:M,onChange:oo,value:ie,tabIndex:S?void 0:-1,onKeyDownCapture:Ge}),Y("button",{"aria-label":"Previous Result","aria-hidden":!S,tabIndex:S?void 0:-1,onClick:Le,disabled:((k==null?void 0:k.results)??0)===0,children:Ui}),Y("button",{"aria-label":"Next Result","aria-hidden":!S,tabIndex:S?void 0:-1,onClick:dt,disabled:((k==null?void 0:k.results)??0)===0,children:Bi}),F!==void 0&&Y("button",{"aria-label":"Close Search","aria-hidden":!S,"data-testid":"search-close-button",tabIndex:S?void 0:-1,onClick:ue,children:Vi})]}),k!==void 0?to(or,{children:[Y("div",{className:"gdg-search-status",children:Y("div",{"data-testid":"search-result-area",children:E})}),Y("div",{className:"gdg-search-progress",style:He})]}):Y("div",{className:"gdg-search-status",children:Y("label",{htmlFor:W,children:"Type to search"})})]})},[S,Ot,k,d,W,M,oo,ie,Ge,Le,dt,F,ue]);return to(or,{children:[Y(fi,{prelightCells:ee,accessibilityHeight:t.accessibilityHeight,canvasRef:t.canvasRef,cellXOffset:t.cellXOffset,cellYOffset:t.cellYOffset,className:t.className,clientSize:t.clientSize,columns:t.columns,disabledRows:t.disabledRows,enableGroups:t.enableGroups,fillHandle:t.fillHandle,firstColAccessible:t.firstColAccessible,nonGrowWidth:t.nonGrowWidth,fixedShadowX:t.fixedShadowX,fixedShadowY:t.fixedShadowY,freezeColumns:t.freezeColumns,getCellContent:t.getCellContent,getCellRenderer:t.getCellRenderer,getGroupDetails:t.getGroupDetails,getRowThemeOverride:t.getRowThemeOverride,groupHeaderHeight:t.groupHeaderHeight,headerHeight:t.headerHeight,highlightRegions:t.highlightRegions,imageWindowLoader:t.imageWindowLoader,initialSize:t.initialSize,isFilling:t.isFilling,isFocused:t.isFocused,lockColumns:t.lockColumns,maxColumnWidth:t.maxColumnWidth,minColumnWidth:t.minColumnWidth,onHeaderMenuClick:t.onHeaderMenuClick,onHeaderIndicatorClick:t.onHeaderIndicatorClick,onMouseMove:t.onMouseMove,onVisibleRegionChanged:t.onVisibleRegionChanged,overscrollX:t.overscrollX,overscrollY:t.overscrollY,preventDiagonalScrolling:t.preventDiagonalScrolling,rightElement:t.rightElement,rightElementProps:t.rightElementProps,rowHeight:t.rowHeight,rows:t.rows,scrollRef:t.scrollRef,selection:t.selection,theme:t.theme,freezeTrailingRows:t.freezeTrailingRows,hasAppendRow:t.hasAppendRow,translateX:t.translateX,translateY:t.translateY,verticalBorder:t.verticalBorder,onColumnProposeMove:t.onColumnProposeMove,drawFocusRing:t.drawFocusRing,drawCell:t.drawCell,drawHeader:t.drawHeader,experimental:t.experimental,gridRef:t.gridRef,headerIcons:t.headerIcons,isDraggable:t.isDraggable,onCanvasBlur:t.onCanvasBlur,onCanvasFocused:t.onCanvasFocused,onCellFocused:t.onCellFocused,onColumnMoved:t.onColumnMoved,onColumnResize:t.onColumnResize,onColumnResizeEnd:t.onColumnResizeEnd,onColumnResizeStart:t.onColumnResizeStart,onContextMenu:t.onContextMenu,onDragEnd:t.onDragEnd,onDragLeave:t.onDragLeave,onDragOverCell:t.onDragOverCell,onDragStart:t.onDragStart,onDrop:t.onDrop,onItemHovered:t.onItemHovered,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onRowMoved:t.onRowMoved,smoothScrollX:t.smoothScrollX,smoothScrollY:t.smoothScrollY,resizeIndicator:t.resizeIndicator}),Wo]})},_i=Yi;class ji extends i.PureComponent{constructor(){super(...arguments);fn(this,"wrapperRef",i.createRef());fn(this,"clickOutside",l=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(l))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(l.target)){let d=l.target;for(;d!==null;){if(d.classList.contains("click-outside-ignore"))return;d=d.parentElement}this.props.onClickOutside()}})}componentDidMount(){document.addEventListener("touchend",this.clickOutside,!0),document.addEventListener("mousedown",this.clickOutside,!0),document.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){document.removeEventListener("touchend",this.clickOutside,!0),document.removeEventListener("mousedown",this.clickOutside,!0),document.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:l,isOutsideClick:d,...w}=this.props;return Y("div",{...w,ref:this.wrapperRef,children:this.props.children})}}const qi=()=>t=>Math.max(16,t.targetHeight-10),Zi=mn("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[qi(),"px"]}}),Ji=t=>{const{bounds:o,group:l,onClose:d,canvasBounds:w,onFinish:M}=t,[b,D]=ye.useState(l);return Y(ji,{style:{position:"absolute",left:o.x-w.left+1,top:o.y-w.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:d,children:Y(Zi,{targetHeight:o.height,"data-testid":"group-rename-input",value:b,onBlur:d,onFocus:z=>z.target.setSelectionRange(0,b.length),onChange:z=>D(z.target.value),onKeyDown:z=>{z.key==="Enter"?M(b):z.key==="Escape"&&d()},autoFocus:!0})})},vn=150;function Qi(t,o,l,d){var M;const w=d(o);return((M=w==null?void 0:w.measure)==null?void 0:M.call(w,t,o,l))??vn}function vr(t,o,l,d,w,M,b,D,z){let p=0;const C=w===void 0?[]:w.map(F=>{const W=Qi(t,F[d],o,z);return p=Math.max(p,W),W});if(C.length>5&&D){p=0;let F=0;for(const K of C)F+=K;const W=F/C.length;for(let K=0;K<C.length;K++)C[K]>=W*2?C[K]=0:p=Math.max(p,C[K])}p=Math.max(p,t.measureText(l.title).width+16+(l.icon===void 0?0:28));const S=Math.max(Math.ceil(M),Math.min(Math.floor(b),Math.ceil(p)));return{...l,width:S}}function es(t,o,l,d,w,M,b,D,z){const p=i.useRef(o),C=i.useRef(l),S=i.useRef(b);p.current=o,C.current=l,S.current=b;const[F,W]=i.useMemo(()=>{if(typeof window>"u")return[null,null];const k=document.createElement("canvas");return k.style.display="none",k.style.opacity="0",k.style.position="fixed",[k,k.getContext("2d",{alpha:!1})]},[]);i.useLayoutEffect(()=>(F&&document.documentElement.append(F),()=>{F==null||F.remove()}),[F]);const K=i.useRef({}),xe=i.useRef(),[ie,Ae]=i.useState();return i.useLayoutEffect(()=>{const k=C.current;if(k===void 0||t.every(Eo))return;let B=Math.max(1,10-Math.floor(t.length/1e4)),le=0;B<p.current&&B>1&&(B--,le=1);const Me={x:0,y:0,width:t.length,height:Math.min(p.current,B)},Q={x:0,y:p.current-1,width:t.length,height:1};(async()=>{const J=k(Me,z.signal),ee=le>0?k(Q,z.signal):void 0;let V;typeof J=="object"?V=J:V=await nr(J),ee!==void 0&&(typeof ee=="object"?V=[...V,...ee]:V=[...V,...await nr(ee)]),xe.current=t,Ae(V)})()},[z.signal,t]),i.useMemo(()=>{let B=t.every(Eo)?t:W===null?t.map(j=>Eo(j)?j:{...j,width:vn}):(W.font=S.current.baseFontFull,t.map((j,J)=>{if(Eo(j))return j;if(K.current[j.id]!==void 0)return{...j,width:K.current[j.id]};if(ie===void 0||xe.current!==t||j.id===void 0)return{...j,width:vn};const ee=vr(W,b,j,J,ie,w,M,!0,D);return K.current[j.id]=ee.width,ee})),le=0,Me=0;const Q=[];for(const[j,J]of B.entries())le+=J.width,J.grow!==void 0&&J.grow>0&&(Me+=J.grow,Q.push(j));if(le<d&&Q.length>0){const j=[...B],J=d-le;let ee=J;for(let V=0;V<Q.length;V++){const Se=Q[V],kt=(B[Se].grow??0)/Me,ue=V===Q.length-1?ee:Math.min(ee,Math.floor(J*kt));j[Se]={...B[Se],growOffset:ue,width:B[Se].width+ue},ee-=ue}B=j}return{sizedColumns:B,nonGrowWidth:le}},[d,t,W,ie,b,w,M,D])}function ts(t,o){return t===void 0?!1:t.length>1&&t.startsWith("_")?Number.parseInt(t.slice(1))===o.keyCode:t.length===1&&t>="a"&&t<="z"?t.toUpperCase().codePointAt(0)===o.keyCode:t===o.key}function A(t,o,l){const d=mr(t,o);return d&&(l.didMatch=!0),d}function mr(t,o){if(t.length===0)return!1;if(t.includes("|")){const z=t.split("|");for(const p of z)if(mr(p,o))return!0;return!1}let l=!1,d=!1,w=!1,M=!1;const b=t.split("+"),D=b.pop();if(!ts(D,o))return!1;if(b[0]==="any")return!0;for(const z of b)switch(z){case"ctrl":l=!0;break;case"shift":d=!0;break;case"alt":w=!0;break;case"meta":M=!0;break;case"primary":Ko.value?M=!0:l=!0;break}return o.altKey===w&&o.ctrlKey===l&&o.shiftKey===d&&o.metaKey===M}function os(t,o,l,d,w,M){const b=ye.useCallback((p,C,S,F)=>{var k;(M==="cell"||M==="multi-cell")&&p!==void 0&&(p={...p,range:{x:p.cell[0],y:p.cell[1],width:1,height:1}});const W=l==="mixed"&&(S||F==="drag"),K=d==="mixed"&&W,xe=w==="mixed"&&W;let ie={current:p===void 0?void 0:{...p,rangeStack:F==="drag"?((k=t.current)==null?void 0:k.rangeStack)??[]:[]},columns:K?t.columns:X.empty(),rows:xe?t.rows:X.empty()};S&&(M==="multi-rect"||M==="multi-cell")&&ie.current!==void 0&&t.current!==void 0&&(ie={...ie,current:{...ie.current,rangeStack:[...t.current.rangeStack,t.current.range]}}),o(ie,C)},[d,t,l,M,w,o]),D=ye.useCallback((p,C,S)=>{p=p??t.rows,C!==void 0&&(p=p.add(C));let F;if(w==="exclusive"&&p.length>0)F={current:void 0,columns:X.empty(),rows:p};else{const W=S&&l==="mixed",K=S&&d==="mixed";F={current:W?t.current:void 0,columns:K?t.columns:X.empty(),rows:p}}o(F,!1)},[d,t,l,w,o]),z=ye.useCallback((p,C,S)=>{p=p??t.columns,C!==void 0&&(p=p.add(C));let F;if(d==="exclusive"&&p.length>0)F={current:void 0,rows:X.empty(),columns:p};else{const W=S&&l==="mixed",K=S&&w==="mixed";F={current:W?t.current:void 0,rows:K?t.rows:X.empty(),columns:p}}o(F,!1)},[d,t,l,w,o]);return[b,D,z]}function ns(t,o,l,d,w){const M=i.useCallback(p=>{if(t===!0){const C=[];for(let S=p.y;S<p.y+p.height;S++){const F=[];for(let W=p.x;W<p.x+p.width;W++)W<0||S>=w?F.push({kind:Z.Loading,allowOverlay:!1}):F.push(o([W,S]));C.push(F)}return C}return(t==null?void 0:t(p,d.signal))??[]},[d.signal,o,t,w]),b=t!==void 0?M:void 0,D=i.useCallback(p=>{if(b===void 0)return[];const C={...p,x:p.x-l};if(C.x<0){C.x=0,C.width--;const S=b(C,d.signal);return typeof S=="function"?async()=>(await S()).map(F=>[{kind:Z.Loading,allowOverlay:!1},...F]):S.map(F=>[{kind:Z.Loading,allowOverlay:!1},...F])}return b(C,d.signal)},[d.signal,b,l]);return[t!==void 0?D:void 0,b]}function dr(t){return typeof t=="string"?t:`${t}px`}const rs=()=>t=>t.innerWidth,ls=()=>t=>t.innerHeight,is=mn("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[rs()],"w2q57ts-1":[ls()]}}),ss=t=>{const{inWidth:o,inHeight:l,children:d,...w}=t;return Y(is,{innerHeight:dr(l),innerWidth:dr(o),...w,children:d})},cs=2,as=1300;function us(t,o,l){const d=ye.useRef(0),[w,M]=t??[0,0];ye.useEffect(()=>{if(w===0&&M===0){d.current=0;return}let b=!1,D=0;const z=p=>{var C;if(!b){if(D===0)D=p;else{const S=p-D;d.current=Math.min(1,d.current+S/as);const F=d.current**1.618*S*cs;(C=o.current)==null||C.scrollBy(w*F,M*F),D=p,l==null||l()}window.requestAnimationFrame(z)}};return window.requestAnimationFrame(z),()=>{b=!0}},[o,w,M,l])}function ds({rowHeight:t,headerHeight:o,groupHeaderHeight:l,theme:d,overscrollX:w,overscrollY:M,scaleToRem:b,remSize:D}){const[z,p,C,S,F,W]=ye.useMemo(()=>{if(!b||D===16)return[t,o,l,d,w,M];const K=D/16,xe=t,ie=hr();return[typeof xe=="number"?xe*K:Ae=>Math.ceil(xe(Ae)*K),Math.ceil(o*K),Math.ceil(l*K),{...d,headerIconSize:((d==null?void 0:d.headerIconSize)??ie.headerIconSize)*K,cellHorizontalPadding:((d==null?void 0:d.cellHorizontalPadding)??ie.cellHorizontalPadding)*K,cellVerticalPadding:((d==null?void 0:d.cellVerticalPadding)??ie.cellVerticalPadding)*K},Math.ceil((w??0)*K),Math.ceil((M??0)*K)]},[l,o,w,M,D,t,b,d]);return{rowHeight:z,headerHeight:p,groupHeaderHeight:C,theme:S,overscrollX:F,overscrollY:W}}const ut={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function G(t,o){return t===!0?o:t===!1?"":t}function fr(t){const o=Ko.value;return{activateCell:G(t.activateCell," |Enter|shift+Enter"),clear:G(t.clear,"any+Escape"),closeOverlay:G(t.closeOverlay,"any+Escape"),acceptOverlayDown:G(t.acceptOverlayDown,"Enter"),acceptOverlayUp:G(t.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:G(t.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:G(t.acceptOverlayRight,"Tab"),copy:t.copy,cut:t.cut,delete:G(t.delete,o?"Backspace|Delete":"Delete"),downFill:G(t.downFill,"primary+_68"),scrollToSelectedCell:G(t.scrollToSelectedCell,"primary+Enter"),goDownCell:G(t.goDownCell,"ArrowDown"),goDownCellRetainSelection:G(t.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:G(t.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:G(t.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:G(t.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:G(t.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:G(t.goUpCell,"ArrowUp"),goUpCellRetainSelection:G(t.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:G(t.goToFirstCell,"primary+Home"),goToFirstColumn:G(t.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:G(t.goToFirstRow,"primary+ArrowUp"),goToLastCell:G(t.goToLastCell,"primary+End"),goToLastColumn:G(t.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:G(t.goToLastRow,"primary+ArrowDown"),goToNextPage:G(t.goToNextPage,"PageDown"),goToPreviousPage:G(t.goToPreviousPage,"PageUp"),paste:t.paste,rightFill:G(t.rightFill,"primary+_82"),search:G(t.search,"primary+f"),selectAll:G(t.selectAll,"primary+a"),selectColumn:G(t.selectColumn,"ctrl+ "),selectGrowDown:G(t.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:G(t.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:G(t.selectGrowRight,"shift+ArrowRight"),selectGrowUp:G(t.selectGrowUp,"shift+ArrowUp"),selectRow:G(t.selectRow,"shift+ "),selectToFirstCell:G(t.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:G(t.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:G(t.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:G(t.selectToLastCell,"primary+shift+End"),selectToLastColumn:G(t.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:G(t.selectToLastRow,"primary+shift+ArrowDown")}}function fs(t){const o=Ul(t);return ye.useMemo(()=>{if(o===void 0)return fr(ut);const l={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??ut.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??ut.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??ut.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??ut.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??ut.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??ut.selectToLastCell};return fr({...ut,...l})},[o])}function hs(t){function o(d,w,M){if(typeof d=="number")return{headerIndex:d,isCollapsed:!1,depth:w,path:M};const b={headerIndex:d.headerIndex,isCollapsed:d.isCollapsed,depth:w,path:M};return d.subGroups!==void 0&&(b.subGroups=d.subGroups.map((D,z)=>o(D,w+1,[...M,z])).sort((D,z)=>D.headerIndex-z.headerIndex)),b}return t.map((d,w)=>o(d,0,[w])).sort((d,w)=>d.headerIndex-w.headerIndex)}function Cn(t,o){const l=[];function d(b,D,z=!1){let p=D!==null?D-b.headerIndex:o-b.headerIndex;if(b.subGroups!==void 0&&(p=b.subGroups[0].headerIndex-b.headerIndex),p--,l.push({headerIndex:b.headerIndex,contentIndex:-1,skip:z,isCollapsed:b.isCollapsed,depth:b.depth,path:b.path,rows:p}),b.subGroups)for(let C=0;C<b.subGroups.length;C++){const S=C<b.subGroups.length-1?b.subGroups[C+1].headerIndex:D;d(b.subGroups[C],S,z||b.isCollapsed)}}const w=hs(t.groups);for(let b=0;b<w.length;b++){const D=b<w.length-1?w[b+1].headerIndex:null;d(w[b],D)}let M=0;for(const b of l)b.contentIndex=M,M+=b.rows;return l.filter(b=>b.skip===!1).map(b=>{const{skip:D,...z}=b;return z})}function No(t,o){if(o===void 0||Cn.length===0)return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1};let l=t;for(const d of o){if(l===0)return{path:[...d.path,-1],originalIndex:d.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:d.rows};if(l--,!d.isCollapsed){if(l<d.rows)return{path:[...d.path,l],originalIndex:d.headerIndex+l,isGroupHeader:!1,groupIndex:l,contentIndex:d.contentIndex+l,groupRows:d.rows};l-=d.rows}}return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1}}function gs(t,o,l,d){const w=ye.useMemo(()=>t===void 0?void 0:Cn(t,o),[t,o]),M=ye.useMemo(()=>w===void 0?o:w.reduce((p,C)=>p+(C.isCollapsed?1:C.rows+1),0),[w,o]),b=ye.useMemo(()=>t===void 0||typeof l=="number"&&t.height===l?l:p=>{const{isGroupHeader:C}=No(p,w);return C?t.height:typeof l=="number"?l:l(p)},[w,t,l]),D=ye.useCallback(p=>{if(w===void 0)return p;let C=p;for(const S of w){if(C===0)return;if(C--,!S.isCollapsed){if(C<S.rows)return S.contentIndex+C;C-=S.rows}}return p},[w]),z=Rt(d??(t==null?void 0:t.themeOverride),ye.useCallback(p=>{if(t===void 0)return d==null?void 0:d(p,p,p);if(d===void 0&&(t==null?void 0:t.themeOverride)===void 0)return;const{isGroupHeader:C,contentIndex:S,groupIndex:F}=No(p,w);return C?t.themeOverride:d==null?void 0:d(p,F,S)},[w,d,t]));return t===void 0?{rowHeight:b,rows:o,rowNumberMapper:D,getRowThemeOverride:z}:{rowHeight:b,rows:M,rowNumberMapper:D,getRowThemeOverride:z}}function vs(t,o){const l=ye.useMemo(()=>t===void 0?void 0:Cn(t,o),[t,o]);return{getRowGroupingForPath:wr,updateRowGroupingByPath:Cr,mapper:ye.useCallback(d=>{if(typeof d=="number")return No(d,l);const w=No(d[1],l);return{...w,originalIndex:[d[0],w.originalIndex]}},[l])}}function Cr(t,o,l){const[d,...w]=o;return w[0]===-1?t.map((M,b)=>b===d?{...M,...l}:M):t.map((M,b)=>b===d?{...M,subGroups:Cr(M.subGroups??[],w,l)}:M)}function wr(t,o){const[l,...d]=o;return d[0]===-1?t[l]:wr(t[l].subGroups??[],d)}const ms=i.lazy(async()=>await Wl(()=>import("./data-grid-overlay-editor-Jtz_jz3i.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url));let Cs=0;function ws(t){return di(ur(ur(t).filter(o=>o.span!==void 0).map(o=>{var l,d;return Gt((((l=o.span)==null?void 0:l[0])??0)+1,(((d=o.span)==null?void 0:d[1])??0)+1)})))}function Ao(t,o){return t===void 0||o===0||t.columns.length===0&&t.current===void 0?t:{current:t.current===void 0?void 0:{cell:[t.current.cell[0]+o,t.current.cell[1]],range:{...t.current.range,x:t.current.range.x+o},rangeStack:t.current.rangeStack.map(l=>({...l,x:l.x+o}))},rows:t.rows,columns:t.columns.offset(o)}}const Go={kind:Z.Loading,allowOverlay:!1},Oo={columns:X.empty(),rows:X.empty(),current:void 0},ps=(t,o)=>{var Qn,er,tr;const[l,d]=i.useState(Oo),[w,M]=i.useState(),b=i.useRef(null),D=i.useRef(null),[z,p]=i.useState(),C=i.useRef(null),S=i.useRef(),F=typeof window>"u"?null:window,{imageEditorOverride:W,getRowThemeOverride:K,markdownDivCreateNode:xe,width:ie,height:Ae,columns:k,rows:B,getCellContent:le,onCellClicked:Me,onCellActivated:Q,onFillPattern:j,onFinishedEditing:J,coercePasteValue:ee,drawHeader:V,drawCell:Se,editorBloom:kt,onHeaderClicked:ue,onColumnProposeMove:oo,spanRangeBehavior:dt="default",onGroupHeaderClicked:Le,onCellContextMenu:Ge,className:Ot,onHeaderContextMenu:Oe,getCellsForSelection:Wo,onGroupHeaderContextMenu:E,onGroupHeaderRenamed:oe,onCellEdited:se,onCellsEdited:He,onSearchResultsChanged:Pe,searchResults:ft,onSearchValueChange:no,searchValue:Uo,onKeyDown:Pt,onKeyUp:ht,keybindings:ro,editOnType:lo=!0,onRowAppended:nt,onColumnMoved:gt,validateCell:vt,highlightRegions:mt,rangeSelect:Ve="rect",columnSelect:ge="multi",rowSelect:De="multi",rangeSelectionBlending:Bo="exclusive",columnSelectionBlending:Ze="exclusive",rowSelectionBlending:Je="exclusive",onDelete:Vo,onDragStart:io,onMouseMove:so,onPaste:Ct,copyHeaders:wn=!1,freezeColumns:Qe=0,cellActivationBehavior:Xo="second-click",rowSelectionMode:Yo="auto",onHeaderMenuClick:co,onHeaderIndicatorClick:ao,getGroupDetails:uo,rowGrouping:rt,onSearchClose:_o,onItemHovered:fo,onSelectionCleared:lt,showSearch:pr,onVisibleRegionChanged:ho,gridSelection:wt,onGridSelectionChange:jo,minColumnWidth:br=50,maxColumnWidth:yr=500,maxColumnAutoWidth:xr,provideEditor:Mr,trailingRowOptions:N,freezeTrailingRows:et=0,allowedFillDirections:pn="orthogonal",scrollOffsetX:Kt,scrollOffsetY:Xe,verticalBorder:St,onDragOverCell:Rr,onDrop:kr,onColumnResize:Nt,onColumnResizeEnd:Wt,onColumnResizeStart:Ut,customRenderers:go,fillHandle:Sr,drawFocusRing:bn=!0,experimental:de,fixedShadowX:zr,fixedShadowY:Tr,headerIcons:Lr,imageWindowLoader:Hr,initialSize:Dr,isDraggable:Er,onDragLeave:Ir,onRowMoved:Bt,overscrollX:$r,overscrollY:Fr,preventDiagonalScrolling:Ar,rightElement:Gr,rightElementProps:Or,trapFocus:yn=!1,smoothScrollX:Pr,smoothScrollY:Kr,scaleToRem:Nr=!1,rowHeight:Wr=34,headerHeight:xn=36,groupHeaderHeight:Ur=xn,theme:Br,isOutsideClick:Vr,renderers:qo,resizeIndicator:Xr}=t,ve=typeof t.rowMarkers=="string"?void 0:t.rowMarkers,Ke=(ve==null?void 0:ve.kind)??t.rowMarkers??"none",Yr=(ve==null?void 0:ve.width)??t.rowMarkerWidth,Mn=(ve==null?void 0:ve.startIndex)??t.rowMarkerStartIndex??1,Rn=(ve==null?void 0:ve.theme)??t.rowMarkerTheme,vo=(ve==null?void 0:ve.checkboxStyle)??"square",zt=Math.max(br,20),mo=Math.max(yr,zt),_r=Math.max(xr??mo,zt),kn=i.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:$,rowNumberMapper:Sn,rowHeight:jr,getRowThemeOverride:tt}=gs(rt,B,Wr,K),qr=i.useMemo(()=>Number.parseFloat(kn.fontSize),[kn]),{rowHeight:Ee,headerHeight:Zo,groupHeaderHeight:zn,theme:Tn,overscrollX:Zr,overscrollY:Jr}=ds({groupHeaderHeight:Ur,headerHeight:xn,overscrollX:$r,overscrollY:Fr,remSize:qr,rowHeight:jr,scaleToRem:Nr,theme:Br}),it=fs(ro),Tt=Yr??(B>1e4?48:B>1e3?44:B>100?36:32),Ye=Ke!=="none",u=Ye?1:0,te=nt!==void 0,Vt=(N==null?void 0:N.sticky)===!0,[Qr,Ln]=i.useState(!1),el=pr??Qr,tl=i.useCallback(()=>{_o!==void 0?_o():Ln(!1)},[_o]),h=i.useMemo(()=>wt===void 0?void 0:Ao(wt,u),[wt,u])??l,Re=i.useRef();Re.current===void 0&&(Re.current=new AbortController),i.useEffect(()=>()=>Re==null?void 0:Re.current.abort(),[]);const[ae,ol]=ns(Wo,le,u,Re.current,$),nl=i.useCallback((e,r,n)=>{if(vt===void 0)return!0;const c=[e[0]-u,e[1]];return vt==null?void 0:vt(c,r,n)},[u,vt]),Co=i.useRef(wt),Ie=i.useCallback((e,r)=>{r&&(e=Bl(e,ae,u,dt,Re.current)),jo!==void 0?(Co.current=Ao(e,-u),jo(Co.current)):d(e)},[jo,ae,u,dt]),Lt=Rt(Nt,i.useCallback((e,r,n,c)=>{Nt==null||Nt(k[n-u],r,n-u,c)},[Nt,u,k])),rl=Rt(Wt,i.useCallback((e,r,n,c)=>{Wt==null||Wt(k[n-u],r,n-u,c)},[Wt,u,k])),ll=Rt(Ut,i.useCallback((e,r,n,c)=>{Ut==null||Ut(k[n-u],r,n-u,c)},[Ut,u,k])),il=Rt(V,i.useCallback((e,r)=>(V==null?void 0:V({...e,columnIndex:e.columnIndex-u},r))??!1,[V,u])),sl=Rt(Se,i.useCallback((e,r)=>(Se==null?void 0:Se({...e,col:e.col-u},r))??!1,[Se,u])),st=i.useCallback(e=>{if(Vo!==void 0){const r=Vo(Ao(e,-u));return typeof r=="boolean"?r:Ao(r,u)}return!0},[Vo,u]),[me,Ce,ce]=os(h,Ie,Bo,Ze,Je,Ve),fe=i.useMemo(()=>hn(hr(),Tn),[Tn]),[Jo,cl]=i.useState([0,0,0]),Hn=i.useMemo(()=>{if(qo===void 0)return{};const e={};for(const r of qo)e[r.kind]=r;return e},[qo]),we=i.useCallback(e=>e.kind!==Z.Custom?Hn[e.kind]:go==null?void 0:go.find(r=>r.isMatch(e)),[go,Hn]);let{sizedColumns:ze,nonGrowWidth:Dn}=es(k,$,ol,Jo[0]-(u===0?0:Tt)-Jo[2],zt,_r,fe,we,Re.current);Ke!=="none"&&(Dn+=Tt);const Qo=i.useMemo(()=>ze.some(e=>e.group!==void 0),[ze]),Xt=Qo?Zo+zn:Zo,En=h.rows.length,In=Ke==="none"?void 0:En===0?!1:En===$?!0:void 0,U=i.useMemo(()=>Ke==="none"?ze:[{title:"",width:Tt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Rn,rowMarker:vo,rowMarkerChecked:In},...ze],[Ke,ze,Tt,Rn,vo,In]),[$n,Fn]=i.useMemo(()=>[Xe!==void 0&&typeof Ee=="number"?Math.floor(Xe/Ee):0,Xe!==void 0&&typeof Ee=="number"?-(Xe%Ee):0],[Xe,Ee]),pe=i.useRef({height:1,width:1,x:0,y:0}),al=i.useMemo(()=>({x:pe.current.x,y:$n,width:pe.current.width??1,height:pe.current.height??1,ty:Fn}),[Fn,$n]),Yt=i.useRef(!1),[ot,An,wo]=Vl(al);pe.current=ot;const Gn=(ot.height??1)>1;i.useLayoutEffect(()=>{if(Xe!==void 0&&C.current!==null&&Gn){if(C.current.scrollTop===Xe)return;C.current.scrollTop=Xe,C.current.scrollTop!==Xe&&wo(),Yt.current=!0}},[Xe,Gn,wo]);const On=(ot.width??1)>1;i.useLayoutEffect(()=>{if(Kt!==void 0&&C.current!==null&&On){if(C.current.scrollLeft===Kt)return;C.current.scrollLeft=Kt,C.current.scrollLeft!==Kt&&wo(),Yt.current=!0}},[Kt,On,wo]);const ul=ot.x+u,po=ot.y,ke=i.useRef(null),be=i.useCallback(e=>{var r;e===!0?(r=ke.current)==null||r.focus():window.requestAnimationFrame(()=>{var n;(n=ke.current)==null||n.focus()})},[]),he=te?$+1:$,$e=i.useCallback(e=>{const r=u===0?e:e.map(c=>({...c,location:[c.location[0]-u,c.location[1]]})),n=He==null?void 0:He(r);if(n!==!0)for(const c of r)se==null||se(c.location,c.value);return n},[se,He,u]),[pt,en]=i.useState(),bo=h.current!==void 0&&h.current.range.width*h.current.range.height>1?h.current.range:void 0,Ht=bn?(Qn=h.current)==null?void 0:Qn.cell:void 0,yo=Ht==null?void 0:Ht[0],xo=Ht==null?void 0:Ht[1],dl=i.useMemo(()=>{if((mt===void 0||mt.length===0)&&(bo??yo??xo??pt)===void 0)return;const e=[];if(mt!==void 0)for(const r of mt){const n=U.length-r.range.x-u;n>0&&e.push({color:r.color,range:{...r.range,x:r.range.x+u,width:Math.min(n,r.range.width)},style:r.style})}return pt!==void 0&&e.push({color:rr(fe.accentColor,0),range:pt,style:"dashed"}),bo!==void 0&&e.push({color:rr(fe.accentColor,.5),range:bo,style:"solid-outline"}),yo!==void 0&&xo!==void 0&&e.push({color:fe.accentColor,range:{x:yo,y:xo,width:1,height:1},style:"solid-outline"}),e.length>0?e:void 0},[pt,bo,yo,xo,mt,U.length,fe.accentColor,u]),Pn=i.useRef(U);Pn.current=U;const Te=i.useCallback(([e,r],n=!1)=>{var g,a,f,v,m,y,T;const c=te&&r===he-1;if(e===0&&Ye){if(c)return Go;const x=Sn(r);return x===void 0?Go:{kind:Io.Marker,allowOverlay:!1,checkboxStyle:vo,checked:(h==null?void 0:h.rows.hasIndex(r))===!0,markerKind:Ke==="clickable-number"?"number":Ke,row:Mn+x,drawHandle:Bt!==void 0,cursor:Ke==="clickable-number"?"pointer":void 0}}else if(c){const H=e===u?(N==null?void 0:N.hint)??"":"",R=Pn.current[e];if(((g=R==null?void 0:R.trailingRowOptions)==null?void 0:g.disabled)===!0)return Go;{const O=((a=R==null?void 0:R.trailingRowOptions)==null?void 0:a.hint)??H,I=((f=R==null?void 0:R.trailingRowOptions)==null?void 0:f.addIcon)??(N==null?void 0:N.addIcon);return{kind:Io.NewRow,hint:O,allowOverlay:!1,icon:I}}}else{const x=e-u;if(n||(de==null?void 0:de.strict)===!0){const R=pe.current,O=R.x>x||x>R.x+R.width||R.y>r||r>R.y+R.height||r>=on.current,I=x===((m=(v=R.extras)==null?void 0:v.selected)==null?void 0:m[0])&&r===((y=R.extras)==null?void 0:y.selected[1]);let L=!1;if(((T=R.extras)==null?void 0:T.freezeRegions)!==void 0){for(const P of R.extras.freezeRegions)if(Xl(P,x,r)){L=!0;break}}if(O&&!I&&!L)return Go}let H=le([x,r]);return u!==0&&H.span!==void 0&&(H={...H,span:[H.span[0]+u,H.span[1]+u]}),H}},[te,he,Ye,Sn,vo,h==null?void 0:h.rows,Ke,Mn,Bt,u,N==null?void 0:N.hint,N==null?void 0:N.addIcon,de==null?void 0:de.strict,le]),tn=i.useCallback(e=>{let r=(uo==null?void 0:uo(e))??{name:e};return oe!==void 0&&e!==""&&(r={icon:r.icon,name:r.name,overrideTheme:r.overrideTheme,actions:[...r.actions??[],{title:"Rename",icon:"renameIcon",onClick:n=>rn({group:r.name,bounds:n.bounds})}]}),r},[uo,oe]),Mo=i.useCallback(e=>{var f;const[r,n]=e.cell,c=U[r],s=(c==null?void 0:c.group)!==void 0?(f=tn(c.group))==null?void 0:f.overrideTheme:void 0,g=c==null?void 0:c.themeOverride,a=tt==null?void 0:tt(n);M({...e,theme:hn(fe,s,g,a,e.content.themeOverride)})},[tt,U,tn,fe]),Dt=i.useCallback((e,r,n)=>{var a;if(h.current===void 0)return;const[c,s]=h.current.cell,g=Te([c,s]);if(g.kind!==Z.Boolean&&g.allowOverlay){let f=g;if(n!==void 0)switch(f.kind){case Z.Number:{const v=Yl(()=>n==="-"?-0:Number.parseFloat(n),0);f={...f,data:Number.isNaN(v)?0:v};break}case Z.Text:case Z.Markdown:case Z.Uri:f={...f,data:n};break}Mo({target:e,content:f,initialValue:n,cell:[c,s],highlight:n===void 0,forceEditMode:n!==void 0})}else g.kind===Z.Boolean&&r&&g.readonly!==!0&&($e([{location:h.current.cell,value:{...g,data:_l(g.data)}}]),(a=ke.current)==null||a.damage([{cell:h.current.cell}]))},[Te,h,$e,Mo]),Kn=i.useCallback((e,r)=>{var s;const n=(s=ke.current)==null?void 0:s.getBounds(e,r);if(n===void 0||C.current===null)return;const c=Te([e,r]);c.allowOverlay&&Mo({target:n,content:c,initialValue:void 0,highlight:!0,cell:[e,r],forceEditMode:!0})},[Te,Mo]),ne=i.useCallback((e,r,n="both",c=0,s=0,g=void 0)=>{if(C.current!==null){const a=ke.current,f=D.current,v=typeof e!="number"?e.unit==="cell"?e.amount:void 0:e,m=typeof r!="number"?r.unit==="cell"?r.amount:void 0:r,y=typeof e!="number"&&e.unit==="px"?e.amount:void 0,T=typeof r!="number"&&r.unit==="px"?r.amount:void 0;if(a!==null&&f!==null){let x={x:0,y:0,width:0,height:0},H=0,R=0;if((v!==void 0||m!==void 0)&&(x=a.getBounds((v??0)+u,m??0)??x,x.width===0||x.height===0))return;const O=f.getBoundingClientRect(),I=O.width/f.offsetWidth;if(y!==void 0&&(x={...x,x:y-O.left-C.current.scrollLeft,width:1}),T!==void 0&&(x={...x,y:T+O.top-C.current.scrollTop,height:1}),x!==void 0){const L={x:x.x-c,y:x.y-s,width:x.width+2*c,height:x.height+2*s};let P=0;for(let dn=0;dn<Qe;dn++)P+=ze[dn].width;let q=0;const re=et+(Vt?1:0);re>0&&(q=jl(he,re,Ee));let Ue=P*I+O.left+u*Tt*I,je=O.right,Be=O.top+Xt*I,qe=O.bottom-q*I;const Ho=x.width+c*2;switch(g==null?void 0:g.hAlign){case"start":je=Ue+Ho;break;case"end":Ue=je-Ho;break;case"center":Ue=Math.floor((Ue+je)/2)-Ho/2,je=Ue+Ho;break}const Do=x.height+s*2;switch(g==null?void 0:g.vAlign){case"start":qe=Be+Do;break;case"end":Be=qe-Do;break;case"center":Be=Math.floor((Be+qe)/2)-Do/2,qe=Be+Do;break}Ue>L.x?H=L.x-Ue:je<L.x+L.width&&(H=L.x+L.width-je),Be>L.y?R=L.y-Be:qe<L.y+L.height&&(R=L.y+L.height-qe),n==="vertical"||typeof e=="number"&&e<Qe?H=0:(n==="horizontal"||typeof r=="number"&&r>=he-re)&&(R=0),(H!==0||R!==0)&&(I!==1&&(H/=I,R/=I),C.current.scrollTo(H+C.current.scrollLeft,R+C.current.scrollTop))}}}},[u,et,Tt,Xt,Qe,ze,he,Vt,Ee]),Nn=i.useRef(Kn),Wn=i.useRef(le),on=i.useRef($);Nn.current=Kn,Wn.current=le,on.current=$;const Et=i.useCallback(async(e,r=!0)=>{var v;const n=U[e];if(((v=n==null?void 0:n.trailingRowOptions)==null?void 0:v.disabled)===!0)return;const c=nt==null?void 0:nt();let s,g=!0;c!==void 0&&(s=await c,s==="top"&&(g=!1),typeof s=="number"&&(g=!1));let a=0;const f=()=>{if(on.current<=$){a<500&&window.setTimeout(f,a),a=50+a*2;return}const m=typeof s=="number"?s:g?$:0;Lo.current(e-u,m),me({cell:[e,m],range:{x:e,y:m,width:1,height:1}},!1,!1,"edit");const y=Wn.current([e-u,m]);y.allowOverlay&&Fo(y)&&y.readonly!==!0&&r&&window.setTimeout(()=>{Nn.current(e,m)},0)};f()},[U,nt,u,$,me]),Ro=i.useCallback(e=>{var n,c;const r=((c=(n=ze[e])==null?void 0:n.trailingRowOptions)==null?void 0:c.targetColumn)??(N==null?void 0:N.targetColumn);if(typeof r=="number")return r+(Ye?1:0);if(typeof r=="object"){const s=k.indexOf(r);if(s>=0)return s+(Ye?1:0)}},[ze,k,Ye,N==null?void 0:N.targetColumn]),ct=i.useRef(),It=i.useRef(),_t=i.useCallback((e,r)=>{var s;const[n,c]=r;return hn(fe,(s=U[n])==null?void 0:s.themeOverride,tt==null?void 0:tt(c),e.themeOverride)},[tt,U,fe]),{mapper:bt}=vs(rt,B),Ne=rt==null?void 0:rt.navigationBehavior,jt=i.useCallback(e=>{var y,T,x;const r=Ko.value?e.metaKey:e.ctrlKey,n=r&&De==="multi",c=r&&ge==="multi",[s,g]=e.location,a=h.columns,f=h.rows,[v,m]=((y=h.current)==null?void 0:y.cell)??[];if(e.kind==="cell"){if(It.current=void 0,yt.current=[s,g],s===0&&Ye){if(te===!0&&g===$||Ke==="number"||De==="none")return;const H=Te(e.location);if(H.kind!==Io.Marker)return;if(Bt!==void 0){const I=we(H);Po((I==null?void 0:I.kind)===Io.Marker);const L=(T=I==null?void 0:I.onClick)==null?void 0:T.call(I,{...e,cell:H,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,theme:_t(H,e.location),preventDefault:()=>{}});if(L===void 0||L.checked===H.checked)return}M(void 0),be();const R=f.hasIndex(g),O=ct.current;if(De==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&O!==void 0&&f.hasIndex(O)){const I=[Math.min(O,g),Math.max(O,g)+1];n||Yo==="multi"?Ce(void 0,I,!0):Ce(X.fromSingleSelection(I),void 0,n)}else n||e.isTouch||Yo==="multi"?R?Ce(f.remove(g),void 0,!0):(Ce(void 0,g,!0),ct.current=g):R&&f.length===1?Ce(X.empty(),void 0,r):(Ce(X.fromSingleSelection(g),void 0,r),ct.current=g)}else if(s>=u&&te&&g===$){const H=Ro(s);Et(H??s)}else if(v!==s||m!==g){const H=Te(e.location),R=we(H);if((R==null?void 0:R.onSelect)!==void 0){let L=!1;if(R.onSelect({...e,cell:H,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,preventDefault:()=>L=!0,theme:_t(H,e.location)}),L)return}if(Ne==="block"&&bt(g).isGroupHeader)return;const O=Vt&&g===$,I=Vt&&h!==void 0&&((x=h.current)==null?void 0:x.cell[1])===$;if((e.shiftKey||e.isLongTouch===!0)&&v!==void 0&&m!==void 0&&h.current!==void 0&&!I){if(O)return;const L=Math.min(s,v),P=Math.max(s,v),q=Math.min(g,m),re=Math.max(g,m);me({...h.current,range:{x:L,y:q,width:P-L+1,height:re-q+1}},!0,r,"click"),ct.current=void 0,be()}else me({cell:[s,g],range:{x:s,y:g,width:1,height:1}},!0,r,"click"),ct.current=void 0,M(void 0),be()}}else if(e.kind==="header")if(yt.current=[s,g],M(void 0),Ye&&s===0)ct.current=void 0,It.current=void 0,De==="multi"&&(f.length!==$?Ce(X.fromSingleSelection([0,$]),void 0,r):Ce(X.empty(),void 0,r),be());else{const H=It.current;if(ge==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&H!==void 0&&a.hasIndex(H)){const R=[Math.min(H,s),Math.max(H,s)+1];c?ce(void 0,R,r):ce(X.fromSingleSelection(R),void 0,r)}else c?(a.hasIndex(s)?ce(a.remove(s),void 0,r):ce(void 0,s,r),It.current=s):ge!=="none"&&(ce(X.fromSingleSelection(s),void 0,r),It.current=s);ct.current=void 0,be()}else e.kind===At?yt.current=[s,g]:e.kind===lr&&!e.isMaybeScrollbar&&(Ie(Oo,!1),M(void 0),be(),lt==null||lt(),ct.current=void 0,It.current=void 0)},[De,ge,h,Ye,u,te,$,Ke,Te,Bt,be,Yo,we,_t,Ce,Ro,Et,Ne,bt,Vt,me,ce,Ie,lt]),qt=i.useRef(!1),yt=i.useRef(),Un=i.useRef(ot),Fe=i.useRef(),fl=i.useCallback(e=>{if($t.current=!1,Un.current=pe.current,e.button!==0&&e.button!==1){Fe.current=void 0;return}const r=performance.now();Fe.current={button:e.button,time:r,location:e.location},(e==null?void 0:e.kind)==="header"&&(qt.current=!0);const n=e.kind==="cell"&&e.isFillHandle;!n&&e.kind!=="cell"&&e.isEdge||(p({previousSelection:h,fillHandle:n}),yt.current=void 0,!e.isTouch&&e.button===0&&!n?jt(e):!e.isTouch&&e.button===1&&(yt.current=e.location))},[h,jt]),[nn,rn]=i.useState(),Bn=i.useCallback(e=>{if(e.kind!==At||ge!=="multi")return;const r=Ko.value?e.metaKey:e.ctrlKey,[n]=e.location,c=h.columns;if(n<u)return;const s=U[n];let g=n,a=n;for(let f=n-1;f>=u&&ir(s.group,U[f].group);f--)g--;for(let f=n+1;f<U.length&&ir(s.group,U[f].group);f++)a++;if(be(),r)if(c.hasAll([g,a+1])){let f=c;for(let v=g;v<=a;v++)f=f.remove(v);ce(f,void 0,r)}else ce(void 0,[g,a+1],r);else ce(X.fromSingleSelection([g,a+1]),void 0,r)},[ge,be,h.columns,U,u,ce]),$t=i.useRef(!1),ko=i.useCallback(async e=>{if(ae!==void 0&&Lt!==void 0){const r=pe.current.y,n=pe.current.height;let c=ae({x:e,y:r,width:1,height:Math.min(n,$-r)},Re.current.signal);typeof c!="object"&&(c=await c());const s=ze[e-u],a=document.createElement("canvas").getContext("2d",{alpha:!1});if(a!==null){a.font=fe.baseFontFull;const f=vr(a,fe,s,0,c,zt,mo,!1,we);Lt==null||Lt(s,f.width,e,f.width)}}},[ze,ae,mo,fe,zt,Lt,u,$,we]),[hl,ln]=i.useState(),Ft=i.useCallback(async(e,r)=>{var f,v;const n=(f=e.current)==null?void 0:f.range;if(n===void 0||ae===void 0||r.current===void 0)return;const c=r.current.range;if(j!==void 0){let m=!1;if(j({fillDestination:{...c,x:c.x-u},patternSource:{...n,x:n.x-u},preventDefault:()=>m=!0}),m)return}let s=ae(n,Re.current.signal);typeof s!="object"&&(s=await s());const g=s,a=[];for(let m=0;m<c.width;m++)for(let y=0;y<c.height;y++){const T=[c.x+m,c.y+y];if(ql(T,n))continue;const x=g[y%n.height][m%n.width];$o(x)||!Fo(x)||a.push({location:T,value:{...x}})}$e(a),(v=ke.current)==null||v.damage(a.map(m=>({cell:m.location})))},[ae,$e,j,u]),Vn=i.useCallback(()=>{if(h.current===void 0||h.current.range.width<=1)return;const e={...h,current:{...h.current,range:{...h.current.range,width:1}}};Ft(e,h)},[Ft,h]),Xn=i.useCallback(()=>{if(h.current===void 0||h.current.range.height<=1)return;const e={...h,current:{...h.current,range:{...h.current.range,height:1}}};Ft(e,h)},[Ft,h]),gl=i.useCallback((e,r)=>{var y,T;const n=z;if(p(void 0),en(void 0),ln(void 0),qt.current=!1,r)return;if((n==null?void 0:n.fillHandle)===!0&&h.current!==void 0&&((y=n.previousSelection)==null?void 0:y.current)!==void 0){if(pt===void 0)return;const x={...h,current:{...h.current,range:Zl(n.previousSelection.current.range,pt)}};Ft(n.previousSelection,x),Ie(x,!0);return}const[c,s]=e.location,[g,a]=yt.current??[],f=()=>{$t.current=!0},v=x=>{var R,O,I;const H=x.isTouch||g===c&&a===s;if(H&&(Me==null||Me([c-u,s],{...x,preventDefault:f})),x.button===1)return!$t.current;if(!$t.current){const L=Te(e.location),P=we(L);if(P!==void 0&&P.onClick!==void 0&&H){const re=P.onClick({...x,cell:L,posX:x.localEventX,posY:x.localEventY,bounds:x.bounds,theme:_t(L,e.location),preventDefault:f});re!==void 0&&!$o(re)&&eo(re)&&($e([{location:x.location,value:re}]),(R=ke.current)==null||R.damage([{cell:x.location}]))}if($t.current||h.current===void 0)return!1;let q=!1;switch(L.activationBehaviorOverride??Xo){case"double-click":case"second-click":{if(((I=(O=n==null?void 0:n.previousSelection)==null?void 0:O.current)==null?void 0:I.cell)===void 0)break;const[re,Ue]=h.current.cell,[je,Be]=n.previousSelection.current.cell;q=c===re&&c===je&&s===Ue&&s===Be&&(x.isDoubleClick===!0||Xo==="second-click");break}case"single-click":{q=!0;break}}if(q)return Q==null||Q([c-u,s]),Dt(x.bounds,!1),!0}return!1},m=e.location[0]-u;if(e.isTouch){const x=pe.current,H=Un.current;if(x.x!==H.x||x.y!==H.y)return;if(e.isLongTouch===!0){if(e.kind==="cell"&&Jl((T=h.current)==null?void 0:T.cell,e.location)){Ge==null||Ge([m,e.location[1]],{...e,preventDefault:f});return}else if(e.kind==="header"&&h.columns.hasIndex(c)){Oe==null||Oe(m,{...e,preventDefault:f});return}else if(e.kind===At){if(m<0)return;E==null||E(m,{...e,preventDefault:f});return}}e.kind==="cell"?v(e)||jt(e):e.kind===At?Le==null||Le(m,{...e,preventDefault:f}):(e.kind===Ql&&(ue==null||ue(m,{...e,preventDefault:f})),jt(e));return}if(e.kind==="header"){if(m<0)return;e.isEdge?e.isDoubleClick===!0&&ko(c):e.button===0&&c===g&&s===a&&(ue==null||ue(m,{...e,preventDefault:f}))}if(e.kind===At){if(m<0)return;e.button===0&&c===g&&s===a&&(Le==null||Le(m,{...e,preventDefault:f}),$t.current||Bn(e))}e.kind==="cell"&&(e.button===0||e.button===1)&&v(e),yt.current=void 0},[z,h,u,pt,Ft,Ie,Me,Te,we,Xo,_t,$e,Q,Dt,Ge,Oe,E,jt,Le,ue,ko,Bn]),vl=i.useCallback(e=>{const r={...e,location:[e.location[0]-u,e.location[1]]};so==null||so(r),z!==void 0&&e.buttons===0&&(p(void 0),en(void 0),ln(void 0),qt.current=!1),ln(n=>{var c;return qt.current?[e.scrollEdge[0],0]:e.scrollEdge[0]===(n==null?void 0:n[0])&&e.scrollEdge[1]===n[1]?n:z===void 0||(((c=Fe.current)==null?void 0:c.location[0])??0)<u?void 0:e.scrollEdge})},[z,so,u]),ml=i.useCallback((e,r)=>{co==null||co(e-u,r)},[co,u]),Cl=i.useCallback((e,r)=>{ao==null||ao(e-u,r)},[ao,u]),_e=(er=h==null?void 0:h.current)==null?void 0:er.cell,wl=i.useCallback((e,r,n,c,s,g)=>{Yt.current=!1;let a=_e;a!==void 0&&(a=[a[0]-u,a[1]]);const f=Qe===0?void 0:{x:0,y:e.y,width:Qe,height:e.height},v=[];f!==void 0&&v.push(f),et>0&&(v.push({x:e.x-u,y:$-et,width:e.width,height:et}),Qe>0&&v.push({x:0,y:$-et,width:Qe,height:et}));const m={x:e.x-u,y:e.y,width:e.width,height:te&&e.y+e.height>=$?e.height-1:e.height,tx:s,ty:g,extras:{selected:a,freezeRegion:f,freezeRegions:v}};pe.current=m,An(m),cl([r,n,c]),ho==null||ho(m,m.tx,m.ty,m.extras)},[_e,u,te,$,Qe,et,An,ho]),pl=Rt(gt,i.useCallback((e,r)=>{gt==null||gt(e-u,r-u),ge!=="none"&&ce(X.fromSingleSelection(r),void 0,!0)},[ge,gt,u,ce])),sn=i.useRef(!1),bl=i.useCallback(e=>{if(e.location[0]===0&&u>0){e.preventDefault();return}io==null||io({...e,location:[e.location[0]-u,e.location[1]]}),e.defaultPrevented()||(sn.current=!0),p(void 0)},[io,u]),yl=i.useCallback(()=>{sn.current=!1},[]),Yn=rt==null?void 0:rt.selectionBehavior,So=i.useCallback(e=>{if(Yn!=="block-spanning")return;const{isGroupHeader:r,path:n,groupRows:c}=bt(e);if(r)return[e,e];const s=n[n.length-1],g=e-s,a=e+c-s-1;return[g,a]},[bt,Yn]),cn=i.useRef(),an=i.useCallback(e=>{var r,n,c;if(!ei(e,cn.current)&&(cn.current=e,!(((r=Fe==null?void 0:Fe.current)==null?void 0:r.button)!==void 0&&Fe.current.button>=1))){if(e.buttons!==0&&z!==void 0&&((n=Fe.current)==null?void 0:n.location[0])===0&&e.location[0]===0&&u===1&&De==="multi"&&z.previousSelection&&!z.previousSelection.rows.hasIndex(Fe.current.location[1])&&h.rows.hasIndex(Fe.current.location[1])){const s=Math.min(Fe.current.location[1],e.location[1]),g=Math.max(Fe.current.location[1],e.location[1])+1;Ce(X.fromSingleSelection([s,g]),void 0,!1)}if(e.buttons!==0&&z!==void 0&&h.current!==void 0&&!sn.current&&!qt.current&&(Ve==="rect"||Ve==="multi-rect")){const[s,g]=h.current.cell;let[a,f]=e.location;if(f<0&&(f=pe.current.y),z.fillHandle===!0&&((c=z.previousSelection)==null?void 0:c.current)!==void 0){const v=z.previousSelection.current.range;f=Math.min(f,te?$-1:$);const m=ti(v,a,f,pn);en(m)}else{if(te&&g===$)return;if(te&&f===$)if(e.kind===lr)f--;else return;a=Math.max(a,u);const y=So(g);f=y===void 0?f:Mt(f,y[0],y[1]);const T=a-s,x=f-g,H={x:T>=0?s:a,y:x>=0?g:f,width:Math.abs(T)+1,height:Math.abs(x)+1};me({...h.current,range:H},!0,!1,"drag")}}fo==null||fo({...e,location:[e.location[0]-u,e.location[1]]})}},[z,u,De,h,Ve,fo,Ce,te,$,pn,So,me]),xl=i.useCallback(()=>{var a,f;const e=cn.current;if(e===void 0)return;const[r,n]=e.scrollEdge;let[c,s]=e.location;const g=pe.current;r===-1?c=((f=(a=g.extras)==null?void 0:a.freezeRegion)==null?void 0:f.x)??g.x:r===1&&(c=g.x+g.width),n===-1?s=Math.max(0,g.y):n===1&&(s=Math.min($-1,g.y+g.height)),c=Mt(c,0,U.length-1),s=Mt(s,0,$-1),an({...e,location:[c,s]})},[U.length,an,$]);us(hl,C,xl);const We=i.useCallback(e=>{if(h.current===void 0)return;const[r,n]=e,[c,s]=h.current.cell,g=h.current.range;let a=g.x,f=g.x+g.width,v=g.y,m=g.y+g.height;const[y,T]=So(s)??[0,$-1],x=T+1;if(n!==0)switch(n){case 2:{m=x,v=s,ne(0,m,"vertical");break}case-2:{v=y,m=s+1,ne(0,v,"vertical");break}case 1:{v<s?(v++,ne(0,v,"vertical")):(m=Math.min(x,m+1),ne(0,m,"vertical"));break}case-1:{m>s+1?(m--,ne(0,m,"vertical")):(v=Math.max(y,v-1),ne(0,v,"vertical"));break}default:sr()}if(r!==0)if(r===2)f=U.length,a=c,ne(f-1-u,0,"horizontal");else if(r===-2)a=u,f=c+1,ne(a-u,0,"horizontal");else{let H=[];if(ae!==void 0){const R=ae({x:a,y:v,width:f-a-u,height:m-v},Re.current.signal);typeof R=="object"&&(H=ws(R))}if(r===1){let R=!1;if(a<c){if(H.length>0){const O=Gt(a+1,c+1).find(I=>!H.includes(I-u));O!==void 0&&(a=O,R=!0)}else a++,R=!0;R&&ne(a,0,"horizontal")}R||(f=Math.min(U.length,f+1),ne(f-1-u,0,"horizontal"))}else if(r===-1){let R=!1;if(f>c+1){if(H.length>0){const O=Gt(f-1,c,-1).find(I=>!H.includes(I-u));O!==void 0&&(f=O,R=!0)}else f--,R=!0;R&&ne(f-u,0,"horizontal")}R||(a=Math.max(u,a-1),ne(a-u,0,"horizontal"))}else sr()}me({cell:h.current.cell,range:{x:a,y:v,width:f-a,height:m-v}},!0,!1,"keyboard-select")},[ae,So,h,U.length,u,$,ne,me]),at=i.useCallback((e,r,n,c)=>{const s=he-(n?0:1);e=Mt(e,u,ze.length-1+u),r=Mt(r,0,s);const g=_e==null?void 0:_e[0],a=_e==null?void 0:_e[1];if(e===g&&r===a)return!1;if(c&&h.current!==void 0){const f=[...h.current.rangeStack];(h.current.range.width>1||h.current.range.height>1)&&f.push(h.current.range),Ie({...h,current:{cell:[e,r],range:{x:e,y:r,width:1,height:1},rangeStack:f}},!0)}else me({cell:[e,r],range:{x:e,y:r,width:1,height:1}},!0,!1,"keyboard-nav");return S.current!==void 0&&S.current[0]===e&&S.current[1]===r&&(S.current=void 0),ne(e-u,r),!0},[he,u,ze.length,_e,h,ne,Ie,me]),Ml=i.useCallback((e,r)=>{(w==null?void 0:w.cell)!==void 0&&e!==void 0&&eo(e)&&($e([{location:w.cell,value:e}]),window.requestAnimationFrame(()=>{var s;(s=ke.current)==null||s.damage([{cell:w.cell}])})),be(!0),M(void 0);const[n,c]=r;if(h.current!==void 0&&(n!==0||c!==0)){const s=h.current.cell[1]===he-1&&e!==void 0;at(Mt(h.current.cell[0]+n,0,U.length-1),Mt(h.current.cell[1]+c,0,he-1),s,!1)}J==null||J(e,r)},[w==null?void 0:w.cell,be,h,J,$e,he,at,U.length]),Rl=i.useMemo(()=>`gdg-overlay-${Cs++}`,[]),xt=i.useCallback(e=>{var n,c,s,g;be();const r=[];for(let a=e.x;a<e.x+e.width;a++)for(let f=e.y;f<e.y+e.height;f++){const v=le([a-u,f]);if(!v.allowOverlay&&v.kind!==Z.Boolean)continue;let m;if(v.kind===Z.Custom){const y=we(v),T=(n=y==null?void 0:y.provideEditor)==null?void 0:n.call(y,v);(y==null?void 0:y.onDelete)!==void 0?m=y.onDelete(v):oi(T)&&(m=(c=T==null?void 0:T.deletedValue)==null?void 0:c.call(T,v))}else if(eo(v)&&v.allowOverlay||v.kind===Z.Boolean){const y=we(v);m=(s=y==null?void 0:y.onDelete)==null?void 0:s.call(y,v)}m!==void 0&&!$o(m)&&eo(m)&&r.push({location:[a,f],value:m})}$e(r),(g=ke.current)==null||g.damage(r.map(a=>({cell:a.location})))},[be,le,we,$e,u]),Zt=w!==void 0,_n=i.useCallback(e=>{var O,I;const r=()=>{e.stopPropagation(),e.preventDefault()},n={didMatch:!1},{bounds:c}=e,s=h.columns,g=h.rows,a=it;if(!Zt&&A(a.clear,e,n))Ie(Oo,!1),lt==null||lt();else if(!Zt&&A(a.selectAll,e,n))Ie({columns:X.empty(),rows:X.empty(),current:{cell:((O=h.current)==null?void 0:O.cell)??[u,0],range:{x:u,y:0,width:k.length,height:$},rangeStack:[]}},!1);else if(A(a.search,e,n))(I=b==null?void 0:b.current)==null||I.focus({preventScroll:!0}),Ln(!0);else if(A(a.delete,e,n)){const L=(st==null?void 0:st(h))??!0;if(L!==!1){const P=L===!0?h:L;if(P.current!==void 0){xt(P.current.range);for(const q of P.current.rangeStack)xt(q)}for(const q of P.rows)xt({x:u,y:q,width:k.length,height:1});for(const q of P.columns)xt({x:q,y:0,width:1,height:$})}}if(n.didMatch)return r(),!0;if(h.current===void 0)return!1;let[f,v]=h.current.cell;const[,m]=h.current.cell;let y=!1,T=!1;if(A(a.scrollToSelectedCell,e,n)?Lo.current(f-u,v):ge!=="none"&&A(a.selectColumn,e,n)?s.hasIndex(f)?ce(s.remove(f),void 0,!0):ge==="single"?ce(X.fromSingleSelection(f),void 0,!0):ce(void 0,f,!0):De!=="none"&&A(a.selectRow,e,n)?g.hasIndex(v)?Ce(g.remove(v),void 0,!0):De==="single"?Ce(X.fromSingleSelection(v),void 0,!0):Ce(void 0,v,!0):!Zt&&c!==void 0&&A(a.activateCell,e,n)?v===$&&te?window.setTimeout(()=>{const L=Ro(f);Et(L??f)},0):(Q==null||Q([f-u,v]),Dt(c,!0)):h.current.range.height>1&&A(a.downFill,e,n)?Xn():h.current.range.width>1&&A(a.rightFill,e,n)?Vn():A(a.goToNextPage,e,n)?v+=Math.max(1,pe.current.height-4):A(a.goToPreviousPage,e,n)?v-=Math.max(1,pe.current.height-4):A(a.goToFirstCell,e,n)?(M(void 0),v=0,f=0):A(a.goToLastCell,e,n)?(M(void 0),v=Number.MAX_SAFE_INTEGER,f=Number.MAX_SAFE_INTEGER):A(a.selectToFirstCell,e,n)?(M(void 0),We([-2,-2])):A(a.selectToLastCell,e,n)?(M(void 0),We([2,2])):Zt?(A(a.closeOverlay,e,n)&&M(void 0),A(a.acceptOverlayDown,e,n)&&(M(void 0),v++),A(a.acceptOverlayUp,e,n)&&(M(void 0),v--),A(a.acceptOverlayLeft,e,n)&&(M(void 0),f--),A(a.acceptOverlayRight,e,n)&&(M(void 0),f++)):(A(a.goDownCell,e,n)?v+=1:A(a.goUpCell,e,n)?v-=1:A(a.goRightCell,e,n)?f+=1:A(a.goLeftCell,e,n)?f-=1:A(a.goDownCellRetainSelection,e,n)?(v+=1,y=!0):A(a.goUpCellRetainSelection,e,n)?(v-=1,y=!0):A(a.goRightCellRetainSelection,e,n)?(f+=1,y=!0):A(a.goLeftCellRetainSelection,e,n)?(f-=1,y=!0):A(a.goToLastRow,e,n)?v=$-1:A(a.goToFirstRow,e,n)?v=Number.MIN_SAFE_INTEGER:A(a.goToLastColumn,e,n)?f=Number.MAX_SAFE_INTEGER:A(a.goToFirstColumn,e,n)?f=Number.MIN_SAFE_INTEGER:(Ve==="rect"||Ve==="multi-rect")&&(A(a.selectGrowDown,e,n)?We([0,1]):A(a.selectGrowUp,e,n)?We([0,-1]):A(a.selectGrowRight,e,n)?We([1,0]):A(a.selectGrowLeft,e,n)?We([-1,0]):A(a.selectToLastRow,e,n)?We([0,2]):A(a.selectToFirstRow,e,n)?We([0,-2]):A(a.selectToLastColumn,e,n)?We([2,0]):A(a.selectToFirstColumn,e,n)&&We([-2,0])),T=n.didMatch),Ne!==void 0&&Ne!=="normal"&&v!==m){const L=Ne==="skip-up"||Ne==="skip"||Ne==="block",P=Ne==="skip-down"||Ne==="skip"||Ne==="block",q=v<m;if(q&&L){for(;v>=0&&bt(v).isGroupHeader;)v--;v<0&&(v=m)}else if(!q&&P){for(;v<$&&bt(v).isGroupHeader;)v++;v>=$&&(v=m)}}const H=at(f,v,!1,y),R=n.didMatch;return R&&(H||!T||yn)&&r(),R},[Ne,Zt,h,it,ge,De,Ve,u,bt,$,at,Ie,lt,k.length,st,yn,xt,ce,Ce,te,Ro,Et,Q,Dt,Xn,Vn,We]),Jt=i.useCallback(e=>{let r=!1;if(Pt!==void 0&&Pt({...e,cancel:()=>{r=!0}}),r||_n(e)||h.current===void 0)return;const[n,c]=h.current.cell,s=pe.current;if(lo&&!e.metaKey&&!e.ctrlKey&&h.current!==void 0&&e.key.length===1&&/[ -~]/g.test(e.key)&&e.bounds!==void 0&&Fo(le([n-u,Math.max(0,Math.min(c,$-1))]))){if((!te||c!==$)&&(s.y>c||c>s.y+s.height||s.x>n||n>s.x+s.width))return;Dt(e.bounds,!0,e.key),e.stopPropagation(),e.preventDefault()}},[lo,Pt,_n,h,le,u,$,te,Dt]),kl=i.useCallback((e,r)=>{const n=e.location[0]-u;if(e.kind==="header"&&(Oe==null||Oe(n,{...e,preventDefault:r})),e.kind===At){if(n<0)return;E==null||E(n,{...e,preventDefault:r})}if(e.kind==="cell"){const[c,s]=e.location;Ge==null||Ge([n,s],{...e,preventDefault:r}),ni(h,e.location)||at(c,s,!1,!1)}},[h,Ge,E,Oe,u,at]),un=i.useCallback(async e=>{var a,f,v;if(!it.paste)return;function r(m,y,T,x){var R,O;const H=typeof T=="object"?(T==null?void 0:T.join(`
`))??"":(T==null?void 0:T.toString())??"";if(!$o(m)&&Fo(m)&&m.readonly!==!0){const I=ee==null?void 0:ee(H,m);if(I!==void 0&&eo(I))return{location:y,value:I};const L=we(m);if(L===void 0)return;if(L.kind===Z.Custom){Po(m.kind===Z.Custom);const P=(R=L.onPaste)==null?void 0:R.call(L,H,m.data);return P===void 0?void 0:{location:y,value:{...m,data:P}}}else{const P=(O=L.onPaste)==null?void 0:O.call(L,H,m,{formatted:x,formattedString:typeof x=="string"?x:x==null?void 0:x.join(`
`),rawValue:T});return P===void 0?void 0:(Po(P.kind===m.kind),{location:y,value:P})}}}const n=h.columns,c=h.rows,s=((a=C.current)==null?void 0:a.contains(document.activeElement))===!0||((f=D.current)==null?void 0:f.contains(document.activeElement))===!0;let g;if(h.current!==void 0?g=[h.current.range.x,h.current.range.y]:n.length===1?g=[n.first()??0,0]:c.length===1&&(g=[u,c.first()??0]),s&&g!==void 0){let m,y;const T="text/plain",x="text/html";if(navigator.clipboard.read!==void 0){const I=await navigator.clipboard.read();for(const L of I){if(L.types.includes(x)){const q=await(await L.getType(x)).text(),re=cr(q);if(re!==void 0){m=re;break}}L.types.includes(T)&&(y=await(await L.getType(T)).text())}}else if(navigator.clipboard.readText!==void 0)y=await navigator.clipboard.readText();else if(e!==void 0&&(e==null?void 0:e.clipboardData)!==null){if(e.clipboardData.types.includes(x)){const I=e.clipboardData.getData(x);m=cr(I)}m===void 0&&e.clipboardData.types.includes(T)&&(y=e.clipboardData.getData(T))}else return;const[H,R]=g,O=[];do{if(Ct===void 0){const I=Te(g),L=y??(m==null?void 0:m.map(q=>q.map(re=>re.rawValue).join("	")).join("	"))??"",P=r(I,g,L,void 0);P!==void 0&&O.push(P);break}if(m===void 0){if(y===void 0)return;m=ri(y)}if(Ct===!1||typeof Ct=="function"&&(Ct==null?void 0:Ct([g[0]-u,g[1]],m.map(I=>I.map(L=>{var P;return((P=L.rawValue)==null?void 0:P.toString())??""}))))!==!0)return;for(const[I,L]of m.entries()){if(I+R>=$)break;for(const[P,q]of L.entries()){const re=[P+H,I+R],[Ue,je]=re;if(Ue>=U.length||je>=he)continue;const Be=Te(re),qe=r(Be,re,q.rawValue,q.formatted);qe!==void 0&&O.push(qe)}}}while(!1);$e(O),(v=ke.current)==null||v.damage(O.map(I=>({cell:I.location})))}},[ee,we,Te,h,it.paste,U.length,$e,he,Ct,u,$]);gn("paste",un,F,!1,!0);const Qt=i.useCallback(async(e,r)=>{var a,f;if(!it.copy)return;const n=r===!0||((a=C.current)==null?void 0:a.contains(document.activeElement))===!0||((f=D.current)==null?void 0:f.contains(document.activeElement))===!0,c=h.columns,s=h.rows,g=(v,m)=>{if(!wn)ar(v,m,e);else{const y=m.map(T=>({kind:Z.Text,data:k[T].title,displayData:k[T].title,allowOverlay:!1}));ar([y,...v],m,e)}};if(n&&ae!==void 0){if(h.current!==void 0){let v=ae(h.current.range,Re.current.signal);typeof v!="object"&&(v=await v()),g(v,Gt(h.current.range.x-u,h.current.range.x+h.current.range.width-u))}else if(s!==void 0&&s.length>0){const m=[...s].map(y=>{const T=ae({x:u,y,width:k.length,height:1},Re.current.signal);return typeof T=="object"?T[0]:T().then(x=>x[0])});if(m.some(y=>y instanceof Promise)){const y=await Promise.all(m);g(y,Gt(k.length))}else g(m,Gt(k.length))}else if(c.length>0){const v=[],m=[];for(const y of c){let T=ae({x:y,y:0,width:1,height:$},Re.current.signal);typeof T!="object"&&(T=await T()),v.push(T),m.push(y-u)}if(v.length===1)g(v[0],m);else{const y=v.reduce((T,x)=>T.map((H,R)=>[...H,...x[R]]));g(y,m)}}}},[k,ae,h,it.copy,u,$,wn]);gn("copy",Qt,F,!1,!1);const Sl=i.useCallback(async e=>{var n,c;if(!(!it.cut||!(((n=C.current)==null?void 0:n.contains(document.activeElement))===!0||((c=D.current)==null?void 0:c.contains(document.activeElement))===!0))&&(await Qt(e),h.current!==void 0)){let s={current:{cell:h.current.cell,range:h.current.range,rangeStack:[]},rows:X.empty(),columns:X.empty()};const g=st==null?void 0:st(s);if(g===!1||(s=g===!0?s:g,s.current===void 0))return;xt(s.current.range)}},[xt,h,it.cut,Qt,st]);gn("cut",Sl,F,!1,!1);const zl=i.useCallback((e,r)=>{if(Pe!==void 0){u!==0&&(e=e.map(s=>[s[0]-u,s[1]])),Pe(e,r);return}if(e.length===0||r===-1)return;const[n,c]=e[r];S.current!==void 0&&S.current[0]===n&&S.current[1]===c||(S.current=[n,c],at(n,c,!1,!1))},[Pe,u,at]),[zo,To]=((tr=wt==null?void 0:wt.current)==null?void 0:tr.cell)??[],Lo=i.useRef(ne);Lo.current=ne,i.useLayoutEffect(()=>{var e,r,n,c;!Yt.current&&zo!==void 0&&To!==void 0&&(zo!==((r=(e=Co.current)==null?void 0:e.current)==null?void 0:r.cell[0])||To!==((c=(n=Co.current)==null?void 0:n.current)==null?void 0:c.cell[1]))&&Lo.current(zo,To),Yt.current=!1},[zo,To]);const jn=h.current!==void 0&&(h.current.cell[0]>=U.length||h.current.cell[1]>=he);i.useLayoutEffect(()=>{jn&&Ie(Oo,!1)},[jn,Ie]);const Tl=i.useMemo(()=>te===!0&&(N==null?void 0:N.tint)===!0?X.fromSingleSelection(he-1):X.empty(),[he,te,N==null?void 0:N.tint]),Ll=i.useCallback(e=>typeof St=="boolean"?St:(St==null?void 0:St(e-u))??!0,[u,St]),Hl=i.useMemo(()=>{if(nn===void 0||D.current===null)return null;const{bounds:e,group:r}=nn,n=D.current.getBoundingClientRect();return Y(Ji,{bounds:e,group:r,canvasBounds:n,onClose:()=>rn(void 0),onFinish:c=>{rn(void 0),oe==null||oe(r,c)}})},[oe,nn]),Dl=Math.min(U.length,Qe+(Ye?1:0));i.useImperativeHandle(o,()=>({appendRow:(e,r)=>Et(e+u,r),updateCells:e=>{var r;return u!==0&&(e=e.map(n=>({cell:[n.cell[0]+u,n.cell[1]]}))),(r=ke.current)==null?void 0:r.damage(e)},getBounds:(e,r)=>{var n;if(!((D==null?void 0:D.current)===null||(C==null?void 0:C.current)===null)){if(e===void 0&&r===void 0){const c=D.current.getBoundingClientRect(),s=c.width/C.current.clientWidth;return{x:c.x-C.current.scrollLeft*s,y:c.y-C.current.scrollTop*s,width:C.current.scrollWidth*s,height:C.current.scrollHeight*s}}return(n=ke.current)==null?void 0:n.getBounds((e??0)+u,r)}},focus:()=>{var e;return(e=ke.current)==null?void 0:e.focus()},emit:async e=>{switch(e){case"delete":Jt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Jt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Jt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Qt(void 0,!0);break;case"paste":await un();break}},scrollTo:ne,remeasureColumns:e=>{for(const r of e)ko(r+u)}}),[Et,ko,Qt,Jt,un,u,ne]);const[qn,Zn]=_e??[],El=i.useCallback(e=>{const[r,n]=e;if(n===-1){ge!=="none"&&(ce(X.fromSingleSelection(r),void 0,!1),be());return}qn===r&&Zn===n||(me({cell:e,range:{x:r,y:n,width:1,height:1}},!0,!1,"keyboard-nav"),ne(r,n))},[ge,be,ne,qn,Zn,me,ce]),[Il,$l]=i.useState(!1),Jn=i.useRef(ui(e=>{$l(e)},5)),Fl=i.useCallback(()=>{Jn.current(!0),h.current===void 0&&h.columns.length===0&&h.rows.length===0&&z===void 0&&me({cell:[u,po],range:{x:u,y:po,width:1,height:1}},!0,!1,"keyboard-select")},[po,h,z,u,me]),Al=i.useCallback(()=>{Jn.current(!1)},[]),[Gl,Ol]=i.useMemo(()=>{let e;const r=(de==null?void 0:de.scrollbarWidthOverride)??li(),n=$+(te?1:0);if(typeof Ee=="number")e=Xt+n*Ee;else{let s=0;const g=Math.min(n,10);for(let a=0;a<g;a++)s+=Ee(a);s=Math.floor(s/g),e=Xt+n*s}e+=r;const c=U.reduce((s,g)=>g.width+s,0)+r;return[`${Math.min(1e5,c)}px`,`${Math.min(1e5,e)}px`]},[U,de==null?void 0:de.scrollbarWidthOverride,Ee,$,te,Xt]),Pl=i.useMemo(()=>ii(fe),[fe]);return Y(si.Provider,{value:fe,children:to(ss,{style:Pl,className:Ot,inWidth:ie??Gl,inHeight:Ae??Ol,children:[Y(_i,{fillHandle:Sr,drawFocusRing:bn,experimental:de,fixedShadowX:zr,fixedShadowY:Tr,getRowThemeOverride:tt,headerIcons:Lr,imageWindowLoader:Hr,initialSize:Dr,isDraggable:Er,onDragLeave:Ir,onRowMoved:Bt,overscrollX:Zr,overscrollY:Jr,preventDiagonalScrolling:Ar,rightElement:Gr,rightElementProps:Or,smoothScrollX:Pr,smoothScrollY:Kr,className:Ot,enableGroups:Qo,onCanvasFocused:Fl,onCanvasBlur:Al,canvasRef:D,onContextMenu:kl,theme:fe,cellXOffset:ul,cellYOffset:po,accessibilityHeight:ot.height,onDragEnd:yl,columns:U,nonGrowWidth:Dn,drawHeader:il,onColumnProposeMove:oo,drawCell:sl,disabledRows:Tl,freezeColumns:Dl,lockColumns:u,firstColAccessible:u===0,getCellContent:Te,minColumnWidth:zt,maxColumnWidth:mo,searchInputRef:b,showSearch:el,onSearchClose:tl,highlightRegions:dl,getCellsForSelection:ae,getGroupDetails:tn,headerHeight:Zo,isFocused:Il,groupHeaderHeight:Qo?zn:0,freezeTrailingRows:et+(te&&(N==null?void 0:N.sticky)===!0?1:0),hasAppendRow:te,onColumnResize:Lt,onColumnResizeEnd:rl,onColumnResizeStart:ll,onCellFocused:El,onColumnMoved:pl,onDragStart:bl,onHeaderMenuClick:ml,onHeaderIndicatorClick:Cl,onItemHovered:an,isFilling:(z==null?void 0:z.fillHandle)===!0,onMouseMove:vl,onKeyDown:Jt,onKeyUp:ht,onMouseDown:fl,onMouseUp:gl,onDragOverCell:Rr,onDrop:kr,onSearchResultsChanged:zl,onVisibleRegionChanged:wl,clientSize:Jo,rowHeight:Ee,searchResults:ft,searchValue:Uo,onSearchValueChange:no,rows:he,scrollRef:C,selection:h,translateX:ot.tx,translateY:ot.ty,verticalBorder:Ll,gridRef:ke,getCellRenderer:we,resizeIndicator:Xr}),Hl,w!==void 0&&Y(i.Suspense,{fallback:null,children:Y(ms,{...w,validateCell:nl,bloom:kt,id:Rl,getCellRenderer:we,className:(de==null?void 0:de.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Mr,imageEditorOverride:W,onFinishEditing:Ml,markdownDivCreateNode:xe,isOutsideClick:Vr})})]})})},bs=i.forwardRef(ps),ys=(t,o)=>{const l=i.useMemo(()=>({...Ni,...t.headerIcons}),[t.headerIcons]),d=i.useMemo(()=>t.imageWindowLoader??new ci,[t.imageWindowLoader]);return Y(bs,{...t,renderers:ai,headerIcons:l,ref:o,imageWindowLoader:d})},Ds=i.forwardRef(ys);export{ji as C,Ds as D,ut as k,vs as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./data-grid-overlay-editor-Jtz_jz3i.js","./marked.esm-dbrxtycE.js","./index-BMVQvedj.js","./index-wocATsGp.js","./image-window-loader-2Fr7t2ou.js","./throttle-7EuXLZa7.js","./_baseIteratee-WTHxv43n.js","./iframe-UFWDJmcQ.js","./image-window-loader-1jHxuE_X.css","./flatten-qRvRBp6y.js","./scrolling-data-grid-By3ovTFU.js","./scrolling-data-grid-dE2iz8sf.css","./data-grid-overlay-editor-EbzU9_4i.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}