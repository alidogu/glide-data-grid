var ms=Object.defineProperty;var ws=(e,t,n)=>t in e?ms(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var We=(e,t,n)=>(ws(e,typeof t!="symbol"?t+"":t,n),n);import{r as l,R as Bt}from"./index-BMVQvedj.js";import{_ as al}from"./iframe-ni8xiI1Q.js";import{h as ys,d as cl,j as bs,v as ps,_ as vs,g as Cs,c as mn,r as Zn,t as ks}from"./throttle-7EuXLZa7.js";import{u as xs,f as Li}from"./flatten-qRvRBp6y.js";import{s as Qt,b as Ss}from"./marked.esm-dbrxtycE.js";function dl(e="This should not happen"){throw new Error(e)}function Zt(e,t="Assertion failed"){if(!e)return dl(t)}function Ko(e,t){return dl(t??"Hell froze over")}function Ms(e,t){try{return e()}catch{return t}}const Ai=Object.prototype.hasOwnProperty;function ko(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&ko(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Ai.call(e,n)&&++o&&!Ai.call(t,n)||!(n in t)||!ko(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const pr=null,ci=void 0;var J;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(J||(J={}));var zi;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(zi||(zi={}));var vr;(function(e){e.Triangle="triangle",e.Dots="dots"})(vr||(vr={}));function gr(e){return"width"in e&&typeof e.width=="number"}async function Pi(e){return typeof e=="object"?e:await e()}function po(e){return!(e.kind===J.Loading||e.kind===J.Bubble||e.kind===J.RowID||e.kind===J.Protected||e.kind===J.Drilldown)}function Jd(e){return!(e.kind===J.Loading||e.kind===J.Bubble||e.kind===J.RowID||e.kind===J.Protected||e.kind===J.Drilldown||e.kind===J.Boolean||e.kind===J.Image||e.kind===J.Custom)}function vo(e){return e.kind===ln.Marker||e.kind===ln.NewRow}function $o(e){if(!po(e)||e.kind===J.Image)return!1;if(e.kind===J.Text||e.kind===J.Number||e.kind===J.Markdown||e.kind===J.Uri||e.kind===J.Custom||e.kind===J.Boolean)return e.readonly!==!0;Ko(e,"A cell was passed with an invalid kind")}function Rs(e){return ys(e,"editor")}function oi(e){return!(e.readonly??!1)}var ln;(function(e){e.NewRow="new-row",e.Marker="marker"})(ln||(ln={}));function Es(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let Bi;const Fn=class Fn{constructor(t){We(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Fn(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Es([...this.items,n]);return new Fn(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,a]of n.entries()){const[s,c]=a;if(s<=r&&o<=c){const f=[];s<o&&f.push([s,o]),r<c&&f.push([r,c]),n.splice(i,1,...f)}}return new Fn(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};We(Fn,"empty",()=>Bi??(Bi=new Fn([]))),We(Fn,"fromSingleSelection",t=>Fn.empty().add(t));let ot=Fn;const Ds=Qt("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Lt(e,t,n,o,r=!1){const i=l.useRef();i.current=t,l.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const a=n,s=c=>{var f;(f=i.current)==null||f.call(a,c)};return a.addEventListener(e,s,{passive:o,capture:r}),()=>{a.removeEventListener(e,s,{capture:r})}},[e,n,o,r])}function yo(e,t){return e===void 0?void 0:t}const Is=Math.PI;function Oi(e){return e*Is/180}const ul=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),fl=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},hl=(e,t,n)=>Math.min(e,t-n*2),gl=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,di=e=>{const t=e.fgColor??"currentColor";return l.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),l.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},Fs=e=>{const t=e.fgColor??"currentColor";return l.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function Ts(e,t,n){const[o,r]=l.useState(e),i=l.useRef(!0);l.useEffect(()=>()=>{i.current=!1},[]);const a=l.useRef(cl(s=>{i.current&&r(s)},n));return l.useLayoutEffect(()=>{i.current&&a.current(()=>e())},t),o}const Hs="֑-߿יִ-﷽ﹰ-ﻼ",Ls="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",As=new RegExp("^[^"+Ls+"]*["+Hs+"]");function ui(e){return As.test(e)?"rtl":"not-rtl"}let mr;function ri(){if(typeof document>"u")return 0;if(mr!==void 0)return mr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),mr=n-o,mr}const jn=Symbol();function zs(e){const t=l.useRef([jn,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=l.useState(e),[,r]=l.useState(),i=l.useCallback(s=>{const c=t.current[0];c!==jn&&(s=typeof s=="function"?s(c):s,s===c)||(c!==jn&&r({}),o(f=>typeof s=="function"?s(c===jn?f:c):s),t.current[0]=jn)},[]),a=l.useCallback(()=>{t.current[0]=jn,r({})},[]);return[t.current[0]===jn?n:t.current[0],i,a]}function ml(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function Ps(e){const t=l.useRef(e);return ko(e,t.current)||(t.current=e),t.current}const Bs=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(s=>s!=="");if(i.length===0)return null;const a=i.length>1;return l.createElement(Ds,{"data-testid":"GDG-default-image-overlay-editor"},l.createElement(bs.Carousel,{showArrows:a,showThumbs:!1,swipeable:a,emulateTouch:a,infiniteLoop:a},i.map(s=>{const c=(r==null?void 0:r(s))??l.createElement("img",{draggable:!1,src:s});return l.createElement("div",{className:"gdg-centering-container",key:s},c)})),n&&o&&l.createElement("button",{className:"gdg-edit-icon",onClick:o},l.createElement(di,null)))},Os=Qt("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class Ws extends Bt.PureComponent{constructor(){super(...arguments);We(this,"targetElement",null);We(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,a=Ss(r),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let c=i==null?void 0:i(a);if(c===void 0){const u=document.createElement("template");u.innerHTML=a,c=u.content}n.append(c);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Bt.createElement(Os,{ref:this.containerRefHook})}}const $s=Qt("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),Ns=Qt("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),Xs=Qt("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let Wi=0;const Mr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:a,...s}=e,{onChange:c,className:f}=s,u=l.useRef(null),w=n??"";Zt(c!==void 0,"GrowingEntry must be a controlled input area");const[m]=l.useState(()=>"input-box-"+(Wi=(Wi+1)%1e7));l.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const y=w.toString().length;h.focus(),h.setSelectionRange(r?0:y,y)},[]),l.useLayoutEffect(()=>{var h;if(a!==void 0){const y=typeof a=="number"?[a,null]:a;(h=u.current)==null||h.setSelectionRange(y[0],y[1])}},[a]);const g=l.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return l.createElement(Xs,{className:"gdg-growing-entry"},l.createElement(Ns,{className:f},w+`
`),l.createElement($s,{...s,className:(f??"")+" gdg-input",id:m,ref:u,onKeyDown:g,value:w,placeholder:t,dir:"auto"}))},qr={};let On=null;function Ys(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function xo(e){const t=e.toLowerCase().trim();if(qr[t]!==void 0)return qr[t];On=On||Ys(),On.style.color="#000",On.style.color=t;const n=getComputedStyle(On).color;On.style.color="#fff",On.style.color=t;const o=getComputedStyle(On).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),qr[t]=r,r}function Jn(e,t){const[n,o,r]=xo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const $i=new Map;function Ni(e,t){const n=`${e}-${t}`,o=$i.get(n);if(o!==void 0)return o;const r=Jt(e,t);return $i.set(n,r),r}function Jt(e,t){if(t===void 0)return e;const[n,o,r,i]=xo(e);if(i===1)return e;const[a,s,c,f]=xo(t),u=i+f*(1-i),w=(i*n+f*a*(1-i))/u,m=(i*o+f*s*(1-i))/u,g=(i*r+f*c*(1-i))/u;return`rgba(${w}, ${m}, ${g}, ${u})`}function Qd(e,t,n){if(n<=0)return e;if(n>=1)return t;const o=[...xo(e)];o[0]=o[0]*o[3],o[1]=o[1]*o[3],o[2]=o[2]*o[3];const r=[...xo(t)];r[0]=r[0]*r[3],r[1]=r[1]*r[3],r[2]=r[2]*r[3];const i=n,a=1-n,s=o[3]*a+r[3]*i,c=Math.floor((o[0]*a+r[0]*i)/s),f=Math.floor((o[1]*a+r[1]*i)/s),u=Math.floor((o[2]*a+r[2]*i)/s);return`rgba(${c}, ${f}, ${u}, ${s})`}function eu(e){if(e==="transparent")return 0;function t(i){const a=i/255;return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}const[n,o,r]=xo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function Ks(e,t){return Bt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked})),[e,t])}function Us(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(No(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function Uo(e,t){return(e??"")===(t??"")}function _s(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function wl(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function No(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function yl(e){return[e.x+e.width-1,e.y+e.height-1]}function Xi(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,a=n.y+n.height-1,[s,c]=e;if(c<i||c>a)return!1;if(t.span===void 0)return s>=o&&s<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function Vs(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&Xi(e,t,i)&&r++;for(const a of n.current.rangeStack)Xi(e,t,a)&&r++;return r}function bl(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,a)=>({...i,sticky:e[a].sticky})),n=o}return n}function So(e,t){let n=0;const o=bl(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function Qn(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function ii(e,t,n,o,r){const i=bl(e,o),a=[];for(const f of i)if(f.sticky)a.push(f);else break;if(a.length>0)for(const f of a)n-=f.width;let s=t,c=r??0;for(;c<=n&&s<i.length;)c+=i[s].width,s++;for(let f=t;f<s;f++){const u=i[f];u.sticky||a.push(u)}return a}function Gs(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function qs(e,t,n,o,r,i,a,s,c,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let w=t;for(let h=0;h<f;h++){const y=i-1-h,k=typeof a=="number"?a:a(y);if(w-=k,e>=w)return y}const m=i-f,g=e-(c??0);if(typeof a=="number"){const h=Math.floor((g-u)/a)+s;return h>=m?void 0:h}else{let h=u;for(let y=s;y<m;y++){const k=a(y);if(g<=h+k)return y;h+=k}return}}let br=0,Xo={};const js=typeof window>"u";async function Zs(){var e;js||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,br=0,Xo={},ps())}Zs();function pl(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function _o(e,t,n,o="middle"){const r=pl(e,t,o,n);let i=Xo[r];return i===void 0&&(i=t.measureText(e),Xo[r]=i,br++),br>1e4&&(Xo={},br=0),i}function Js(e,t){const n=pl(e,void 0,"middle",t);return Xo[n]}function Xn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Qs(e,t)}function Yi(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Ki=[];function Qs(e,t){for(const i of Ki)if(i.key===t)return i.val;const n=Yi(e,"alphabetic"),r=-(Yi(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Ki.push({key:t,val:r}),r}function ea(e,t,n,o,r,i){const{ctx:a,rect:s,theme:c}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const w=1-f/u;a.globalAlpha=w,a.fillStyle=c.bgSearchResult,a.fillRect(s.x+1,s.y+1,s.width-(r?2:1),s.height-(i?2:1)),a.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return f<u}function Vo(e,t,n){const{ctx:o,theme:r}=e,i=t??{},a=n??r.textDark;return a!==i.fillStyle&&(o.fillStyle=a,i.fillStyle=a),i}function tu(e,t,n){const{rect:o,ctx:r,theme:i}=e;r.fillStyle=i.textDark,kn({ctx:r,rect:o,theme:i},t,n)}function vl(e,t,n,o,r,i,a,s,c){c==="right"?e.fillText(t,n+r-(s.cellHorizontalPadding+.5),o+i/2+a):c==="center"?e.fillText(t,n+r/2,o+i/2+a):e.fillText(t,n+s.cellHorizontalPadding+.5,o+i/2+a)}function Cl(e,t){const n=_o("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function ta(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function na(e,t,n,o,r,i,a,s,c,f){const u=s.baseFontFull,w=vs(e,t,u,r-s.cellHorizontalPadding*2,f??!1),m=Cl(e,u),g=s.lineHeight*m,h=m+g*(w.length-1),y=h+s.cellVerticalPadding>i;y&&(e.save(),e.rect(n,o,r,i),e.clip());const k=o+i/2-h/2;let M=Math.max(o+s.cellVerticalPadding,k);for(const C of w)if(vl(e,C,n,M,r,m,a,s,c),M+=g,M>o+i)break;y&&e.restore()}function kn(e,t,n,o,r){const{ctx:i,rect:a,theme:s}=e,{x:c,y:f,width:u,height:w}=a;o=o??!1,o||(t=ta(t,u));const m=Xn(i,s),g=ui(t)==="rtl";if(n===void 0&&g&&(n="right"),g&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?na(i,t,c,f,u,w,m,s,n,r):vl(i,t,c,f,u,w,m,s,n),h&&(i.textAlign="start"),g&&(i.direction="inherit")}}function xn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function oa(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function ra(e,t,n){const o=function(s,c){const f=c.x-s.x,u=c.y-s.y,w=Math.sqrt(f*f+u*u),m=f/w,g=u/w;return{x:f,y:c.y-s.y,len:w,nx:m,ny:g,ang:Math.atan2(g,m)}};let r;const i=t.length;let a=t[i-1];for(let s=0;s<i;s++){let c=t[s%i];const f=t[(s+1)%i],u=o(c,a),w=o(c,f),m=u.nx*w.ny-u.ny*w.nx,g=u.nx*w.nx-u.ny*-w.ny;let h=Math.asin(m<-1?-1:m>1?1:m),y=1,k=!1;g<0?h<0?h=Math.PI+h:(h=Math.PI-h,y=-1,k=!0):h>0&&(y=-1,k=!0),r=c.radius!==void 0?c.radius:n;const M=h/2;let C=Math.abs(Math.cos(M)*r/Math.sin(M)),v;C>Math.min(u.len/2,w.len/2)?(C=Math.min(u.len/2,w.len/2),v=Math.abs(C*Math.sin(M)/Math.cos(M))):v=r;let A=c.x+w.nx*C,P=c.y+w.ny*C;A+=-w.ny*v*y,P+=w.nx*v*y,e.arc(A,P,v,u.ang+Math.PI/2*y,w.ang-Math.PI/2*y,k),a=c,c=f}e.closePath()}function li(e,t,n,o,r,i,a,s,c,f,u,w,m,g,h){const y={x:0,y:i+f,width:0,height:0};if(e>=g.length||t>=u||t<-2||e<0)return y;const k=i-r;if(e>=w){const M=a>e?-1:1,C=So(g);y.x+=C+c;for(let v=a;v!==e;v+=M)y.x+=g[M===1?v:v-1].width*M}else for(let M=0;M<e;M++)y.x+=g[M].width;if(y.width=g[e].width+1,t===-1)y.y=r,y.height=k;else if(t===-2){y.y=0,y.height=r;let M=e;const C=g[e].group,v=g[e].sticky;for(;M>0&&Uo(g[M-1].group,C)&&g[M-1].sticky===v;){const P=g[M-1];y.x-=P.width,y.width+=P.width,M--}let A=e;for(;A+1<g.length&&Uo(g[A+1].group,C)&&g[A+1].sticky===v;){const P=g[A+1];y.width+=P.width,A++}if(!v){const P=So(g),O=y.x-P;O<0&&(y.x-=O,y.width+=O),y.x+y.width>n&&(y.width=n-y.x)}}else if(t>=u-m){let M=u-t;for(y.y=o;M>0;){const C=t+M-1;y.height=typeof h=="number"?h:h(C),y.y-=y.height,M--}y.height+=1}else{const M=s>t?-1:1;if(typeof h=="number"){const C=t-s;y.y+=C*h}else for(let C=s;C!==t;C+=M)y.y+=h(C)*M;y.height=(typeof h=="number"?h:h(t))+1}return y}const fi=1<<21;function wn(e,t){return(t+2)*fi+e}function kl(e){return e%fi}function hi(e){return Math.floor(e/fi)-2}function gi(e){const t=kl(e),n=hi(e);return[t,n]}class xl{constructor(){We(this,"visibleWindow",{x:0,y:0,width:0,height:0});We(this,"freezeCols",0);We(this,"freezeRows",[]);We(this,"isInWindow",t=>{const n=kl(t),o=hi(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,a=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&a})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&ko(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class ia extends xl{constructor(){super(...arguments);We(this,"cache",new Map);We(this,"setValue",(n,o)=>{this.cache.set(wn(n[0],n[1]),o)});We(this,"getValue",n=>this.cache.get(wn(n[0],n[1])));We(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Yo{constructor(t=[]){We(this,"cells");this.cells=new Set(t.map(n=>wn(n[0],n[1])))}add(t){this.cells.add(wn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(wn(t[0],t[1]))}remove(t){this.cells.delete(wn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(hi(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(wn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield gi(t)}}function la(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const Sl={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4};function Ml(){return Sl}const Rl=Bt.createContext(Sl);function nu(){return Bt.useContext(Rl)}function Nn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=Jt(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const si=150;function sa(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??si}function El(e,t,n,o,r,i,a,s,c){let f=0;const u=r===void 0?[]:r.map(m=>{const g=sa(e,m[o],t,c);return f=Math.max(f,g),g});if(u.length>5&&s){f=0;let m=0;for(const h of u)m+=h;const g=m/u.length;for(let h=0;h<u.length;h++)u[h]>=g*2?u[h]=0:f=Math.max(f,u[h])}f=Math.max(f,e.measureText(n.title).width+16+(n.icon===void 0?0:28));const w=Math.max(Math.ceil(i),Math.min(Math.floor(a),Math.ceil(f)));return{...n,width:w}}function aa(e,t,n,o,r,i,a,s,c){const f=l.useRef(t),u=l.useRef(n),w=l.useRef(a);f.current=t,u.current=n,w.current=a;const[m,g]=l.useMemo(()=>{if(typeof window>"u")return[null,null];const C=document.createElement("canvas");return C.style.display="none",C.style.opacity="0",C.style.position="fixed",[C,C.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>(m&&document.documentElement.append(m),()=>{m==null||m.remove()}),[m]);const h=l.useRef({}),y=l.useRef(),[k,M]=l.useState();return l.useLayoutEffect(()=>{const C=u.current;if(C===void 0||e.every(gr))return;let v=Math.max(1,10-Math.floor(e.length/1e4)),A=0;v<f.current&&v>1&&(v--,A=1);const P={x:0,y:0,width:e.length,height:Math.min(f.current,v)},O={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const X=C(P,c.signal),R=A>0?C(O,c.signal):void 0;let W;typeof X=="object"?W=X:W=await Pi(X),R!==void 0&&(typeof R=="object"?W=[...W,...R]:W=[...W,...await Pi(R)]),y.current=e,M(W)})()},[c.signal,e]),l.useMemo(()=>{let v=e.every(gr)?e:g===null?e.map(T=>gr(T)?T:{...T,width:si}):(g.font=w.current.baseFontFull,e.map((T,X)=>{if(gr(T))return T;if(h.current[T.id]!==void 0)return{...T,width:h.current[T.id]};if(k===void 0||y.current!==e||T.id===void 0)return{...T,width:si};const R=El(g,a,T,X,k,r,i,!0,s);return h.current[T.id]=R.width,R})),A=0,P=0;const O=[];for(const[T,X]of v.entries())A+=X.width,X.grow!==void 0&&X.grow>0&&(P+=X.grow,O.push(T));if(A<o&&O.length>0){const T=[...v],X=o-A;let R=X;for(let W=0;W<O.length;W++){const B=O[W],D=(v[B].grow??0)/P,S=W===O.length-1?R:Math.min(R,Math.floor(X*D));T[B]={...v[B],growOffset:S,width:v[B].width+S},R-=S}v=T}return{sizedColumns:v,nonGrowWidth:A}},[o,e,g,k,a,r,i,s])}const at='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',ca=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},da=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},ua=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},fa=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},ha=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Dl=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},ga=e=>{const t=e.bgColor;return`${at}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},ma=Dl,wa=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},ya=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},ba=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},pa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},va=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Ca=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},ka=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},xa=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},Sa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},Ma=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},Ra=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},Ea=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},Da=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},Ia=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},Fa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},Ta=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},Ha=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${at}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},La=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},Aa=e=>{const t=e.fgColor,n=e.bgColor;return`${at}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},za=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},Pa=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},Ba={headerRowID:ca,headerNumber:ua,headerCode:da,headerString:fa,headerBoolean:ha,headerAudioUri:ma,headerVideoUri:wa,headerEmoji:ya,headerImage:ba,headerUri:Dl,headerPhone:pa,headerMarkdown:va,headerDate:Ca,headerTime:ka,headerEmail:xa,headerReference:Sa,headerIfThenElse:Ma,headerSingleValue:Ra,headerLookup:Ea,headerTextTemplate:Da,headerMath:Ia,headerRollup:Fa,headerJoinStrings:Ta,headerSplitString:Ha,headerGeoDistance:La,headerArray:Aa,rowOwnerOverlay:za,protectedColumnOverlay:Pa,renameIcon:ga};function Oa(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Wa{constructor(t,n){We(this,"onSettled");We(this,"spriteMap",new Map);We(this,"headerIcons");We(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,a,s,c=1){const[f,u]=Oa(n,s),w=a*Math.ceil(window.devicePixelRatio),m=`${f}_${u}_${w}_${t}`;let g=this.spriteMap.get(m);if(g===void 0){const h=this.headerIcons[t];if(h===void 0)return;g=document.createElement("canvas");const y=g.getContext("2d");if(y===null)return;const k=new Image;k.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(m,g);const M=k.decode();if(M===void 0)return;this.inFlight++,M.then(()=>{y.drawImage(k,0,0,w,w)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(g,0,0,w,w,r,i,a,a),c<1&&(o.globalAlpha=1)}}function Il(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function Rr(e,t,n,o,r,i,a,s,c){s=s??t;let f=t,u=e;const w=o-i;let m=!1;for(;f<n&&u<w;){const g=r(u);if(f+g>s&&c(f,u,g,!1,a&&u===o-1)===!0){m=!0;break}f+=g,u++}if(!m){f=n;for(let g=0;g<i;g++){u=o-1-g;const h=r(u);f-=h,c(f,u,h,!0,a&&u===o-1)}}}function Yn(e,t,n,o,r,i){let a=0,s=0;const c=r+o;for(const f of e){const u=f.sticky?s:a+n;if(i(f,u,c,f.sticky?0:s+1,t)===!0)break;a+=f.width,s+=f.sticky?f.width:0}}function Fl(e,t,n,o,r){let i=0,a=0;for(let s=0;s<e.length;s++){const c=e[s];let f=s+1,u=c.width;for(c.sticky&&(a+=u);f<e.length&&Uo(e[f].group,c.group)&&e[f].sticky===e[s].sticky;){const y=e[f];u+=y.width,f++,s++,y.sticky&&(a+=y.width)}const w=c.sticky?0:n,m=i+w,g=c.sticky?0:Math.max(0,a-m),h=Math.min(u-g,t-(m+g));r([c.sourceIndex,e[f-1].sourceIndex],c.group??"",m+g,0,h,o),i+=u}}function Tl(e,t,n,o,r,i,a){var m;const[s,c]=e;let f,u;const w=((m=a.find(g=>!g.sticky))==null?void 0:m.sourceIndex)??0;if(c>w){const g=Math.max(s,w);let h=t,y=o;for(let k=i.sourceIndex-1;k>=g;k--)h-=a[k].width,y+=a[k].width;for(let k=i.sourceIndex+1;k<=c;k++)y+=a[k].width;u={x:h,y:n,width:y,height:r}}if(w>s){const g=Math.min(c,w-1);let h=t,y=o;for(let k=i.sourceIndex-1;k>=s;k--)h-=a[k].width,y+=a[k].width;for(let k=i.sourceIndex+1;k<=g;k++)y+=a[k].width;f={x:h,y:n,width:y,height:r}}return[f,u]}function $a(e,t,n,o){if(o==="any")return Hl(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),wl([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,a=n-e.y+1,s=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:a,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return c===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===a?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function Cr(e,t,n,o,r,i,a,s){return e<=r+a&&r<=e+n&&t<=i+s&&i<=t+o}function Er(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Hl(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function Na(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Xa(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,a=t+4,s=n+4,c=r-e.x,f=e.x+e.width-a,u=i-e.y,w=e.y+e.height-s,m=c>0?e.x+Math.floor(c/o)*o:e.x,g=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,y=w>0?e.y+e.height-Math.floor(w/o)*o:e.y+e.height;return{x:m,y:h,width:g-m,height:y-h}}function Ya(e,t,n,o,r){const[i,a,s,c]=t,[f,u,w,m]=r,{x:g,y:h,width:y,height:k}=e,M=[];if(y<=0||k<=0)return M;const C=g+y,v=h+k,A=g<i,P=h<a,O=g+y>s,T=h+k>c,X=g>=i&&g<s||C>i&&C<=s||g<i&&C>s,R=h>=a&&h<c||v>a&&v<=c||h<a&&v>c;if(X&&R){const B=Math.max(g,i),D=Math.max(h,a),S=Math.min(C,s),E=Math.min(v,c);M.push({rect:{x:B,y:D,width:S-B,height:E-D},clip:{x:f,y:u,width:w-f+1,height:m-u+1}})}if(A&&P){const B=g,D=h,S=Math.min(C,i),E=Math.min(v,a);M.push({rect:{x:B,y:D,width:S-B,height:E-D},clip:{x:0,y:0,width:f+1,height:u+1}})}if(P&&X){const B=Math.max(g,i),D=h,S=Math.min(C,s),E=Math.min(v,a);M.push({rect:{x:B,y:D,width:S-B,height:E-D},clip:{x:f,y:0,width:w-f+1,height:u+1}})}if(P&&O){const B=Math.max(g,s),D=h,S=C,E=Math.min(v,a);M.push({rect:{x:B,y:D,width:S-B,height:E-D},clip:{x:w,y:0,width:n-w+1,height:u+1}})}if(A&&R){const B=g,D=Math.max(h,a),S=Math.min(C,i),E=Math.min(v,c);M.push({rect:{x:B,y:D,width:S-B,height:E-D},clip:{x:0,y:u,width:f+1,height:m-u+1}})}if(O&&R){const B=Math.max(g,s),D=Math.max(h,a),S=C,E=Math.min(v,c);M.push({rect:{x:B,y:D,width:S-B,height:E-D},clip:{x:w,y:u,width:n-w+1,height:m-u+1}})}if(A&&T){const B=g,D=Math.max(h,c),S=Math.min(C,i),E=v;M.push({rect:{x:B,y:D,width:S-B,height:E-D},clip:{x:0,y:m,width:f+1,height:o-m+1}})}if(T&&X){const B=Math.max(g,i),D=Math.max(h,c),S=Math.min(C,s),E=v;M.push({rect:{x:B,y:D,width:S-B,height:E-D},clip:{x:f,y:m,width:w-f+1,height:o-m+1}})}if(O&&T){const B=Math.max(g,s),D=Math.max(h,c),S=C,E=v;M.push({rect:{x:B,y:D,width:S-B,height:E-D},clip:{x:w,y:m,width:n-w+1,height:o-m+1}})}return M}const Ka={kind:J.Loading,allowOverlay:!1};function Ui(e,t,n,o,r,i,a,s,c,f,u,w,m,g,h,y,k,M,C,v,A,P,O,T,X,R,W,B,D,S,E,Z,te,le,fe){let De=(v==null?void 0:v.size)??Number.MAX_SAFE_INTEGER;const re=performance.now();let V=S.baseFontFull;e.font=V;const se={ctx:e},de=[0,0],He=k>0?Qn(c,k,f):0;let U,pe;const ke=Il(C);return Yn(t,s,i,a,r,(xe,qe,Ze,rt,Je)=>{const Re=Math.max(0,rt-qe),Be=qe+Re,Le=r+1,wt=xe.width-Re,ue=o-r-1;if(C.length>0){let Ke=!1;for(let Ue=0;Ue<C.length;Ue++){const j=C[Ue];if(Cr(Be,Le,wt,ue,j.x,j.y,j.width,j.height)){Ke=!0;break}}if(!Ke)return}const ae=()=>{e.save(),e.beginPath(),e.rect(Be,Le,wt,ue),e.clip()},Se=A.columns.hasIndex(xe.sourceIndex),Ee=w(xe.group??"").overrideTheme,Fe=xe.themeOverride===void 0&&Ee===void 0?S:Nn(S,Ee,xe.themeOverride),be=Fe.baseFontFull;be!==V&&(V=be,e.font=be),ae();let tt;return Rr(Je,Ze,o,c,f,k,M,ke,(Ke,Ue,j,Te,Oe)=>{var bt,Dt,sn;if(Ue<0||(de[0]=xe.sourceIndex,de[1]=Ue,v!==void 0&&!v.has(de)))return;if(C.length>0){let Ye=!1;for(let ft=0;ft<C.length;ft++){const it=C[ft];if(Cr(qe,Ke,xe.width,j,it.x,it.y,it.width,it.height)){Ye=!0;break}}if(!Ye)return}const Me=A.rows.hasIndex(Ue),St=g.hasIndex(Ue),_e=Ue<c?u(de):Ka;let $e=qe,Ve=xe.width,yt=!1,Mt=!1;if(_e.span!==void 0){const[Ye,ft]=_e.span,it=`${Ue},${Ye},${ft},${xe.sticky}`;if(pe===void 0&&(pe=new Set),pe.has(it)){De--;return}else{const lt=Tl(_e.span,qe,Ke,xe.width,j,xe,n),Ht=xe.sticky?lt[0]:lt[1];if(!xe.sticky&&lt[0]!==void 0&&(Mt=!0),Ht!==void 0){$e=Ht.x,Ve=Ht.width,pe.add(it),e.restore(),tt=void 0,e.save(),e.beginPath();const dt=Math.max(0,rt-Ht.x);e.rect(Ht.x+dt,Ke,Ht.width-dt,j),U===void 0&&(U=[]),U.push({x:Ht.x+dt,y:Ke,width:Ht.width-dt,height:j}),e.clip(),yt=!0}}}const en=m==null?void 0:m(Ue),Kt=Oe&&((bt=xe.trailingRowOptions)==null?void 0:bt.themeOverride)!==void 0?(Dt=xe.trailingRowOptions)==null?void 0:Dt.themeOverride:void 0,ut=_e.themeOverride===void 0&&en===void 0&&Kt===void 0?Fe:Nn(Fe,en,Kt,_e.themeOverride);e.beginPath();const Ot=_s(de,_e,A);let Wt=Vs(de,_e,A,y);const Sn=_e.span!==void 0&&A.columns.some(Ye=>_e.span!==void 0&&Ye>=_e.span[0]&&Ye<=_e.span[1]);Ot&&!h&&y?Wt=0:Ot&&y&&(Wt=Math.max(Wt,1)),Sn&&Wt++,Ot||(Me&&Wt++,Se&&!Oe&&Wt++);const Mn=_e.kind===J.Protected?ut.bgCellMedium:ut.bgCell;let ct;if((Te||Mn!==S.bgCell)&&(ct=Jt(Mn,ct)),Wt>0||St){St&&(ct=Jt(ut.bgHeader,ct));for(let Ye=0;Ye<Wt;Ye++)ct=Jt(ut.accentLight,ct)}else if(P!==void 0){for(const Ye of P)if(Ye[0]===xe.sourceIndex&&Ye[1]===Ue){ct=Jt(ut.bgSearchResult,ct);break}}if(O!==void 0)for(let Ye=0;Ye<O.length;Ye++){const ft=O[Ye],it=ft.range;ft.style!=="solid-outline"&&it.x<=xe.sourceIndex&&xe.sourceIndex<it.x+it.width&&it.y<=Ue&&Ue<it.y+it.height&&(ct=Jt(ft.color,ct))}let Ne=!1;if(v!==void 0){const Ye=Ke+1,it=(Te?Ye+j-1:Math.min(Ye+j-1,o-He))-Ye;(it!==j-1||$e+1<=rt)&&(Ne=!0,e.save(),e.beginPath(),e.rect($e+1,Ye,Ve-1,it),e.clip()),ct=ct===void 0?ut.bgCell:Jt(ct,ut.bgCell)}const Ge=xe.sourceIndex===n.length-1,Ft=Ue===c-1;ct!==void 0&&(e.fillStyle=ct,tt!==void 0&&(tt.fillStyle=ct),v!==void 0?e.fillRect($e+1,Ke+1,Ve-(Ge?2:1),j-(Ft?2:1)):e.fillRect($e,Ke,Ve,j)),_e.style==="faded"&&(e.globalAlpha=.6);let Tt;for(let Ye=0;Ye<R.length;Ye++){const ft=R[Ye];if(ft.item[0]===xe.sourceIndex&&ft.item[1]===Ue){Tt=ft;break}}if(Ve>fe&&!Mt){const Ye=ut.baseFontFull;Ye!==V&&(e.font=Ye,V=Ye),tt=Ll(e,_e,xe.sourceIndex,Ue,Ge,Ft,$e,Ke,Ve,j,Wt>0,ut,ct??ut.bgCell,T,X,(Tt==null?void 0:Tt.hoverAmount)??0,W,D,re,B,tt,E,Z,te,le)}return Ne&&e.restore(),_e.style==="faded"&&(e.globalAlpha=1),De--,yt&&(e.restore(),(sn=tt==null?void 0:tt.deprep)==null||sn.call(tt,se),tt=void 0,ae(),V=be,e.font=be),De<=0}),e.restore(),De<=0}),U}const Bo=[0,0],Oo={x:0,y:0,width:0,height:0},jr=[void 0,()=>{}];let ai=!1;function Ua(){ai=!0}function Ll(e,t,n,o,r,i,a,s,c,f,u,w,m,g,h,y,k,M,C,v,A,P,O,T,X){var Z,te;let R,W;k!==void 0&&k[0][0]===n&&k[0][1]===o&&(R=k[1][0],W=k[1][1]);let B;Bo[0]=n,Bo[1]=o,Oo.x=a,Oo.y=s,Oo.width=c,Oo.height=f,jr[0]=O.getValue(Bo),jr[1]=le=>O.setValue(Bo,le),ai=!1;const D={ctx:e,theme:w,col:n,row:o,cell:t,rect:Oo,highlighted:u,cellFillColor:m,hoverAmount:y,frameTime:C,hoverX:R,drawState:jr,hoverY:W,imageLoader:g,spriteManager:h,hyperWrapping:M,overrideCursor:R!==void 0?X:void 0,requestAnimationFrame:Ua},S=ea(D,t.lastUpdated,C,A,r,i),E=T(t);if(E!==void 0){(A==null?void 0:A.renderer)!==E&&((Z=A==null?void 0:A.deprep)==null||Z.call(A,D),A=void 0);const le=(te=E.drawPrep)==null?void 0:te.call(E,D,A);v!==void 0&&!vo(D.cell)?v(D,()=>E.draw(D,t)):E.draw(D,t),B=le===void 0?void 0:{deprep:le==null?void 0:le.deprep,fillStyle:le==null?void 0:le.fillStyle,font:le==null?void 0:le.font,renderer:E}}return(S||ai)&&(P==null||P(Bo)),B}function mi(e,t,n,o,r,i,a,s,c=-20,f=-20,u=32,w="center",m="square"){const g=Math.floor(r+a/2),h=m==="circle"?1e4:t.roundingRadius??4;let y=hl(u,a,t.cellVerticalPadding),k=y/2;const M=fl(w,o,i,t.cellHorizontalPadding,y),C=ul(M,g,y),v=gl(o+c,r+f,C);switch(n){case!0:{e.beginPath(),xn(e,M-y/2,g-y/2,y,y,h),m==="circle"&&(k*=.8,y*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(M-k+y/4.23,g-k+y/1.97),e.lineTo(M-k+y/2.42,g-k+y/1.44),e.lineTo(M-k+y/1.29,g-k+y/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case pr:case!1:{e.beginPath(),xn(e,M-y/2+.5,g-y/2+.5,y-1,y-1,h),e.lineWidth=1,e.strokeStyle=v?t.textDark:t.textMedium,e.stroke();break}case ci:{e.beginPath(),xn(e,M-y/2,g-y/2,y,y,h),e.fillStyle=v?t.textMedium:t.textLight,e.fill(),m==="circle"&&(k*=.8,y*=.8),e.beginPath(),e.moveTo(M-y/3,g),e.lineTo(M+y/3,g),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:Ko()}}function _a(e,t,n,o,r,i,a,s,c,f,u,w,m,g,h,y,k,M,C){const v=a+s;if(v<=0)return;e.fillStyle=w.bgHeader,e.fillRect(0,0,r,v);const[A,P]=(o==null?void 0:o[0])??[],O=w.headerFontFull;e.font=O,Yn(t,0,i,0,v,(T,X,R,W)=>{var se;if(k!==void 0&&!k.has([T.sourceIndex,-1]))return;const B=Math.max(0,W-X);e.save(),e.beginPath(),e.rect(X+B,s,T.width-B,a),e.clip();const D=y(T.group??"").overrideTheme,S=T.themeOverride===void 0&&D===void 0?w:Nn(w,D,T.themeOverride);S.bgHeader!==w.bgHeader&&(e.fillStyle=S.bgHeader,e.fill()),S!==w&&(e.font=S.baseFontFull);const E=u.columns.hasIndex(T.sourceIndex),Z=c!==void 0||f,te=!Z&&P===-1&&A===T.sourceIndex,le=Z?0:((se=g.find(de=>de.item[0]===T.sourceIndex&&de.item[1]===-1))==null?void 0:se.hoverAmount)??0,fe=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===T.sourceIndex,De=E?S.accentColor:fe?S.bgHeaderHasFocus:S.bgHeader,re=n?s:0,V=T.sourceIndex===0?0:1;E?(e.fillStyle=De,e.fillRect(X+V,re,T.width-V,a)):(fe||le>0)&&(e.beginPath(),e.rect(X+V,re,T.width-V,a),fe&&(e.fillStyle=S.bgHeaderHasFocus,e.fill()),le>0&&(e.globalAlpha=le,e.fillStyle=S.bgHeaderHovered,e.fill(),e.globalAlpha=1)),Pl(e,X,re,T.width,a,T,E,S,te,fe,le,m,M,C),e.restore()}),n&&Va(e,t,r,i,s,o,w,m,g,h,y,k)}function Va(e,t,n,o,r,i,a,s,c,f,u,w){const[g,h]=(i==null?void 0:i[0])??[];let y=0;Fl(t,n,o,r,(k,M,C,v,A,P)=>{if(w!==void 0&&!w.hasItemInRectangle({x:k[0],y:-2,width:k[1]-k[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(C,v,A,P),e.clip();const O=u(M),T=(O==null?void 0:O.overrideTheme)===void 0?a:Nn(a,O.overrideTheme),X=h===-2&&g!==void 0&&g>=k[0]&&g<=k[1],R=X?T.bgHeaderHovered:T.bgHeader;if(R!==a.bgHeader&&(e.fillStyle=R,e.fill()),e.fillStyle=T.textGroupHeader??T.textHeader,O!==void 0){let W=C;if(O.icon!==void 0&&(s.drawSprite(O.icon,"normal",e,W+8,(r-20)/2,20,T),W+=26),e.fillText(O.name,W+8,r/2+Xn(e,a.headerFontFull)),O.actions!==void 0&&X){const B=zl({x:C,y:v,width:A,height:P},O.actions);e.beginPath();const D=B[0].x-10,S=C+A-D;e.rect(D,0,S,r);const E=e.createLinearGradient(D,0,D+S,0),Z=Jn(R,0);E.addColorStop(0,Z),E.addColorStop(10/S,R),E.addColorStop(1,R),e.fillStyle=E,e.fill(),e.globalAlpha=.6;const[te,le]=(i==null?void 0:i[1])??[-1,-1];for(let fe=0;fe<O.actions.length;fe++){const De=O.actions[fe],re=B[fe],V=Er(re,te+C,le);V&&(e.globalAlpha=1),s.drawSprite(De.icon,"normal",e,re.x+re.width/2-10,re.y+re.height/2-10,20,T),V&&(e.globalAlpha=.6)}e.globalAlpha=1}}C!==0&&f(k[0])&&(e.beginPath(),e.moveTo(C+.5,0),e.lineTo(C+.5,r),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()),e.restore(),y=C+A}),e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()}const bo=30;function Al(e,t,n,o,r){return r?{x:e,y:t,width:bo,height:Math.min(bo,o)}:{x:e+n-bo,y:Math.max(t,t+o/2-bo/2),width:bo,height:Math.min(bo,o)}}function zl(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,a=26;for(let s=0;s<t.length;s++)n.push({x:o,y:r,width:a,height:i}),o+=26;return n}function _i(e,t,n,o,r,i,a,s,c,f,u,w,m,g){if(i.rowMarker!==void 0){const v=i.rowMarkerChecked;v!==!0&&(e.globalAlpha=f),mi(e,s,v,t,n,o,r,!1,void 0,void 0,18,"center",i.rowMarker),v!==!0&&(e.globalAlpha=1);return}const h=s.cellHorizontalPadding,y=a?s.textHeaderSelected:s.textHeader,k=i.hasMenu===!0&&(c||w&&a),M=m?-1:1;let C=m?t+o-h:t+h;if(i.icon!==void 0){let v=a?"selected":"normal";i.style==="highlight"&&(v=a?"selected":"special");const A=s.headerIconSize;u.drawSprite(i.icon,v,e,m?C-A:C,n+(r-A)/2,A,s),i.overlayIcon!==void 0&&u.drawSprite(i.overlayIcon,a?"selected":"special",e,m?C-A+9:C+9,n+((r-18)/2+6),18,s),C+=Math.ceil(A*1.3)*M}if(k&&i.hasMenu===!0&&o>35){const A=m?35:o-35,P=m?35*.7:o-35*.7,O=A/o,T=P/o,X=e.createLinearGradient(t,0,t+o,0),R=Jn(y,0);X.addColorStop(m?1:0,y),X.addColorStop(O,y),X.addColorStop(T,R),X.addColorStop(m?0:1,R),e.fillStyle=X}else e.fillStyle=y;if(m&&(e.textAlign="right"),e.fillText(i.title,C,n+r/2+Xn(e,s.headerFontFull)),m&&(e.textAlign="left"),k&&i.hasMenu===!0)if(i.menuIcon===void 0||i.menuIcon===vr.Triangle){e.beginPath();const v=g.x+g.width/2-5.5,A=g.y+g.height/2-3;ra(e,[{x:v,y:A},{x:v+11,y:A},{x:v+5.5,y:A+6}],1),e.fillStyle=y,e.fill()}else if(i.menuIcon===vr.Dots){e.beginPath();const v=g.x+g.width/2,A=g.y+g.height/2;oa(e,v,A),e.fillStyle=y,e.fill()}else{const v=g.x+(g.width-s.headerIconSize)/2,A=g.y+(g.height-s.headerIconSize)/2;u.drawSprite(i.menuIcon,"normal",e,v,A,s.headerIconSize,s)}}function Pl(e,t,n,o,r,i,a,s,c,f,u,w,m,g){const h=ui(i.title)==="rtl",y=Al(t,n,o,r,h);m!==void 0?m({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:a,hoverAmount:u,isHovered:c,hasSelectedCell:f,spriteManager:w,menuBounds:y},()=>_i(e,t,n,o,r,i,a,s,c,u,w,g,h,y)):_i(e,t,n,o,r,i,a,s,c,u,w,g,h,y)}function Ga(e,t,n,o,r,i,a,s,c,f,u,w,m,g,h,y,k,M,C){if(M!==void 0||t[t.length-1]!==n[t.length-1])return;const v=Il(k);Yn(t,c,a,s,i,(A,P,O,T,X)=>{if(A!==t[t.length-1])return;P+=A.width;const R=Math.max(P,T);R>o||(e.save(),e.beginPath(),e.rect(R,i+1,1e4,r-i-1),e.clip(),Rr(X,O,r,f,u,h,y,v,(W,B,D,S)=>{if(!S&&k.length>0&&!k.some(fe=>Cr(P,W,1e4,D,fe.x,fe.y,fe.width,fe.height)))return;const E=m.hasIndex(B),Z=g.hasIndex(B);e.beginPath();const te=w==null?void 0:w(B),le=te===void 0?C:Nn(C,te);le.bgCell!==C.bgCell&&(e.fillStyle=le.bgCell,e.fillRect(P,W,1e4,D)),Z&&(e.fillStyle=le.bgHeader,e.fillRect(P,W,1e4,D)),E&&(e.fillStyle=le.accentLight,e.fillRect(P,W,1e4,D))}),e.restore())})}function qa(e,t,n,o,r,i,a,s,c){let f=!1;for(const h of t)if(!h.sticky){f=a(h.sourceIndex);break}const u=c.horizontalBorderColor??c.borderColor,w=c.borderColor,m=f?So(t):0;let g;if(m!==0&&(g=Ni(w,c.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=g,e.stroke()),r>0){const h=w===u&&g!==void 0?g:Ni(u,c.bgCell),y=Qn(i,r,s);e.beginPath(),e.moveTo(0,o-y+.5),e.lineTo(n,o-y+.5),e.strokeStyle=h,e.stroke()}}const Bl=(e,t,n)=>{let o=0,r=t,i=0,a=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),r=Math.max(r,s.x+s.width+1),i=Math.min(i,s.y-1),a=Math.max(a,s.y+s.height+1)}return{minX:o,maxX:r,minY:i,maxY:a}};function ja(e,t,n,o,r,i,a,s,c,f,u,w,m,g,h){var D;const y=h.bgCell,{minX:k,maxX:M,minY:C,maxY:v}=Bl(s,i,a),A=[],P=a-Qn(g,m,f);let O=c,T=n,X=0;for(;O+r<P;){const S=O+r,E=f(T);if(S>=C&&S<=v-1){const Z=u==null?void 0:u(T),te=Z==null?void 0:Z.bgCell;te!==void 0&&te!==y&&T>=g-m&&A.push({x:k,y:S,w:M-k,h:E,color:te})}O+=E,T<g-m&&(X=O),T++}let R=0;const W=Math.min(P,v)-X;if(W>0)for(let S=0;S<t.length;S++){const E=t[S];if(E.width===0)continue;const Z=E.sticky?R:R+o,te=(D=E.themeOverride)==null?void 0:D.bgCell;te!==void 0&&te!==y&&Z>=k&&Z<=M&&w(S+1)&&A.push({x:Z,y:X,w:E.width,h:W,color:te}),R+=E.width}if(A.length===0)return;let B;e.beginPath();for(let S=A.length-1;S>=0;S--){const E=A[S];B===void 0?B=E.color:E.color!==B&&(e.fillStyle=B,e.fill(),e.beginPath(),B=E.color),e.rect(E.x,E.y,E.w,E.h)}B!==void 0&&(e.fillStyle=B,e.fill()),e.beginPath()}function Vi(e,t,n,o,r,i,a,s,c,f,u,w,m,g,h,y,k,M=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,a);for(const D of c)e.rect(D.x+1,D.y+1,D.width-1,D.height-1);e.clip("evenodd")}const C=k.horizontalBorderColor??k.borderColor,v=k.borderColor,{minX:A,maxX:P,minY:O,maxY:T}=Bl(s,i,a),X=[];e.beginPath();let R=.5;for(let D=0;D<t.length;D++){const S=t[D];if(S.width===0)continue;R+=S.width;const E=S.sticky?R:R+o;E>=A&&E<=P&&g(D+1)&&X.push({x1:E,y1:Math.max(f,O),x2:E,y2:Math.min(a,T),color:v})}let W=a+.5;for(let D=y-h;D<y;D++){const S=w(D);W-=S,X.push({x1:A,y1:W,x2:P,y2:W,color:C})}if(M!==!0){let D=u+.5,S=n;const E=W;for(;D+r<E;){const Z=D+r;if(Z>=O&&Z<=T-1){const te=m==null?void 0:m(S);X.push({x1:A,y1:Z,x2:P,y2:Z,color:(te==null?void 0:te.horizontalBorderColor)??(te==null?void 0:te.borderColor)??C})}D+=w(S),S++}}const B=Cs(X,D=>D.color);for(const D of Object.keys(B)){e.strokeStyle=D;for(const S of B[D])e.moveTo(S.x1,S.y1),e.lineTo(S.x2,S.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function Za(e,t,n,o,r,i,a,s,c,f,u,w,m,g,h,y,k,M,C){const v=[];e.imageSmoothingEnabled=!1;const A=Math.min(r.cellYOffset,a),P=Math.max(r.cellYOffset,a);let O=0;if(typeof M=="number")O+=(P-A)*M;else for(let E=A;E<P;E++)O+=M(E);a>r.cellYOffset&&(O=-O),O+=c-r.translateY;const T=Math.min(r.cellXOffset,i),X=Math.max(r.cellXOffset,i);let R=0;for(let E=T;E<X;E++)R+=y[E].width;i>r.cellXOffset&&(R=-R),R+=s-r.translateX;let W=So(k);if(W>0&&W++,R!==0&&O!==0)return{regions:[]};const B=f>0?Qn(m,f,M):0,D=u-W-Math.abs(R),S=w-g-B-Math.abs(O)-1;if(D>150&&S>150){const E={sx:0,sy:0,sw:u*h,sh:w*h,dx:0,dy:0,dw:u*h,dh:w*h};if(O>0?(E.sy=(g+1)*h,E.sh=S*h,E.dy=(O+g+1)*h,E.dh=S*h,v.push({x:0,y:g,width:u,height:O+1})):O<0&&(E.sy=(-O+g+1)*h,E.sh=S*h,E.dy=(g+1)*h,E.dh=S*h,v.push({x:0,y:w+O-B,width:u,height:-O+B})),R>0?(E.sx=W*h,E.sw=D*h,E.dx=(R+W)*h,E.dw=D*h,v.push({x:W-1,y:0,width:R+2,height:w})):R<0&&(E.sx=(W-R)*h,E.sw=D*h,E.dx=W*h,E.dw=D*h,v.push({x:u+R,y:0,width:-R,height:w})),e.setTransform(1,0,0,1,0,0),C){if(W>0&&R!==0&&O===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const Z=W*h,te=w*h;e.drawImage(t,0,0,Z,te,0,0,Z,te)}if(B>0&&R===0&&O!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const Z=(w-B)*h,te=u*h,le=B*h;e.drawImage(t,0,Z,te,le,0,Z,te,le)}}e.drawImage(t,E.sx,E.sy,E.sw,E.sh,E.dx,E.dy,E.dw,E.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:v}}function Ja(e,t,n,o,r,i,a,s,c,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||Yn(c,n,o,r,s,(w,m,g,h)=>{if(w.sourceIndex===f){const y=Math.max(m,h)+1;return u.push({x:y,y:0,width:i-y,height:a}),!0}}),u}function Qa(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(ko(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:a,...s}=r,{width:c,...f}=i;if(!ko(s,f))return!1;n=o}return n===void 0?!0:n}return!0}function Gi(e,t,n,o,r,i,a,s,c,f,u,w,m,g,h,y){const k=h==null?void 0:h.filter(T=>T.style!=="no-outline");if(k===void 0||k.length===0)return;const M=So(s),C=Qn(g,m,w),v=[c,0,s.length,g-m],A=[M,0,t,n-C],P=k.map(T=>{const X=T.range,R=T.style??"dashed";return Ya(X,v,t,n,A).map(W=>{const B=W.rect,D=li(B.x,B.y,t,n,u,f+u,o,r,i,a,g,c,m,s,w),S=B.width===1&&B.height===1?D:li(B.x+B.width-1,B.y+B.height-1,t,n,u,f+u,o,r,i,a,g,c,m,s,w);return B.x+B.width>=s.length&&(S.width-=1),B.y+B.height>=g&&(S.height-=1),{color:T.color,style:R,clip:W.clip,rect:Xa({x:D.x,y:D.y,width:S.x+S.width-D.x,height:S.y+S.height-D.y},t,n,8)}})}),O=()=>{e.lineWidth=1;let T=!1;for(const X of P)for(const R of X)if((R==null?void 0:R.rect)!==void 0&&Cr(0,0,t,n,R.rect.x,R.rect.y,R.rect.width,R.rect.height)){const W=T,B=!Na(R.clip,R.rect);B&&(e.save(),e.rect(R.clip.x,R.clip.y,R.clip.width,R.clip.height),e.clip()),R.style==="dashed"&&!T?(e.setLineDash([5,3]),T=!0):(R.style==="solid"||R.style==="solid-outline")&&T&&(e.setLineDash([]),T=!1),e.strokeStyle=R.style==="solid-outline"?Jt(Jt(R.color,y.borderColor),y.bgCell):Jn(R.color,1),e.strokeRect(R.rect.x+.5,R.rect.y+.5,R.rect.width-1,R.rect.height-1),B&&(e.restore(),T=W)}T&&e.setLineDash([])};return O(),O}function qi(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function Zr(e,t,n,o,r,i,a,s,c,f,u,w,m,g,h,y,k){if(u.current===void 0)return;const M=u.current.range,C=u.current.cell,v=[M.x+M.width-1,M.y+M.height-1];if(C[1]>=k&&v[1]>=k||!a.some(Z=>Z.sourceIndex===C[0]||Z.sourceIndex===v[0]))return;const[P,O]=u.current.cell,T=m(u.current.cell),X=T.span??[P,P],R=O>=k-g,W=g>0&&!R?Qn(k,g,w)-1:0,B=v[1];let D,S;if(Yn(a,o,r,i,f,(Z,te,le,fe,De)=>{if(fe-=1,Z.sticky&&P>Z.sourceIndex)return;const re=Z.sourceIndex<X[0],V=Z.sourceIndex>X[1],se=Z.sourceIndex===v[0];if(!(!se&&(re||V)))return Rr(De,le,n,k,w,g,h,void 0,(de,He,U)=>{if(He!==O&&He!==B)return;let pe=te,ke=Z.width;const xe=Z.sourceIndex===s.length-1,qe=He===k-1;if(T.span!==void 0){const Je=Tl(T.span,te,de,Z.width,U,Z,s),Re=Z.sticky?Je[0]:Je[1];Re!==void 0&&(pe=Re.x,ke=Re.width)}const Ze=He===B&&se&&y,rt=He===O&&!re&&!V&&D===void 0;return Ze&&(S=()=>{var Je;fe>pe&&!Z.sticky&&!rt&&(e.beginPath(),e.rect(fe,0,t-fe,n),e.clip()),e.beginPath(),e.rect(pe+ke-4,de+U-4,4,4),e.fillStyle=((Je=Z.themeOverride)==null?void 0:Je.accentColor)??c.accentColor,e.fill()}),rt&&(D=()=>{var Je;fe>pe&&!Z.sticky&&(e.beginPath(),e.rect(fe,0,t-fe,n),e.clip()),e.beginPath(),e.rect(pe+.5,de+.5,ke-(xe?1:0),U-(qe?1:0)),e.strokeStyle=((Je=Z.themeOverride)==null?void 0:Je.accentColor)??c.accentColor,e.lineWidth=1,e.stroke()}),D!==void 0&&(y?S!==void 0:!0)}),D!==void 0&&(y?S!==void 0:!0)}),D===void 0&&S===void 0)return;const E=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-W),e.clip(),D==null||D(),S==null||S(),e.restore()};return E(),E}function ec(e,t,n,o,r,i,a,s,c){c===void 0||c.size===0||(e.beginPath(),Fl(t,n,i,o,(f,u,w,m,g,h)=>{c.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(w,m,g,h)}),Yn(t,s,i,a,r,(f,u,w,m)=>{const g=Math.max(0,m-u),h=u+g+1,y=f.width-g-1;c.has([f.sourceIndex,-1])&&e.rect(h,o,y,r-o)}),e.clip())}function tc(e,t,n,o,r,i,a,s,c,f){let u=0;return Yn(e,i,o,r,n,(w,m,g,h,y)=>(Rr(y,g,t,a,s,c,f,void 0,(k,M,C,v)=>{v||(u=Math.max(M,u))}),!0)),u}function ji(e,t){var Ne;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:a,cellYOffset:s,translateX:c,translateY:f,mappedColumns:u,enableGroups:w,freezeColumns:m,dragAndDropState:g,theme:h,drawFocus:y,headerHeight:k,groupHeaderHeight:M,disabledRows:C,rowHeight:v,verticalBorder:A,overrideCursor:P,isResizing:O,selection:T,fillHandle:X,freezeTrailingRows:R,rows:W,getCellContent:B,getGroupDetails:D,getRowThemeOverride:S,isFocused:E,drawHeaderCallback:Z,prelightCells:te,drawCellCallback:le,highlightRegions:fe,resizeCol:De,imageLoader:re,lastBlitData:V,hoverValues:se,hyperWrapping:de,hoverInfo:He,spriteManager:U,maxScaleFactor:pe,hasAppendRow:ke,touchMode:xe,enqueue:qe,renderStateProvider:Ze,getCellRenderer:rt,renderStrategy:Je,bufferACtx:Re,bufferBCtx:Be,damage:Le,minimumCellWidth:wt}=e;if(r===0||i===0)return;const ue=Je==="double-buffer",ae=Math.min(pe,Math.ceil(window.devicePixelRatio??1)),Se=Je!=="direct"&&Qa(e,t),Ee=n.canvas;(Ee.width!==r*ae||Ee.height!==i*ae)&&(Ee.width=r*ae,Ee.height=i*ae,Ee.style.width=r+"px",Ee.style.height=i+"px");const Fe=o.canvas,be=w?M+k:k,tt=be+1;(Fe.width!==r*ae||Fe.height!==tt*ae)&&(Fe.width=r*ae,Fe.height=tt*ae,Fe.style.width=r+"px",Fe.style.height=tt+"px");const Ke=Re.canvas,Ue=Be.canvas;ue&&(Ke.width!==r*ae||Ke.height!==i*ae)&&(Ke.width=r*ae,Ke.height=i*ae,V.current!==void 0&&(V.current.aBufferScroll=void 0)),ue&&(Ue.width!==r*ae||Ue.height!==i*ae)&&(Ue.width=r*ae,Ue.height=i*ae,V.current!==void 0&&(V.current.bBufferScroll=void 0));const j=V.current;if(Se===!0&&a===(j==null?void 0:j.cellXOffset)&&s===(j==null?void 0:j.cellYOffset)&&c===(j==null?void 0:j.translateX)&&f===(j==null?void 0:j.translateY))return;let Te=null;ue&&(Te=n);const Oe=o;let Me;ue?Le!==void 0?Me=(j==null?void 0:j.lastBuffer)==="b"?Be:Re:Me=(j==null?void 0:j.lastBuffer)==="b"?Re:Be:Me=n;const St=Me.canvas,_e=ue?St===Ke?Ue:Ke:Ee,$e=typeof v=="number"?()=>v:v;Oe.save(),Me.save(),Oe.beginPath(),Me.beginPath(),Oe.textBaseline="middle",Me.textBaseline="middle",ae!==1&&(Oe.scale(ae,ae),Me.scale(ae,ae));const Ve=ii(u,a,r,g,c);let yt=[];const Mt=y&&((Ne=T.current)==null?void 0:Ne.cell[1])===s&&f===0;let en=!1;if(fe!==void 0){for(const Ge of fe)if(Ge.style!=="no-outline"&&Ge.range.y===s&&f===0){en=!0;break}}const Kt=()=>{_a(Oe,Ve,w,He,r,c,k,M,g,O,T,h,U,se,A,D,Le,Z,xe),Vi(Oe,Ve,s,c,f,r,i,void 0,void 0,M,be,$e,S,A,R,W,h,!0),Oe.beginPath(),Oe.moveTo(0,tt-.5),Oe.lineTo(r,tt-.5),Oe.strokeStyle=Jt(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),Oe.stroke(),en&&Gi(Oe,r,i,a,s,c,f,u,m,k,M,v,R,W,fe,h),Mt&&Zr(Oe,r,i,s,c,f,Ve,u,h,be,T,$e,B,R,ke,X,W)};if(Le!==void 0){const Ge=Ve[Ve.length-1].sourceIndex+1,Ft=Le.hasItemInRegion([{x:a,y:-2,width:Ge,height:2},{x:a,y:s,width:Ge,height:300},{x:0,y:s,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:a,y:W-R,width:Ge,height:R,when:R>0}]),Tt=bt=>{Ui(bt,Ve,u,i,be,c,f,s,W,$e,B,D,S,C,E,y,R,ke,yt,Le,T,te,fe,re,U,se,He,le,de,h,qe,Ze,rt,P,wt);const Dt=T.current;X&&y&&Dt!==void 0&&Le.has(yl(Dt.range))&&Zr(bt,r,i,s,c,f,Ve,u,h,be,T,$e,B,R,ke,X,W)};Ft&&(Tt(Me),Te!==null&&(Te.save(),Te.scale(ae,ae),Te.textBaseline="middle",Tt(Te),Te.restore()),Le.hasHeader()&&(ec(Oe,Ve,r,M,be,c,f,s,Le),Kt())),Me.restore(),Oe.restore();return}if((Se!==!0||a!==(j==null?void 0:j.cellXOffset)||c!==(j==null?void 0:j.translateX)||Mt!==(j==null?void 0:j.mustDrawFocusOnHeader)||en!==(j==null?void 0:j.mustDrawHighlightRingsOnHeader))&&Kt(),Se===!0){Zt(_e!==void 0&&j!==void 0);const{regions:Ge}=Za(Me,_e,_e===Ke?j.aBufferScroll:j.bBufferScroll,_e===Ke?j.bBufferScroll:j.aBufferScroll,j,a,s,c,f,R,r,i,W,be,ae,u,Ve,v,ue);yt=Ge}else Se!==!1&&(Zt(j!==void 0),yt=Ja(j,a,s,c,f,r,i,be,Ve,Se));qa(Me,Ve,r,i,R,W,A,$e,h);const ut=Gi(Me,r,i,a,s,c,f,u,m,k,M,v,R,W,fe,h),Ot=y?Zr(Me,r,i,s,c,f,Ve,u,h,be,T,$e,B,R,ke,X,W):void 0;if(Me.fillStyle=h.bgCell,yt.length>0){Me.beginPath();for(const Ge of yt)Me.rect(Ge.x,Ge.y,Ge.width,Ge.height);Me.clip(),Me.fill(),Me.beginPath()}else Me.fillRect(0,0,r,i);const Wt=Ui(Me,Ve,u,i,be,c,f,s,W,$e,B,D,S,C,E,y,R,ke,yt,Le,T,te,fe,re,U,se,He,le,de,h,qe,Ze,rt,P,wt);Ga(Me,Ve,u,r,i,be,c,f,s,W,$e,S,T.rows,C,R,ke,yt,Le,h),ja(Me,Ve,s,c,f,r,i,yt,be,$e,S,A,R,W,h),Vi(Me,Ve,s,c,f,r,i,yt,Wt,M,be,$e,S,A,R,W,h),ut==null||ut(),Ot==null||Ot(),O&&Yn(Ve,0,c,0,be,(Ge,Ft)=>Ge.sourceIndex===De?(qi(Oe,Ft+Ge.width,0,be+1,Jt(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),qi(Me,Ft+Ge.width,be,i,Jt(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),Te!==null&&(Te.fillStyle=h.bgCell,Te.fillRect(0,0,r,i),Te.drawImage(Me.canvas,0,0));const Sn=tc(Ve,i,be,c,f,s,W,$e,R,ke);re==null||re.setWindow({x:a,y:s,width:Ve.length,height:Sn-s},m,Array.from({length:R},(Ge,Ft)=>W-1-Ft));const Mn=j!==void 0&&(a!==j.cellXOffset||c!==j.translateX),ct=j!==void 0&&(s!==j.cellYOffset||f!==j.translateY);V.current={cellXOffset:a,cellYOffset:s,translateX:c,translateY:f,mustDrawFocusOnHeader:Mt,mustDrawHighlightRingsOnHeader:en,lastBuffer:ue?St===Ke?"a":"b":void 0,aBufferScroll:St===Ke?[Mn,ct]:j==null?void 0:j.aBufferScroll,bBufferScroll:St===Ue?[Mn,ct]:j==null?void 0:j.bBufferScroll},Me.restore(),Oe.restore()}const nc=80;function oc(e){const t=e-1;return t*t*t+1}class rc{constructor(t){We(this,"callback");We(this,"currentHoveredItem");We(this,"leavingItems",[]);We(this,"lastAnimationTime");We(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>No(o.item,t.item))||this.leavingItems.push(t)});We(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>No(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});We(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});We(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});We(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:oc(t.hoverAmount)})));We(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/nc;for(const i of this.leavingItems)i.hoverAmount=mn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=mn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});We(this,"setHovered",t=>{var n;if(!No((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class ic{constructor(t){We(this,"fn");We(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function wi(e){return new ic(e)}const lc=wi(()=>window.navigator.userAgent.includes("Firefox")),kr=wi(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),xr=wi(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function sc(e){const t=l.useRef([]),n=l.useRef(0),o=l.useRef(e);o.current=e;const r=l.useCallback(()=>{const i=()=>window.requestAnimationFrame(a),a=()=>{const s=t.current.map(gi);t.current=[],o.current(new Yo(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:a)},[]);return l.useCallback(i=>{t.current.length===0&&r();const a=wn(i[0],i[1]);t.current.includes(a)||t.current.push(a)},[r])}const $n="header",jt="group-header",Sr="out-of-bounds";var Co;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Co||(Co={}));function Ol(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Zi=6,ac=(e,t)=>{if(e.kind===J.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},cc=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:a,cellYOffset:s,headerHeight:c,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:w,rows:m,getCellContent:g,getRowThemeOverride:h,onHeaderMenuClick:y,enableGroups:k,isFilling:M,onCanvasFocused:C,onCanvasBlur:v,isFocused:A,selection:P,freezeColumns:O,onContextMenu:T,freezeTrailingRows:X,fixedShadowX:R=!0,fixedShadowY:W=!0,drawFocusRing:B=!0,onMouseDown:D,onMouseUp:S,onMouseMoveRaw:E,onMouseMove:Z,onItemHovered:te,dragAndDropState:le,firstColAccessible:fe,onKeyDown:De,onKeyUp:re,highlightRegions:V,canvasRef:se,onDragStart:de,onDragEnd:He,eventTargetRef:U,isResizing:pe,resizeColumn:ke,isDragging:xe,isDraggable:qe=!1,allowResize:Ze,disabledRows:rt,hasAppendRow:Je,getGroupDetails:Re,theme:Be,prelightCells:Le,headerIcons:wt,verticalBorder:ue,drawCell:ae,drawHeader:Se,onCellFocused:Ee,onDragOverCell:Fe,onDrop:be,onDragLeave:tt,imageWindowLoader:Ke,smoothScrollX:Ue=!1,smoothScrollY:j=!1,experimental:Te,getCellRenderer:Oe}=e,Me=e.translateX??0,St=e.translateY??0,_e=Math.max(O,Math.min(i.length-1,a)),$e=l.useRef(null),Ve=Ke,yt=l.useRef(),[Mt,en]=l.useState(!1),Kt=l.useRef([]),ut=l.useRef(),[Ot,Wt]=l.useState(),[Sn,Mn]=l.useState(),ct=l.useRef(null),[Ne,Ge]=l.useState(),[Ft,Tt]=l.useState(!1),bt=l.useRef(Ft);bt.current=Ft;const Dt=l.useMemo(()=>new Wa(wt,()=>{yn.current=void 0,Kn.current()}),[wt]),sn=k?u+c:c,Ye=l.useRef(-1),ft=((Te==null?void 0:Te.enableFirefoxRescaling)??!1)&&lc.value,it=((Te==null?void 0:Te.enableSafariRescaling)??!1)&&kr.value;l.useLayoutEffect(()=>{window.devicePixelRatio===1||!ft&&!it||(Ye.current!==-1&&en(!0),window.clearTimeout(Ye.current),Ye.current=window.setTimeout(()=>{en(!1),Ye.current=-1},200))},[s,_e,Me,St,ft,it]);const lt=Ks(i,O),Ht=R?So(lt,le):0,dt=l.useCallback((x,K,Q)=>{const q=x.getBoundingClientRect();if(K>=lt.length||Q>=m)return;const G=q.width/n,ie=li(K,Q,n,o,u,sn,_e,s,Me,St,m,O,X,lt,w);return G!==1&&(ie.x*=G,ie.y*=G,ie.width*=G,ie.height*=G),ie.x+=q.x,ie.y+=q.y,ie},[n,o,u,sn,_e,s,Me,St,m,O,X,lt,w]),It=l.useCallback((x,K,Q,q)=>{const G=x.getBoundingClientRect(),ie=G.width/n,ve=(K-G.left)/ie,Ce=(Q-G.top)/ie,oe=5,et=ii(lt,_e,n,void 0,Me);let he=0,nt=0;q instanceof MouseEvent&&(he=q.button,nt=q.buttons);const Ie=Gs(ve,et,Me),Xe=qs(Ce,o,k,c,u,m,w,s,St,X),vt=(q==null?void 0:q.shiftKey)===!0,Ae=(q==null?void 0:q.ctrlKey)===!0,pt=(q==null?void 0:q.metaKey)===!0,nn=q!==void 0&&!(q instanceof MouseEvent)||(q==null?void 0:q.pointerType)==="touch",mt=[ve<0?-1:n<ve?1:0,Ce<sn?-1:o<Ce?1:0];let Vt;if(Ie===-1||Ce<0||ve<0||Xe===void 0||ve>n||Ce>o){const Qe=ve>n?1:ve<0?-1:0,Ct=Ce>o?1:Ce<0?-1:0;let Gt=Qe*2,bn=Ct*2;Qe===0&&(Gt=Ie===-1?Co.EndPadding:Co.Center),Ct===0&&(bn=Xe===void 0?Co.EndPadding:Co.Center);let un=!1;if(Ie===-1&&Xe===-1){const _n=dt(x,lt.length-1,-1);Zt(_n!==void 0),un=K<_n.x+_n.width+oe}const uo=ve>n&&ve<n+ri()||Ce>o&&Ce<o+ri();Vt={kind:Sr,location:[Ie!==-1?Ie:ve<0?0:lt.length-1,Xe??m-1],region:[Gt,bn],shiftKey:vt,ctrlKey:Ae,metaKey:pt,isEdge:un,isTouch:nn,button:he,buttons:nt,scrollEdge:mt,isMaybeScrollbar:uo}}else if(Xe<=-1){let Qe=dt(x,Ie,Xe);Zt(Qe!==void 0);let Ct=Qe!==void 0&&Qe.x+Qe.width-K<=oe;const Gt=Ie-1;K-Qe.x<=oe&&Gt>=0?(Ct=!0,Qe=dt(x,Gt,Xe),Zt(Qe!==void 0),Vt={kind:k&&Xe===-2?jt:$n,location:[Gt,Xe],bounds:Qe,group:lt[Gt].group??"",isEdge:Ct,shiftKey:vt,ctrlKey:Ae,metaKey:pt,isTouch:nn,localEventX:K-Qe.x,localEventY:Q-Qe.y,button:he,buttons:nt,scrollEdge:mt}):Vt={kind:k&&Xe===-2?jt:$n,group:lt[Ie].group??"",location:[Ie,Xe],bounds:Qe,isEdge:Ct,shiftKey:vt,ctrlKey:Ae,metaKey:pt,isTouch:nn,localEventX:K-Qe.x,localEventY:Q-Qe.y,button:he,buttons:nt,scrollEdge:mt}}else{const Qe=dt(x,Ie,Xe);Zt(Qe!==void 0);const Ct=Qe!==void 0&&Qe.x+Qe.width-K<oe;let Gt=!1;if(f&&P.current!==void 0){const bn=yl(P.current.range),un=dt(x,bn[0],bn[1]);if(un!==void 0){const uo=un.x+un.width-2,_n=un.y+un.height-2;Gt=Math.abs(uo-K)<Zi&&Math.abs(_n-Q)<Zi}}Vt={kind:"cell",location:[Ie,Xe],bounds:Qe,isEdge:Ct,shiftKey:vt,ctrlKey:Ae,isFillHandle:Gt,metaKey:pt,isTouch:nn,localEventX:K-Qe.x,localEventY:Q-Qe.y,button:he,buttons:nt,scrollEdge:mt}}return Vt},[n,lt,_e,Me,o,k,c,u,m,w,s,St,X,dt,f,P,sn]),[ht]=Ot??[],Go=l.useRef(()=>{}),Tn=l.useRef(Ot);Tn.current=Ot;const[Rn,En]=l.useMemo(()=>{const x=document.createElement("canvas"),K=document.createElement("canvas");return x.style.display="none",x.style.opacity="0",x.style.position="fixed",K.style.display="none",K.style.opacity="0",K.style.position="fixed",[x.getContext("2d",{alpha:!1}),K.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>{if(!(Rn===null||En===null))return document.documentElement.append(Rn.canvas),document.documentElement.append(En.canvas),()=>{Rn.canvas.remove(),En.canvas.remove()}},[Rn,En]);const eo=l.useMemo(()=>new ia,[]),qo=ft&&Mt?1:it&&Mt?2:5,jo=(Te==null?void 0:Te.disableMinimumCellWidth)===!0?1:10,yn=l.useRef(),to=l.useRef(null),no=l.useRef(null),oo=l.useCallback(()=>{var ve;const x=$e.current,K=ct.current;if(x===null||K===null||(to.current===null&&(to.current=x.getContext("2d",{alpha:!1}),x.width=0,x.height=0),no.current===null&&(no.current=K.getContext("2d",{alpha:!1}),K.width=0,K.height=0),to.current===null||no.current===null||Rn===null||En===null))return;let Q=!1;const q=Ce=>{Q=!0,Ge(Ce)},G=yn.current,ie={headerCanvasCtx:no.current,canvasCtx:to.current,bufferACtx:Rn,bufferBCtx:En,width:n,height:o,cellXOffset:_e,cellYOffset:s,translateX:Math.round(Me),translateY:Math.round(St),mappedColumns:lt,enableGroups:k,freezeColumns:O,dragAndDropState:le,theme:Be,headerHeight:c,groupHeaderHeight:u,disabledRows:rt??ot.empty(),rowHeight:w,verticalBorder:ue,isResizing:pe,resizeCol:ke,isFocused:A,selection:P,fillHandle:f,drawCellCallback:ae,hasAppendRow:Je,overrideCursor:q,maxScaleFactor:qo,freezeTrailingRows:X,rows:m,drawFocus:B,getCellContent:g,getGroupDetails:Re??(Ce=>({name:Ce})),getRowThemeOverride:h,drawHeaderCallback:Se,prelightCells:Le,highlightRegions:V,imageLoader:Ve,lastBlitData:ut,damage:yt.current,hoverValues:Kt.current,hoverInfo:Tn.current,spriteManager:Dt,scrolling:Mt,hyperWrapping:(Te==null?void 0:Te.hyperWrapping)??!1,touchMode:Ft,enqueue:Go.current,renderStateProvider:eo,renderStrategy:(Te==null?void 0:Te.renderStrategy)??(kr.value?"double-buffer":"single-buffer"),getCellRenderer:Oe,minimumCellWidth:jo};ie.damage===void 0?(yn.current=ie,ji(ie,G)):ji(ie,void 0),!Q&&(ie.damage===void 0||ie.damage.has((ve=Tn==null?void 0:Tn.current)==null?void 0:ve[0]))&&Ge(void 0)},[Rn,En,n,o,_e,s,Me,St,lt,k,O,le,Be,c,u,rt,w,ue,pe,Je,ke,A,P,f,X,m,B,qo,g,Re,h,ae,Se,Le,V,Ve,Dt,Mt,Te==null?void 0:Te.hyperWrapping,Te==null?void 0:Te.renderStrategy,Ft,eo,Oe,jo]),Kn=l.useRef(oo);l.useLayoutEffect(()=>{oo(),Kn.current=oo},[oo]),l.useLayoutEffect(()=>{(async()=>{var K;((K=document==null?void 0:document.fonts)==null?void 0:K.ready)!==void 0&&(await document.fonts.ready,yn.current=void 0,Kn.current())})()},[]);const Hn=l.useCallback(x=>{yt.current=x,Kn.current(),yt.current=void 0},[]),Zo=sc(Hn);Go.current=Zo;const Jo=l.useCallback(x=>{Hn(new Yo(x.map(K=>K.cell)))},[Hn]);Ve.setCallback(Hn);const[Dr,Ir]=l.useState(!1),[ro,Dn]=ht??[],Fr=ro!==void 0&&Dn===-1,Tr=ro!==void 0&&Dn===-2;let Qo=!1,io=!1,Rt=Ne;if(Rt===void 0&&ro!==void 0&&Dn!==void 0&&Dn>-1&&Dn<m){const x=g([ro,Dn],!0);Qo=x.kind===ln.NewRow||x.kind===ln.Marker&&x.markerKind!=="number",io=x.kind===J.Boolean&&oi(x),Rt=x.cursor}const er=xe?"grabbing":(Sn??!1)||pe?"col-resize":Dr||M?"crosshair":Rt!==void 0?Rt:Fr||Qo||io||Tr?"pointer":"default",lo=l.useMemo(()=>({contain:"strict",display:"block",cursor:er}),[er]),Mo=l.useRef("default"),Ln=U==null?void 0:U.current;Ln!=null&&Mo.current!==lo.cursor&&(Ln.style.cursor=Mo.current=lo.cursor);const Ut=l.useCallback((x,K,Q,q)=>{if(Re===void 0)return;const G=Re(x);if(G.actions!==void 0){const ie=zl(K,G.actions);for(const[ve,Ce]of ie.entries())if(Er(Ce,Q+K.x,q+Ce.y))return G.actions[ve]}},[Re]),an=l.useCallback((x,K,Q,q)=>{const G=i[K];if(!xe&&!pe&&G.hasMenu===!0&&!(Sn??!1)){const ie=dt(x,K,-1);Zt(ie!==void 0);const ve=Al(ie.x,ie.y,ie.width,ie.height,ui(G.title)==="rtl");if(Q>ve.x&&Q<ve.x+ve.width&&q>ve.y&&q<ve.y+ve.height)return ie}},[i,dt,Sn,xe,pe]),Ro=l.useRef(0),An=l.useRef(),Eo=l.useRef(!1),$t=l.useCallback(x=>{const K=$e.current,Q=U==null?void 0:U.current;if(K===null||x.target!==K&&x.target!==Q)return;Eo.current=!0;let q,G;if(x instanceof MouseEvent?(q=x.clientX,G=x.clientY):(q=x.touches[0].clientX,G=x.touches[0].clientY),x.target===Q&&Q!==null){const ve=Q.getBoundingClientRect();if(q>ve.right||G>ve.bottom)return}const ie=It(K,q,G,x);An.current=ie.location,ie.isTouch&&(Ro.current=Date.now()),bt.current!==ie.isTouch&&Tt(ie.isTouch),!(ie.kind===$n&&an(K,ie.location[0],q,G)!==void 0)&&(ie.kind===jt&&Ut(ie.group,ie.bounds,ie.localEventX,ie.localEventY)!==void 0||(D==null||D(ie),!ie.isTouch&&qe!==!0&&qe!==ie.kind&&ie.button<3&&ie.button!==1&&x.preventDefault()))},[U,qe,It,Ut,an,D]);Lt("touchstart",$t,window,!1),Lt("mousedown",$t,window,!1);const so=l.useRef(0),Do=l.useCallback(x=>{var nt,Ie;const K=so.current;so.current=Date.now();const Q=$e.current;if(Eo.current=!1,S===void 0||Q===null)return;const q=U==null?void 0:U.current,G=x.target!==Q&&x.target!==q;let ie,ve,Ce=!0;if(x instanceof MouseEvent){if(ie=x.clientX,ve=x.clientY,Ce=x.button<3,x.pointerType==="touch")return}else ie=x.changedTouches[0].clientX,ve=x.changedTouches[0].clientY;let oe=It(Q,ie,ve,x);oe.isTouch&&Ro.current!==0&&Date.now()-Ro.current>500&&(oe={...oe,isLongTouch:!0}),K!==0&&Date.now()-K<(oe.isTouch?1e3:500)&&(oe={...oe,isDoubleClick:!0}),bt.current!==oe.isTouch&&Tt(oe.isTouch),!G&&x.cancelable&&Ce&&x.preventDefault();const[et]=oe.location,he=an(Q,et,ie,ve);if(oe.kind===$n&&he!==void 0){(oe.button!==0||((nt=An.current)==null?void 0:nt[0])!==et||((Ie=An.current)==null?void 0:Ie[1])!==-1)&&S(oe,!0);return}else if(oe.kind===jt){const Xe=Ut(oe.group,oe.bounds,oe.localEventX,oe.localEventY);if(Xe!==void 0){oe.button===0&&Xe.onClick(oe);return}}S(oe,G)},[S,U,It,an,Ut]);Lt("mouseup",Do,window,!1),Lt("touchend",Do,window,!1);const tr=l.useCallback(x=>{var he,nt;const K=$e.current;if(K===null)return;const Q=U==null?void 0:U.current,q=x.target!==K&&x.target!==Q;let G,ie,ve=!0;x instanceof MouseEvent?(G=x.clientX,ie=x.clientY,ve=x.button<3):(G=x.changedTouches[0].clientX,ie=x.changedTouches[0].clientY);const Ce=It(K,G,ie,x);bt.current!==Ce.isTouch&&Tt(Ce.isTouch),!q&&x.cancelable&&ve&&x.preventDefault();const[oe]=Ce.location,et=an(K,oe,G,ie);if(Ce.kind===$n&&et!==void 0)Ce.button===0&&((he=An.current)==null?void 0:he[0])===oe&&((nt=An.current)==null?void 0:nt[1])===-1&&(y==null||y(oe,et));else if(Ce.kind===jt){const Ie=Ut(Ce.group,Ce.bounds,Ce.localEventX,Ce.localEventY);Ie!==void 0&&Ce.button===0&&Ie.onClick(Ce)}},[U,It,an,y,Ut]);Lt("click",tr,window,!1);const Hr=l.useCallback(x=>{const K=$e.current,Q=U==null?void 0:U.current;if(K===null||x.target!==K&&x.target!==Q||T===void 0)return;const q=It(K,x.clientX,x.clientY,x);T(q,()=>{x.cancelable&&x.preventDefault()})},[U,It,T]);Lt("contextmenu",Hr,(U==null?void 0:U.current)??null,!1);const nr=l.useCallback(x=>{yt.current=new Yo(x.map(K=>K.item)),Kt.current=x,Kn.current(),yt.current=void 0},[]),cn=l.useMemo(()=>new rc(nr),[nr]),In=l.useRef(cn);In.current=cn,l.useLayoutEffect(()=>{const x=In.current;if(ht===void 0||ht[1]<0){x.setHovered(ht);return}const K=g(ht,!0),Q=Oe(K),q=Q===void 0&&K.kind===J.Custom||(Q==null?void 0:Q.needsHover)!==void 0&&(typeof Q.needsHover=="boolean"?Q.needsHover:Q.needsHover(K));x.setHovered(q?ht:void 0)},[g,Oe,ht]);const _t=l.useRef(),H=l.useCallback(x=>{var Ce;const K=$e.current;if(K===null)return;const Q=U==null?void 0:U.current,q=x.target!==K&&x.target!==Q,G=It(K,x.clientX,x.clientY,x);if(G.kind!=="out-of-bounds"&&q&&!Eo.current&&!G.isTouch)return;const ie=(oe,et)=>{Wt(he=>he===oe||(he==null?void 0:he[0][0])===(oe==null?void 0:oe[0][0])&&(he==null?void 0:he[0][1])===(oe==null?void 0:oe[0][1])&&((he==null?void 0:he[1][0])===(oe==null?void 0:oe[1][0])&&(he==null?void 0:he[1][1])===(oe==null?void 0:oe[1][1])||!et)?he:oe)};if(!Ol(G,_t.current))Ge(void 0),te==null||te(G),ie(G.kind===Sr?void 0:[G.location,[G.localEventX,G.localEventY]],!0),_t.current=G;else if(G.kind==="cell"||G.kind===$n||G.kind===jt){let oe=!1,et=!0;if(G.kind==="cell"){const nt=g(G.location);et=((Ce=Oe(nt))==null?void 0:Ce.needsHoverPosition)??nt.kind===J.Custom,oe=et}else G.kind===jt&&(oe=!0);const he=[G.location,[G.localEventX,G.localEventY]];ie(he,et),Tn.current=he,oe&&Hn(new Yo([G.location]))}const ve=G.location[0]>=(fe?0:1);Mn(G.kind===$n&&G.isEdge&&ve&&Ze===!0),Ir(G.kind==="cell"&&G.isFillHandle),E==null||E(x),Z(G)},[U,It,fe,Ze,E,Z,te,g,Oe,Hn]);Lt("mousemove",H,window,!0);const gt=l.useCallback(x=>{const K=$e.current;if(K===null)return;let Q,q;P.current!==void 0&&(Q=dt(K,P.current.cell[0],P.current.cell[1]),q=P.current.cell),De==null||De({bounds:Q,stopPropagation:()=>x.stopPropagation(),preventDefault:()=>x.preventDefault(),cancel:()=>{},ctrlKey:x.ctrlKey,metaKey:x.metaKey,shiftKey:x.shiftKey,altKey:x.altKey,key:x.key,keyCode:x.keyCode,rawEvent:x,location:q})},[De,P,dt]),Un=l.useCallback(x=>{const K=$e.current;if(K===null)return;let Q,q;P.current!==void 0&&(Q=dt(K,P.current.cell[0],P.current.cell[1]),q=P.current.cell),re==null||re({bounds:Q,stopPropagation:()=>x.stopPropagation(),preventDefault:()=>x.preventDefault(),cancel:()=>{},ctrlKey:x.ctrlKey,metaKey:x.metaKey,shiftKey:x.shiftKey,altKey:x.altKey,key:x.key,keyCode:x.keyCode,rawEvent:x,location:q})},[re,P,dt]),Lr=l.useCallback(x=>{$e.current=x,se!==void 0&&(se.current=x)},[se]),or=l.useCallback(x=>{const K=$e.current;if(K===null||qe===!1||pe){x.preventDefault();return}let Q,q;const G=It(K,x.clientX,x.clientY);if(qe!==!0&&G.kind!==qe){x.preventDefault();return}const ie=(nt,Ie)=>{Q=nt,q=Ie};let ve,Ce,oe;const et=(nt,Ie,Xe)=>{ve=nt,Ce=Ie,oe=Xe};let he=!1;if(de==null||de({...G,setData:ie,setDragImage:et,preventDefault:()=>he=!0,defaultPrevented:()=>he}),!he&&Q!==void 0&&q!==void 0&&x.dataTransfer!==null)if(x.dataTransfer.setData(Q,q),x.dataTransfer.effectAllowed="copyLink",ve!==void 0&&Ce!==void 0&&oe!==void 0)x.dataTransfer.setDragImage(ve,Ce,oe);else{const[nt,Ie]=G.location;if(Ie!==void 0){const Xe=document.createElement("canvas"),vt=dt(K,nt,Ie);Zt(vt!==void 0);const Ae=Math.ceil(window.devicePixelRatio??1);Xe.width=vt.width*Ae,Xe.height=vt.height*Ae;const pt=Xe.getContext("2d");pt!==null&&(pt.scale(Ae,Ae),pt.textBaseline="middle",Ie===-1?(pt.font=Be.headerFontFull,pt.fillStyle=Be.bgHeader,pt.fillRect(0,0,Xe.width,Xe.height),Pl(pt,0,0,vt.width,vt.height,lt[nt],!1,Be,!1,!1,0,Dt,Se,!1)):(pt.font=Be.baseFontFull,pt.fillStyle=Be.bgCell,pt.fillRect(0,0,Xe.width,Xe.height),Ll(pt,g([nt,Ie]),0,Ie,!1,!1,0,0,vt.width,vt.height,!1,Be,Be.bgCell,Ve,Dt,1,void 0,!1,0,void 0,void 0,void 0,eo,Oe,()=>{}))),Xe.style.left="-100%",Xe.style.position="absolute",Xe.style.width=`${vt.width}px`,Xe.style.height=`${vt.height}px`,document.body.append(Xe),x.dataTransfer.setDragImage(Xe,vt.width/2,vt.height/2),window.setTimeout(()=>{Xe.remove()},0)}}else x.preventDefault()},[qe,pe,It,de,dt,Be,lt,Dt,Se,g,Ve,eo,Oe]);Lt("dragstart",or,(U==null?void 0:U.current)??null,!1,!1);const Io=l.useRef(),Ar=l.useCallback(x=>{const K=$e.current;if(be!==void 0&&x.preventDefault(),K===null||Fe===void 0)return;const Q=It(K,x.clientX,x.clientY),[q,G]=Q.location,ie=q-(fe?0:1),[ve,Ce]=Io.current??[];(ve!==ie||Ce!==G)&&(Io.current=[ie,G],Fe([ie,G],x.dataTransfer))},[fe,It,Fe,be]);Lt("dragover",Ar,(U==null?void 0:U.current)??null,!1,!1);const yi=l.useCallback(()=>{Io.current=void 0,He==null||He()},[He]);Lt("dragend",yi,(U==null?void 0:U.current)??null,!1,!1);const z=l.useCallback(x=>{const K=$e.current;if(K===null||be===void 0)return;x.preventDefault();const Q=It(K,x.clientX,x.clientY),[q,G]=Q.location,ie=q-(fe?0:1);be([ie,G],x.dataTransfer)},[fe,It,be]);Lt("drop",z,(U==null?void 0:U.current)??null,!1,!1);const At=l.useCallback(()=>{tt==null||tt()},[tt]);Lt("dragleave",At,(U==null?void 0:U.current)??null,!1,!1);const Et=l.useRef(P);Et.current=P;const ao=l.useRef(null),Fo=l.useCallback(x=>{var K;$e.current===null||!$e.current.contains(document.activeElement)||(x===null&&Et.current.current!==void 0?(K=se==null?void 0:se.current)==null||K.focus({preventScroll:!0}):x!==null&&x.focus({preventScroll:!0}),ao.current=x)},[se]);l.useImperativeHandle(t,()=>({focus:()=>{var K;const x=ao.current;x===null||!document.contains(x)?(K=se==null?void 0:se.current)==null||K.focus({preventScroll:!0}):x.focus({preventScroll:!0})},getBounds:(x,K)=>{if(!(se===void 0||se.current===null))return dt(se.current,x??0,K??-1)},damage:Jo}),[se,Jo,dt]);const zn=l.useRef(),Xt=Ts(()=>{var Ce,oe,et;if(n<50||(Te==null?void 0:Te.disableAccessibilityTree)===!0)return null;let x=ii(lt,_e,n,le,Me);const K=fe?0:-1;!fe&&((Ce=x[0])==null?void 0:Ce.sourceIndex)===0&&(x=x.slice(1));const[Q,q]=((oe=P.current)==null?void 0:oe.cell)??[],G=(et=P.current)==null?void 0:et.range,ie=x.map(he=>he.sourceIndex),ve=Zn(s,Math.min(m,s+r));return Q!==void 0&&q!==void 0&&!(ie.includes(Q)&&ve.includes(q))&&Fo(null),l.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":lt.length+K},l.createElement("thead",{role:"rowgroup"},l.createElement("tr",{role:"row","aria-rowindex":1},x.map(he=>l.createElement("th",{role:"columnheader","aria-selected":P.columns.hasIndex(he.sourceIndex),"aria-colindex":he.sourceIndex+1+K,tabIndex:-1,onFocus:nt=>{if(nt.target!==ao.current)return Ee==null?void 0:Ee([he.sourceIndex,-1])},key:he.sourceIndex},he.title)))),l.createElement("tbody",{role:"rowgroup"},ve.map(he=>l.createElement("tr",{role:"row","aria-selected":P.rows.hasIndex(he),key:he,"aria-rowindex":he+2},x.map(nt=>{const Ie=nt.sourceIndex,Xe=wn(Ie,he),vt=Q===Ie&&q===he,Ae=G!==void 0&&Ie>=G.x&&Ie<G.x+G.width&&he>=G.y&&he<G.y+G.height,pt=`glide-cell-${Ie}-${he}`,nn=[Ie,he],mt=g(nn,!0);return l.createElement("td",{key:Xe,role:"gridcell","aria-colindex":Ie+1+K,"aria-selected":Ae,"aria-readonly":vo(mt)||!$o(mt),id:pt,"data-testid":pt,onClick:()=>{const Vt=se==null?void 0:se.current;if(Vt!=null)return De==null?void 0:De({bounds:dt(Vt,Ie,he),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:nn})},onFocusCapture:Vt=>{var Qe,Ct;if(!(Vt.target===ao.current||((Qe=zn.current)==null?void 0:Qe[0])===Ie&&((Ct=zn.current)==null?void 0:Ct[1])===he))return zn.current=nn,Ee==null?void 0:Ee(nn)},ref:vt?Fo:void 0,tabIndex:-1},ac(mt,Oe))})))))},[n,lt,_e,le,Me,m,s,r,P,Fo,g,se,De,dt,Ee],200),dn=O===0||!R?0:_e>O?1:mn(-Me/100,0,1),zr=-s*32+St,co=W?mn(-zr/100,0,1):0,Pr=l.useMemo(()=>{if(!dn&&!co)return null;const x={position:"absolute",top:0,left:Ht,width:n-Ht,height:o,opacity:dn,pointerEvents:"none",transition:Ue?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},K={position:"absolute",top:sn,left:0,width:n,height:o,opacity:co,pointerEvents:"none",transition:j?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return l.createElement(l.Fragment,null,dn>0&&l.createElement("div",{id:"shadow-x",style:x}),co>0&&l.createElement("div",{id:"shadow-y",style:K}))},[dn,co,Ht,n,Ue,sn,o,j]),Br=l.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return l.createElement(l.Fragment,null,l.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:gt,onKeyUp:Un,onFocus:C,onBlur:v,ref:Lr,style:lo},Xt),l.createElement("canvas",{ref:ct,style:Br}),Pr)},dc=l.memo(l.forwardRef(cc));function Wo(e,t,n,o){return mn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const uc=e=>{const[t,n]=l.useState(),[o,r]=l.useState(),[i,a]=l.useState(),[s,c]=l.useState(),[f,u]=l.useState(!1),[w,m]=l.useState(),[g,h]=l.useState(),[y,k]=l.useState(),[M,C]=l.useState(!1),[v,A]=l.useState(),{onHeaderMenuClick:P,getCellContent:O,onColumnMoved:T,onColumnResize:X,onColumnResizeStart:R,onColumnResizeEnd:W,gridRef:B,maxColumnWidth:D,minColumnWidth:S,onRowMoved:E,lockColumns:Z,onColumnProposeMove:te,onMouseDown:le,onMouseUp:fe,onItemHovered:De,onDragStart:re,canvasRef:V}=e,se=(X??W??R)!==void 0,{columns:de,selection:He}=e,U=He.columns,pe=l.useCallback(ue=>{const[ae,Se]=ue.location;i!==void 0&&s!==ae&&ae>=Z?(u(!0),c(ae)):g!==void 0&&Se!==void 0?(C(!0),k(Math.max(0,Se))):o===void 0&&!f&&!M&&(De==null||De(ue))},[i,g,s,De,Z,o,f,M]),ke=T!==void 0,xe=l.useCallback(ue=>{var ae;if(ue.button===0){const[Se,Ee]=ue.location;if(ue.kind==="out-of-bounds"&&ue.isEdge&&se){const Fe=(ae=B==null?void 0:B.current)==null?void 0:ae.getBounds(de.length-1,-1);Fe!==void 0&&(n(Fe.x),r(de.length-1))}else if(ue.kind==="header"&&Se>=Z){const Fe=V==null?void 0:V.current;if(ue.isEdge&&se&&Fe){n(ue.bounds.x),r(Se);const tt=Fe.getBoundingClientRect().width/Fe.offsetWidth,Ke=ue.bounds.width/tt;R==null||R(de[Se],Ke,Se,Ke+(de[Se].growOffset??0))}else ue.kind==="header"&&ke&&(m(ue.bounds.x),a(Se))}else ue.kind==="cell"&&Z>0&&Se===0&&Ee!==void 0&&E!==void 0&&(A(ue.bounds.y),h(Ee))}le==null||le(ue)},[le,se,Z,E,B,de,ke,R,V]),qe=l.useCallback((ue,ae)=>{f||M||P==null||P(ue,ae)},[f,M,P]),Ze=l.useRef(-1),rt=l.useCallback(()=>{Ze.current=-1,h(void 0),k(void 0),A(void 0),C(!1),a(void 0),c(void 0),m(void 0),u(!1),r(void 0),n(void 0)},[]),Je=l.useCallback((ue,ae)=>{if(ue.button===0){if(o!==void 0){if((U==null?void 0:U.hasIndex(o))===!0)for(const Ee of U){if(Ee===o)continue;const Fe=de[Ee],be=Wo(Fe,Ze.current,S,D);X==null||X(Fe,be,Ee,be+(Fe.growOffset??0))}const Se=Wo(de[o],Ze.current,S,D);if(W==null||W(de[o],Se,o,Se+(de[o].growOffset??0)),U.hasIndex(o))for(const Ee of U){if(Ee===o)continue;const Fe=de[Ee],be=Wo(Fe,Ze.current,S,D);W==null||W(Fe,be,Ee,be+(Fe.growOffset??0))}}rt(),i!==void 0&&s!==void 0&&(T==null||T(i,s)),g!==void 0&&y!==void 0&&(E==null||E(g,y))}fe==null||fe(ue,ae)},[fe,o,i,s,g,y,U,W,de,S,D,X,T,E,rt]),Re=l.useMemo(()=>{if(!(i===void 0||s===void 0)&&i!==s&&(te==null?void 0:te(i,s))!==!1)return{src:i,dest:s}},[i,s,te]),Be=l.useCallback(ue=>{const ae=V==null?void 0:V.current;if(i!==void 0&&w!==void 0)Math.abs(ue.clientX-w)>20&&u(!0);else if(g!==void 0&&v!==void 0)Math.abs(ue.clientY-v)>20&&C(!0);else if(o!==void 0&&t!==void 0&&ae){const Ee=ae.getBoundingClientRect().width/ae.offsetWidth,Fe=(ue.clientX-t)/Ee,be=de[o],tt=Wo(be,Fe,S,D);if(X==null||X(be,tt,o,tt+(be.growOffset??0)),Ze.current=Fe,(U==null?void 0:U.first())===o)for(const Ke of U){if(Ke===o)continue;const Ue=de[Ke],j=Wo(Ue,Ze.current,S,D);X==null||X(Ue,j,Ke,j+(Ue.growOffset??0))}}},[i,w,g,v,o,t,de,S,D,X,U,V]),Le=l.useCallback((ue,ae)=>{if(g===void 0||y===void 0)return O(ue,ae);let[Se,Ee]=ue;return Ee===y?Ee=g:(Ee>y&&(Ee-=1),Ee>=g&&(Ee+=1)),O([Se,Ee],ae)},[g,y,O]),wt=l.useCallback(ue=>{re==null||re(ue),ue.defaultPrevented()||rt()},[rt,re]);return l.createElement(dc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,width:e.width,getCellContent:Le,isResizing:o!==void 0,onHeaderMenuClick:qe,isDragging:f,onItemHovered:pe,onDragStart:wt,onMouseDown:xe,allowResize:se,onMouseUp:Je,dragAndDropState:Re,onMouseMoveRaw:Be,ref:B})},fc=uc;function hc(e){const t=l.useRef(null),[n,o]=l.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return l.useLayoutEffect(()=>{const r=a=>{for(const s of a){const{width:c,height:f}=s&&s.contentRect||{};o(u=>u.width===c&&u.height===f?u:{width:c,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const gc=(e,t,n)=>{const o=l.useRef(null),r=l.useRef(null),i=l.useRef(null),a=l.useRef(0),s=l.useRef(t);s.current=t;const c=n.current;l.useEffect(()=>{const f=()=>{var m,g;if(r.current===!1&&c!==null){const h=[c.scrollLeft,c.scrollTop];if(((m=i.current)==null?void 0:m[0])===h[0]&&((g=i.current)==null?void 0:g[1])===h[1])if(a.current>10){i.current=null,r.current=null;return}else a.current++;else a.current=0,s.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},w=m=>{m.touches.length===0&&(r.current=!1,a.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&c!==null){const m=c;return m.addEventListener("touchstart",u),m.addEventListener("touchend",w),()=>{m.removeEventListener("touchstart",u),m.removeEventListener("touchend",w),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},mc=gc,wc=()=>e=>e.isSafari?"scroll":"auto",yc=Qt("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[wc()]}});function bc(e){const[t,n]=l.useState(!1),o=typeof window>"u"?null:window,r=l.useRef(0);return Lt("touchstart",l.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Lt("touchend",l.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const pc=e=>{var de,He;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:a,className:s,preventDiagonalScrolling:c=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:w,rightElementProps:m,kineticScrollPerfHack:g=!1,scrollRef:h,initialSize:y}=e,k=[],M=(m==null?void 0:m.sticky)??!1,C=(m==null?void 0:m.fill)??!1,v=l.useRef(0),A=l.useRef(0),P=l.useRef(null),O=typeof window>"u"?1:window.devicePixelRatio,T=l.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),X=l.useRef(null),R=bc(200),[W,B]=l.useState(!0),D=l.useRef(0);l.useLayoutEffect(()=>{if(!W||R||T.current.lockDirection===void 0)return;const U=P.current;if(U===null)return;const[pe,ke]=T.current.lockDirection;pe!==void 0?U.scrollLeft=pe:ke!==void 0&&(U.scrollTop=ke),T.current.lockDirection=void 0},[R,W]);const S=l.useCallback((U,pe)=>{var ae;const ke=P.current;if(ke===null)return;pe=pe??ke.scrollTop,U=U??ke.scrollLeft;const xe=T.current.scrollTop,qe=T.current.scrollLeft,Ze=U-qe,rt=pe-xe;R&&Ze!==0&&rt!==0&&(Math.abs(Ze)>3||Math.abs(rt)>3)&&c&&T.current.lockDirection===void 0&&(T.current.lockDirection=Math.abs(Ze)<Math.abs(rt)?[qe,void 0]:[void 0,xe]);const Je=T.current.lockDirection;U=(Je==null?void 0:Je[0])??U,pe=(Je==null?void 0:Je[1])??pe,T.current.scrollLeft=U,T.current.scrollTop=pe;const Re=ke.clientWidth,Be=ke.clientHeight,Le=pe,wt=A.current-Le,ue=ke.scrollHeight-Be;if(A.current=Le,ue>0&&(Math.abs(wt)>2e3||Le===0||Le===ue)&&o>ke.scrollHeight+5){const Se=Le/ue,Ee=(o-Be)*Se;v.current=Ee-Le}Je!==void 0&&(window.clearTimeout(D.current),B(!1),D.current=window.setTimeout(()=>B(!0),200)),i({x:U,y:Le+v.current,width:Re-u,height:Be-f,paddingRight:((ae=X.current)==null?void 0:ae.clientWidth)??0})},[f,u,o,i,c,R]);mc(g&&kr.value,S,P);const E=l.useRef(S);E.current=S;const Z=l.useRef(),te=l.useRef(!1);l.useLayoutEffect(()=>{te.current?S():te.current=!0},[S,f,u]);const le=l.useCallback(U=>{P.current=U,h!==void 0&&(h.current=U)},[h]);let fe=0,De=0;for(k.push(l.createElement("div",{key:fe++,style:{width:r,height:0}}));De<o;){const U=Math.min(5e6,o-De);k.push(l.createElement("div",{key:fe++,style:{width:0,height:U}})),De+=U}const{ref:re,width:V,height:se}=hc(y);return typeof window<"u"&&(((de=Z.current)==null?void 0:de.height)!==se||((He=Z.current)==null?void 0:He.width)!==V)&&(window.setTimeout(()=>E.current(),0),Z.current={width:V,height:se}),(V??0)===0||(se??0)===0?l.createElement("div",{ref:re}):l.createElement("div",{ref:re},l.createElement(yc,{isSafari:kr.value},l.createElement("div",{className:"dvn-underlay"},t),l.createElement("div",{ref:le,style:Z.current,draggable:a,onDragStart:U=>{a||(U.stopPropagation(),U.preventDefault())},className:"dvn-scroller "+(s??""),onScroll:()=>S()},l.createElement("div",{className:"dvn-scroll-inner"+(w===void 0?" dvn-hidden":"")},l.createElement("div",{className:"dvn-stack"},k),w!==void 0&&l.createElement(l.Fragment,null,!C&&l.createElement("div",{className:"dvn-spacer"}),l.createElement("div",{ref:X,style:{height:se,maxHeight:n-Math.ceil(O%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:C?1:void 0,right:M?u??0:void 0,pointerEvents:"auto"}},w))))))},vc=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:a,freezeColumns:s,experimental:c,nonGrowWidth:f,clientSize:u,className:w,onVisibleRegionChanged:m,scrollRef:g,preventDiagonalScrolling:h,rightElement:y,rightElementProps:k,overscrollX:M,overscrollY:C,initialSize:v,smoothScrollX:A=!1,smoothScrollY:P=!1,isDraggable:O}=e,{paddingRight:T,paddingBottom:X}=c??{},[R,W]=u,B=l.useRef(),D=l.useRef(),S=l.useRef(),E=l.useRef(),Z=f+Math.max(0,M??0);let te=a?r+i:r;if(typeof o=="number")te+=n*o;else for(let re=0;re<n;re++)te+=o(re);C!==void 0&&(te+=C);const le=l.useRef(),fe=l.useCallback(()=>{var rt,Je;if(le.current===void 0)return;const re={...le.current};let V=0,se=re.x<0?-re.x:0,de=0,He=0;re.x=re.x<0?0:re.x;let U=0;for(let Re=0;Re<s;Re++)U+=t[Re].width;for(const Re of t){const Be=V-U;if(re.x>=Be+Re.width)V+=Re.width,He++,de++;else if(re.x>Be)V+=Re.width,A?se+=Be-re.x:He++,de++;else if(re.x+re.width>Be)V+=Re.width,de++;else break}let pe=0,ke=0,xe=0;if(typeof o=="number")P?(ke=Math.floor(re.y/o),pe=ke*o-re.y):ke=Math.ceil(re.y/o),xe=Math.ceil(re.height/o)+ke,pe<0&&xe++;else{let Re=0;for(let Be=0;Be<n;Be++){const Le=o(Be),wt=Re+(P?0:Le/2);if(re.y>=Re+Le)Re+=Le,ke++,xe++;else if(re.y>wt)Re+=Le,P?pe+=wt-re.y:ke++,xe++;else if(re.y+re.height>Le/2+Re)Re+=Le,xe++;else break}}const qe={x:He,y:ke,width:de-He,height:xe-ke},Ze=B.current;(Ze===void 0||Ze.y!==qe.y||Ze.x!==qe.x||Ze.height!==qe.height||Ze.width!==qe.width||D.current!==se||S.current!==pe||re.width!==((rt=E.current)==null?void 0:rt[0])||re.height!==((Je=E.current)==null?void 0:Je[1]))&&(m==null||m({x:He,y:ke,width:de-He,height:xe-ke},re.width,re.height,re.paddingRight??0,se,pe),B.current=qe,D.current=se,S.current=pe,E.current=[re.width,re.height])},[t,o,n,m,s,A,P]),De=l.useCallback(re=>{le.current=re,fe()},[fe]);return l.useEffect(()=>{fe()},[fe]),l.createElement(pc,{scrollRef:g,className:w,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:O===!0||typeof O=="string",scrollWidth:Z+(T??0),scrollHeight:te+(X??0),clientHeight:W,rightElement:y,paddingBottom:X,paddingRight:T,rightElementProps:k,update:De,initialSize:v},l.createElement(fc,{eventTargetRef:g,width:R,height:W,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY}))},Cc=vc,kc=Qt("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),xc=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Sc=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Mc=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Rc=10,Ec=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:a,searchResults:s,onSearchValueChange:c,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:w=!1,onSearchClose:m}=e,[g]=l.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,y]=l.useState(""),k=a??h,M=l.useCallback(V=>{y(V),c==null||c(V)},[c]),[C,v]=l.useState(),A=l.useRef(C);A.current=C,l.useEffect(()=>{s!==void 0&&(s.length>0?v(V=>({rowsSearched:o,results:s.length,selectedIndex:(V==null?void 0:V.selectedIndex)??-1})):v(void 0))},[o,s]);const P=l.useRef();P.current===void 0&&(P.current=new AbortController);const O=l.useRef(),[T,X]=l.useState([]),R=s??T,W=l.useCallback(()=>{O.current!==void 0&&(window.cancelAnimationFrame(O.current),O.current=void 0,P.current.abort())},[]),B=l.useRef(n);B.current=n;const D=l.useCallback(V=>{const se=new RegExp(V.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let de=B.current,He=Math.min(10,o),U=0;v(void 0),X([]);const pe=[],ke=async()=>{var ue;if(f===void 0)return;const xe=performance.now(),qe=o-U;let Ze=f({x:0,y:de,width:r.length,height:Math.min(He,qe,o-de)},P.current.signal);typeof Ze=="function"&&(Ze=await Ze());let rt=!1;for(const[ae,Se]of Ze.entries())for(const[Ee,Fe]of Se.entries()){let be;switch(Fe.kind){case J.Text:case J.Number:be=Fe.displayData;break;case J.Uri:case J.Markdown:be=Fe.data;break;case J.Boolean:be=typeof Fe.data=="boolean"?Fe.data.toString():void 0;break;case J.Image:case J.Bubble:be=Fe.data.join("🐳");break;case J.Custom:be=Fe.copyData;break}be!==void 0&&se.test(be)&&(pe.push([Ee,ae+de]),rt=!0)}const Je=performance.now();rt&&X([...pe]),U+=Ze.length,Zt(U<=o);const Re=((ue=A.current)==null?void 0:ue.selectedIndex)??-1;v({results:pe.length,rowsSearched:U,selectedIndex:Re}),u==null||u(pe,Re),de+He>=o?de=0:de+=He;const Be=Je-xe,Le=Math.max(Be,1),wt=Rc/Le;He=Math.ceil(He*wt),U<o&&pe.length<1e3&&(O.current=window.requestAnimationFrame(ke))};W(),O.current=window.requestAnimationFrame(ke)},[W,r.length,f,u,o]),S=l.useCallback(()=>{var V;m==null||m(),v(void 0),X([]),u==null||u([],-1),W(),(V=t==null?void 0:t.current)==null||V.focus()},[W,t,m,u]),E=l.useCallback(V=>{M(V.target.value),s===void 0&&(V.target.value===""?(v(void 0),X([]),W()):D(V.target.value))},[D,W,M,s]);l.useEffect(()=>{w&&i.current!==null&&(M(""),i.current.focus({preventScroll:!0}))},[w,i,M]);const Z=l.useCallback(V=>{var de;if((de=V==null?void 0:V.stopPropagation)==null||de.call(V),C===void 0)return;const se=(C.selectedIndex+1)%C.results;v({...C,selectedIndex:se}),u==null||u(R,se)},[C,u,R]),te=l.useCallback(V=>{var de;if((de=V==null?void 0:V.stopPropagation)==null||de.call(V),C===void 0)return;let se=(C.selectedIndex-1)%C.results;se<0&&(se+=C.results),v({...C,selectedIndex:se}),u==null||u(R,se)},[u,R,C]),le=l.useCallback(V=>{(V.ctrlKey||V.metaKey)&&V.nativeEvent.code==="KeyF"||V.key==="Escape"?(S(),V.stopPropagation(),V.preventDefault()):V.key==="Enter"&&(V.shiftKey?te():Z())},[S,Z,te]);l.useEffect(()=>()=>{W()},[W]);const[fe,De]=l.useState(!1);l.useEffect(()=>{if(w)De(!0);else{const V=setTimeout(()=>De(!1),150);return()=>clearTimeout(V)}},[w]);const re=l.useMemo(()=>{if(!w&&!fe)return null;let V;C!==void 0&&(V=C.results>=1e3?"over 1000":`${C.results} result${C.results!==1?"s":""}`,C.selectedIndex>=0&&(V=`${C.selectedIndex+1} of ${V}`));const se=U=>{U.stopPropagation()},He={width:`${Math.floor(((C==null?void 0:C.rowsSearched)??0)/o*100)}%`};return l.createElement(kc,{className:w?"":"out",onMouseDown:se,onMouseMove:se,onMouseUp:se,onClick:se},l.createElement("div",{className:"gdg-search-bar-inner"},l.createElement("input",{id:g,"aria-hidden":!w,"data-testid":"search-input",ref:i,onChange:E,value:k,tabIndex:w?void 0:-1,onKeyDownCapture:le}),l.createElement("button",{"aria-label":"Previous Result","aria-hidden":!w,tabIndex:w?void 0:-1,onClick:te,disabled:((C==null?void 0:C.results)??0)===0},xc),l.createElement("button",{"aria-label":"Next Result","aria-hidden":!w,tabIndex:w?void 0:-1,onClick:Z,disabled:((C==null?void 0:C.results)??0)===0},Sc),m!==void 0&&l.createElement("button",{"aria-label":"Close Search","aria-hidden":!w,"data-testid":"search-close-button",tabIndex:w?void 0:-1,onClick:S},Mc)),C!==void 0?l.createElement(l.Fragment,null,l.createElement("div",{className:"gdg-search-status"},l.createElement("div",{"data-testid":"search-result-area"},V)),l.createElement("div",{className:"gdg-search-progress",style:He})):l.createElement("div",{className:"gdg-search-status"},l.createElement("label",{htmlFor:g},"Type to search")))},[w,fe,C,o,g,i,E,k,le,te,Z,m,S]);return l.createElement(l.Fragment,null,l.createElement(Cc,{prelightCells:R,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY}),re)},Dc=Ec;class Ic extends l.PureComponent{constructor(){super(...arguments);We(this,"wrapperRef",l.createRef());We(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){document.addEventListener("touchend",this.clickOutside,!0),document.addEventListener("mousedown",this.clickOutside,!0),document.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){document.removeEventListener("touchend",this.clickOutside,!0),document.removeEventListener("mousedown",this.clickOutside,!0),document.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,...r}=this.props;return l.createElement("div",{...r,ref:this.wrapperRef},this.props.children)}}const Fc=()=>e=>Math.max(16,e.targetHeight-10),Tc=Qt("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[Fc(),"px"]}}),Hc=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[a,s]=Bt.useState(n);return Bt.createElement(Ic,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},Bt.createElement(Tc,{targetHeight:t.height,"data-testid":"group-rename-input",value:a,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,a.length),onChange:c=>s(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(a):c.key==="Escape"&&o()},autoFocus:!0}))};function Lc(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function ze(e,t,n){const o=Wl(e,t);return o&&(n.didMatch=!0),o}function Wl(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const f of c)if(Wl(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const a=e.split("+"),s=a.pop();if(!Lc(s,t))return!1;if(a[0]==="any")return!0;for(const c of a)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":xr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function Ac(e,t,n,o,r,i){const a=Bt.useCallback((f,u,w,m)=>{var C;(i==="cell"||i==="multi-cell")&&f!==void 0&&(f={...f,range:{x:f.cell[0],y:f.cell[1],width:1,height:1}});const g=n==="mixed"&&(w||m==="drag"),h=o==="mixed"&&g,y=r==="mixed"&&g;let k={current:f===void 0?void 0:{...f,rangeStack:m==="drag"?((C=e.current)==null?void 0:C.rangeStack)??[]:[]},columns:h?e.columns:ot.empty(),rows:y?e.rows:ot.empty()};w&&(i==="multi-rect"||i==="multi-cell")&&k.current!==void 0&&e.current!==void 0&&(k={...k,current:{...k.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(k,u)},[o,e,n,i,r,t]),s=Bt.useCallback((f,u,w)=>{f=f??e.rows,u!==void 0&&(f=f.add(u));let m;if(r==="exclusive"&&f.length>0)m={current:void 0,columns:ot.empty(),rows:f};else{const g=w&&n==="mixed",h=w&&o==="mixed";m={current:g?e.current:void 0,columns:h?e.columns:ot.empty(),rows:f}}t(m,!1)},[o,e,n,r,t]),c=Bt.useCallback((f,u,w)=>{f=f??e.columns,u!==void 0&&(f=f.add(u));let m;if(o==="exclusive"&&f.length>0)m={current:void 0,rows:ot.empty(),columns:f};else{const g=w&&n==="mixed",h=w&&r==="mixed";m={current:g?e.current:void 0,rows:h?e.rows:ot.empty(),columns:f}}t(m,!1)},[o,e,n,r,t]);return[a,s,c]}function zc(e,t,n,o,r){const i=l.useCallback(f=>{if(e===!0){const u=[];for(let w=f.y;w<f.y+f.height;w++){const m=[];for(let g=f.x;g<f.x+f.width;g++)g<0||w>=r?m.push({kind:J.Loading,allowOverlay:!1}):m.push(t([g,w]));u.push(m)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),a=e!==void 0?i:void 0,s=l.useCallback(f=>{if(a===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const w=a(u,o.signal);return typeof w=="function"?async()=>(await w()).map(m=>[{kind:J.Loading,allowOverlay:!1},...m]):w.map(m=>[{kind:J.Loading,allowOverlay:!1},...m])}return a(u,o.signal)},[o.signal,a,n]);return[e!==void 0?s:void 0,a]}function Pc(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case J.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===ci?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case J.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case J.Image:case J.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case J.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case J.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case J.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case J.Markdown:case J.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case J.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case J.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case J.Protected:return{formatted:"************",rawValue:"",format:"string"};default:Ko()}}function Bc(e,t){return e.map((o,r)=>{const i=t[r];return o.map(a=>a.span!==void 0&&a.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:Pc(a))})}function Ji(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function Oc(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(a=>Ji(a,!0)).join(",")):r.push(Ji(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Jr(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Qi(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function Wc(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function $c(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Jr(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((a,s)=>`<li gdg-raw-value=${Qi(r.rawValue[s])}>`+Jr(a)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Qi(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Jr(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function Nc(e,t){const n=Bc(e,t),o=Oc(n),r=$c(n);return{textPlain:o,textHtml:r}}function el(e){var a;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const c=s.cloneNode(!0),u=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,w=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",m=c.querySelectorAll("br");for(const y of m)y.replaceWith(`
`);const g=c.getAttribute("gdg-raw-value"),h=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((a=c.querySelector("a"))==null?void 0:a.getAttribute("href"))??"",formatted:c.textContent??"",format:h});else if(c.querySelector("ol")!==null){const y=c.querySelectorAll("li");i==null||i.push({rawValue:[...y].map(k=>k.getAttribute("gdg-raw-value")??""),formatted:[...y].map(k=>k.textContent??""),format:"string-array"})}else if(g!==null)i==null||i.push({rawValue:Wc(g),formatted:c.textContent??"",format:h});else{let y=c.textContent??"";w&&(y=y.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:y??"",formatted:y??"",format:h})}}}return i!==void 0&&r.push(i),r}function Xc(e,t,n,o,r){var s;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let a=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(s=e.current)==null?void 0:s.range,f=[];if(c.width>2){const m=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof m=="function")return i;f.push(...m);const g=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof g=="function")return i;f.push(...g)}else{const m=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof m=="function")return i;f.push(...m)}let u=c.x-n,w=c.x+c.width-1-n;for(const m of f)for(const g of m)g.span!==void 0&&(u=Math.min(g.span[0],u),w=Math.max(g.span[1],w));u===c.x-n&&w===c.x+c.width-1-n?a=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:c.y,width:w-u+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!a);return e}function tl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Yc(e){let t;(function(s){s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let a=0;for(const s of e){switch(i){case t.None:s==="	"||s===`
`?(o.push(e.slice(r,a)),r=a+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(i=t.inString);break;case t.inString:s==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:s==='"'?i=t.inString:((s==="	"||s===`
`)&&(o.push(tl(e.slice(r,a))),r=a+1,s===`
`&&(n.push(o),o=[])),i=t.None);break}a++}return r<e.length&&o.push(tl(e.slice(r,e.length))),n.push(o),n.map(s=>s.map(c=>({rawValue:c,formatted:c,format:"string"})))}function nl(e,t,n){var s;const o=Nc(e,t),r=c=>{var f;(f=window.navigator.clipboard)==null||f.writeText(c)},i=(c,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},a=(c,f)=>{var u,w;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",c),(w=n==null?void 0:n.clipboardData)==null||w.setData("text/html",f)}catch{i(c,f)||r(c)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?a(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function $l(e){return e!==!0}function ol(e){return typeof e=="string"?e:`${e}px`}const Kc=()=>e=>e.innerWidth,Uc=()=>e=>e.innerHeight,_c=Qt("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[Kc()],"wmyidgi-1":[Uc()]}}),Vc=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return l.createElement(_c,{innerHeight:ol(n),innerWidth:ol(t),...r},o)},Gc=2,qc=1300;function jc(e,t,n){const o=Bt.useRef(0),[r,i]=e??[0,0];Bt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let a=!1,s=0;const c=f=>{var u;if(!a){if(s===0)s=f;else{const w=f-s;o.current=Math.min(1,o.current+w/qc);const m=o.current**1.618*w*Gc;(u=t.current)==null||u.scrollBy(r*m,i*m),s=f,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{a=!0}},[t,r,i,n])}function Zc({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:a,remSize:s}){const[c,f,u,w,m,g]=Bt.useMemo(()=>{if(!a||s===16)return[e,t,n,o,r,i];const h=s/16,y=e,k=Ml();return[typeof y=="number"?y*h:M=>Math.ceil(y(M)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??k.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??k.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??k.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,s,e,a,o]);return{rowHeight:c,headerHeight:f,groupHeaderHeight:u,theme:w,overscrollX:m,overscrollY:g}}const Wn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Pe(e,t){return e===!0?t:e===!1?"":e}function rl(e){const t=xr.value;return{activateCell:Pe(e.activateCell," |Enter|shift+Enter"),clear:Pe(e.clear,"any+Escape"),closeOverlay:Pe(e.closeOverlay,"any+Escape"),acceptOverlayDown:Pe(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Pe(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Pe(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Pe(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Pe(e.delete,t?"Backspace|Delete":"Delete"),downFill:Pe(e.downFill,"primary+_68"),scrollToSelectedCell:Pe(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Pe(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Pe(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Pe(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Pe(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Pe(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Pe(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Pe(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Pe(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Pe(e.goToFirstCell,"primary+Home"),goToFirstColumn:Pe(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Pe(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Pe(e.goToLastCell,"primary+End"),goToLastColumn:Pe(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Pe(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Pe(e.goToNextPage,"PageDown"),goToPreviousPage:Pe(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Pe(e.rightFill,"primary+_82"),search:Pe(e.search,"primary+f"),selectAll:Pe(e.selectAll,"primary+a"),selectColumn:Pe(e.selectColumn,"ctrl+ "),selectGrowDown:Pe(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Pe(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Pe(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Pe(e.selectGrowUp,"shift+ArrowUp"),selectRow:Pe(e.selectRow,"shift+ "),selectToFirstCell:Pe(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Pe(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Pe(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Pe(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Pe(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Pe(e.selectToLastRow,"primary+shift+ArrowDown")}}function Jc(e){const t=Ps(e);return Bt.useMemo(()=>{if(t===void 0)return rl(Wn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??Wn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??Wn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??Wn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??Wn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??Wn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??Wn.selectToLastCell};return rl({...Wn,...n})},[t])}const Qc=l.lazy(async()=>await al(()=>import("./data-grid-overlay-editor-6WKZfUKe.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url));let ed=0;function td(e){return xs(Li(Li(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return Zn((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function wr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Qr={kind:J.Loading,allowOverlay:!1},yr={columns:ot.empty(),rows:ot.empty(),current:void 0},nd=(e,t)=>{var Ti,Hi;const[n,o]=l.useState(yr),[r,i]=l.useState(),a=l.useRef(null),s=l.useRef(null),[c,f]=l.useState(),u=l.useRef(null),w=l.useRef(),m=typeof window>"u"?null:window,{imageEditorOverride:g,getRowThemeOverride:h,markdownDivCreateNode:y,width:k,height:M,columns:C,rows:v,getCellContent:A,onCellClicked:P,onCellActivated:O,onFillPattern:T,onFinishedEditing:X,coercePasteValue:R,drawHeader:W,drawCell:B,editorBloom:D,onHeaderClicked:S,onColumnProposeMove:E,spanRangeBehavior:Z="default",onGroupHeaderClicked:te,onCellContextMenu:le,className:fe,onHeaderContextMenu:De,getCellsForSelection:re,onGroupHeaderContextMenu:V,onGroupHeaderRenamed:se,onCellEdited:de,onCellsEdited:He,onSearchResultsChanged:U,searchResults:pe,onSearchValueChange:ke,searchValue:xe,onKeyDown:qe,onKeyUp:Ze,keybindings:rt,editOnType:Je=!0,onRowAppended:Re,onColumnMoved:Be,validateCell:Le,highlightRegions:wt,rangeSelect:ue="rect",columnSelect:ae="multi",rowSelect:Se="multi",rangeSelectionBlending:Ee="exclusive",columnSelectionBlending:Fe="exclusive",rowSelectionBlending:be="exclusive",onDelete:tt,onDragStart:Ke,onMouseMove:Ue,onPaste:j,copyHeaders:Te=!1,freezeColumns:Oe=0,cellActivationBehavior:Me="second-click",rowSelectionMode:St="auto",onHeaderMenuClick:_e,getGroupDetails:$e,onSearchClose:Ve,onItemHovered:yt,onSelectionCleared:Mt,showSearch:en,onVisibleRegionChanged:Kt,gridSelection:ut,onGridSelectionChange:Ot,minColumnWidth:Wt=50,maxColumnWidth:Sn=500,maxColumnAutoWidth:Mn,provideEditor:ct,trailingRowOptions:Ne,freezeTrailingRows:Ge=0,allowedFillDirections:Ft="orthogonal",scrollOffsetX:Tt,scrollOffsetY:bt,verticalBorder:Dt,onDragOverCell:sn,onDrop:Ye,onColumnResize:ft,onColumnResizeEnd:it,onColumnResizeStart:lt,customRenderers:Ht,fillHandle:dt,drawFocusRing:It,experimental:ht,fixedShadowX:Go,fixedShadowY:Tn,headerIcons:Rn,imageWindowLoader:En,initialSize:eo,isDraggable:qo,onDragLeave:jo,onRowMoved:yn,overscrollX:to,overscrollY:no,preventDiagonalScrolling:oo,rightElement:Kn,rightElementProps:Hn,trapFocus:Zo=!1,smoothScrollX:Jo,smoothScrollY:Dr,scaleToRem:Ir=!1,rowHeight:ro=34,headerHeight:Dn=36,groupHeaderHeight:Fr=Dn,theme:Tr,isOutsideClick:Qo,renderers:io}=e,Rt=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,tn=(Rt==null?void 0:Rt.kind)??e.rowMarkers??"none",er=(Rt==null?void 0:Rt.width)??e.rowMarkerWidth,lo=(Rt==null?void 0:Rt.startIndex)??e.rowMarkerStartIndex??1,Mo=(Rt==null?void 0:Rt.theme)??e.rowMarkerTheme,Ln=(Rt==null?void 0:Rt.checkboxStyle)??"square",Ut=Math.max(Wt,20),an=Math.max(Sn,Ut),Ro=Math.max(Mn??an,Ut),An=l.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),Eo=l.useMemo(()=>Number.parseFloat(An.fontSize),[An]),{rowHeight:$t,headerHeight:so,groupHeaderHeight:Do,theme:tr,overscrollX:Hr,overscrollY:nr}=Zc({groupHeaderHeight:Fr,headerHeight:Dn,overscrollX:to,overscrollY:no,remSize:Eo,rowHeight:ro,scaleToRem:Ir,theme:Tr}),cn=Jc(rt),In=er??(v>1e4?48:v>1e3?44:v>100?36:32),_t=tn!=="none",H=_t?1:0,gt=Re!==void 0,Un=(Ne==null?void 0:Ne.sticky)===!0,[Lr,or]=l.useState(!1),Io=en??Lr,Ar=l.useCallback(()=>{Ve!==void 0?Ve():or(!1)},[Ve]),z=l.useMemo(()=>ut===void 0?void 0:wr(ut,H),[ut,H])??n,At=l.useRef();At.current===void 0&&(At.current=new AbortController),l.useEffect(()=>()=>At==null?void 0:At.current.abort(),[]);const[Et,ao]=zc(re,A,H,At.current,v),Fo=l.useCallback((d,p,b)=>{if(Le===void 0)return!0;const I=[d[0]-H,d[1]];return Le==null?void 0:Le(I,p,b)},[H,Le]),zn=l.useRef(ut),Xt=l.useCallback((d,p)=>{p&&(d=Xc(d,Et,H,Z,At.current)),Ot!==void 0?(zn.current=wr(d,-H),Ot(zn.current)):o(d)},[Ot,Et,H,Z]),dn=yo(ft,l.useCallback((d,p,b,I)=>{ft==null||ft(C[b-H],p,b-H,I)},[ft,H,C])),zr=yo(it,l.useCallback((d,p,b,I)=>{it==null||it(C[b-H],p,b-H,I)},[it,H,C])),co=yo(lt,l.useCallback((d,p,b,I)=>{lt==null||lt(C[b-H],p,b-H,I)},[lt,H,C])),Pr=yo(W,l.useCallback((d,p)=>(W==null?void 0:W({...d,columnIndex:d.columnIndex-H},p))??!1,[W,H])),Br=yo(B,l.useCallback((d,p)=>(B==null?void 0:B({...d,col:d.col-H},p))??!1,[B,H])),x=l.useCallback(d=>{if(tt!==void 0){const p=tt(wr(d,-H));return typeof p=="boolean"?p:wr(p,H)}return!0},[tt,H]),[K,Q,q]=Ac(z,Xt,Ee,Fe,be,ue),G=l.useMemo(()=>Nn(Ml(),tr),[tr]),[ie,ve]=l.useState([0,0,0]),Ce=l.useMemo(()=>{if(io===void 0)return{};const d={};for(const p of io)d[p.kind]=p;return d},[io]),oe=l.useCallback(d=>d.kind!==J.Custom?Ce[d.kind]:Ht==null?void 0:Ht.find(p=>p.isMatch(d)),[Ht,Ce]);let{sizedColumns:et,nonGrowWidth:he}=aa(C,v,ao,ie[0]-(H===0?0:In)-ie[2],Ut,Ro,G,oe,At.current);tn!=="none"&&(he+=In);const nt=l.useMemo(()=>et.some(d=>d.group!==void 0),[et]),Ie=nt?so+Do:so,Xe=z.rows.length,vt=tn==="none"?void 0:Xe===0?!1:Xe===v?!0:void 0,Ae=l.useMemo(()=>tn==="none"?et:[{title:"",width:In,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Mo,rowMarker:Ln,rowMarkerChecked:vt},...et],[tn,et,In,Mo,Ln,vt]),[pt,nn]=l.useMemo(()=>[bt!==void 0&&typeof $t=="number"?Math.floor(bt/$t):0,bt!==void 0&&typeof $t=="number"?-(bt%$t):0],[bt,$t]),mt=l.useRef({height:1,width:1,x:0,y:0}),Vt=l.useMemo(()=>({x:mt.current.x,y:pt,width:mt.current.width??1,height:mt.current.height??1,ty:nn}),[nn,pt]),Qe=l.useRef(!1),[Ct,Gt,bn]=zs(Vt);mt.current=Ct;const un=(Ct.height??1)>1;l.useLayoutEffect(()=>{if(bt!==void 0&&u.current!==null&&un){if(u.current.scrollTop===bt)return;u.current.scrollTop=bt,u.current.scrollTop!==bt&&bn(),Qe.current=!0}},[bt,un,bn]);const uo=(Ct.width??1)>1;l.useLayoutEffect(()=>{if(Tt!==void 0&&u.current!==null&&uo){if(u.current.scrollLeft===Tt)return;u.current.scrollLeft=Tt,u.current.scrollLeft!==Tt&&bn(),Qe.current=!0}},[Tt,uo,bn]);const _n=Ct.x+H,rr=Ct.y,Yt=l.useRef(null),Nt=l.useCallback(d=>{var p;d===!0?(p=Yt.current)==null||p.focus():window.requestAnimationFrame(()=>{var b;(b=Yt.current)==null||b.focus()})},[]),zt=gt?v+1:v,on=l.useCallback(d=>{const p=H===0?d:d.map(I=>({...I,location:[I.location[0]-H,I.location[1]]})),b=He==null?void 0:He(p);if(b!==!0)for(const I of p)de==null||de(I.location,I.value);return b},[de,He,H]),[Vn,Or]=l.useState(),ir=z.current!==void 0&&z.current.range.width*z.current.range.height>1?z.current.range:void 0,Nl=l.useMemo(()=>{if((wt===void 0||wt.length===0)&&ir===void 0&&Vn===void 0)return;const d=[];if(wt!==void 0)for(const p of wt){const b=Ae.length-p.range.x-H;b>0&&d.push({color:p.color,range:{...p.range,x:p.range.x+H,width:Math.min(b,p.range.width)},style:p.style})}return Vn!==void 0&&d.push({color:Jn(G.accentColor,0),range:Vn,style:"dashed"}),ir!==void 0&&d.push({color:Jn(G.accentColor,.5),range:ir,style:"solid-outline"}),d.length>0?d:void 0},[Vn,ir,wt,Ae.length,G.accentColor,H]),bi=l.useRef(Ae);bi.current=Ae;const qt=l.useCallback(([d,p],b=!1)=>{var N,L,$,_,Y,ne,ce;const I=gt&&p===zt-1;if(d===0&&_t)return I?Qr:{kind:ln.Marker,allowOverlay:!1,checkboxStyle:Ln,checked:(z==null?void 0:z.rows.hasIndex(p))===!0,markerKind:tn==="clickable-number"?"number":tn,row:lo+p,drawHandle:yn!==void 0,cursor:tn==="clickable-number"?"pointer":void 0};if(I){const me=d===H?(Ne==null?void 0:Ne.hint)??"":"",we=bi.current[d];if(((N=we==null?void 0:we.trailingRowOptions)==null?void 0:N.disabled)===!0)return Qr;{const je=((L=we==null?void 0:we.trailingRowOptions)==null?void 0:L.hint)??me,ye=(($=we==null?void 0:we.trailingRowOptions)==null?void 0:$.addIcon)??(Ne==null?void 0:Ne.addIcon);return{kind:ln.NewRow,hint:je,allowOverlay:!1,icon:ye}}}else{const ee=d-H;if(b||(ht==null?void 0:ht.strict)===!0){const we=mt.current,je=we.x>ee||ee>we.x+we.width||we.y>p||p>we.y+we.height||p>=$r.current,ye=ee===((Y=(_=we.extras)==null?void 0:_.selected)==null?void 0:Y[0])&&p===((ne=we.extras)==null?void 0:ne.selected[1]);let ge=!1;if(((ce=we.extras)==null?void 0:ce.freezeRegions)!==void 0){for(const st of we.extras.freezeRegions)if(Er(st,ee,p)){ge=!0;break}}if(je&&!ye&&!ge)return Qr}let me=A([ee,p]);return H!==0&&me.span!==void 0&&(me={...me,span:[me.span[0]+H,me.span[1]+H]}),me}},[gt,zt,_t,Ln,z==null?void 0:z.rows,tn,lo,yn,H,Ne==null?void 0:Ne.hint,Ne==null?void 0:Ne.addIcon,ht==null?void 0:ht.strict,A]),Wr=l.useCallback(d=>{let p=($e==null?void 0:$e(d))??{name:d};return se!==void 0&&d!==""&&(p={icon:p.icon,name:p.name,overrideTheme:p.overrideTheme,actions:[...p.actions??[],{title:"Rename",icon:"renameIcon",onClick:b=>Xr({group:p.name,bounds:b.bounds})}]}),p},[$e,se]),lr=l.useCallback(d=>{var $;const[p,b]=d.cell,I=Ae[p],F=(I==null?void 0:I.group)!==void 0?($=Wr(I.group))==null?void 0:$.overrideTheme:void 0,N=I==null?void 0:I.themeOverride,L=h==null?void 0:h(b);i({...d,theme:Nn(G,F,N,L,d.content.themeOverride)})},[h,Ae,Wr,G]),fo=l.useCallback((d,p,b)=>{var L;if(z.current===void 0)return;const[I,F]=z.current.cell,N=qt([I,F]);if(N.kind!==J.Boolean&&N.allowOverlay){let $=N;if(b!==void 0)switch($.kind){case J.Number:{const _=Ms(()=>b==="-"?-0:Number.parseFloat(b),0);$={...$,data:Number.isNaN(_)?0:_};break}case J.Text:case J.Markdown:case J.Uri:$={...$,data:b};break}lr({target:d,content:$,initialValue:b,cell:[I,F],highlight:b===void 0,forceEditMode:b!==void 0})}else N.kind===J.Boolean&&p&&N.readonly!==!0&&(on([{location:z.current.cell,value:{...N,data:$l(N.data)}}]),(L=Yt.current)==null||L.damage([{cell:z.current.cell}]))},[qt,z,on,lr]),pi=l.useCallback((d,p)=>{var F;const b=(F=Yt.current)==null?void 0:F.getBounds(d,p);if(b===void 0||u.current===null)return;const I=qt([d,p]);I.allowOverlay&&lr({target:b,content:I,initialValue:void 0,highlight:!0,cell:[d,p],forceEditMode:!0})},[qt,lr]),kt=l.useCallback((d,p,b="both",I=0,F=0,N=void 0)=>{if(u.current!==null){const L=Yt.current,$=s.current,_=typeof d!="number"?d.unit==="cell"?d.amount:void 0:d,Y=typeof p!="number"?p.unit==="cell"?p.amount:void 0:p,ne=typeof d!="number"&&d.unit==="px"?d.amount:void 0,ce=typeof p!="number"&&p.unit==="px"?p.amount:void 0;if(L!==null&&$!==null){let ee={x:0,y:0,width:0,height:0},me=0,we=0;if((_!==void 0||Y!==void 0)&&(ee=L.getBounds((_??0)+H,Y??0)??ee,ee.width===0||ee.height===0))return;const je=$.getBoundingClientRect(),ye=je.width/$.offsetWidth;if(ne!==void 0&&(ee={...ee,x:ne-je.left-u.current.scrollLeft,width:1}),ce!==void 0&&(ee={...ee,y:ce+je.top-u.current.scrollTop,height:1}),ee!==void 0){const ge={x:ee.x-I,y:ee.y-F,width:ee.width+2*I,height:ee.height+2*F};let st=0;for(let Gr=0;Gr<Oe;Gr++)st+=et[Gr].width;let Pt=0;const xt=Ge+(Un?1:0);xt>0&&(Pt=Qn(zt,xt,$t));let hn=st*ye+je.left+H*In*ye,vn=je.right,gn=je.top+Ie*ye,Cn=je.bottom-Pt*ye;const fr=ee.width+I*2;switch(N==null?void 0:N.hAlign){case"start":vn=hn+fr;break;case"end":hn=vn-fr;break;case"center":hn=Math.floor((hn+vn)/2)-fr/2,vn=hn+fr;break}const hr=ee.height+F*2;switch(N==null?void 0:N.vAlign){case"start":Cn=gn+hr;break;case"end":gn=Cn-hr;break;case"center":gn=Math.floor((gn+Cn)/2)-hr/2,Cn=gn+hr;break}hn>ge.x?me=ge.x-hn:vn<ge.x+ge.width&&(me=ge.x+ge.width-vn),gn>ge.y?we=ge.y-gn:Cn<ge.y+ge.height&&(we=ge.y+ge.height-Cn),b==="vertical"||typeof d=="number"&&d<Oe?me=0:(b==="horizontal"||typeof p=="number"&&p>=zt-xt)&&(we=0),(me!==0||we!==0)&&(ye!==1&&(me/=ye,we/=ye),u.current.scrollTo(me+u.current.scrollLeft,we+u.current.scrollTop))}}}},[H,Ge,In,Ie,Oe,et,zt,Un,$t]),vi=l.useRef(pi),Ci=l.useRef(A),$r=l.useRef(v);vi.current=pi,Ci.current=A,$r.current=v;const ho=l.useCallback(async(d,p=!0)=>{var _;const b=Ae[d];if(((_=b==null?void 0:b.trailingRowOptions)==null?void 0:_.disabled)===!0)return;const I=Re==null?void 0:Re();let F,N=!0;I!==void 0&&(F=await I,F==="top"&&(N=!1),typeof F=="number"&&(N=!1));let L=0;const $=()=>{if($r.current<=v){L<500&&window.setTimeout($,L),L=50+L*2;return}const Y=typeof F=="number"?F:N?v:0;ur.current(d-H,Y),K({cell:[d,Y],range:{x:d,y:Y,width:1,height:1}},!1,!1,"edit");const ne=Ci.current([d-H,Y]);ne.allowOverlay&&$o(ne)&&ne.readonly!==!0&&p&&window.setTimeout(()=>{vi.current(d,Y)},0)};$()},[Ae,Re,H,v,K]),sr=l.useCallback(d=>{var b,I;const p=((I=(b=et[d])==null?void 0:b.trailingRowOptions)==null?void 0:I.targetColumn)??(Ne==null?void 0:Ne.targetColumn);if(typeof p=="number")return p+(_t?1:0);if(typeof p=="object"){const F=C.indexOf(p);if(F>=0)return F+(_t?1:0)}},[et,C,_t,Ne==null?void 0:Ne.targetColumn]),Pn=l.useRef(),go=l.useRef(),To=l.useCallback((d,p)=>{var F;const[b,I]=p;return Nn(G,(F=Ae[b])==null?void 0:F.themeOverride,h==null?void 0:h(I),d.themeOverride)},[h,Ae,G]),Ho=l.useCallback(d=>{var ne,ce,ee;const p=xr.value?d.metaKey:d.ctrlKey,b=p&&Se==="multi",I=p&&ae==="multi",[F,N]=d.location,L=z.columns,$=z.rows,[_,Y]=((ne=z.current)==null?void 0:ne.cell)??[];if(d.kind==="cell"){if(go.current=void 0,Gn.current=[F,N],F===0&&_t){if(gt===!0&&N===v||tn==="number"||Se==="none")return;const me=qt(d.location);if(me.kind!==ln.Marker)return;if(yn!==void 0){const ye=oe(me);Zt((ye==null?void 0:ye.kind)===ln.Marker);const ge=(ce=ye==null?void 0:ye.onClick)==null?void 0:ce.call(ye,{...d,cell:me,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,theme:To(me,d.location),preventDefault:()=>{}});if(ge===void 0||ge.checked===me.checked)return}i(void 0),Nt();const we=$.hasIndex(N),je=Pn.current;if(Se==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&je!==void 0&&$.hasIndex(je)){const ye=[Math.min(je,N),Math.max(je,N)+1];b||St==="multi"?Q(void 0,ye,!0):Q(ot.fromSingleSelection(ye),void 0,b)}else b||d.isTouch||St==="multi"?we?Q($.remove(N),void 0,!0):(Q(void 0,N,!0),Pn.current=N):we&&$.length===1?Q(ot.empty(),void 0,p):(Q(ot.fromSingleSelection(N),void 0,p),Pn.current=N)}else if(F>=H&&gt&&N===v){const me=sr(F);ho(me??F)}else if(_!==F||Y!==N){const me=qt(d.location),we=oe(me);if((we==null?void 0:we.onSelect)!==void 0){let ge=!1;if(we.onSelect({...d,cell:me,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,preventDefault:()=>ge=!0,theme:To(me,d.location)}),ge)return}const je=Un&&N===v,ye=Un&&z!==void 0&&((ee=z.current)==null?void 0:ee.cell[1])===v;if((d.shiftKey||d.isLongTouch===!0)&&_!==void 0&&Y!==void 0&&z.current!==void 0&&!ye){if(je)return;const ge=Math.min(F,_),st=Math.max(F,_),Pt=Math.min(N,Y),xt=Math.max(N,Y);K({...z.current,range:{x:ge,y:Pt,width:st-ge+1,height:xt-Pt+1}},!0,p,"click"),Pn.current=void 0,Nt()}else K({cell:[F,N],range:{x:F,y:N,width:1,height:1}},!0,p,"click"),Pn.current=void 0,i(void 0),Nt()}}else if(d.kind==="header")if(Gn.current=[F,N],i(void 0),_t&&F===0)Pn.current=void 0,go.current=void 0,Se==="multi"&&($.length!==v?Q(ot.fromSingleSelection([0,v]),void 0,p):Q(ot.empty(),void 0,p),Nt());else{const me=go.current;if(ae==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&me!==void 0&&L.hasIndex(me)){const we=[Math.min(me,F),Math.max(me,F)+1];I?q(void 0,we,p):q(ot.fromSingleSelection(we),void 0,p)}else I?(L.hasIndex(F)?q(L.remove(F),void 0,p):q(void 0,F,p),go.current=F):ae!=="none"&&(q(ot.fromSingleSelection(F),void 0,p),go.current=F);Pn.current=void 0,Nt()}else d.kind===jt?Gn.current=[F,N]:d.kind===Sr&&!d.isMaybeScrollbar&&(Xt(yr,!1),i(void 0),Nt(),Mt==null||Mt(),Pn.current=void 0,go.current=void 0)},[ho,ae,Nt,oe,sr,qt,z,_t,Un,Mt,yn,H,tn,Se,St,v,K,Xt,q,Q,gt,To]),Lo=l.useRef(!1),Gn=l.useRef(),ki=l.useRef(Ct),rn=l.useRef(),Xl=l.useCallback(d=>{if(mo.current=!1,ki.current=mt.current,d.button!==0&&d.button!==1){rn.current=void 0;return}const p=performance.now();rn.current={button:d.button,time:p,location:d.location},(d==null?void 0:d.kind)==="header"&&(Lo.current=!0);const b=d.kind==="cell"&&d.isFillHandle;!b&&d.kind!=="cell"&&d.isEdge||(f({previousSelection:z,fillHandle:b}),Gn.current=void 0,!d.isTouch&&d.button===0&&!b?Ho(d):!d.isTouch&&d.button===1&&(Gn.current=d.location))},[z,Ho]),[Nr,Xr]=l.useState(),xi=l.useCallback(d=>{if(d.kind!==jt||ae!=="multi")return;const p=xr.value?d.metaKey:d.ctrlKey,[b]=d.location,I=z.columns;if(b<H)return;const F=Ae[b];let N=b,L=b;for(let $=b-1;$>=H&&Uo(F.group,Ae[$].group);$--)N--;for(let $=b+1;$<Ae.length&&Uo(F.group,Ae[$].group);$++)L++;if(Nt(),p)if(I.hasAll([N,L+1])){let $=I;for(let _=N;_<=L;_++)$=$.remove(_);q($,void 0,p)}else q(void 0,[N,L+1],p);else q(ot.fromSingleSelection([N,L+1]),void 0,p)},[ae,Nt,z.columns,Ae,H,q]),mo=l.useRef(!1),ar=l.useCallback(async d=>{if(Et!==void 0&&dn!==void 0){const p=mt.current.y,b=mt.current.height;let I=Et({x:d,y:p,width:1,height:Math.min(b,v-p)},At.current.signal);typeof I!="object"&&(I=await I());const F=et[d-H],L=document.createElement("canvas").getContext("2d",{alpha:!1});if(L!==null){L.font=G.baseFontFull;const $=El(L,G,F,0,I,Ut,an,!1,oe);dn==null||dn(F,$.width,d,$.width)}}},[et,Et,an,G,Ut,dn,H,v,oe]),[Yl,Yr]=l.useState(),wo=l.useCallback(async(d,p)=>{var $,_;const b=($=d.current)==null?void 0:$.range;if(b===void 0||Et===void 0||p.current===void 0)return;const I=p.current.range;if(T!==void 0){let Y=!1;if(T({fillDestination:{...I,x:I.x-H},patternSource:{...b,x:b.x-H},preventDefault:()=>Y=!0}),Y)return}let F=Et(b,At.current.signal);typeof F!="object"&&(F=await F());const N=F,L=[];for(let Y=0;Y<I.width;Y++)for(let ne=0;ne<I.height;ne++){const ce=[I.x+Y,I.y+ne];if(wl(ce,b))continue;const ee=N[ne%b.height][Y%b.width];vo(ee)||!$o(ee)||L.push({location:ce,value:{...ee}})}on(L),(_=Yt.current)==null||_.damage(L.map(Y=>({cell:Y.location})))},[Et,on,T,H]),Si=l.useCallback(()=>{if(z.current===void 0||z.current.range.width<=1)return;const d={...z,current:{...z.current,range:{...z.current.range,width:1}}};wo(d,z)},[wo,z]),Mi=l.useCallback(()=>{if(z.current===void 0||z.current.range.height<=1)return;const d={...z,current:{...z.current,range:{...z.current.range,height:1}}};wo(d,z)},[wo,z]),Kl=l.useCallback((d,p)=>{var ne,ce;const b=c;if(f(void 0),Or(void 0),Yr(void 0),Lo.current=!1,p)return;if((b==null?void 0:b.fillHandle)===!0&&z.current!==void 0&&((ne=b.previousSelection)==null?void 0:ne.current)!==void 0){if(Vn===void 0)return;const ee={...z,current:{...z.current,range:Hl(b.previousSelection.current.range,Vn)}};wo(b.previousSelection,ee),Xt(ee,!0);return}const[I,F]=d.location,[N,L]=Gn.current??[],$=()=>{mo.current=!0},_=ee=>{var we,je,ye;const me=ee.isTouch||N===I&&L===F;if(me&&(P==null||P([I-H,F],{...ee,preventDefault:$})),ee.button===1)return!mo.current;if(!mo.current){const ge=qt(d.location),st=oe(ge);if(st!==void 0&&st.onClick!==void 0&&me){const xt=st.onClick({...ee,cell:ge,posX:ee.localEventX,posY:ee.localEventY,bounds:ee.bounds,theme:To(ge,d.location),preventDefault:$});xt!==void 0&&!vo(xt)&&po(xt)&&(on([{location:ee.location,value:xt}]),(we=Yt.current)==null||we.damage([{cell:ee.location}]))}if(mo.current||z.current===void 0)return!1;let Pt=!1;switch(ge.activationBehaviorOverride??Me){case"double-click":case"second-click":{if(((ye=(je=b==null?void 0:b.previousSelection)==null?void 0:je.current)==null?void 0:ye.cell)===void 0)break;const[xt,hn]=z.current.cell,[vn,gn]=b.previousSelection.current.cell;Pt=I===xt&&I===vn&&F===hn&&F===gn&&(ee.isDoubleClick===!0||Me==="second-click");break}case"single-click":{Pt=!0;break}}if(Pt)return O==null||O([I-H,F]),fo(ee.bounds,!1),!0}return!1},Y=d.location[0]-H;if(d.isTouch){const ee=mt.current,me=ki.current;if(ee.x!==me.x||ee.y!==me.y)return;if(d.isLongTouch===!0){if(d.kind==="cell"&&No((ce=z.current)==null?void 0:ce.cell,d.location)){le==null||le([Y,d.location[1]],{...d,preventDefault:$});return}else if(d.kind==="header"&&z.columns.hasIndex(I)){De==null||De(Y,{...d,preventDefault:$});return}else if(d.kind===jt){if(Y<0)return;V==null||V(Y,{...d,preventDefault:$});return}}d.kind==="cell"?_(d)||Ho(d):d.kind===jt?te==null||te(Y,{...d,preventDefault:$}):(d.kind===$n&&(S==null||S(Y,{...d,preventDefault:$})),Ho(d));return}if(d.kind==="header"){if(Y<0)return;d.isEdge?d.isDoubleClick===!0&&ar(I):d.button===0&&I===N&&F===L&&(S==null||S(Y,{...d,preventDefault:$}))}if(d.kind===jt){if(Y<0)return;d.button===0&&I===N&&F===L&&(te==null||te(Y,{...d,preventDefault:$}),mo.current||xi(d))}d.kind==="cell"&&(d.button===0||d.button===1)&&_(d),Gn.current=void 0},[c,z,H,Vn,wo,Xt,P,qt,oe,Me,To,on,O,fo,le,De,V,Ho,te,S,ar,xi]),Ul=l.useCallback(d=>{const p={...d,location:[d.location[0]-H,d.location[1]]};Ue==null||Ue(p),c!==void 0&&d.buttons===0&&(f(void 0),Or(void 0),Yr(void 0),Lo.current=!1),Yr(b=>{var I;return Lo.current?[d.scrollEdge[0],0]:d.scrollEdge[0]===(b==null?void 0:b[0])&&d.scrollEdge[1]===b[1]?b:c===void 0||(((I=rn.current)==null?void 0:I.location[0])??0)<H?void 0:d.scrollEdge})},[c,Ue,H]),_l=l.useCallback((d,p)=>{_e==null||_e(d-H,p)},[_e,H]),pn=(Ti=z==null?void 0:z.current)==null?void 0:Ti.cell,Vl=l.useCallback((d,p,b,I,F,N)=>{Qe.current=!1;let L=pn;L!==void 0&&(L=[L[0]-H,L[1]]);const $=Oe===0?void 0:{x:0,y:d.y,width:Oe,height:d.height},_=[];$!==void 0&&_.push($),Ge>0&&(_.push({x:d.x-H,y:v-Ge,width:d.width,height:Ge}),Oe>0&&_.push({x:0,y:v-Ge,width:Oe,height:Ge}));const Y={x:d.x-H,y:d.y,width:d.width,height:gt&&d.y+d.height>=v?d.height-1:d.height,tx:F,ty:N,extras:{selected:L,freezeRegion:$,freezeRegions:_}};mt.current=Y,Gt(Y),ve([p,b,I]),Kt==null||Kt(Y,Y.tx,Y.ty,Y.extras)},[pn,H,gt,v,Oe,Ge,Gt,Kt]),Gl=yo(Be,l.useCallback((d,p)=>{Be==null||Be(d-H,p-H),ae!=="none"&&q(ot.fromSingleSelection(p),void 0,!0)},[ae,Be,H,q])),Kr=l.useRef(!1),ql=l.useCallback(d=>{if(d.location[0]===0&&H>0){d.preventDefault();return}Ke==null||Ke({...d,location:[d.location[0]-H,d.location[1]]}),d.defaultPrevented()||(Kr.current=!0),f(void 0)},[Ke,H]),jl=l.useCallback(()=>{Kr.current=!1},[]),Ur=l.useRef(),_r=l.useCallback(d=>{var p,b,I;if(!Ol(d,Ur.current)&&(Ur.current=d,!(((p=rn==null?void 0:rn.current)==null?void 0:p.button)!==void 0&&rn.current.button>=1))){if(d.buttons!==0&&c!==void 0&&((b=rn.current)==null?void 0:b.location[0])===0&&d.location[0]===0&&H===1&&Se==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(rn.current.location[1])&&z.rows.hasIndex(rn.current.location[1])){const F=Math.min(rn.current.location[1],d.location[1]),N=Math.max(rn.current.location[1],d.location[1])+1;Q(ot.fromSingleSelection([F,N]),void 0,!1)}if(d.buttons!==0&&c!==void 0&&z.current!==void 0&&!Kr.current&&!Lo.current&&(ue==="rect"||ue==="multi-rect")){const[F,N]=z.current.cell;let[L,$]=d.location;if($<0&&($=mt.current.y),c.fillHandle===!0&&((I=c.previousSelection)==null?void 0:I.current)!==void 0){const _=c.previousSelection.current.range;$=Math.min($,gt?v-1:v);const Y=$a(_,L,$,Ft);Or(Y)}else{if(gt&&N===v)return;if(gt&&$===v)if(d.kind===Sr)$--;else return;L=Math.max(L,H);const ne=L-F,ce=$-N,ee={x:ne>=0?F:L,y:ce>=0?N:$,width:Math.abs(ne)+1,height:Math.abs(ce)+1};K({...z.current,range:ee},!0,!1,"drag")}}yt==null||yt({...d,location:[d.location[0]-H,d.location[1]]})}},[Ft,c,H,Se,z,ue,yt,Q,gt,v,K]),Zl=l.useCallback(()=>{var L,$;const d=Ur.current;if(d===void 0)return;const[p,b]=d.scrollEdge;let[I,F]=d.location;const N=mt.current;p===-1?I=(($=(L=N.extras)==null?void 0:L.freezeRegion)==null?void 0:$.x)??N.x:p===1&&(I=N.x+N.width),b===-1?F=Math.max(0,N.y):b===1&&(F=Math.min(v-1,N.y+N.height)),I=mn(I,0,Ae.length-1),F=mn(F,0,v-1),_r({...d,location:[I,F]})},[Ae.length,_r,v]);jc(Yl,u,Zl);const fn=l.useCallback(d=>{if(z.current===void 0)return;const[p,b]=d,[I,F]=z.current.cell,N=z.current.range;let L=N.x,$=N.x+N.width,_=N.y,Y=N.y+N.height;if(b!==0)switch(b){case 2:{Y=v,_=F,kt(0,Y,"vertical");break}case-2:{_=0,Y=F+1,kt(0,_,"vertical");break}case 1:{_<F?(_++,kt(0,_,"vertical")):(Y=Math.min(v,Y+1),kt(0,Y,"vertical"));break}case-1:{Y>F+1?(Y--,kt(0,Y,"vertical")):(_=Math.max(0,_-1),kt(0,_,"vertical"));break}default:Ko()}if(p!==0)if(p===2)$=Ae.length,L=I,kt($-1-H,0,"horizontal");else if(p===-2)L=H,$=I+1,kt(L-H,0,"horizontal");else{let ne=[];if(Et!==void 0){const ce=Et({x:L,y:_,width:$-L-H,height:Y-_},At.current.signal);typeof ce=="object"&&(ne=td(ce))}if(p===1){let ce=!1;if(L<I){if(ne.length>0){const ee=Zn(L+1,I+1).find(me=>!ne.includes(me-H));ee!==void 0&&(L=ee,ce=!0)}else L++,ce=!0;ce&&kt(L,0,"horizontal")}ce||($=Math.min(Ae.length,$+1),kt($-1-H,0,"horizontal"))}else if(p===-1){let ce=!1;if($>I+1){if(ne.length>0){const ee=Zn($-1,I,-1).find(me=>!ne.includes(me-H));ee!==void 0&&($=ee,ce=!0)}else $--,ce=!0;ce&&kt($-H,0,"horizontal")}ce||(L=Math.max(H,L-1),kt(L-H,0,"horizontal"))}else Ko()}K({cell:z.current.cell,range:{x:L,y:_,width:$-L,height:Y-_}},!0,!1,"keyboard-select")},[Et,z,Ae.length,H,v,kt,K]),Bn=l.useCallback((d,p,b,I)=>{const F=zt-(b?0:1);if(d=mn(d,H,et.length-1+H),p=mn(p,0,F),d===(pn==null?void 0:pn[0])&&p===(pn==null?void 0:pn[1]))return!1;if(I&&z.current!==void 0){const N=[...z.current.rangeStack];(z.current.range.width>1||z.current.range.height>1)&&N.push(z.current.range),Xt({...z,current:{cell:[d,p],range:{x:d,y:p,width:1,height:1},rangeStack:N}},!0)}else K({cell:[d,p],range:{x:d,y:p,width:1,height:1}},!0,!1,"keyboard-nav");return w.current!==void 0&&w.current[0]===d&&w.current[1]===p&&(w.current=void 0),kt(d-H,p),!0},[zt,H,et.length,pn,z,kt,Xt,K]),Jl=l.useCallback((d,p)=>{(r==null?void 0:r.cell)!==void 0&&d!==void 0&&po(d)&&(on([{location:r.cell,value:d}]),window.requestAnimationFrame(()=>{var F;(F=Yt.current)==null||F.damage([{cell:r.cell}])})),Nt(!0),i(void 0);const[b,I]=p;if(z.current!==void 0&&(b!==0||I!==0)){const F=z.current.cell[1]===zt-1&&d!==void 0;Bn(mn(z.current.cell[0]+b,0,Ae.length-1),mn(z.current.cell[1]+I,0,zt-1),F,!1)}X==null||X(d,p)},[r==null?void 0:r.cell,Nt,z,X,on,zt,Bn,Ae.length]),Ql=l.useMemo(()=>`gdg-overlay-${ed++}`,[]),qn=l.useCallback(d=>{var b,I,F,N;Nt();const p=[];for(let L=d.x;L<d.x+d.width;L++)for(let $=d.y;$<d.y+d.height;$++){const _=A([L-H,$]);if(!_.allowOverlay&&_.kind!==J.Boolean)continue;let Y;if(_.kind===J.Custom){const ne=oe(_),ce=(b=ne==null?void 0:ne.provideEditor)==null?void 0:b.call(ne,_);(ne==null?void 0:ne.onDelete)!==void 0?Y=ne.onDelete(_):Rs(ce)&&(Y=(I=ce==null?void 0:ce.deletedValue)==null?void 0:I.call(ce,_))}else if(po(_)&&_.allowOverlay||_.kind===J.Boolean){const ne=oe(_);Y=(F=ne==null?void 0:ne.onDelete)==null?void 0:F.call(ne,_)}Y!==void 0&&!vo(Y)&&po(Y)&&p.push({location:[L,$],value:Y})}on(p),(N=Yt.current)==null||N.damage(p.map(L=>({cell:L.location})))},[Nt,A,oe,on,H]),Ao=r!==void 0,Ri=l.useCallback(d=>{var me,we;const p=()=>{d.stopPropagation(),d.preventDefault()},b={didMatch:!1},{bounds:I}=d,F=z.columns,N=z.rows,L=cn;if(!Ao&&ze(L.clear,d,b))Xt(yr,!1),Mt==null||Mt();else if(!Ao&&ze(L.selectAll,d,b))Xt({columns:ot.empty(),rows:ot.empty(),current:{cell:((me=z.current)==null?void 0:me.cell)??[H,0],range:{x:H,y:0,width:C.length,height:v},rangeStack:[]}},!1);else if(ze(L.search,d,b))(we=a==null?void 0:a.current)==null||we.focus({preventScroll:!0}),or(!0);else if(ze(L.delete,d,b)){const je=(x==null?void 0:x(z))??!0;if(je!==!1){const ye=je===!0?z:je;if(ye.current!==void 0){qn(ye.current.range);for(const ge of ye.current.rangeStack)qn(ge)}for(const ge of ye.rows)qn({x:H,y:ge,width:C.length,height:1});for(const ge of ye.columns)qn({x:ge,y:0,width:1,height:v})}}if(b.didMatch)return p(),!0;if(z.current===void 0)return!1;let[$,_]=z.current.cell,Y=!1,ne=!1;ze(L.scrollToSelectedCell,d,b)?ur.current($-H,_):ae!=="none"&&ze(L.selectColumn,d,b)?F.hasIndex($)?q(F.remove($),void 0,!0):ae==="single"?q(ot.fromSingleSelection($),void 0,!0):q(void 0,$,!0):Se!=="none"&&ze(L.selectRow,d,b)?N.hasIndex(_)?Q(N.remove(_),void 0,!0):Se==="single"?Q(ot.fromSingleSelection(_),void 0,!0):Q(void 0,_,!0):!Ao&&I!==void 0&&ze(L.activateCell,d,b)?_===v&&gt?window.setTimeout(()=>{const je=sr($);ho(je??$)},0):(O==null||O([$-H,_]),fo(I,!0)):z.current.range.height>1&&ze(L.downFill,d,b)?Mi():z.current.range.width>1&&ze(L.rightFill,d,b)?Si():ze(L.goToNextPage,d,b)?_+=Math.max(1,mt.current.height-4):ze(L.goToPreviousPage,d,b)?_-=Math.max(1,mt.current.height-4):ze(L.goToFirstCell,d,b)?(i(void 0),_=0,$=0):ze(L.goToLastCell,d,b)?(i(void 0),_=Number.MAX_SAFE_INTEGER,$=Number.MAX_SAFE_INTEGER):ze(L.selectToFirstCell,d,b)?(i(void 0),fn([-2,-2])):ze(L.selectToLastCell,d,b)?(i(void 0),fn([2,2])):Ao?(ze(L.closeOverlay,d,b)&&i(void 0),ze(L.acceptOverlayDown,d,b)&&(i(void 0),_++),ze(L.acceptOverlayUp,d,b)&&(i(void 0),_--),ze(L.acceptOverlayLeft,d,b)&&(i(void 0),$--),ze(L.acceptOverlayRight,d,b)&&(i(void 0),$++)):(ze(L.goDownCell,d,b)?_+=1:ze(L.goUpCell,d,b)?_-=1:ze(L.goRightCell,d,b)?$+=1:ze(L.goLeftCell,d,b)?$-=1:ze(L.goDownCellRetainSelection,d,b)?(_+=1,Y=!0):ze(L.goUpCellRetainSelection,d,b)?(_-=1,Y=!0):ze(L.goRightCellRetainSelection,d,b)?($+=1,Y=!0):ze(L.goLeftCellRetainSelection,d,b)?($-=1,Y=!0):ze(L.goToLastRow,d,b)?_=v-1:ze(L.goToFirstRow,d,b)?_=Number.MIN_SAFE_INTEGER:ze(L.goToLastColumn,d,b)?$=Number.MAX_SAFE_INTEGER:ze(L.goToFirstColumn,d,b)?$=Number.MIN_SAFE_INTEGER:(ue==="rect"||ue==="multi-rect")&&(ze(L.selectGrowDown,d,b)?fn([0,1]):ze(L.selectGrowUp,d,b)?fn([0,-1]):ze(L.selectGrowRight,d,b)?fn([1,0]):ze(L.selectGrowLeft,d,b)?fn([-1,0]):ze(L.selectToLastRow,d,b)?fn([0,2]):ze(L.selectToFirstRow,d,b)?fn([0,-2]):ze(L.selectToLastColumn,d,b)?fn([2,0]):ze(L.selectToFirstColumn,d,b)&&fn([-2,0])),ne=b.didMatch);const ce=Bn($,_,!1,Y),ee=b.didMatch;return ee&&(ce||!ne||Zo)&&p(),ee},[Ao,z,cn,ae,Se,ue,H,v,Bn,Xt,Mt,C.length,x,Zo,qn,q,Q,gt,sr,ho,O,fo,Mi,Si,fn]),zo=l.useCallback(d=>{let p=!1;if(qe!==void 0&&qe({...d,cancel:()=>{p=!0}}),p||Ri(d)||z.current===void 0)return;const[b,I]=z.current.cell,F=mt.current;if(Je&&!d.metaKey&&!d.ctrlKey&&z.current!==void 0&&d.key.length===1&&/[ -~]/g.test(d.key)&&d.bounds!==void 0&&$o(A([b-H,Math.max(0,Math.min(I,v-1))]))){if((!gt||I!==v)&&(F.y>I||I>F.y+F.height||F.x>b||b>F.x+F.width))return;fo(d.bounds,!0,d.key),d.stopPropagation(),d.preventDefault()}},[Je,qe,Ri,z,A,H,v,gt,fo]),es=l.useCallback((d,p)=>{const b=d.location[0]-H;if(d.kind==="header"&&(De==null||De(b,{...d,preventDefault:p})),d.kind===jt){if(b<0)return;V==null||V(b,{...d,preventDefault:p})}if(d.kind==="cell"){const[I,F]=d.location;le==null||le([b,F],{...d,preventDefault:p}),Us(z,d.location)||Bn(I,F,!1,!1)}},[z,le,V,De,H,Bn]),Vr=l.useCallback(async d=>{var L,$,_;if(!cn.paste)return;function p(Y,ne,ce,ee){var we,je;const me=typeof ce=="object"?(ce==null?void 0:ce.join(`
`))??"":(ce==null?void 0:ce.toString())??"";if(!vo(Y)&&$o(Y)&&Y.readonly!==!0){const ye=R==null?void 0:R(me,Y);if(ye!==void 0&&po(ye))return{location:ne,value:ye};const ge=oe(Y);if(ge===void 0)return;if(ge.kind===J.Custom){Zt(Y.kind===J.Custom);const st=(we=ge.onPaste)==null?void 0:we.call(ge,me,Y.data);return st===void 0?void 0:{location:ne,value:{...Y,data:st}}}else{const st=(je=ge.onPaste)==null?void 0:je.call(ge,me,Y,{formatted:ee,formattedString:typeof ee=="string"?ee:ee==null?void 0:ee.join(`
`),rawValue:ce});return st===void 0?void 0:(Zt(st.kind===Y.kind),{location:ne,value:st})}}}const b=z.columns,I=z.rows,F=((L=u.current)==null?void 0:L.contains(document.activeElement))===!0||(($=s.current)==null?void 0:$.contains(document.activeElement))===!0;let N;if(z.current!==void 0?N=[z.current.range.x,z.current.range.y]:b.length===1?N=[b.first()??0,0]:I.length===1&&(N=[H,I.first()??0]),F&&N!==void 0){let Y,ne;const ce="text/plain",ee="text/html";if(navigator.clipboard.read!==void 0){const ye=await navigator.clipboard.read();for(const ge of ye){if(ge.types.includes(ee)){const Pt=await(await ge.getType(ee)).text(),xt=el(Pt);if(xt!==void 0){Y=xt;break}}ge.types.includes(ce)&&(ne=await(await ge.getType(ce)).text())}}else if(navigator.clipboard.readText!==void 0)ne=await navigator.clipboard.readText();else if(d!==void 0&&(d==null?void 0:d.clipboardData)!==null){if(d.clipboardData.types.includes(ee)){const ye=d.clipboardData.getData(ee);Y=el(ye)}Y===void 0&&d.clipboardData.types.includes(ce)&&(ne=d.clipboardData.getData(ce))}else return;const[me,we]=N,je=[];do{if(j===void 0){const ye=qt(N),ge=ne??(Y==null?void 0:Y.map(Pt=>Pt.map(xt=>xt.rawValue).join("	")).join("	"))??"",st=p(ye,N,ge,void 0);st!==void 0&&je.push(st);break}if(Y===void 0){if(ne===void 0)return;Y=Yc(ne)}if(j===!1||typeof j=="function"&&(j==null?void 0:j([N[0]-H,N[1]],Y.map(ye=>ye.map(ge=>{var st;return((st=ge.rawValue)==null?void 0:st.toString())??""}))))!==!0)return;for(const[ye,ge]of Y.entries()){if(ye+we>=v)break;for(const[st,Pt]of ge.entries()){const xt=[st+me,ye+we],[hn,vn]=xt;if(hn>=Ae.length||vn>=zt)continue;const gn=qt(xt),Cn=p(gn,xt,Pt.rawValue,Pt.formatted);Cn!==void 0&&je.push(Cn)}}}while(!1);on(je),(_=Yt.current)==null||_.damage(je.map(ye=>({cell:ye.location})))}},[R,oe,qt,z,cn.paste,Ae.length,on,zt,j,H,v]);Lt("paste",Vr,m,!1,!0);const Po=l.useCallback(async(d,p)=>{var L,$;if(!cn.copy)return;const b=p===!0||((L=u.current)==null?void 0:L.contains(document.activeElement))===!0||(($=s.current)==null?void 0:$.contains(document.activeElement))===!0,I=z.columns,F=z.rows,N=(_,Y)=>{if(!Te)nl(_,Y,d);else{const ne=Y.map(ce=>({kind:J.Text,data:C[ce].title,displayData:C[ce].title,allowOverlay:!1}));nl([ne,..._],Y,d)}};if(b&&Et!==void 0){if(z.current!==void 0){let _=Et(z.current.range,At.current.signal);typeof _!="object"&&(_=await _()),N(_,Zn(z.current.range.x-H,z.current.range.x+z.current.range.width-H))}else if(F!==void 0&&F.length>0){const Y=[...F].map(ne=>{const ce=Et({x:H,y:ne,width:C.length,height:1},At.current.signal);return typeof ce=="object"?ce[0]:ce().then(ee=>ee[0])});if(Y.some(ne=>ne instanceof Promise)){const ne=await Promise.all(Y);N(ne,Zn(C.length))}else N(Y,Zn(C.length))}else if(I.length>0){const _=[],Y=[];for(const ne of I){let ce=Et({x:ne,y:0,width:1,height:v},At.current.signal);typeof ce!="object"&&(ce=await ce()),_.push(ce),Y.push(ne-H)}if(_.length===1)N(_[0],Y);else{const ne=_.reduce((ce,ee)=>ce.map((me,we)=>[...me,...ee[we]]));N(ne,Y)}}}},[C,Et,z,cn.copy,H,v,Te]);Lt("copy",Po,m,!1,!1);const ts=l.useCallback(async d=>{var b,I;if(!(!cn.cut||!(((b=u.current)==null?void 0:b.contains(document.activeElement))===!0||((I=s.current)==null?void 0:I.contains(document.activeElement))===!0))&&(await Po(d),z.current!==void 0)){let F={current:{cell:z.current.cell,range:z.current.range,rangeStack:[]},rows:ot.empty(),columns:ot.empty()};const N=x==null?void 0:x(F);if(N===!1||(F=N===!0?F:N,F.current===void 0))return;qn(F.current.range)}},[qn,z,cn.cut,Po,x]);Lt("cut",ts,m,!1,!1);const ns=l.useCallback((d,p)=>{if(U!==void 0){H!==0&&(d=d.map(F=>[F[0]-H,F[1]])),U(d,p);return}if(d.length===0||p===-1)return;const[b,I]=d[p];w.current!==void 0&&w.current[0]===b&&w.current[1]===I||(w.current=[b,I],Bn(b,I,!1,!1))},[U,H,Bn]),[cr,dr]=((Hi=ut==null?void 0:ut.current)==null?void 0:Hi.cell)??[],ur=l.useRef(kt);ur.current=kt,l.useLayoutEffect(()=>{var d,p,b,I;!Qe.current&&cr!==void 0&&dr!==void 0&&(cr!==((p=(d=zn.current)==null?void 0:d.current)==null?void 0:p.cell[0])||dr!==((I=(b=zn.current)==null?void 0:b.current)==null?void 0:I.cell[1]))&&ur.current(cr,dr),Qe.current=!1},[cr,dr]);const Ei=z.current!==void 0&&(z.current.cell[0]>=Ae.length||z.current.cell[1]>=zt);l.useLayoutEffect(()=>{Ei&&Xt(yr,!1)},[Ei,Xt]);const os=l.useMemo(()=>gt===!0&&(Ne==null?void 0:Ne.tint)===!0?ot.fromSingleSelection(zt-1):ot.empty(),[zt,gt,Ne==null?void 0:Ne.tint]),rs=l.useCallback(d=>typeof Dt=="boolean"?Dt:(Dt==null?void 0:Dt(d-H))??!0,[H,Dt]),is=l.useMemo(()=>{if(Nr===void 0||s.current===null)return null;const{bounds:d,group:p}=Nr,b=s.current.getBoundingClientRect();return l.createElement(Hc,{bounds:d,group:p,canvasBounds:b,onClose:()=>Xr(void 0),onFinish:I=>{Xr(void 0),se==null||se(p,I)}})},[se,Nr]),ls=Math.min(Ae.length,Oe+(_t?1:0));l.useImperativeHandle(t,()=>({appendRow:(d,p)=>ho(d+H,p),updateCells:d=>{var p;return H!==0&&(d=d.map(b=>({cell:[b.cell[0]+H,b.cell[1]]}))),(p=Yt.current)==null?void 0:p.damage(d)},getBounds:(d,p)=>{var b;if(!((s==null?void 0:s.current)===null||(u==null?void 0:u.current)===null)){if(d===void 0&&p===void 0){const I=s.current.getBoundingClientRect(),F=I.width/u.current.clientWidth;return{x:I.x-u.current.scrollLeft*F,y:I.y-u.current.scrollTop*F,width:u.current.scrollWidth*F,height:u.current.scrollHeight*F}}return(b=Yt.current)==null?void 0:b.getBounds((d??0)+H,p)}},focus:()=>{var d;return(d=Yt.current)==null?void 0:d.focus()},emit:async d=>{switch(d){case"delete":zo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":zo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":zo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Po(void 0,!0);break;case"paste":await Vr();break}},scrollTo:kt,remeasureColumns:d=>{for(const p of d)ar(p+H)}}),[ho,ar,Po,zo,Vr,H,kt]);const[Di,Ii]=pn??[],ss=l.useCallback(d=>{const[p,b]=d;if(b===-1){ae!=="none"&&(q(ot.fromSingleSelection(p),void 0,!1),Nt());return}Di===p&&Ii===b||(K({cell:d,range:{x:p,y:b,width:1,height:1}},!0,!1,"keyboard-nav"),kt(p,b))},[ae,Nt,kt,Di,Ii,K,q]),[as,cs]=l.useState(!1),Fi=l.useRef(cl(d=>{cs(d)},5)),ds=l.useCallback(()=>{Fi.current(!0),z.current===void 0&&z.columns.length===0&&z.rows.length===0&&c===void 0&&K({cell:[H,rr],range:{x:H,y:rr,width:1,height:1}},!0,!1,"keyboard-select")},[rr,z,c,H,K]),us=l.useCallback(()=>{Fi.current(!1)},[]),[fs,hs]=l.useMemo(()=>{let d;const p=(ht==null?void 0:ht.scrollbarWidthOverride)??ri(),b=v+(gt?1:0);if(typeof $t=="number")d=Ie+b*$t;else{let F=0;const N=Math.min(b,10);for(let L=0;L<N;L++)F+=$t(L);F=Math.floor(F/N),d=Ie+b*F}d+=p;const I=Ae.reduce((F,N)=>N.width+F,0)+p;return[`${Math.min(1e5,I)}px`,`${Math.min(1e5,d)}px`]},[Ae,ht==null?void 0:ht.scrollbarWidthOverride,$t,v,gt,Ie]),gs=l.useMemo(()=>la(G),[G]);return l.createElement(Rl.Provider,{value:G},l.createElement(Vc,{style:gs,className:fe,inWidth:k??fs,inHeight:M??hs},l.createElement(Dc,{fillHandle:dt,drawFocusRing:It,experimental:ht,fixedShadowX:Go,fixedShadowY:Tn,getRowThemeOverride:h,headerIcons:Rn,imageWindowLoader:En,initialSize:eo,isDraggable:qo,onDragLeave:jo,onRowMoved:yn,overscrollX:Hr,overscrollY:nr,preventDiagonalScrolling:oo,rightElement:Kn,rightElementProps:Hn,smoothScrollX:Jo,smoothScrollY:Dr,className:fe,enableGroups:nt,onCanvasFocused:ds,onCanvasBlur:us,canvasRef:s,onContextMenu:es,theme:G,cellXOffset:_n,cellYOffset:rr,accessibilityHeight:Ct.height,onDragEnd:jl,columns:Ae,nonGrowWidth:he,drawHeader:Pr,onColumnProposeMove:E,drawCell:Br,disabledRows:os,freezeColumns:ls,lockColumns:H,firstColAccessible:H===0,getCellContent:qt,minColumnWidth:Ut,maxColumnWidth:an,searchInputRef:a,showSearch:Io,onSearchClose:Ar,highlightRegions:Nl,getCellsForSelection:Et,getGroupDetails:Wr,headerHeight:so,isFocused:as,groupHeaderHeight:nt?Do:0,freezeTrailingRows:Ge+(gt&&(Ne==null?void 0:Ne.sticky)===!0?1:0),hasAppendRow:gt,onColumnResize:dn,onColumnResizeEnd:zr,onColumnResizeStart:co,onCellFocused:ss,onColumnMoved:Gl,onDragStart:ql,onHeaderMenuClick:_l,onItemHovered:_r,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:Ul,onKeyDown:zo,onKeyUp:Ze,onMouseDown:Xl,onMouseUp:Kl,onDragOverCell:sn,onDrop:Ye,onSearchResultsChanged:ns,onVisibleRegionChanged:Vl,clientSize:ie,rowHeight:$t,searchResults:pe,searchValue:xe,onSearchValueChange:ke,rows:zt,scrollRef:u,selection:z,translateX:Ct.tx,translateY:Ct.ty,verticalBorder:rs,gridRef:Yt,getCellRenderer:oe}),is,r!==void 0&&l.createElement(l.Suspense,{fallback:null},l.createElement(Qc,{...r,validateCell:Fo,bloom:D,id:Ql,getCellRenderer:oe,className:(ht==null?void 0:ht.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:ct,imageEditorOverride:g,onFinishEditing:Jl,markdownDivCreateNode:y,isOutsideClick:Qo}))))},od=l.forwardRef(nd),il=20,rd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:J.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>id(e,e.cell.data,oi(e.cell),e.cell.maxSize??il),onDelete:e=>({...e,data:!1}),onClick:e=>{const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:a,height:s,x:c,y:f}=r,u=t.maxSize??il,w=Math.floor(r.y+s/2),m=hl(u,s,i.cellVerticalPadding),g=fl(t.contentAlign??"center",c,a,i.cellHorizontalPadding,m),h=ul(g,w,m),y=gl(c+n,f+o,h);if(oi(t)&&y)return{...t,data:$l(t.data)}},onPaste:(e,t)=>{let n=pr;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=ci),n===t.data?void 0:{...t,data:n}}};function id(e,t,n,o){if(!n&&t===pr)return;const{ctx:r,hoverAmount:i,theme:a,rect:s,highlighted:c,hoverX:f,hoverY:u,cell:{contentAlign:w}}=e,{x:m,y:g,width:h,height:y}=s,k=.35;let M=n?1-k+k*i:.4;t===pr&&(M*=i),M!==0&&(r.globalAlpha=M,mi(r,a,t,m,g,h,y,c,f,u,o,w),r.globalAlpha=1)}const ld=Qt("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),sd=e=>{const{bubbles:t}=e;return l.createElement(ld,null,t.map((n,o)=>l.createElement("div",{key:o,className:"boe-bubble"},n)),l.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},ad=sd,cd={getAccessibilityString:e=>ml(e.data),kind:J.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r).width+o+20,0)+2*n.cellHorizontalPadding-4,draw:e=>ud(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return l.createElement(ad,{bubbles:t.data})},onPaste:()=>{}},dd=4;function ud(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:a,y:s,width:c,height:f}=n,u=20,w=8,m=dd;let g=a+o.cellHorizontalPadding;const h=[];for(const y of t){if(g>a+c)break;const k=_o(y,r,o.baseFontFull).width;h.push({x:g,width:k}),g+=k+w*2+m}r.beginPath();for(const y of h)xn(r,y.x,s+(f-u)/2,y.width+w*2,u,o.roundingRadius??u/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[y,k]of h.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[y],k.x+w,s+f/2+Xn(r,o))}const fd=Qt("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),hd=e=>{const{drilldowns:t}=e;return l.createElement(fd,null,t.map((n,o)=>l.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&l.createElement("img",{src:n.img}),l.createElement("div",null,n.text))))},gd=hd,md={getAccessibilityString:e=>ml(e.data.map(t=>t.text)),kind:J.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+20+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>bd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return l.createElement(gd,{drilldowns:t.data})},onPaste:()=>{}},wd=4,ei={};function yd(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,a=n-i*2,s=4,c=n*r,f=o+i,u=o*3,w=(u+i*2)*r,m=`${e},${t},${r},${n}`;if(ei[m]!==void 0)return{el:ei[m],height:c,width:w,middleWidth:s*r,sideWidth:f*r,padding:i*r,dpr:r};const g=document.createElement("canvas"),h=g.getContext("2d");return h===null?null:(g.width=w,g.height=c,h.scale(r,r),ei[m]=g,h.beginPath(),xn(h,i,i,u,a,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),xn(h,i+.5,i+.5,u,a,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:g,height:c,width:w,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function bd(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:a,row:s}=e,{x:c,width:f}=n,u=o.baseFontFull,w=Cl(r,u),m=Math.min(n.height,Math.max(16,Math.ceil(w*o.lineHeight)*2)),g=Math.floor(n.y+(n.height-m)/2),h=m-10,y=8,k=wd;let M=c+o.cellHorizontalPadding;const C=o.roundingRadius??6,v=yd(o.bgCell,o.drilldownBorder,m,C),A=[];for(const P of t){if(M>c+f)break;const T=_o(P.text,r,u).width;let X=0;P.img!==void 0&&i.loadOrGetImage(P.img,a,s)!==void 0&&(X=h-8+4);const R=T+X+y*2;A.push({x:M,width:R}),M+=R+k}if(v!==null){const{el:P,height:O,middleWidth:T,sideWidth:X,width:R,dpr:W,padding:B}=v,D=X/W,S=B/W;for(const E of A){const Z=Math.floor(E.x),te=Math.floor(E.width),le=te-(D-S)*2;r.imageSmoothingEnabled=!1,r.drawImage(P,0,0,X,O,Z-S,g,D,m),le>0&&r.drawImage(P,X,0,T,O,Z+(D-S),g,le,m),r.drawImage(P,R-X,0,X,O,Z+te-(D-S),g,D,m),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[P,O]of A.entries()){const T=t[P];let X=O.x+y;if(T.img!==void 0){const R=i.loadOrGetImage(T.img,a,s);if(R!==void 0){const W=h-8;let B=0,D=0,S=R.width,E=R.height;S>E?(B+=(S-E)/2,S=E):E>S&&(D+=(E-S)/2,E=S),r.beginPath(),xn(r,X,g+m/2-W/2,W,W,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(R,B,D,S,E,X,g+m/2-W/2,W,W),r.restore(),X+=W+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(T.text,X,g+m/2+Xn(r,o))}}const pd={getAccessibilityString:e=>e.data.join(", "),kind:J.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>vd(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??Bs;return l.createElement(r,{urls:t.data,canWrite:t.readonly!==!1,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},ti=4;function vd(e,t,n,o){const{rect:r,col:i,row:a,theme:s,ctx:c,imageLoader:f}=e,{x:u,y:w,height:m,width:g}=r,h=m-s.cellVerticalPadding*2,y=[];let k=0;for(let C=0;C<t.length;C++){const v=t[C];if(v.length===0)continue;const A=f.loadOrGetImage(v,i,a);if(A!==void 0){y[C]=A;const P=A.width*(h/A.height);k+=P+ti}}if(k===0)return;k-=ti;let M=u+s.cellHorizontalPadding;o==="right"?M=Math.floor(u+g-s.cellHorizontalPadding-k):o==="center"&&(M=Math.floor(u+g/2-k/2));for(const C of y){if(C===void 0)continue;const v=C.width*(h/C.height);n>0&&(c.beginPath(),xn(c,M,w+s.cellVerticalPadding,v,h,n),c.save(),c.clip()),c.drawImage(C,M,w+s.cellVerticalPadding,v,h),n>0&&c.restore(),M+=v+ti}}function Cd(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const kd={getAccessibilityString:()=>"",kind:J.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:a}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(Cd(n,o)*t.skeletonWidthVariability));const c=a.cellHorizontalPadding,f=t.skeletonHeight??Math.min(18,i.height-2*a.cellVerticalPadding);xn(r,i.x+c,i.y+(i.height-f)/2,s,f,a.roundingRadius??3),r.fillStyle=Jn(a.textDark,.1),r.fill()},onPaste:()=>{}},xd=()=>e=>e.targetWidth,ll=Qt("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[xd(),"px"]}}),Sd=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:a,validatedSelection:s}=e,c=t.data,f=t.readonly===!0,[u,w]=l.useState(c===""||o),m=l.useCallback(()=>{w(h=>!h)},[]),g=c?"gdg-ml-6":"";return u?l.createElement(ll,{targetWidth:i.width-20},l.createElement(Mr,{autoFocus:!0,highlight:!1,validatedSelection:s,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),l.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${g}`,onClick:()=>a(t)},l.createElement(Fs,null))):l.createElement(ll,{targetWidth:i.width},l.createElement(Ws,{contents:c,createNode:r}),!f&&l.createElement(l.Fragment,null,l.createElement("div",{className:"spacer"}),l.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${g}`,onClick:m},l.createElement(di,null))),l.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Md={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:Vo,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>kn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:a,validatedSelection:s}=e;return l.createElement(Sd,{onFinish:r,targetRect:o,value:n,validatedSelection:s,onChange:c=>t({...n,data:c.target.value}),forceEditMode:a,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Rd={getAccessibilityString:e=>e.row.toString(),kind:ln.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Ed,measure:()=>44,draw:e=>Id(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:a}=t,s=n.drawHandle?7+(i-7)/2:i/2,c=a/2;if(Math.abs(o-s)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Ed(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=Dd,n.textAlign="center",i}function Dd(e){const{ctx:t}=e;t.textAlign="start"}function Id(e,t,n,o,r,i){const{ctx:a,rect:s,hoverAmount:c,theme:f}=e,{x:u,y:w,width:m,height:g}=s,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){a.globalAlpha=h;const y=7*(n?c:1);if(mi(a,f,n,r?u+y:u,w,r?m-y:m,g,!0,void 0,void 0,18,"center",i),r){a.globalAlpha=c,a.beginPath();for(const k of[3,6])for(const M of[-5,-1,3])a.rect(u+k,w+g/2+M,2,2);a.fillStyle=f.textLight,a.fill(),a.beginPath()}a.globalAlpha=1}if(o==="number"||o==="both"&&!n){const y=t.toString(),k=f.markerFontFull,M=u+m/2;o==="both"&&c!==0&&(a.globalAlpha=1-c),a.fillStyle=f.textLight,a.font=k,a.fillText(y,M,w+g/2+Xn(a,k)),c!==0&&(a.globalAlpha=1)}}const Fd={getAccessibilityString:()=>"",kind:ln.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>Td(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function Td(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:a,spriteManager:s}=e,{x:c,y:f,width:u,height:w}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,f+1,u,w-2),o.fillStyle=a.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let g=0;if(n!==void 0){const y=w-8,k=c+8/2,M=f+8/2;s.drawSprite(n,"normal",o,k,M,y,a,m?1:i),g=y}else{g=24;const h=12,y=m?h:i*h,k=m?0:(1-i)*h*.5,M=a.cellHorizontalPadding+4;y>0&&(o.moveTo(c+M+k,f+w/2),o.lineTo(c+M+k+y,f+w/2),o.moveTo(c+M+k+y*.5,f+w/2-y*.5),o.lineTo(c+M+k+y*.5,f+w/2+y*.5),o.lineWidth=2,o.strokeStyle=a.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=a.textMedium,o.fillText(t,g+c+a.cellHorizontalPadding+.5,f+w/2+Xn(o,a)),o.beginPath()}const Hd=l.lazy(async()=>await al(()=>import("./number-overlay-editor-3ljU3NGx.js"),__vite__mapDeps([8,1,3,9]),import.meta.url)),Ld={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Number,needsHover:!1,needsHoverPosition:!1,useLabel:!0,drawPrep:Vo,draw:e=>kn(e,e.cell.displayData,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return l.createElement(l.Suspense,{fallback:null},l.createElement(Hd,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},Ad={getAccessibilityString:()=>"",measure:()=>108,kind:J.Protected,needsHover:!1,needsHoverPosition:!1,draw:zd,onPaste:()=>{}};function zd(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:a}=o;t.beginPath();const s=2.5;let c=r+n.cellHorizontalPadding+s;const f=i+a/2,u=Math.cos(Oi(30))*s,w=Math.sin(Oi(30))*s;for(let m=0;m<12;m++)t.moveTo(c,f-s),t.lineTo(c,f+s),t.moveTo(c+u,f-w),t.lineTo(c-u,f+w),t.moveTo(c-u,f-w),t.lineTo(c+u,f+w),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const Pd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>Vo(e,t,e.theme.textLight),draw:e=>kn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return Bt.createElement(Mr,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},Bd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:Vo,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:a,overrideCursor:s}=e,{displayData:c,contentAlign:f,hoverEffect:u,allowWrapping:w}=t;if(u===!0&&n>0){r.textBaseline="alphabetic";const m=a.cellHorizontalPadding,g=a.cellVerticalPadding,h=_o(c,r,a.baseFontFull,"alphabetic"),y=i.height-g,k=Math.min(y,h.actualBoundingBoxAscent*2.5);r.beginPath(),xn(r,i.x+m/2,i.y+(i.height-k)/2+1,h.width+m*3,k-1,a.roundingRadius??4),r.globalAlpha=n,r.fillStyle=Jn(a.textDark,.1),r.fill(),r.globalAlpha=1,r.fillStyle=a.textDark,r.textBaseline="middle",s==null||s("text")}kn(e,c,f,w,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return l.createElement(Mr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:a=>o({...r,data:a.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Od=Qt("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),Wd=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:a}=e,[s,c]=l.useState(!r&&(t===""||o)),f=l.useCallback(()=>{c(!0)},[]);return s?l.createElement(Mr,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):l.createElement(Od,null,l.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},a),!r&&l.createElement("div",{className:"gdg-edit-icon",onClick:f},l.createElement(di,null)),l.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},$d=Wd;function sl(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,a=e.width,s=e.actualBoundingBoxAscent;return o==="right"?r=t.width-a-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-a/2),{x:r,y:i,width:a,height:s}}const Nd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:Vo,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:a,ctx:s}=e,c=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=_o(c,s,n.baseFontFull),w=sl(u,a,n,t.contentAlign),{x:m,y:g,width:h,height:y}=w;if(r>=m-4&&r<=m-4+h+8&&i>=g-4&&i<=g-4+y+8){const k=Xn(s,n.baseFontFull);o("pointer");const M=5,C=g-k;s.beginPath(),s.moveTo(a.x+m,Math.floor(a.y+C+y+M)+.5),s.lineTo(a.x+m+h,Math.floor(a.y+C+y+M)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,kn({...e,rect:{...a,x:a.x-1}},c,t.contentAlign),kn({...e,rect:{...a,x:a.x-2}},c,t.contentAlign),kn({...e,rect:{...a,x:a.x+1}},c,t.contentAlign),kn({...e,rect:{...a,x:a.x+2}},c,t.contentAlign),s.restore()}}s.fillStyle=f?n.linkColor:n.textDark,kn(e,c,t.contentAlign)},onClick:e=>{const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,a=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return;const s=Js(a,i.baseFontFull);if(s===void 0)return;const c=sl(s,n,i,t.contentAlign);Er({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)&&t.onClickUri(e)},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return l.createElement($d,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:a=>n({...o,data:a.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Xd=[Rd,Fd,rd,cd,md,pd,kd,Md,Ld,Ad,Pd,Bd,Nd],ni=[];class Yd extends xl{constructor(){super(...arguments);We(this,"imageLoaded",()=>{});We(this,"loadedLocations",[]);We(this,"cache",{});We(this,"sendLoaded",ks(()=>{this.imageLoaded(new Yo(this.loadedLocations)),this.loadedLocations=[]},20));We(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let a=0;a<r.cells.length;a++){const s=r.cells[a];if(this.isInWindow(s)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let a=!1;const s=ni.pop()??new Image;let c=!1;const f={img:void 0,cells:[wn(o,r)],url:n,cancel:()=>{c||(c=!0,ni.length<12?ni.unshift(s):a||(s.src=""))}},u=new Promise(w=>s.addEventListener("load",()=>w(null)));requestAnimationFrame(async()=>{try{s.src=n,await u,await s.decode();const w=this.cache[i];if(w!==void 0&&!c){w.img=s;for(const m of w.cells)this.loadedLocations.push(gi(m));a=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,a=this.cache[i];if(a!==void 0){const s=wn(o,r);return a.cells.includes(s)||a.cells.push(s),a.img}else this.loadImage(n,o,r,i)}}const Kd=Yd,Ud=(e,t)=>{const n=l.useMemo(()=>({...Ba,...e.headerIcons}),[e.headerIcons]),o=l.useMemo(()=>e.imageWindowLoader??new Kd,[e.imageWindowLoader]);return l.createElement(od,{...e,renderers:Xd,headerIcons:n,ref:t,imageWindowLoader:o})},ou=l.forwardRef(Ud);export{Ic as C,ou as D,J as G,Rl as T,Mr as a,Jt as b,eu as c,tu as d,Jd as e,po as f,Xn as g,zi as h,Qd as i,vo as j,Rs as k,la as l,_o as m,xo as p,xn as r,nu as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./data-grid-overlay-editor-6WKZfUKe.js","./index-BMVQvedj.js","./index-wocATsGp.js","./marked.esm-dbrxtycE.js","./iframe-ni8xiI1Q.js","./throttle-7EuXLZa7.js","./_baseIteratee-WTHxv43n.js","./flatten-qRvRBp6y.js","./number-overlay-editor-3ljU3NGx.js","./react-number-format.es-2Vaki8Uh.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}