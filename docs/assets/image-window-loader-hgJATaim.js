var Hi=Object.defineProperty;var Bi=(e,t,n)=>t in e?Hi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ee=(e,t,n)=>(Bi(e,typeof t!="symbol"?t+"":t,n),n);import{a as Ge,j as Y,F as Rn,s as mt,b as Ti}from"./marked.esm-dbrxtycE.js";import{r as M,R as _n}from"./index-BMVQvedj.js";import{h as Ri,d as Li,v as Wi,_ as Ni,g as zi,c as mn,r as Oi,j as Xi,t as $i}from"./throttle-7EuXLZa7.js";import{_ as Yi}from"./iframe-ni8xiI1Q.js";function Yo(e="This should not happen"){throw new Error(e)}function ht(e,t="Assertion failed"){if(!e)return Yo(t)}function Un(e,t){return Yo(t??"Hell froze over")}function Ks(e,t){try{return e()}catch{return t}}const vo=Object.prototype.hasOwnProperty;function Nt(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Nt(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(vo.call(e,n)&&++o&&!vo.call(t,n)||!(n in t)||!Nt(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const yn=null,qn=void 0;var le=(e=>(e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom",e))(le||{}),_i=(e=>(e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e))(_i||{}),Ln=(e=>(e.Triangle="triangle",e.Dots="dots",e))(Ln||{});function Gs(e){return"width"in e&&typeof e.width=="number"}async function Js(e){return typeof e=="object"?e:await e()}function Ui(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown")}function Qs(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown"||e.kind==="boolean"||e.kind==="image"||e.kind==="custom")}function _o(e){return e.kind==="marker"||e.kind==="new-row"}function qi(e){if(!Ui(e)||e.kind==="image")return!1;if(e.kind==="text"||e.kind==="number"||e.kind==="markdown"||e.kind==="uri"||e.kind==="custom"||e.kind==="boolean")return e.readonly!==!0;Un(e,"A cell was passed with an invalid kind")}function Zs(e){return Ri(e,"editor")}function Wn(e){return!(e.readonly??!1)}var Gt=(e=>(e.NewRow="new-row",e.Marker="marker",e))(Gt||{});function ji(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,i){return o[0]-i[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const i=n[n.length-1];i[1]<o[0]?n.push([...o]):i[1]<o[1]&&(i[1]=o[1])}return n}let po;const ft=class ft{constructor(t){this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new ft(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=ji([...this.items,n]);return new ft(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],i=typeof t=="number"?t+1:t[1];for(const[r,l]of n.entries()){const[s,a]=l;if(s<=i&&o<=a){const d=[];s<o&&d.push([s,o]),i<a&&d.push([i,a]),n.splice(r,1,...d)}}return new ft(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,i]=this.items[n];if(t>=o&&t<i)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],i=this.items[n];if(o[0]!==i[0]||o[1]!==i[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let i=n;i<o;i++)t.push(i);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};ee(ft,"empty",()=>po??(po=new ft([]))),ee(ft,"fromSingleSelection",t=>ft.empty().add(t));let Nn=ft;function Ke(e,t,n,o,i=!1){const r=M.useRef();r.current=t,M.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=a=>{var d;(d=r.current)==null||d.call(l,a)};return l.addEventListener(e,s,{passive:o,capture:i}),()=>{l.removeEventListener(e,s,{capture:i})}},[e,n,o,i])}function el(e,t){return e===void 0?void 0:t}const Vi=Math.PI;function wo(e){return e*Vi/180}const Uo=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),qo=(e,t,n,o,i)=>{switch(e){case"left":return Math.floor(t)+o+i/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-i/2}},jo=(e,t,n)=>Math.min(e,t-n*2),Vo=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,jn=e=>{const t=e.fgColor??"currentColor";return Ge("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Y("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),Y("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"})]})},Ki=e=>{const t=e.fgColor??"currentColor";return Y("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Y("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})};function Gi(e,t,n){const[o,i]=M.useState(e),r=M.useRef(!0);M.useEffect(()=>()=>{r.current=!1},[]);const l=M.useRef(Li(s=>{r.current&&i(s)},n));return M.useLayoutEffect(()=>{r.current&&l.current(()=>e())},t),o}const Ji="֑-߿יִ-﷽ﹰ-ﻼ",Qi="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",Zi=new RegExp("^[^"+Qi+"]*["+Ji+"]");function Vn(e){return Zi.test(e)?"rtl":"not-rtl"}let fn;function ko(){if(typeof document>"u")return 0;if(fn!==void 0)return fn;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),fn=n-o,fn}const Dt=Symbol();function tl(e){const t=M.useRef([Dt,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=M.useState(e),[,i]=M.useState(),r=M.useCallback(s=>{const a=t.current[0];a!==Dt&&(s=typeof s=="function"?s(a):s,s===a)||(a!==Dt&&i({}),o(d=>typeof s=="function"?s(a===Dt?d:a):s),t.current[0]=Dt)},[]),l=M.useCallback(()=>{t.current[0]=Dt,i({})},[]);return[t.current[0]===Dt?n:t.current[0],r,l]}function Ko(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function nl(e){const t=M.useRef(e);return Nt(e,t.current)||(t.current=e),t.current}function er(e,t){return _n.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked})),[e,t])}function ol(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(hn(e.current.cell,t))return!0;const i=[e.current.range,...e.current.rangeStack];for(const r of i)if(n>=r.x&&n<r.x+r.width&&o>=r.y&&o<r.y+r.height)return!0}return!1}function zn(e,t){return(e??"")===(t??"")}function tr(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function nr(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function hn(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Go(e){return[e.x+e.width-1,e.y+e.height-1]}function xo(e,t,n){const o=n.x,i=n.x+n.width-1,r=n.y,l=n.y+n.height-1,[s,a]=e;if(a<r||a>l)return!1;if(t.span===void 0)return s>=o&&s<=i;const[d,u]=t.span;return d>=o&&d<=i||u>=o&&d<=i||d<o&&u>i}function or(e,t,n,o){let i=0;if(n.current===void 0)return i;const r=n.current.range;(o||r.height*r.width>1)&&xo(e,t,r)&&i++;for(const l of n.current.rangeStack)xo(e,t,l)&&i++;return i}function Jo(e,t){let n=e;if(t!==void 0){let o=[...e];const i=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,i)):(o.splice(t.dest+1,0,i),o.splice(t.src,1)),o=o.map((r,l)=>({...r,sticky:e[l].sticky})),n=o}return n}function zt(e,t){let n=0;const o=Jo(e,t);for(let i=0;i<o.length;i++){const r=o[i];if(r.sticky)n+=r.width;else break}return n}function Ot(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let i=e-t;i<e;i++)o+=n(i);return o}}function On(e,t,n,o,i){const r=Jo(e,o),l=[];for(const d of r)if(d.sticky)l.push(d);else break;if(l.length>0)for(const d of l)n-=d.width;let s=t,a=i??0;for(;a<=n&&s<r.length;)a+=r[s].width,s++;for(let d=t;d<s;d++){const u=r[d];u.sticky||l.push(u)}return l}function ir(e,t,n){let o=0;for(const i of t){const r=i.sticky?o:o+(n??0);if(e<=r+i.width)return i.sourceIndex;o+=i.width}return-1}function rr(e,t,n,o,i,r,l,s,a,d){const u=o+i;if(n&&e<=i)return-2;if(e<=u)return-1;let g=t;for(let c=0;c<d;c++){const h=r-1-c,b=typeof l=="number"?l:l(h);if(g-=b,e>=g)return h}const m=r-d,f=e-(a??0);if(typeof l=="number"){const c=Math.floor((f-u)/l)+s;return c>=m?void 0:c}else{let c=u;for(let h=s;h<m;h++){const b=l(h);if(f<=c+b)return h;c+=b}return}}let gn=0,Vt={};const sr=typeof window>"u";async function lr(){var e;sr||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,gn=0,Vt={},Wi())}lr();function Qo(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Qt(e,t,n,o="middle"){const i=Qo(e,t,o,n);let r=Vt[i];return r===void 0&&(r=t.measureText(e),Vt[i]=r,gn++),gn>1e4&&(Vt={},gn=0),r}function ar(e,t){const n=Qo(e,void 0,"middle",t);return Vt[n]}function kt(e,t){return typeof t!="string"&&(t=t.baseFontFull),cr(e,t)}function Co(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const So=[];function cr(e,t){for(const r of So)if(r.key===t)return r.val;const n=Co(e,"alphabetic"),i=-(Co(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return So.push({key:t,val:i}),i}function dr(e,t,n,o,i,r){const{ctx:l,rect:s,theme:a}=e;let d=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(d=n-t,d<u)){const g=1-d/u;l.globalAlpha=g,l.fillStyle=a.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(i?2:1),s.height-(r?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=a.bgSearchResult)}return d<u}function Zt(e,t,n){const{ctx:o,theme:i}=e,r=t??{},l=n??i.textDark;return l!==r.fillStyle&&(o.fillStyle=l,r.fillStyle=l),r}function Zo(e,t,n,o,i,r,l,s,a){a==="right"?e.fillText(t,n+i-(s.cellHorizontalPadding+.5),o+r/2+l):a==="center"?e.fillText(t,n+i/2,o+r/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+r/2+l)}function ei(e,t){const n=Qt("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function ur(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function fr(e,t,n,o,i,r,l,s,a,d){const u=s.baseFontFull,g=Ni(e,t,u,i-s.cellHorizontalPadding*2,d??!1),m=ei(e,u),f=s.lineHeight*m,c=m+f*(g.length-1),h=c+s.cellVerticalPadding>r;h&&(e.save(),e.rect(n,o,i,r),e.clip());const b=o+r/2-c/2;let v=Math.max(o+s.cellVerticalPadding,b);for(const S of g)if(Zo(e,S,n,v,i,m,l,s,a),v+=f,v>o+r)break;h&&e.restore()}function gt(e,t,n,o,i){const{ctx:r,rect:l,theme:s}=e,{x:a,y:d,width:u,height:g}=l;o=o??!1,o||(t=ur(t,u));const m=kt(r,s),f=Vn(t)==="rtl";if(n===void 0&&f&&(n="right"),f&&(r.direction="rtl"),t.length>0){let c=!1;n==="right"?(r.textAlign="right",c=!0):n!==void 0&&n!=="left"&&(r.textAlign=n,c=!0),o?fr(r,t,a,d,u,g,m,s,n,i):Zo(r,t,a,d,u,g,m,s,n),c&&(r.textAlign="start"),f&&(r.direction="inherit")}}function at(e,t,n,o,i,r){typeof r=="number"&&(r={tl:r,tr:r,br:r,bl:r}),r={tl:Math.max(0,Math.min(r.tl,i/2,o/2)),tr:Math.max(0,Math.min(r.tr,i/2,o/2)),bl:Math.max(0,Math.min(r.bl,i/2,o/2)),br:Math.max(0,Math.min(r.br,i/2,o/2))},e.moveTo(t+r.tl,n),e.arcTo(t+o,n,t+o,n+r.tr,r.tr),e.arcTo(t+o,n+i,t+o-r.br,n+i,r.br),e.arcTo(t,n+i,t,n+i-r.bl,r.bl),e.arcTo(t,n,t+r.tl,n,r.tl)}function hr(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function gr(e,t,n){const o=function(s,a){const d=a.x-s.x,u=a.y-s.y,g=Math.sqrt(d*d+u*u),m=d/g,f=u/g;return{x:d,y:a.y-s.y,len:g,nx:m,ny:f,ang:Math.atan2(f,m)}};let i;const r=t.length;let l=t[r-1];for(let s=0;s<r;s++){let a=t[s%r];const d=t[(s+1)%r],u=o(a,l),g=o(a,d),m=u.nx*g.ny-u.ny*g.nx,f=u.nx*g.nx-u.ny*-g.ny;let c=Math.asin(m<-1?-1:m>1?1:m),h=1,b=!1;f<0?c<0?c=Math.PI+c:(c=Math.PI-c,h=-1,b=!0):c>0&&(h=-1,b=!0),i=a.radius!==void 0?a.radius:n;const v=c/2;let S=Math.abs(Math.cos(v)*i/Math.sin(v)),C;S>Math.min(u.len/2,g.len/2)?(S=Math.min(u.len/2,g.len/2),C=Math.abs(S*Math.sin(v)/Math.cos(v))):C=i;let E=a.x+g.nx*S,D=a.y+g.ny*S;E+=-g.ny*C*h,D+=g.nx*C*h,e.arc(E,D,C,u.ang+Math.PI/2*h,g.ang-Math.PI/2*h,b),l=a,a=d}e.closePath()}function Xn(e,t,n,o,i,r,l,s,a,d,u,g,m,f,c){const h={x:0,y:r+d,width:0,height:0};if(e>=f.length||t>=u||t<-2||e<0)return h;const b=r-i;if(e>=g){const v=l>e?-1:1,S=zt(f);h.x+=S+a;for(let C=l;C!==e;C+=v)h.x+=f[v===1?C:C-1].width*v}else for(let v=0;v<e;v++)h.x+=f[v].width;if(h.width=f[e].width+1,t===-1)h.y=i,h.height=b;else if(t===-2){h.y=0,h.height=i;let v=e;const S=f[e].group,C=f[e].sticky;for(;v>0&&zn(f[v-1].group,S)&&f[v-1].sticky===C;){const D=f[v-1];h.x-=D.width,h.width+=D.width,v--}let E=e;for(;E+1<f.length&&zn(f[E+1].group,S)&&f[E+1].sticky===C;){const D=f[E+1];h.width+=D.width,E++}if(!C){const D=zt(f),A=h.x-D;A<0&&(h.x-=A,h.width+=A),h.x+h.width>n&&(h.width=n-h.x)}}else if(t>=u-m){let v=u-t;for(h.y=o;v>0;){const S=t+v-1;h.height=typeof c=="number"?c:c(S),h.y-=h.height,v--}h.height+=1}else{const v=s>t?-1:1;if(typeof c=="number"){const S=t-s;h.y+=S*c}else for(let S=s;S!==t;S+=v)h.y+=c(S)*v;h.height=(typeof c=="number"?c:c(t))+1}return h}const Kn=1<<21;function rt(e,t){return(t+2)*Kn+e}function ti(e){return e%Kn}function Gn(e){return Math.floor(e/Kn)-2}function Jn(e){const t=ti(e),n=Gn(e);return[t,n]}class ni{constructor(){ee(this,"visibleWindow",{x:0,y:0,width:0,height:0});ee(this,"freezeCols",0);ee(this,"freezeRows",[]);ee(this,"isInWindow",t=>{const n=ti(t),o=Gn(t),i=this.visibleWindow,r=n>=i.x&&n<=i.x+i.width||n<this.freezeCols,l=o>=i.y&&o<=i.y+i.height||this.freezeRows.includes(o);return r&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Nt(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class mr extends ni{constructor(){super(...arguments);ee(this,"cache",new Map);ee(this,"setValue",(n,o)=>{this.cache.set(rt(n[0],n[1]),o)});ee(this,"getValue",n=>this.cache.get(rt(n[0],n[1])));ee(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Kt{constructor(t=[]){ee(this,"cells");this.cells=new Set(t.map(n=>rt(n[0],n[1])))}add(t){this.cells.add(rt(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(rt(t[0],t[1]))}remove(t){this.cells.delete(rt(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Gn(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(rt(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Jn(t)}}function yr(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class br{constructor(t,n){ee(this,"spriteMap",new Map);ee(this,"headerIcons");ee(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,i,r,l,s,a=1){const[d,u]=yr(n,s),g=l*Math.ceil(window.devicePixelRatio),m=`${d}_${u}_${g}_${t}`;let f=this.spriteMap.get(m);if(f===void 0){const c=this.headerIcons[t];if(c===void 0)return;f=document.createElement("canvas");const h=f.getContext("2d");if(h===null)return;const b=new Image;b.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(c({fgColor:u,bgColor:d}))}`,this.spriteMap.set(m,f);const v=b.decode();if(v===void 0)return;this.inFlight++,v.then(()=>{h.drawImage(b,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(o.globalAlpha=a),o.drawImage(f,0,0,g,g,i,r,l,l),a<1&&(o.globalAlpha=1)}}const Fn={};let wt=null;function vr(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function $n(e){const t=e.toLowerCase().trim();if(Fn[t]!==void 0)return Fn[t];wt=wt||vr(),wt.style.color="#000",wt.style.color=t;const n=getComputedStyle(wt).color;wt.style.color="#fff",wt.style.color=t;const o=getComputedStyle(wt).color;if(o!==n)return[0,0,0,1];let i=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return i.length<4&&i.push(1),i=i.map(r=>Number.isNaN(r)?0:r),Fn[t]=i,i}function en(e,t){const[n,o,i]=$n(e);return`rgba(${n}, ${o}, ${i}, ${t})`}const Mo=new Map;function Io(e,t){const n=`${e}-${t}`,o=Mo.get(n);if(o!==void 0)return o;const i=Ue(e,t);return Mo.set(n,i),i}function Ue(e,t){if(t===void 0)return e;const[n,o,i,r]=$n(e);if(r===1)return e;const[l,s,a,d]=$n(t),u=r+d*(1-r),g=(r*n+d*l*(1-r))/u,m=(r*o+d*s*(1-r))/u,f=(r*i+d*a*(1-r))/u;return`rgba(${g}, ${m}, ${f}, ${u})`}function oi(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function vn(e,t,n,o,i,r,l,s,a){s=s??t;let d=t,u=e;const g=o-r;let m=!1;for(;d<n&&u<g;){const f=i(u);if(d+f>s&&a(d,u,f,!1,l&&u===o-1)===!0){m=!0;break}d+=f,u++}if(!m){d=n;for(let f=0;f<r;f++){u=o-1-f;const c=i(u);d-=c,a(d,u,c,!0,l&&u===o-1)}}}function xt(e,t,n,o,i,r){let l=0,s=0;const a=i+o;for(const d of e){const u=d.sticky?s:l+n;if(r(d,u,a,d.sticky?0:s+1,t)===!0)break;l+=d.width,s+=d.sticky?d.width:0}}function ii(e,t,n,o,i){let r=0,l=0;for(let s=0;s<e.length;s++){const a=e[s];let d=s+1,u=a.width;for(a.sticky&&(l+=u);d<e.length&&zn(e[d].group,a.group)&&e[d].sticky===e[s].sticky;){const h=e[d];u+=h.width,d++,s++,h.sticky&&(l+=h.width)}const g=a.sticky?0:n,m=r+g,f=a.sticky?0:Math.max(0,l-m),c=Math.min(u-f,t-(m+f));i([a.sourceIndex,e[d-1].sourceIndex],a.group??"",m+f,0,c,o),r+=u}}function ri(e,t,n,o,i,r,l){var m;const[s,a]=e;let d,u;const g=((m=l.find(f=>!f.sticky))==null?void 0:m.sourceIndex)??0;if(a>g){const f=Math.max(s,g);let c=t,h=o;for(let b=r.sourceIndex-1;b>=f;b--)c-=l[b].width,h+=l[b].width;for(let b=r.sourceIndex+1;b<=a;b++)h+=l[b].width;u={x:c,y:n,width:h,height:i}}if(g>s){const f=Math.min(a,g-1);let c=t,h=o;for(let b=r.sourceIndex-1;b>=s;b--)c-=l[b].width,h+=l[b].width;for(let b=r.sourceIndex+1;b<=f;b++)h+=l[b].width;d={x:c,y:n,width:h,height:i}}return[d,u]}function il(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const si={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4};function rl(){return si}const sl=_n.createContext(si);function Jt(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const i in o)o.hasOwnProperty(i)&&(i==="bgCell"?n[i]=Ue(o[i],n[i]):n[i]=o[i]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}function ll(e,t,n,o){if(o==="any")return pr(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),nr([t,n],e))return;const i=t-e.x,r=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,a=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return a===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:a===l?{x:e.x,y:n,width:e.width,height:e.y-n}:a===r?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function bn(e,t,n,o,i,r,l,s){return e<=i+l&&i<=e+n&&t<=r+s&&r<=t+o}function Qn(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function pr(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-n,r=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:i,height:r}}function wr(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function kr(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const i=-4,r=-4,l=t+4,s=n+4,a=i-e.x,d=e.x+e.width-l,u=r-e.y,g=e.y+e.height-s,m=a>0?e.x+Math.floor(a/o)*o:e.x,f=d>0?e.x+e.width-Math.floor(d/o)*o:e.x+e.width,c=u>0?e.y+Math.floor(u/o)*o:e.y,h=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:m,y:c,width:f-m,height:h-c}}function xr(e,t,n,o,i){const[r,l,s,a]=t,[d,u,g,m]=i,{x:f,y:c,width:h,height:b}=e,v=[];if(h<=0||b<=0)return v;const S=f+h,C=c+b,E=f<r,D=c<l,A=f+h>s,P=c+b>a,R=f>=r&&f<s||S>r&&S<=s||f<r&&S>s,x=c>=l&&c<a||C>l&&C<=a||c<l&&C>a;if(R&&x){const I=Math.max(f,r),k=Math.max(c,l),w=Math.min(S,s),p=Math.min(C,a);v.push({rect:{x:I,y:k,width:w-I,height:p-k},clip:{x:d,y:u,width:g-d+1,height:m-u+1}})}if(E&&D){const I=f,k=c,w=Math.min(S,r),p=Math.min(C,l);v.push({rect:{x:I,y:k,width:w-I,height:p-k},clip:{x:0,y:0,width:d+1,height:u+1}})}if(D&&R){const I=Math.max(f,r),k=c,w=Math.min(S,s),p=Math.min(C,l);v.push({rect:{x:I,y:k,width:w-I,height:p-k},clip:{x:d,y:0,width:g-d+1,height:u+1}})}if(D&&A){const I=Math.max(f,s),k=c,w=S,p=Math.min(C,l);v.push({rect:{x:I,y:k,width:w-I,height:p-k},clip:{x:g,y:0,width:n-g+1,height:u+1}})}if(E&&x){const I=f,k=Math.max(c,l),w=Math.min(S,r),p=Math.min(C,a);v.push({rect:{x:I,y:k,width:w-I,height:p-k},clip:{x:0,y:u,width:d+1,height:m-u+1}})}if(A&&x){const I=Math.max(f,s),k=Math.max(c,l),w=S,p=Math.min(C,a);v.push({rect:{x:I,y:k,width:w-I,height:p-k},clip:{x:g,y:u,width:n-g+1,height:m-u+1}})}if(E&&P){const I=f,k=Math.max(c,a),w=Math.min(S,r),p=C;v.push({rect:{x:I,y:k,width:w-I,height:p-k},clip:{x:0,y:m,width:d+1,height:o-m+1}})}if(P&&R){const I=Math.max(f,r),k=Math.max(c,a),w=Math.min(S,s),p=C;v.push({rect:{x:I,y:k,width:w-I,height:p-k},clip:{x:d,y:m,width:g-d+1,height:o-m+1}})}if(A&&P){const I=Math.max(f,s),k=Math.max(c,a),w=S,p=C;v.push({rect:{x:I,y:k,width:w-I,height:p-k},clip:{x:g,y:m,width:n-g+1,height:o-m+1}})}return v}const Cr={kind:le.Loading,allowOverlay:!1};function Eo(e,t,n,o,i,r,l,s,a,d,u,g,m,f,c,h,b,v,S,C,E,D,A,P,R,x,B,I,k,w,p,z,_,q,K){let we=(C==null?void 0:C.size)??Number.MAX_SAFE_INTEGER;const me=performance.now();let de=w.baseFontFull;e.font=de;const ie={ctx:e},ke=[0,0],Be=b>0?Ot(a,b,d):0;let X,Se;const Te=oi(S);return xt(t,s,r,l,i,(ae,Ie,ct,qe,Re)=>{const Le=Math.max(0,qe-Ie),He=Ie+Le,We=i+1,yt=ae.width-Le,Ye=o-i-1;if(S.length>0){let ye=!1;for(let ue=0;ue<S.length;ue++){const T=S[ue];if(bn(He,We,yt,Ye,T.x,T.y,T.width,T.height)){ye=!0;break}}if(!ye)return}const re=()=>{e.save(),e.beginPath(),e.rect(He,We,yt,Ye),e.clip()},je=E.columns.hasIndex(ae.sourceIndex),Ee=g(ae.group??"").overrideTheme,Xe=ae.themeOverride===void 0&&Ee===void 0?w:Jt(w,Ee,ae.themeOverride),ce=Xe.baseFontFull;ce!==de&&(de=ce,e.font=ce),re();let pe;return vn(Re,ct,o,a,d,b,v,Te,(ye,ue,T,G,se)=>{var et,tt,dt;if(ue<0||(ke[0]=ae.sourceIndex,ke[1]=ue,C!==void 0&&!C.has(ke)))return;if(S.length>0){let Q=!1;for(let De=0;De<S.length;De++){const xe=S[De];if(bn(Ie,ye,ae.width,T,xe.x,xe.y,xe.width,xe.height)){Q=!0;break}}if(!Q)return}const V=E.rows.hasIndex(ue),Ne=f.hasIndex(ue),oe=ue<a?u(ke):Cr;let te=Ie,ne=ae.width,Fe=!1,Je=!1;if(oe.span!==void 0){const[Q,De]=oe.span,xe=`${ue},${Q},${De},${ae.sticky}`;if(Se===void 0&&(Se=new Set),Se.has(xe)){we--;return}else{const Ce=ri(oe.span,Ie,ye,ae.width,T,ae,n),Ve=ae.sticky?Ce[0]:Ce[1];if(!ae.sticky&&Ce[0]!==void 0&&(Je=!0),Ve!==void 0){te=Ve.x,ne=Ve.width,Se.add(xe),e.restore(),pe=void 0,e.save(),e.beginPath();const ve=Math.max(0,qe-Ve.x);e.rect(Ve.x+ve,ye,Ve.width-ve,T),X===void 0&&(X=[]),X.push({x:Ve.x+ve,y:ye,width:Ve.width-ve,height:T}),e.clip(),Fe=!0}}}const st=m==null?void 0:m(ue),bt=se&&((et=ae.trailingRowOptions)==null?void 0:et.themeOverride)!==void 0?(tt=ae.trailingRowOptions)==null?void 0:tt.themeOverride:void 0,ze=oe.themeOverride===void 0&&st===void 0&&bt===void 0?Xe:Jt(Xe,st,bt,oe.themeOverride);e.beginPath();const Qe=tr(ke,oe,E);let _e=or(ke,oe,E,h);const Ct=oe.span!==void 0&&E.columns.some(Q=>oe.span!==void 0&&Q>=oe.span[0]&&Q<=oe.span[1]);Qe&&!c&&h?_e=0:Qe&&h&&(_e=Math.max(_e,1)),Ct&&_e++,Qe||(V&&_e++,je&&!se&&_e++);const St=oe.kind===le.Protected?ze.bgCellMedium:ze.bgCell;let be;if((G||St!==w.bgCell)&&(be=Ue(St,be)),_e>0||Ne){Ne&&(be=Ue(ze.bgHeader,be));for(let Q=0;Q<_e;Q++)be=Ue(ze.accentLight,be)}else if(D!==void 0){for(const Q of D)if(Q[0]===ae.sourceIndex&&Q[1]===ue){be=Ue(ze.bgSearchResult,be);break}}if(A!==void 0)for(let Q=0;Q<A.length;Q++){const De=A[Q],xe=De.range;De.style!=="solid-outline"&&xe.x<=ae.sourceIndex&&ae.sourceIndex<xe.x+xe.width&&xe.y<=ue&&ue<xe.y+xe.height&&(be=Ue(De.color,be))}let Mt=!1;if(C!==void 0){const Q=ye+1,xe=(G?Q+T-1:Math.min(Q+T-1,o-Be))-Q;(xe!==T-1||te+1<=qe)&&(Mt=!0,e.save(),e.beginPath(),e.rect(te+1,Q,ne-1,xe),e.clip()),be=be===void 0?ze.bgCell:Ue(be,ze.bgCell)}const he=ae.sourceIndex===n.length-1,$e=ue===a-1;be!==void 0&&(e.fillStyle=be,pe!==void 0&&(pe.fillStyle=be),C!==void 0?e.fillRect(te+1,ye+1,ne-(he?2:1),T-($e?2:1)):e.fillRect(te,ye,ne,T)),oe.style==="faded"&&(e.globalAlpha=.6);let Ze;for(let Q=0;Q<x.length;Q++){const De=x[Q];if(De.item[0]===ae.sourceIndex&&De.item[1]===ue){Ze=De;break}}if(ne>K&&!Je){const Q=ze.baseFontFull;Q!==de&&(e.font=Q,de=Q),pe=li(e,oe,ae.sourceIndex,ue,he,$e,te,ye,ne,T,_e>0,ze,be??ze.bgCell,P,R,(Ze==null?void 0:Ze.hoverAmount)??0,B,k,me,I,pe,p,z,_,q)}return Mt&&e.restore(),oe.style==="faded"&&(e.globalAlpha=1),we--,Fe&&(e.restore(),(dt=pe==null?void 0:pe.deprep)==null||dt.call(pe,ie),pe=void 0,re(),de=ce,e.font=ce),we<=0}),e.restore(),we<=0}),X}const Ut=[0,0],qt={x:0,y:0,width:0,height:0},Dn=[void 0,()=>{}];let Yn=!1;function Sr(){Yn=!0}function li(e,t,n,o,i,r,l,s,a,d,u,g,m,f,c,h,b,v,S,C,E,D,A,P,R){var z,_;let x,B;b!==void 0&&b[0][0]===n&&b[0][1]===o&&(x=b[1][0],B=b[1][1]);let I;Ut[0]=n,Ut[1]=o,qt.x=l,qt.y=s,qt.width=a,qt.height=d,Dn[0]=A.getValue(Ut),Dn[1]=q=>A.setValue(Ut,q),Yn=!1;const k={ctx:e,theme:g,col:n,row:o,cell:t,rect:qt,highlighted:u,cellFillColor:m,hoverAmount:h,frameTime:S,hoverX:x,drawState:Dn,hoverY:B,imageLoader:f,spriteManager:c,hyperWrapping:v,overrideCursor:x!==void 0?R:void 0,requestAnimationFrame:Sr},w=dr(k,t.lastUpdated,S,E,i,r),p=P(t);if(p!==void 0){(E==null?void 0:E.renderer)!==p&&((z=E==null?void 0:E.deprep)==null||z.call(E,k),E=void 0);const q=(_=p.drawPrep)==null?void 0:_.call(p,k,E);C!==void 0&&!_o(k.cell)?C(k,()=>p.draw(k,t)):p.draw(k,t),I=q===void 0?void 0:{deprep:q==null?void 0:q.deprep,fillStyle:q==null?void 0:q.fillStyle,font:q==null?void 0:q.font,renderer:p}}return(w||Yn)&&(D==null||D(Ut)),I}function Zn(e,t,n,o,i,r,l,s,a=-20,d=-20,u=32,g="center",m="square"){const f=Math.floor(i+l/2),c=m==="circle"?1e4:t.roundingRadius??4;let h=jo(u,l,t.cellVerticalPadding),b=h/2;const v=qo(g,o,r,t.cellHorizontalPadding,h),S=Uo(v,f,h),C=Vo(o+a,i+d,S);switch(n){case!0:{e.beginPath(),at(e,v-h/2,f-h/2,h,h,c),m==="circle"&&(b*=.8,h*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(v-b+h/4.23,f-b+h/1.97),e.lineTo(v-b+h/2.42,f-b+h/1.44),e.lineTo(v-b+h/1.29,f-b+h/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case yn:case!1:{e.beginPath(),at(e,v-h/2+.5,f-h/2+.5,h-1,h-1,c),e.lineWidth=1,e.strokeStyle=C?t.textDark:t.textMedium,e.stroke();break}case qn:{e.beginPath(),at(e,v-h/2,f-h/2,h,h,c),e.fillStyle=C?t.textMedium:t.textLight,e.fill(),m==="circle"&&(b*=.8,h*=.8),e.beginPath(),e.moveTo(v-h/3,f),e.lineTo(v+h/3,f),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:Un()}}function Mr(e,t,n,o,i,r,l,s,a,d,u,g,m,f,c,h,b,v,S){const C=l+s;if(C<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,i,C);const[E,D]=(o==null?void 0:o[0])??[],A=g.headerFontFull;e.font=A,xt(t,0,r,0,C,(P,R,x,B)=>{var ie;if(b!==void 0&&!b.has([P.sourceIndex,-1]))return;const I=Math.max(0,B-R);e.save(),e.beginPath(),e.rect(R+I,s,P.width-I,l),e.clip();const k=h(P.group??"").overrideTheme,w=P.themeOverride===void 0&&k===void 0?g:Jt(g,k,P.themeOverride);w.bgHeader!==g.bgHeader&&(e.fillStyle=w.bgHeader,e.fill()),w!==g&&(e.font=w.baseFontFull);const p=u.columns.hasIndex(P.sourceIndex),z=a!==void 0||d,_=!z&&D===-1&&E===P.sourceIndex,q=z?0:((ie=f.find(ke=>ke.item[0]===P.sourceIndex&&ke.item[1]===-1))==null?void 0:ie.hoverAmount)??0,K=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===P.sourceIndex,we=p?w.accentColor:K?w.bgHeaderHasFocus:w.bgHeader,me=n?s:0,de=P.sourceIndex===0?0:1;p?(e.fillStyle=we,e.fillRect(R+de,me,P.width-de,l)):(K||q>0)&&(e.beginPath(),e.rect(R+de,me,P.width-de,l),K&&(e.fillStyle=w.bgHeaderHasFocus,e.fill()),q>0&&(e.globalAlpha=q,e.fillStyle=w.bgHeaderHovered,e.fill(),e.globalAlpha=1)),di(e,R,me,P.width,l,P,p,w,_,K,q,m,v,S),e.restore()}),n&&Ir(e,t,i,r,s,o,g,m,f,c,h,b)}function Ir(e,t,n,o,i,r,l,s,a,d,u,g){const[f,c]=(r==null?void 0:r[0])??[];let h=0;ii(t,n,o,i,(b,v,S,C,E,D)=>{if(g!==void 0&&!g.hasItemInRectangle({x:b[0],y:-2,width:b[1]-b[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(S,C,E,D),e.clip();const A=u(v),P=(A==null?void 0:A.overrideTheme)===void 0?l:Jt(l,A.overrideTheme),R=c===-2&&f!==void 0&&f>=b[0]&&f<=b[1],x=R?P.bgHeaderHovered:P.bgHeader;if(x!==l.bgHeader&&(e.fillStyle=x,e.fill()),e.fillStyle=P.textGroupHeader??P.textHeader,A!==void 0){let B=S;if(A.icon!==void 0&&(s.drawSprite(A.icon,"normal",e,B+8,(i-20)/2,20,P),B+=26),e.fillText(A.name,B+8,i/2+kt(e,l.headerFontFull)),A.actions!==void 0&&R){const I=ci({x:S,y:C,width:E,height:D},A.actions);e.beginPath();const k=I[0].x-10,w=S+E-k;e.rect(k,0,w,i);const p=e.createLinearGradient(k,0,k+w,0),z=en(x,0);p.addColorStop(0,z),p.addColorStop(10/w,x),p.addColorStop(1,x),e.fillStyle=p,e.fill(),e.globalAlpha=.6;const[_,q]=(r==null?void 0:r[1])??[-1,-1];for(let K=0;K<A.actions.length;K++){const we=A.actions[K],me=I[K],de=Qn(me,_+S,q);de&&(e.globalAlpha=1),s.drawSprite(we.icon,"normal",e,me.x+me.width/2-10,me.y+me.height/2-10,20,P),de&&(e.globalAlpha=.6)}e.globalAlpha=1}}S!==0&&d(b[0])&&(e.beginPath(),e.moveTo(S+.5,0),e.lineTo(S+.5,i),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),h=S+E}),e.beginPath(),e.moveTo(h+.5,0),e.lineTo(h+.5,i),e.moveTo(0,i+.5),e.lineTo(n,i+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}const Wt=30;function ai(e,t,n,o,i){return i?{x:e,y:t,width:Wt,height:Math.min(Wt,o)}:{x:e+n-Wt,y:Math.max(t,t+o/2-Wt/2),width:Wt,height:Math.min(Wt,o)}}function ci(e,t){const n=[];let o=e.x+e.width-26*t.length;const i=e.y+e.height/2-13,r=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:i,width:l,height:r}),o+=26;return n}function Fo(e,t,n,o,i,r,l,s,a,d,u,g,m,f){if(r.rowMarker!==void 0){const C=r.rowMarkerChecked;C!==!0&&(e.globalAlpha=d),Zn(e,s,C,t,n,o,i,!1,void 0,void 0,18,"center",r.rowMarker),C!==!0&&(e.globalAlpha=1);return}const c=s.cellHorizontalPadding,h=l?s.textHeaderSelected:s.textHeader,b=r.hasMenu===!0&&(a||g&&l),v=m?-1:1;let S=m?t+o-c:t+c;if(r.icon!==void 0){let C=l?"selected":"normal";r.style==="highlight"&&(C=l?"selected":"special");const E=s.headerIconSize;u.drawSprite(r.icon,C,e,m?S-E:S,n+(i-E)/2,E,s),r.overlayIcon!==void 0&&u.drawSprite(r.overlayIcon,l?"selected":"special",e,m?S-E+9:S+9,n+((i-18)/2+6),18,s),S+=Math.ceil(E*1.3)*v}if(b&&r.hasMenu===!0&&o>35){const E=m?35:o-35,D=m?35*.7:o-35*.7,A=E/o,P=D/o,R=e.createLinearGradient(t,0,t+o,0),x=en(h,0);R.addColorStop(m?1:0,h),R.addColorStop(A,h),R.addColorStop(P,x),R.addColorStop(m?0:1,x),e.fillStyle=R}else e.fillStyle=h;if(m&&(e.textAlign="right"),e.fillText(r.title,S,n+i/2+kt(e,s.headerFontFull)),m&&(e.textAlign="left"),b&&r.hasMenu===!0)if(r.menuIcon===void 0||r.menuIcon===Ln.Triangle){e.beginPath();const C=f.x+f.width/2-5.5,E=f.y+f.height/2-3;gr(e,[{x:C,y:E},{x:C+11,y:E},{x:C+5.5,y:E+6}],1),e.fillStyle=h,e.fill()}else if(r.menuIcon===Ln.Dots){e.beginPath();const C=f.x+f.width/2,E=f.y+f.height/2;hr(e,C,E),e.fillStyle=h,e.fill()}else{const C=f.x+(f.width-s.headerIconSize)/2,E=f.y+(f.height-s.headerIconSize)/2;u.drawSprite(r.menuIcon,"normal",e,C,E,s.headerIconSize,s)}}function di(e,t,n,o,i,r,l,s,a,d,u,g,m,f){const c=Vn(r.title)==="rtl",h=ai(t,n,o,i,c);m!==void 0?m({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:i},column:r,columnIndex:r.sourceIndex,isSelected:l,hoverAmount:u,isHovered:a,hasSelectedCell:d,spriteManager:g,menuBounds:h},()=>Fo(e,t,n,o,i,r,l,s,a,u,g,f,c,h)):Fo(e,t,n,o,i,r,l,s,a,u,g,f,c,h)}function Er(e,t,n,o,i,r,l,s,a,d,u,g,m,f,c,h,b,v,S){if(v!==void 0||t[t.length-1]!==n[t.length-1])return;const C=oi(b);xt(t,a,l,s,r,(E,D,A,P,R)=>{if(E!==t[t.length-1])return;D+=E.width;const x=Math.max(D,P);x>o||(e.save(),e.beginPath(),e.rect(x,r+1,1e4,i-r-1),e.clip(),vn(R,A,i,d,u,c,h,C,(B,I,k,w)=>{if(!w&&b.length>0&&!b.some(K=>bn(D,B,1e4,k,K.x,K.y,K.width,K.height)))return;const p=m.hasIndex(I),z=f.hasIndex(I);e.beginPath();const _=g==null?void 0:g(I),q=_===void 0?S:Jt(S,_);q.bgCell!==S.bgCell&&(e.fillStyle=q.bgCell,e.fillRect(D,B,1e4,k)),z&&(e.fillStyle=q.bgHeader,e.fillRect(D,B,1e4,k)),p&&(e.fillStyle=q.accentLight,e.fillRect(D,B,1e4,k))}),e.restore())})}function Fr(e,t,n,o,i,r,l,s,a){let d=!1;for(const c of t)if(!c.sticky){d=l(c.sourceIndex);break}const u=a.horizontalBorderColor??a.borderColor,g=a.borderColor,m=d?zt(t):0;let f;if(m!==0&&(f=Io(g,a.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=f,e.stroke()),i>0){const c=g===u&&f!==void 0?f:Io(u,a.bgCell),h=Ot(r,i,s);e.beginPath(),e.moveTo(0,o-h+.5),e.lineTo(n,o-h+.5),e.strokeStyle=c,e.stroke()}}const ui=(e,t,n)=>{let o=0,i=t,r=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),i=Math.max(i,s.x+s.width+1),r=Math.min(r,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:i,minY:r,maxY:l}};function Dr(e,t,n,o,i,r,l,s,a,d,u,g,m,f,c){var k;const h=c.bgCell,{minX:b,maxX:v,minY:S,maxY:C}=ui(s,r,l),E=[],D=l-Ot(f,m,d);let A=a,P=n,R=0;for(;A+i<D;){const w=A+i,p=d(P);if(w>=S&&w<=C-1){const z=u==null?void 0:u(P),_=z==null?void 0:z.bgCell;_!==void 0&&_!==h&&P>=f-m&&E.push({x:b,y:w,w:v-b,h:p,color:_})}A+=p,P<f-m&&(R=A),P++}let x=0;const B=Math.min(D,C)-R;if(B>0)for(let w=0;w<t.length;w++){const p=t[w];if(p.width===0)continue;const z=p.sticky?x:x+o,_=(k=p.themeOverride)==null?void 0:k.bgCell;_!==void 0&&_!==h&&z>=b&&z<=v&&g(w+1)&&E.push({x:z,y:R,w:p.width,h:B,color:_}),x+=p.width}if(E.length===0)return;let I;e.beginPath();for(let w=E.length-1;w>=0;w--){const p=E[w];I===void 0?I=p.color:p.color!==I&&(e.fillStyle=I,e.fill(),e.beginPath(),I=p.color),e.rect(p.x,p.y,p.w,p.h)}I!==void 0&&(e.fillStyle=I,e.fill()),e.beginPath()}function Do(e,t,n,o,i,r,l,s,a,d,u,g,m,f,c,h,b,v=!1){if(a!==void 0){e.beginPath(),e.save(),e.rect(0,0,r,l);for(const k of a)e.rect(k.x+1,k.y+1,k.width-1,k.height-1);e.clip("evenodd")}const S=b.horizontalBorderColor??b.borderColor,C=b.borderColor,{minX:E,maxX:D,minY:A,maxY:P}=ui(s,r,l),R=[];e.beginPath();let x=.5;for(let k=0;k<t.length;k++){const w=t[k];if(w.width===0)continue;x+=w.width;const p=w.sticky?x:x+o;p>=E&&p<=D&&f(k+1)&&R.push({x1:p,y1:Math.max(d,A),x2:p,y2:Math.min(l,P),color:C})}let B=l+.5;for(let k=h-c;k<h;k++){const w=g(k);B-=w,R.push({x1:E,y1:B,x2:D,y2:B,color:S})}if(v!==!0){let k=u+.5,w=n;const p=B;for(;k+i<p;){const z=k+i;if(z>=A&&z<=P-1){const _=m==null?void 0:m(w);R.push({x1:E,y1:z,x2:D,y2:z,color:(_==null?void 0:_.horizontalBorderColor)??(_==null?void 0:_.borderColor)??S})}k+=g(w),w++}}const I=zi(R,k=>k.color);for(const k of Object.keys(I)){e.strokeStyle=k;for(const w of I[k])e.moveTo(w.x1,w.y1),e.lineTo(w.x2,w.y2);e.stroke(),e.beginPath()}a!==void 0&&e.restore()}function Ar(e,t,n,o,i,r,l,s,a,d,u,g,m,f,c,h,b,v,S){const C=[];e.imageSmoothingEnabled=!1;const E=Math.min(i.cellYOffset,l),D=Math.max(i.cellYOffset,l);let A=0;if(typeof v=="number")A+=(D-E)*v;else for(let p=E;p<D;p++)A+=v(p);l>i.cellYOffset&&(A=-A),A+=a-i.translateY;const P=Math.min(i.cellXOffset,r),R=Math.max(i.cellXOffset,r);let x=0;for(let p=P;p<R;p++)x+=h[p].width;r>i.cellXOffset&&(x=-x),x+=s-i.translateX;let B=zt(b);if(B>0&&B++,x!==0&&A!==0)return{regions:[]};const I=d>0?Ot(m,d,v):0,k=u-B-Math.abs(x),w=g-f-I-Math.abs(A)-1;if(k>150&&w>150){const p={sx:0,sy:0,sw:u*c,sh:g*c,dx:0,dy:0,dw:u*c,dh:g*c};if(A>0?(p.sy=(f+1)*c,p.sh=w*c,p.dy=(A+f+1)*c,p.dh=w*c,C.push({x:0,y:f,width:u,height:A+1})):A<0&&(p.sy=(-A+f+1)*c,p.sh=w*c,p.dy=(f+1)*c,p.dh=w*c,C.push({x:0,y:g+A-I,width:u,height:-A+I})),x>0?(p.sx=B*c,p.sw=k*c,p.dx=(x+B)*c,p.dw=k*c,C.push({x:B-1,y:0,width:x+2,height:g})):x<0&&(p.sx=(B-x)*c,p.sw=k*c,p.dx=B*c,p.dw=k*c,C.push({x:u+x,y:0,width:-x,height:g})),e.setTransform(1,0,0,1,0,0),S){if(B>0&&x!==0&&A===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const z=B*c,_=g*c;e.drawImage(t,0,0,z,_,0,0,z,_)}if(I>0&&x===0&&A!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const z=(g-I)*c,_=u*c,q=I*c;e.drawImage(t,0,z,_,q,0,z,_,q)}}e.drawImage(t,p.sx,p.sy,p.sw,p.sh,p.dx,p.dy,p.dw,p.dh),e.scale(c,c)}return e.imageSmoothingEnabled=!0,{regions:C}}function Pr(e,t,n,o,i,r,l,s,a,d){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||i!==e.translateY||xt(a,n,o,i,s,(g,m,f,c)=>{if(g.sourceIndex===d){const h=Math.max(m,c)+1;return u.push({x:h,y:0,width:r-h,height:l}),!0}}),u}function Hr(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const i=e.mappedColumns[o],r=t.mappedColumns[o];if(Nt(i,r))continue;if(n!==void 0||i.width===r.width)return!1;const{width:l,...s}=i,{width:a,...d}=r;if(!Nt(s,d))return!1;n=o}return n===void 0?!0:n}return!0}function Ao(e,t,n,o,i,r,l,s,a,d,u,g,m,f,c,h){const b=c==null?void 0:c.filter(P=>P.style!=="no-outline");if(b===void 0||b.length===0)return;const v=zt(s),S=Ot(f,m,g),C=[a,0,s.length,f-m],E=[v,0,t,n-S],D=b.map(P=>{const R=P.range,x=P.style??"dashed";return xr(R,C,t,n,E).map(B=>{const I=B.rect,k=Xn(I.x,I.y,t,n,u,d+u,o,i,r,l,f,a,m,s,g),w=I.width===1&&I.height===1?k:Xn(I.x+I.width-1,I.y+I.height-1,t,n,u,d+u,o,i,r,l,f,a,m,s,g);return I.x+I.width>=s.length&&(w.width-=1),I.y+I.height>=f&&(w.height-=1),{color:P.color,style:x,clip:B.clip,rect:kr({x:k.x,y:k.y,width:w.x+w.width-k.x,height:w.y+w.height-k.y},t,n,8)}})}),A=()=>{e.lineWidth=1;let P=!1;for(const R of D)for(const x of R)if((x==null?void 0:x.rect)!==void 0&&bn(0,0,t,n,x.rect.x,x.rect.y,x.rect.width,x.rect.height)){const B=P,I=!wr(x.clip,x.rect);I&&(e.save(),e.rect(x.clip.x,x.clip.y,x.clip.width,x.clip.height),e.clip()),x.style==="dashed"&&!P?(e.setLineDash([5,3]),P=!0):(x.style==="solid"||x.style==="solid-outline")&&P&&(e.setLineDash([]),P=!1),e.strokeStyle=x.style==="solid-outline"?Ue(Ue(x.color,h.borderColor),h.bgCell):en(x.color,1),e.strokeRect(x.rect.x+.5,x.rect.y+.5,x.rect.width-1,x.rect.height-1),I&&(e.restore(),P=B)}P&&e.setLineDash([])};return A(),A}function Po(e,t,n,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=i,e.stroke(),e.globalAlpha=1}function An(e,t,n,o,i,r,l,s,a,d,u,g,m,f,c,h,b){if(u.current===void 0)return;const v=u.current.range,S=u.current.cell,C=[v.x+v.width-1,v.y+v.height-1];if(S[1]>=b&&C[1]>=b||!l.some(z=>z.sourceIndex===S[0]||z.sourceIndex===C[0]))return;const[D,A]=u.current.cell,P=m(u.current.cell),R=P.span??[D,D],x=A>=b-f,B=f>0&&!x?Ot(b,f,g)-1:0,I=C[1];let k,w;if(xt(l,o,i,r,d,(z,_,q,K,we)=>{if(K-=1,z.sticky&&D>z.sourceIndex)return;const me=z.sourceIndex<R[0],de=z.sourceIndex>R[1],ie=z.sourceIndex===C[0];if(!(!ie&&(me||de)))return vn(we,q,n,b,g,f,c,void 0,(ke,Be,X)=>{if(Be!==A&&Be!==I)return;let Se=_,Te=z.width;const ae=z.sourceIndex===s.length-1,Ie=Be===b-1;if(P.span!==void 0){const Re=ri(P.span,_,ke,z.width,X,z,s),Le=z.sticky?Re[0]:Re[1];Le!==void 0&&(Se=Le.x,Te=Le.width)}const ct=Be===I&&ie&&h,qe=Be===A&&!me&&!de&&k===void 0;return ct&&(w=()=>{var Re;K>Se&&!z.sticky&&!qe&&(e.beginPath(),e.rect(K,0,t-K,n),e.clip()),e.beginPath(),e.rect(Se+Te-4,ke+X-4,4,4),e.fillStyle=((Re=z.themeOverride)==null?void 0:Re.accentColor)??a.accentColor,e.fill()}),qe&&(k=()=>{var Re;K>Se&&!z.sticky&&(e.beginPath(),e.rect(K,0,t-K,n),e.clip()),e.beginPath(),e.rect(Se+.5,ke+.5,Te-(ae?1:0),X-(Ie?1:0)),e.strokeStyle=((Re=z.themeOverride)==null?void 0:Re.accentColor)??a.accentColor,e.lineWidth=1,e.stroke()}),k!==void 0&&(h?w!==void 0:!0)}),k!==void 0&&(h?w!==void 0:!0)}),k===void 0&&w===void 0)return;const p=()=>{e.save(),e.beginPath(),e.rect(0,d,t,n-d-B),e.clip(),k==null||k(),w==null||w(),e.restore()};return p(),p}function Br(e,t,n,o,i,r,l,s,a){a===void 0||a.size===0||(e.beginPath(),ii(t,n,r,o,(d,u,g,m,f,c)=>{a.hasItemInRectangle({x:d[0],y:-2,width:d[1]-d[0]+1,height:1})&&e.rect(g,m,f,c)}),xt(t,s,r,l,i,(d,u,g,m)=>{const f=Math.max(0,m-u),c=u+f+1,h=d.width-f-1;a.has([d.sourceIndex,-1])&&e.rect(c,o,h,i-o)}),e.clip())}function Tr(e,t,n,o,i,r,l,s,a,d){let u=0;return xt(e,r,o,i,n,(g,m,f,c,h)=>(vn(h,f,t,l,s,a,d,void 0,(b,v,S,C)=>{C||(u=Math.max(v,u))}),!0)),u}function Ho(e,t){var Mt;const{canvasCtx:n,headerCanvasCtx:o,width:i,height:r,cellXOffset:l,cellYOffset:s,translateX:a,translateY:d,mappedColumns:u,enableGroups:g,freezeColumns:m,dragAndDropState:f,theme:c,drawFocus:h,headerHeight:b,groupHeaderHeight:v,disabledRows:S,rowHeight:C,verticalBorder:E,overrideCursor:D,isResizing:A,selection:P,fillHandle:R,freezeTrailingRows:x,rows:B,getCellContent:I,getGroupDetails:k,getRowThemeOverride:w,isFocused:p,drawHeaderCallback:z,prelightCells:_,drawCellCallback:q,highlightRegions:K,resizeCol:we,imageLoader:me,lastBlitData:de,hoverValues:ie,hyperWrapping:ke,hoverInfo:Be,spriteManager:X,maxScaleFactor:Se,hasAppendRow:Te,touchMode:ae,enqueue:Ie,renderStateProvider:ct,getCellRenderer:qe,renderStrategy:Re,bufferACtx:Le,bufferBCtx:He,damage:We,minimumCellWidth:yt}=e;if(i===0||r===0)return;const Ye=Re==="double-buffer",re=Math.min(Se,Math.ceil(window.devicePixelRatio??1)),je=Re!=="direct"&&Hr(e,t),Ee=n.canvas;(Ee.width!==i*re||Ee.height!==r*re)&&(Ee.width=i*re,Ee.height=r*re,Ee.style.width=i+"px",Ee.style.height=r+"px");const Xe=o.canvas,ce=g?v+b:b,pe=ce+1;(Xe.width!==i*re||Xe.height!==pe*re)&&(Xe.width=i*re,Xe.height=pe*re,Xe.style.width=i+"px",Xe.style.height=pe+"px");const ye=Le.canvas,ue=He.canvas;Ye&&(ye.width!==i*re||ye.height!==r*re)&&(ye.width=i*re,ye.height=r*re,de.current!==void 0&&(de.current.aBufferScroll=void 0)),Ye&&(ue.width!==i*re||ue.height!==r*re)&&(ue.width=i*re,ue.height=r*re,de.current!==void 0&&(de.current.bBufferScroll=void 0));const T=de.current;if(je===!0&&l===(T==null?void 0:T.cellXOffset)&&s===(T==null?void 0:T.cellYOffset)&&a===(T==null?void 0:T.translateX)&&d===(T==null?void 0:T.translateY))return;let G=null;Ye&&(G=n);const se=o;let V;Ye?We!==void 0?V=(T==null?void 0:T.lastBuffer)==="b"?He:Le:V=(T==null?void 0:T.lastBuffer)==="b"?Le:He:V=n;const Ne=V.canvas,oe=Ye?Ne===ye?ue:ye:Ee,te=typeof C=="number"?()=>C:C;se.save(),V.save(),se.beginPath(),V.beginPath(),se.textBaseline="middle",V.textBaseline="middle",re!==1&&(se.scale(re,re),V.scale(re,re));const ne=On(u,l,i,f,a);let Fe=[];const Je=h&&((Mt=P.current)==null?void 0:Mt.cell[1])===s&&d===0;let st=!1;if(K!==void 0){for(const he of K)if(he.style!=="no-outline"&&he.range.y===s&&d===0){st=!0;break}}const bt=()=>{Mr(se,ne,g,Be,i,a,b,v,f,A,P,c,X,ie,E,k,We,z,ae),Do(se,ne,s,a,d,i,r,void 0,void 0,v,ce,te,w,E,x,B,c,!0),se.beginPath(),se.moveTo(0,pe-.5),se.lineTo(i,pe-.5),se.strokeStyle=Ue(c.headerBottomBorderColor??c.horizontalBorderColor??c.borderColor,c.bgHeader),se.stroke(),st&&Ao(se,i,r,l,s,a,d,u,m,b,v,C,x,B,K,c),Je&&An(se,i,r,s,a,d,ne,u,c,ce,P,te,I,x,Te,R,B)};if(We!==void 0){const he=ne[ne.length-1].sourceIndex+1,$e=We.hasItemInRegion([{x:l,y:-2,width:he,height:2},{x:l,y:s,width:he,height:300},{x:0,y:s,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:l,y:B-x,width:he,height:x,when:x>0}]),Ze=et=>{Eo(et,ne,u,r,ce,a,d,s,B,te,I,k,w,S,p,h,x,Te,Fe,We,P,_,K,me,X,ie,Be,q,ke,c,Ie,ct,qe,D,yt);const tt=P.current;R&&h&&tt!==void 0&&We.has(Go(tt.range))&&An(et,i,r,s,a,d,ne,u,c,ce,P,te,I,x,Te,R,B)};$e&&(Ze(V),G!==null&&(G.save(),G.scale(re,re),G.textBaseline="middle",Ze(G),G.restore()),We.hasHeader()&&(Br(se,ne,i,v,ce,a,d,s,We),bt())),V.restore(),se.restore();return}if((je!==!0||l!==(T==null?void 0:T.cellXOffset)||a!==(T==null?void 0:T.translateX)||Je!==(T==null?void 0:T.mustDrawFocusOnHeader)||st!==(T==null?void 0:T.mustDrawHighlightRingsOnHeader))&&bt(),je===!0){ht(oe!==void 0&&T!==void 0);const{regions:he}=Ar(V,oe,oe===ye?T.aBufferScroll:T.bBufferScroll,oe===ye?T.bBufferScroll:T.aBufferScroll,T,l,s,a,d,x,i,r,B,ce,re,u,ne,C,Ye);Fe=he}else je!==!1&&(ht(T!==void 0),Fe=Pr(T,l,s,a,d,i,r,ce,ne,je));Fr(V,ne,i,r,x,B,E,te,c);const ze=Ao(V,i,r,l,s,a,d,u,m,b,v,C,x,B,K,c),Qe=h?An(V,i,r,s,a,d,ne,u,c,ce,P,te,I,x,Te,R,B):void 0;if(V.fillStyle=c.bgCell,Fe.length>0){V.beginPath();for(const he of Fe)V.rect(he.x,he.y,he.width,he.height);V.clip(),V.fill(),V.beginPath()}else V.fillRect(0,0,i,r);const _e=Eo(V,ne,u,r,ce,a,d,s,B,te,I,k,w,S,p,h,x,Te,Fe,We,P,_,K,me,X,ie,Be,q,ke,c,Ie,ct,qe,D,yt);Er(V,ne,u,i,r,ce,a,d,s,B,te,w,P.rows,S,x,Te,Fe,We,c),Dr(V,ne,s,a,d,i,r,Fe,ce,te,w,E,x,B,c),Do(V,ne,s,a,d,i,r,Fe,_e,v,ce,te,w,E,x,B,c),ze==null||ze(),Qe==null||Qe(),A&&xt(ne,0,a,0,ce,(he,$e)=>he.sourceIndex===we?(Po(se,$e+he.width,0,ce+1,Ue(c.resizeIndicatorColor??c.accentLight,c.bgHeader)),Po(V,$e+he.width,ce,r,Ue(c.resizeIndicatorColor??c.accentLight,c.bgCell)),!0):!1),G!==null&&(G.fillStyle=c.bgCell,G.fillRect(0,0,i,r),G.drawImage(V.canvas,0,0));const Ct=Tr(ne,r,ce,a,d,s,B,te,x,Te);me==null||me.setWindow({x:l,y:s,width:ne.length,height:Ct-s},m,Array.from({length:x},(he,$e)=>B-1-$e));const St=T!==void 0&&(l!==T.cellXOffset||a!==T.translateX),be=T!==void 0&&(s!==T.cellYOffset||d!==T.translateY);de.current={cellXOffset:l,cellYOffset:s,translateX:a,translateY:d,mustDrawFocusOnHeader:Je,mustDrawHighlightRingsOnHeader:st,lastBuffer:Ye?Ne===ye?"a":"b":void 0,aBufferScroll:Ne===ye?[St,be]:T==null?void 0:T.aBufferScroll,bBufferScroll:Ne===ue?[St,be]:T==null?void 0:T.bBufferScroll},V.restore(),se.restore()}const Rr=80;function Lr(e){const t=e-1;return t*t*t+1}class Wr{constructor(t){ee(this,"currentHoveredItem");ee(this,"leavingItems",[]);ee(this,"lastAnimationTime");ee(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>hn(o.item,t.item))||this.leavingItems.push(t)});ee(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>hn(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});ee(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});ee(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});ee(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Lr(t.hoverAmount)})));ee(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Rr;for(const r of this.leavingItems)r.hoverAmount=mn(r.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=mn(this.currentHoveredItem.hoverAmount+o,0,1));const i=this.getAnimatingItems();this.callback(i),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});ee(this,"setHovered",t=>{var n;if(!hn((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Nr{constructor(t){ee(this,"fn");ee(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function eo(e){return new Nr(e)}const zr=eo(()=>window.navigator.userAgent.includes("Firefox")),Bo=eo(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),al=eo(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Or(e){const t=M.useRef([]),n=M.useRef(0),o=M.useRef(e);o.current=e;const i=M.useCallback(()=>{const r=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(Jn);t.current=[],o.current(new Kt(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?r:l)},[]);return M.useCallback(r=>{t.current.length===0&&i();const l=rt(r[0],r[1]);t.current.includes(l)||t.current.push(l)},[i])}const At="header",Pt="group-header",To="out-of-bounds";var jt=(e=>(e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End",e))(jt||{});function Xr(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Ro=6,$r=(e,t)=>{if(e.kind===le.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Yr=(e,t)=>{const{width:n,height:o,accessibilityHeight:i,columns:r,cellXOffset:l,cellYOffset:s,headerHeight:a,fillHandle:d=!1,groupHeaderHeight:u,rowHeight:g,rows:m,getCellContent:f,getRowThemeOverride:c,onHeaderMenuClick:h,enableGroups:b,isFilling:v,onCanvasFocused:S,onCanvasBlur:C,isFocused:E,selection:D,freezeColumns:A,onContextMenu:P,freezeTrailingRows:R,fixedShadowX:x=!0,fixedShadowY:B=!0,drawFocusRing:I=!0,onMouseDown:k,onMouseUp:w,onMouseMoveRaw:p,onMouseMove:z,onItemHovered:_,dragAndDropState:q,firstColAccessible:K,onKeyDown:we,onKeyUp:me,highlightRegions:de,canvasRef:ie,onDragStart:ke,onDragEnd:Be,eventTargetRef:X,isResizing:Se,resizeColumn:Te,isDragging:ae,isDraggable:Ie=!1,allowResize:ct,disabledRows:qe,hasAppendRow:Re,getGroupDetails:Le,theme:He,prelightCells:We,headerIcons:yt,verticalBorder:Ye,drawCell:re,drawHeader:je,onCellFocused:Ee,onDragOverCell:Xe,onDrop:ce,onDragLeave:pe,imageWindowLoader:ye,smoothScrollX:ue=!1,smoothScrollY:T=!1,experimental:G,getCellRenderer:se}=e,V=e.translateX??0,Ne=e.translateY??0,oe=Math.max(A,Math.min(r.length-1,l)),te=M.useRef(null),ne=ye,Fe=M.useRef(),[Je,st]=M.useState(!1),bt=M.useRef([]),ze=M.useRef(),[Qe,_e]=M.useState(),[Ct,St]=M.useState(),be=M.useRef(null),[Mt,he]=M.useState(),[$e,Ze]=M.useState(!1),et=M.useRef($e);et.current=$e;const tt=M.useMemo(()=>new br(yt,()=>{nn.current=void 0,Xt.current()}),[yt]),dt=b?u+a:a,Q=M.useRef(-1),De=((G==null?void 0:G.enableFirefoxRescaling)??!1)&&zr.value,xe=((G==null?void 0:G.enableSafariRescaling)??!1)&&Bo.value;M.useLayoutEffect(()=>{window.devicePixelRatio===1||!De&&!xe||(Q.current!==-1&&st(!0),window.clearTimeout(Q.current),Q.current=window.setTimeout(()=>{st(!1),Q.current=-1},200))},[s,oe,V,Ne,De,xe]);const Ce=er(r,A),Ve=x?zt(Ce,q):0,ve=M.useCallback((y,F,N)=>{const W=y.getBoundingClientRect();if(F>=Ce.length||N>=m)return;const H=W.width/n,L=Xn(F,N,n,o,u,dt,oe,s,V,Ne,m,A,R,Ce,g);return H!==1&&(L.x*=H,L.y*=H,L.width*=H,L.height*=H),L.x+=W.x,L.y+=W.y,L},[n,o,u,dt,oe,s,V,Ne,m,A,R,Ce,g]),Oe=M.useCallback((y,F,N,W)=>{const H=y.getBoundingClientRect(),L=H.width/n,U=(F-H.left)/L,j=(N-H.top)/L,O=5,Ae=On(Ce,oe,n,void 0,V);let $=0,ge=0;W instanceof MouseEvent&&($=W.button,ge=W.buttons);const J=ir(U,Ae,V),Z=rr(j,o,b,a,u,m,g,s,Ne,R),Pe=(W==null?void 0:W.shiftKey)===!0,nt=(W==null?void 0:W.ctrlKey)===!0,Me=(W==null?void 0:W.metaKey)===!0,ut=W!==void 0&&!(W instanceof MouseEvent)||(W==null?void 0:W.pointerType)==="touch",vt=[U<0?-1:n<U?1:0,j<dt?-1:o<j?1:0];let ot;if(J===-1||j<0||U<0||Z===void 0||U>n||j>o){const fe=U>n?1:U<0?-1:0,it=j>o?1:j<0?-1:0;let lt=fe*2,Yt=it*2;fe===0&&(lt=J===-1?jt.EndPadding:jt.Center),it===0&&(Yt=Z===void 0?jt.EndPadding:jt.Center);let pt=!1;if(J===-1&&Z===-1){const _t=ve(y,Ce.length-1,-1);ht(_t!==void 0),pt=F<_t.x+_t.width+O}const En=U>n&&U<n+ko()||j>o&&j<o+ko();ot={kind:To,location:[J!==-1?J:U<0?0:Ce.length-1,Z??m-1],region:[lt,Yt],shiftKey:Pe,ctrlKey:nt,metaKey:Me,isEdge:pt,isTouch:ut,button:$,buttons:ge,scrollEdge:vt,isMaybeScrollbar:En}}else if(Z<=-1){let fe=ve(y,J,Z);ht(fe!==void 0);let it=fe!==void 0&&fe.x+fe.width-F<=O;const lt=J-1;F-fe.x<=O&&lt>=0?(it=!0,fe=ve(y,lt,Z),ht(fe!==void 0),ot={kind:b&&Z===-2?Pt:At,location:[lt,Z],bounds:fe,group:Ce[lt].group??"",isEdge:it,shiftKey:Pe,ctrlKey:nt,metaKey:Me,isTouch:ut,localEventX:F-fe.x,localEventY:N-fe.y,button:$,buttons:ge,scrollEdge:vt}):ot={kind:b&&Z===-2?Pt:At,group:Ce[J].group??"",location:[J,Z],bounds:fe,isEdge:it,shiftKey:Pe,ctrlKey:nt,metaKey:Me,isTouch:ut,localEventX:F-fe.x,localEventY:N-fe.y,button:$,buttons:ge,scrollEdge:vt}}else{const fe=ve(y,J,Z);ht(fe!==void 0);const it=fe!==void 0&&fe.x+fe.width-F<O;let lt=!1;if(d&&D.current!==void 0){const Yt=Go(D.current.range),pt=ve(y,Yt[0],Yt[1]);if(pt!==void 0){const En=pt.x+pt.width-2,_t=pt.y+pt.height-2;lt=Math.abs(En-F)<Ro&&Math.abs(_t-N)<Ro}}ot={kind:"cell",location:[J,Z],bounds:fe,isEdge:it,shiftKey:Pe,ctrlKey:nt,isFillHandle:lt,metaKey:Me,isTouch:ut,localEventX:F-fe.x,localEventY:N-fe.y,button:$,buttons:ge,scrollEdge:vt}}return ot},[n,Ce,oe,V,o,b,a,u,m,g,s,Ne,R,ve,d,D,dt]),[It]=Qe??[],to=M.useRef(()=>{}),Ht=M.useRef(Qe);Ht.current=Qe;const[Et,Ft]=M.useMemo(()=>{const y=document.createElement("canvas"),F=document.createElement("canvas");return y.style.display="none",y.style.opacity="0",y.style.position="fixed",F.style.display="none",F.style.opacity="0",F.style.position="fixed",[y.getContext("2d",{alpha:!1}),F.getContext("2d",{alpha:!1})]},[]);M.useLayoutEffect(()=>{if(!(Et===null||Ft===null))return document.documentElement.append(Et.canvas),document.documentElement.append(Ft.canvas),()=>{Et.canvas.remove(),Ft.canvas.remove()}},[Et,Ft]);const tn=M.useMemo(()=>new mr,[]),no=De&&Je?1:xe&&Je?2:5,oo=(G==null?void 0:G.disableMinimumCellWidth)===!0?1:10,nn=M.useRef(),on=M.useRef(null),rn=M.useRef(null),sn=M.useCallback(()=>{var U;const y=te.current,F=be.current;if(y===null||F===null||(on.current===null&&(on.current=y.getContext("2d",{alpha:!1}),y.width=0,y.height=0),rn.current===null&&(rn.current=F.getContext("2d",{alpha:!1}),F.width=0,F.height=0),on.current===null||rn.current===null||Et===null||Ft===null))return;let N=!1;const W=j=>{N=!0,he(j)},H=nn.current,L={headerCanvasCtx:rn.current,canvasCtx:on.current,bufferACtx:Et,bufferBCtx:Ft,width:n,height:o,cellXOffset:oe,cellYOffset:s,translateX:Math.round(V),translateY:Math.round(Ne),mappedColumns:Ce,enableGroups:b,freezeColumns:A,dragAndDropState:q,theme:He,headerHeight:a,groupHeaderHeight:u,disabledRows:qe??Nn.empty(),rowHeight:g,verticalBorder:Ye,isResizing:Se,resizeCol:Te,isFocused:E,selection:D,fillHandle:d,drawCellCallback:re,hasAppendRow:Re,overrideCursor:W,maxScaleFactor:no,freezeTrailingRows:R,rows:m,drawFocus:I,getCellContent:f,getGroupDetails:Le??(j=>({name:j})),getRowThemeOverride:c,drawHeaderCallback:je,prelightCells:We,highlightRegions:de,imageLoader:ne,lastBlitData:ze,damage:Fe.current,hoverValues:bt.current,hoverInfo:Ht.current,spriteManager:tt,scrolling:Je,hyperWrapping:(G==null?void 0:G.hyperWrapping)??!1,touchMode:$e,enqueue:to.current,renderStateProvider:tn,renderStrategy:(G==null?void 0:G.renderStrategy)??(Bo.value?"double-buffer":"single-buffer"),getCellRenderer:se,minimumCellWidth:oo};L.damage===void 0?(nn.current=L,Ho(L,H)):Ho(L,void 0),!N&&(L.damage===void 0||L.damage.has((U=Ht==null?void 0:Ht.current)==null?void 0:U[0]))&&he(void 0)},[Et,Ft,n,o,oe,s,V,Ne,Ce,b,A,q,He,a,u,qe,g,Ye,Se,Re,Te,E,D,d,R,m,I,no,f,Le,c,re,je,We,de,ne,tt,Je,G==null?void 0:G.hyperWrapping,G==null?void 0:G.renderStrategy,$e,tn,se,oo]),Xt=M.useRef(sn);M.useLayoutEffect(()=>{sn(),Xt.current=sn},[sn]),M.useLayoutEffect(()=>{(async()=>{var F;((F=document==null?void 0:document.fonts)==null?void 0:F.ready)!==void 0&&(await document.fonts.ready,nn.current=void 0,Xt.current())})()},[]);const Bt=M.useCallback(y=>{Fe.current=y,Xt.current(),Fe.current=void 0},[]),fi=Or(Bt);to.current=fi;const io=M.useCallback(y=>{Bt(new Kt(y.map(F=>F.cell)))},[Bt]);ne.setCallback(Bt);const[hi,gi]=M.useState(!1),[ln,Tt]=It??[],mi=ln!==void 0&&Tt===-1,yi=ln!==void 0&&Tt===-2;let ro=!1,so=!1,an=Mt;if(an===void 0&&ln!==void 0&&Tt!==void 0&&Tt>-1&&Tt<m){const y=f([ln,Tt],!0);ro=y.kind===Gt.NewRow||y.kind===Gt.Marker&&y.markerKind!=="number",so=y.kind===le.Boolean&&Wn(y),an=y.cursor}const lo=ae?"grabbing":(Ct??!1)||Se?"col-resize":hi||v?"crosshair":an!==void 0?an:mi||ro||so||yi?"pointer":"default",wn=M.useMemo(()=>({contain:"strict",display:"block",cursor:lo}),[lo]),ao=M.useRef("default"),kn=X==null?void 0:X.current;kn!=null&&ao.current!==wn.cursor&&(kn.style.cursor=ao.current=wn.cursor);const Rt=M.useCallback((y,F,N,W)=>{if(Le===void 0)return;const H=Le(y);if(H.actions!==void 0){const L=ci(F,H.actions);for(const[U,j]of L.entries())if(Qn(j,N+F.x,W+j.y))return H.actions[U]}},[Le]),Lt=M.useCallback((y,F,N,W)=>{const H=r[F];if(!ae&&!Se&&H.hasMenu===!0&&!(Ct??!1)){const L=ve(y,F,-1);ht(L!==void 0);const U=ai(L.x,L.y,L.width,L.height,Vn(H.title)==="rtl");if(N>U.x&&N<U.x+U.width&&W>U.y&&W<U.y+U.height)return L}},[r,ve,Ct,ae,Se]),xn=M.useRef(0),$t=M.useRef(),Cn=M.useRef(!1),co=M.useCallback(y=>{const F=te.current,N=X==null?void 0:X.current;if(F===null||y.target!==F&&y.target!==N)return;Cn.current=!0;let W,H;if(y instanceof MouseEvent?(W=y.clientX,H=y.clientY):(W=y.touches[0].clientX,H=y.touches[0].clientY),y.target===N&&N!==null){const U=N.getBoundingClientRect();if(W>U.right||H>U.bottom)return}const L=Oe(F,W,H,y);$t.current=L.location,L.isTouch&&(xn.current=Date.now()),et.current!==L.isTouch&&Ze(L.isTouch),!(L.kind===At&&Lt(F,L.location[0],W,H)!==void 0)&&(L.kind===Pt&&Rt(L.group,L.bounds,L.localEventX,L.localEventY)!==void 0||(k==null||k(L),!L.isTouch&&Ie!==!0&&Ie!==L.kind&&L.button<3&&L.button!==1&&y.preventDefault()))},[X,Ie,Oe,Rt,Lt,k]);Ke("touchstart",co,window,!1),Ke("mousedown",co,window,!1);const uo=M.useRef(0),fo=M.useCallback(y=>{var ge,J;const F=uo.current;uo.current=Date.now();const N=te.current;if(Cn.current=!1,w===void 0||N===null)return;const W=X==null?void 0:X.current,H=y.target!==N&&y.target!==W;let L,U,j=!0;if(y instanceof MouseEvent){if(L=y.clientX,U=y.clientY,j=y.button<3,y.pointerType==="touch")return}else L=y.changedTouches[0].clientX,U=y.changedTouches[0].clientY;let O=Oe(N,L,U,y);O.isTouch&&xn.current!==0&&Date.now()-xn.current>500&&(O={...O,isLongTouch:!0}),F!==0&&Date.now()-F<(O.isTouch?1e3:500)&&(O={...O,isDoubleClick:!0}),et.current!==O.isTouch&&Ze(O.isTouch),!H&&y.cancelable&&j&&y.preventDefault();const[Ae]=O.location,$=Lt(N,Ae,L,U);if(O.kind===At&&$!==void 0){(O.button!==0||((ge=$t.current)==null?void 0:ge[0])!==Ae||((J=$t.current)==null?void 0:J[1])!==-1)&&w(O,!0);return}else if(O.kind===Pt){const Z=Rt(O.group,O.bounds,O.localEventX,O.localEventY);if(Z!==void 0){O.button===0&&Z.onClick(O);return}}w(O,H)},[w,X,Oe,Lt,Rt]);Ke("mouseup",fo,window,!1),Ke("touchend",fo,window,!1);const bi=M.useCallback(y=>{var $,ge;const F=te.current;if(F===null)return;const N=X==null?void 0:X.current,W=y.target!==F&&y.target!==N;let H,L,U=!0;y instanceof MouseEvent?(H=y.clientX,L=y.clientY,U=y.button<3):(H=y.changedTouches[0].clientX,L=y.changedTouches[0].clientY);const j=Oe(F,H,L,y);et.current!==j.isTouch&&Ze(j.isTouch),!W&&y.cancelable&&U&&y.preventDefault();const[O]=j.location,Ae=Lt(F,O,H,L);if(j.kind===At&&Ae!==void 0)j.button===0&&(($=$t.current)==null?void 0:$[0])===O&&((ge=$t.current)==null?void 0:ge[1])===-1&&(h==null||h(O,Ae));else if(j.kind===Pt){const J=Rt(j.group,j.bounds,j.localEventX,j.localEventY);J!==void 0&&j.button===0&&J.onClick(j)}},[X,Oe,Lt,h,Rt]);Ke("click",bi,window,!1);const vi=M.useCallback(y=>{const F=te.current,N=X==null?void 0:X.current;if(F===null||y.target!==F&&y.target!==N||P===void 0)return;const W=Oe(F,y.clientX,y.clientY,y);P(W,()=>{y.cancelable&&y.preventDefault()})},[X,Oe,P]);Ke("contextmenu",vi,(X==null?void 0:X.current)??null,!1);const ho=M.useCallback(y=>{Fe.current=new Kt(y.map(F=>F.item)),bt.current=y,Xt.current(),Fe.current=void 0},[]),go=M.useMemo(()=>new Wr(ho),[ho]),mo=M.useRef(go);mo.current=go,M.useLayoutEffect(()=>{const y=mo.current;if(It===void 0||It[1]<0){y.setHovered(It);return}const F=f(It,!0),N=se(F),W=N===void 0&&F.kind===le.Custom||(N==null?void 0:N.needsHover)!==void 0&&(typeof N.needsHover=="boolean"?N.needsHover:N.needsHover(F));y.setHovered(W?It:void 0)},[f,se,It]);const yo=M.useRef(),pi=M.useCallback(y=>{var j;const F=te.current;if(F===null)return;const N=X==null?void 0:X.current,W=y.target!==F&&y.target!==N,H=Oe(F,y.clientX,y.clientY,y);if(H.kind!=="out-of-bounds"&&W&&!Cn.current&&!H.isTouch)return;const L=(O,Ae)=>{_e($=>$===O||($==null?void 0:$[0][0])===(O==null?void 0:O[0][0])&&($==null?void 0:$[0][1])===(O==null?void 0:O[0][1])&&(($==null?void 0:$[1][0])===(O==null?void 0:O[1][0])&&($==null?void 0:$[1][1])===(O==null?void 0:O[1][1])||!Ae)?$:O)};if(!Xr(H,yo.current))he(void 0),_==null||_(H),L(H.kind===To?void 0:[H.location,[H.localEventX,H.localEventY]],!0),yo.current=H;else if(H.kind==="cell"||H.kind===At||H.kind===Pt){let O=!1,Ae=!0;if(H.kind==="cell"){const ge=f(H.location);Ae=((j=se(ge))==null?void 0:j.needsHoverPosition)??ge.kind===le.Custom,O=Ae}else H.kind===Pt&&(O=!0);const $=[H.location,[H.localEventX,H.localEventY]];L($,Ae),Ht.current=$,O&&Bt(new Kt([H.location]))}const U=H.location[0]>=(K?0:1);St(H.kind===At&&H.isEdge&&U&&ct===!0),gi(H.kind==="cell"&&H.isFillHandle),p==null||p(y),z(H)},[X,Oe,K,ct,p,z,_,f,se,Bt]);Ke("mousemove",pi,window,!0);const wi=M.useCallback(y=>{const F=te.current;if(F===null)return;let N,W;D.current!==void 0&&(N=ve(F,D.current.cell[0],D.current.cell[1]),W=D.current.cell),we==null||we({bounds:N,stopPropagation:()=>y.stopPropagation(),preventDefault:()=>y.preventDefault(),cancel:()=>{},ctrlKey:y.ctrlKey,metaKey:y.metaKey,shiftKey:y.shiftKey,altKey:y.altKey,key:y.key,keyCode:y.keyCode,rawEvent:y,location:W})},[we,D,ve]),ki=M.useCallback(y=>{const F=te.current;if(F===null)return;let N,W;D.current!==void 0&&(N=ve(F,D.current.cell[0],D.current.cell[1]),W=D.current.cell),me==null||me({bounds:N,stopPropagation:()=>y.stopPropagation(),preventDefault:()=>y.preventDefault(),cancel:()=>{},ctrlKey:y.ctrlKey,metaKey:y.metaKey,shiftKey:y.shiftKey,altKey:y.altKey,key:y.key,keyCode:y.keyCode,rawEvent:y,location:W})},[me,D,ve]),xi=M.useCallback(y=>{te.current=y,ie!==void 0&&(ie.current=y)},[ie]),Ci=M.useCallback(y=>{const F=te.current;if(F===null||Ie===!1||Se){y.preventDefault();return}let N,W;const H=Oe(F,y.clientX,y.clientY);if(Ie!==!0&&H.kind!==Ie){y.preventDefault();return}const L=(ge,J)=>{N=ge,W=J};let U,j,O;const Ae=(ge,J,Z)=>{U=ge,j=J,O=Z};let $=!1;if(ke==null||ke({...H,setData:L,setDragImage:Ae,preventDefault:()=>$=!0,defaultPrevented:()=>$}),!$&&N!==void 0&&W!==void 0&&y.dataTransfer!==null)if(y.dataTransfer.setData(N,W),y.dataTransfer.effectAllowed="copyLink",U!==void 0&&j!==void 0&&O!==void 0)y.dataTransfer.setDragImage(U,j,O);else{const[ge,J]=H.location;if(J!==void 0){const Z=document.createElement("canvas"),Pe=ve(F,ge,J);ht(Pe!==void 0);const nt=Math.ceil(window.devicePixelRatio??1);Z.width=Pe.width*nt,Z.height=Pe.height*nt;const Me=Z.getContext("2d");Me!==null&&(Me.scale(nt,nt),Me.textBaseline="middle",J===-1?(Me.font=He.headerFontFull,Me.fillStyle=He.bgHeader,Me.fillRect(0,0,Z.width,Z.height),di(Me,0,0,Pe.width,Pe.height,Ce[ge],!1,He,!1,!1,0,tt,je,!1)):(Me.font=He.baseFontFull,Me.fillStyle=He.bgCell,Me.fillRect(0,0,Z.width,Z.height),li(Me,f([ge,J]),0,J,!1,!1,0,0,Pe.width,Pe.height,!1,He,He.bgCell,ne,tt,1,void 0,!1,0,void 0,void 0,void 0,tn,se,()=>{}))),Z.style.left="-100%",Z.style.position="absolute",Z.style.width=`${Pe.width}px`,Z.style.height=`${Pe.height}px`,document.body.append(Z),y.dataTransfer.setDragImage(Z,Pe.width/2,Pe.height/2),window.setTimeout(()=>{Z.remove()},0)}}else y.preventDefault()},[Ie,Se,Oe,ke,ve,He,Ce,tt,je,f,ne,tn,se]);Ke("dragstart",Ci,(X==null?void 0:X.current)??null,!1,!1);const Sn=M.useRef(),Si=M.useCallback(y=>{const F=te.current;if(ce!==void 0&&y.preventDefault(),F===null||Xe===void 0)return;const N=Oe(F,y.clientX,y.clientY),[W,H]=N.location,L=W-(K?0:1),[U,j]=Sn.current??[];(U!==L||j!==H)&&(Sn.current=[L,H],Xe([L,H],y.dataTransfer))},[K,Oe,Xe,ce]);Ke("dragover",Si,(X==null?void 0:X.current)??null,!1,!1);const Mi=M.useCallback(()=>{Sn.current=void 0,Be==null||Be()},[Be]);Ke("dragend",Mi,(X==null?void 0:X.current)??null,!1,!1);const Ii=M.useCallback(y=>{const F=te.current;if(F===null||ce===void 0)return;y.preventDefault();const N=Oe(F,y.clientX,y.clientY),[W,H]=N.location,L=W-(K?0:1);ce([L,H],y.dataTransfer)},[K,Oe,ce]);Ke("drop",Ii,(X==null?void 0:X.current)??null,!1,!1);const Ei=M.useCallback(()=>{pe==null||pe()},[pe]);Ke("dragleave",Ei,(X==null?void 0:X.current)??null,!1,!1);const bo=M.useRef(D);bo.current=D;const cn=M.useRef(null),Mn=M.useCallback(y=>{var F;te.current===null||!te.current.contains(document.activeElement)||(y===null&&bo.current.current!==void 0?(F=ie==null?void 0:ie.current)==null||F.focus({preventScroll:!0}):y!==null&&y.focus({preventScroll:!0}),cn.current=y)},[ie]);M.useImperativeHandle(t,()=>({focus:()=>{var F;const y=cn.current;y===null||!document.contains(y)?(F=ie==null?void 0:ie.current)==null||F.focus({preventScroll:!0}):y.focus({preventScroll:!0})},getBounds:(y,F)=>{if(!(ie===void 0||ie.current===null))return ve(ie.current,y??0,F??-1)},damage:io}),[ie,io,ve]);const In=M.useRef(),Fi=Gi(()=>{var j,O,Ae;if(n<50||(G==null?void 0:G.disableAccessibilityTree)===!0)return null;let y=On(Ce,oe,n,q,V);const F=K?0:-1;!K&&((j=y[0])==null?void 0:j.sourceIndex)===0&&(y=y.slice(1));const[N,W]=((O=D.current)==null?void 0:O.cell)??[],H=(Ae=D.current)==null?void 0:Ae.range,L=y.map($=>$.sourceIndex),U=Oi(s,Math.min(m,s+i));return N!==void 0&&W!==void 0&&!(L.includes(N)&&U.includes(W))&&Mn(null),Ge("table",{role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":Ce.length+F,children:[Y("thead",{role:"rowgroup",children:Y("tr",{role:"row","aria-rowindex":1,children:y.map($=>Y("th",{role:"columnheader","aria-selected":D.columns.hasIndex($.sourceIndex),"aria-colindex":$.sourceIndex+1+F,tabIndex:-1,onFocus:ge=>{if(ge.target!==cn.current)return Ee==null?void 0:Ee([$.sourceIndex,-1])},children:$.title},$.sourceIndex))})}),Y("tbody",{role:"rowgroup",children:U.map($=>Y("tr",{role:"row","aria-selected":D.rows.hasIndex($),"aria-rowindex":$+2,children:y.map(ge=>{const J=ge.sourceIndex,Z=rt(J,$),Pe=N===J&&W===$,nt=H!==void 0&&J>=H.x&&J<H.x+H.width&&$>=H.y&&$<H.y+H.height,Me=`glide-cell-${J}-${$}`,ut=[J,$],vt=f(ut,!0);return Y("td",{role:"gridcell","aria-colindex":J+1+F,"aria-selected":nt,"aria-readonly":_o(vt)||!qi(vt),id:Me,"data-testid":Me,onClick:()=>{const ot=ie==null?void 0:ie.current;if(ot!=null)return we==null?void 0:we({bounds:ve(ot,J,$),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:ut})},onFocusCapture:ot=>{var fe,it;if(!(ot.target===cn.current||((fe=In.current)==null?void 0:fe[0])===J&&((it=In.current)==null?void 0:it[1])===$))return In.current=ut,Ee==null?void 0:Ee(ut)},ref:Pe?Mn:void 0,tabIndex:-1,children:$r(vt,se)},Z)})},$))})]},"access-tree")},[n,Ce,oe,q,V,m,s,i,D,Mn,f,ie,we,ve,Ee],200),dn=A===0||!x?0:oe>A?1:mn(-V/100,0,1),Di=-s*32+Ne,un=B?mn(-Di/100,0,1):0,Ai=M.useMemo(()=>{if(!dn&&!un)return null;const y={position:"absolute",top:0,left:Ve,width:n-Ve,height:o,opacity:dn,pointerEvents:"none",transition:ue?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},F={position:"absolute",top:dt,left:0,width:n,height:o,opacity:un,pointerEvents:"none",transition:T?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return Ge(Rn,{children:[dn>0&&Y("div",{id:"shadow-x",style:y}),un>0&&Y("div",{id:"shadow-y",style:F})]})},[dn,un,Ve,n,ue,dt,o,T]),Pi=M.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return Ge(Rn,{children:[Y("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:wi,onKeyUp:ki,onFocus:S,onBlur:C,ref:xi,style:wn,children:Fi}),Y("canvas",{ref:be,style:Pi}),Ai]})},cl=M.memo(M.forwardRef(Yr));function _r(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case le.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===qn?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case le.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case le.Image:case le.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case le.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case le.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case le.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case le.Markdown:case le.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case le.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case le.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case le.Protected:return{formatted:"************",rawValue:"",format:"string"};default:Un()}}function Ur(e,t){return e.map((o,i)=>{const r=t[i];return o.map(l=>l.span!==void 0&&l.span[0]!==r?{formatted:"",rawValue:"",format:"string"}:_r(l))})}function Lo(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function qr(e){var n;const t=[];for(const o of e){const i=[];for(const r of o)r.format==="url"?i.push(((n=r.rawValue)==null?void 0:n.toString())??""):r.format==="string-array"?i.push(r.formatted.map(l=>Lo(l,!0)).join(",")):i.push(Lo(r.formatted,!1));t.push(i.join("	"))}return t.join(`
`)}function Pn(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Wo(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function jr(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function Vr(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const i of o){const r=`gdg-format="${i.format}"`;i.format==="url"?t.push(`<td ${r}><a href="${i.rawValue}">${Pn(i.formatted)}</a></td>`):i.format==="string-array"?t.push(`<td ${r}><ol>${i.formatted.map((l,s)=>`<li gdg-raw-value=${Wo(i.rawValue[s])}>`+Pn(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Wo(((n=i.rawValue)==null?void 0:n.toString())??"")} ${r}>${Pn(i.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function Kr(e,t){const n=Ur(e,t),o=qr(n),i=Vr(n);return{textPlain:o,textHtml:i}}function dl(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],i=[];let r;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)r!==void 0&&i.push(r),r=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const a=s.cloneNode(!0),u=a.children.length===1&&a.children[0].nodeName==="P"?a.children[0]:null,g=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",m=a.querySelectorAll("br");for(const h of m)h.replaceWith(`
`);const f=a.getAttribute("gdg-raw-value"),c=a.getAttribute("gdg-format")??"string";if(a.querySelector("a")!==null)r==null||r.push({rawValue:((l=a.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:a.textContent??"",format:c});else if(a.querySelector("ol")!==null){const h=a.querySelectorAll("li");r==null||r.push({rawValue:[...h].map(b=>b.getAttribute("gdg-raw-value")??""),formatted:[...h].map(b=>b.textContent??""),format:"string-array"})}else if(f!==null)r==null||r.push({rawValue:jr(f),formatted:a.textContent??"",format:c});else{let h=a.textContent??"";g&&(h=h.replace(/\n(?!\n)/g,"")),r==null||r.push({rawValue:h??"",formatted:h??"",format:c})}}}return r!==void 0&&i.push(r),i}function ul(e,t,n,o,i){var s;const r=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const a=(s=e.current)==null?void 0:s.range,d=[];if(a.width>2){const m=t({x:a.x,y:a.y,width:1,height:a.height},i.signal);if(typeof m=="function")return r;d.push(...m);const f=t({x:a.x+a.width-1,y:a.y,width:1,height:a.height},i.signal);if(typeof f=="function")return r;d.push(...f)}else{const m=t({x:a.x,y:a.y,width:a.width,height:a.height},i.signal);if(typeof m=="function")return r;d.push(...m)}let u=a.x-n,g=a.x+a.width-1-n;for(const m of d)for(const f of m)f.span!==void 0&&(u=Math.min(f.span[0],u),g=Math.max(f.span[1],g));u===a.x-n&&g===a.x+a.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:a.y,width:g-u+1,height:a.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function No(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function fl(e){let t;(s=>{s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],i=0,r=0;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(r){case 0:s==="	"||s===`
`?(o.push(e.slice(i,l)),i=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(r=1);break;case 1:s==='"'&&(r=2);break;case 2:s==='"'?r=1:((s==="	"||s===`
`)&&(o.push(No(e.slice(i,l))),i=l+1,s===`
`&&(n.push(o),o=[])),r=0);break}l++}return i<e.length&&o.push(No(e.slice(i,e.length))),n.push(o),n.map(s=>s.map(a=>({rawValue:a,formatted:a,format:"string"})))}function hl(e,t,n){var s;const o=Kr(e,t),i=a=>{var d;(d=window.navigator.clipboard)==null||d.writeText(a)},r=(a,d)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([d],{type:"text/html"})})]),!0)},l=(a,d)=>{var u,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",a),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",d)}catch{r(a,d)||i(a)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):i(o.textPlain),n==null||n.preventDefault()}function Gr(e){return e!==!0}const zo=20,Jr={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:le.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Qr(e,e.cell.data,Wn(e.cell),e.cell.maxSize??zo),onDelete:e=>({...e,data:!1}),onClick:e=>{const{cell:t,posX:n,posY:o,bounds:i,theme:r}=e,{width:l,height:s,x:a,y:d}=i,u=t.maxSize??zo,g=Math.floor(i.y+s/2),m=jo(u,s,r.cellVerticalPadding),f=qo(t.contentAlign??"center",a,l,r.cellHorizontalPadding,m),c=Uo(f,g,m),h=Vo(a+n,d+o,c);if(Wn(t)&&h)return{...t,data:Gr(t.data)}},onPaste:(e,t)=>{let n=yn;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=qn),n===t.data?void 0:{...t,data:n}}};function Qr(e,t,n,o){if(!n&&t===yn)return;const{ctx:i,hoverAmount:r,theme:l,rect:s,highlighted:a,hoverX:d,hoverY:u,cell:{contentAlign:g}}=e,{x:m,y:f,width:c,height:h}=s,b=.35;let v=n?1-b+b*r:.4;t===yn&&(v*=r),v!==0&&(i.globalAlpha=v,Zn(i,l,t,m,f,c,h,a,d,u,o,g),i.globalAlpha=1)}const Zr=mt("div")({name:"BubblesOverlayEditorStyle",class:"bed7b9f",propsAsIs:!1}),es=e=>{const{bubbles:t}=e;return Ge(Zr,{children:[t.map((n,o)=>Y("div",{className:"boe-bubble",children:n},o)),Y("textarea",{className:"gdg-input",autoFocus:!0})]})},ts=es,ns={getAccessibilityString:e=>Ko(e.data),kind:le.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i).width+o+20,0)+2*n.cellHorizontalPadding-4,draw:e=>is(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return Y(ts,{bubbles:t.data})},onPaste:()=>{}},os=4;function is(e,t){const{rect:n,theme:o,ctx:i,highlighted:r}=e,{x:l,y:s,width:a,height:d}=n,u=20,g=8,m=os;let f=l+o.cellHorizontalPadding;const c=[];for(const h of t){if(f>l+a)break;const b=Qt(h,i,o.baseFontFull).width;c.push({x:f,width:b}),f+=b+g*2+m}i.beginPath();for(const h of c)at(i,h.x,s+(d-u)/2,h.width+g*2,u,o.roundingRadius??u/2);i.fillStyle=r?o.bgBubbleSelected:o.bgBubble,i.fill();for(const[h,b]of c.entries())i.beginPath(),i.fillStyle=o.textBubble,i.fillText(t[h],b.x+g,s+d/2+kt(i,o))}const rs=mt("div")({name:"DrilldownOverlayEditorStyle",class:"dy18k32",propsAsIs:!1}),ss=e=>{const{drilldowns:t}=e;return Y(rs,{children:t.map((n,o)=>Ge("div",{className:"doe-bubble",children:[n.img!==void 0&&Y("img",{src:n.img}),Y("div",{children:n.text})]},o))})},ls=ss,as={getAccessibilityString:e=>Ko(e.data.map(t=>t.text)),kind:le.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i.text).width+o+20+(i.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>us(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return Y(ls,{drilldowns:t.data})},onPaste:()=>{}},cs=4,Hn={};function ds(e,t,n,o){const i=Math.ceil(window.devicePixelRatio),r=5,l=n-r*2,s=4,a=n*i,d=o+r,u=o*3,g=(u+r*2)*i,m=`${e},${t},${i},${n}`;if(Hn[m]!==void 0)return{el:Hn[m],height:a,width:g,middleWidth:s*i,sideWidth:d*i,padding:r*i,dpr:i};const f=document.createElement("canvas"),c=f.getContext("2d");return c===null?null:(f.width=g,f.height=a,c.scale(i,i),Hn[m]=f,c.beginPath(),at(c,r,r,u,l,o),c.shadowColor="rgba(24, 25, 34, 0.4)",c.shadowBlur=1,c.fillStyle=e,c.fill(),c.shadowColor="rgba(24, 25, 34, 0.3)",c.shadowOffsetY=1,c.shadowBlur=5,c.fillStyle=e,c.fill(),c.shadowOffsetY=0,c.shadowBlur=0,c.shadowBlur=0,c.beginPath(),at(c,r+.5,r+.5,u,l,o),c.strokeStyle=t,c.lineWidth=1,c.stroke(),{el:f,height:a,width:g,sideWidth:d*i,middleWidth:o*i,padding:r*i,dpr:i})}function us(e,t){const{rect:n,theme:o,ctx:i,imageLoader:r,col:l,row:s}=e,{x:a,width:d}=n,u=o.baseFontFull,g=ei(i,u),m=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),f=Math.floor(n.y+(n.height-m)/2),c=m-10,h=8,b=cs;let v=a+o.cellHorizontalPadding;const S=o.roundingRadius??6,C=ds(o.bgCell,o.drilldownBorder,m,S),E=[];for(const D of t){if(v>a+d)break;const P=Qt(D.text,i,u).width;let R=0;D.img!==void 0&&r.loadOrGetImage(D.img,l,s)!==void 0&&(R=c-8+4);const x=P+R+h*2;E.push({x:v,width:x}),v+=x+b}if(C!==null){const{el:D,height:A,middleWidth:P,sideWidth:R,width:x,dpr:B,padding:I}=C,k=R/B,w=I/B;for(const p of E){const z=Math.floor(p.x),_=Math.floor(p.width),q=_-(k-w)*2;i.imageSmoothingEnabled=!1,i.drawImage(D,0,0,R,A,z-w,f,k,m),q>0&&i.drawImage(D,R,0,P,A,z+(k-w),f,q,m),i.drawImage(D,x-R,0,R,A,z+_-(k-w),f,k,m),i.imageSmoothingEnabled=!0}}i.beginPath();for(const[D,A]of E.entries()){const P=t[D];let R=A.x+h;if(P.img!==void 0){const x=r.loadOrGetImage(P.img,l,s);if(x!==void 0){const B=c-8;let I=0,k=0,w=x.width,p=x.height;w>p?(I+=(w-p)/2,w=p):p>w&&(k+=(p-w)/2,p=w),i.beginPath(),at(i,R,f+m/2-B/2,B,B,o.roundingRadius??3),i.save(),i.clip(),i.drawImage(x,I,k,w,p,R,f+m/2-B/2,B,B),i.restore(),R+=B+4}}i.beginPath(),i.fillStyle=o.textBubble,i.fillText(P.text,R,f+m/2+kt(i,o))}}const fs=mt("div")({name:"ImageOverlayEditorStyle",class:"i1f2fhaz",propsAsIs:!1}),hs=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:i}=e,r=t.filter(s=>s!=="");if(r.length===0)return null;const l=r.length>1;return Ge(fs,{"data-testid":"GDG-default-image-overlay-editor",children:[Y(Xi.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l,children:r.map(s=>{const a=(i==null?void 0:i(s))??Y("img",{draggable:!1,src:s});return Y("div",{className:"gdg-centering-container",children:a},s)})}),n&&o&&Y("button",{className:"gdg-edit-icon",onClick:o,children:Y(jn,{})})]})},gs={getAccessibilityString:e=>e.data.join(", "),kind:le.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>ms(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e;return Y(o??hs,{urls:t.data,canWrite:t.readonly!==!1,onCancel:n,onChange:r=>{n({...t,data:[r]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(i=>{try{return new URL(i),i}catch{return}}).filter(i=>i!==void 0);if(!(o.length===t.data.length&&o.every((i,r)=>i===t.data[r])))return{...t,data:o}}},Bn=4;function ms(e,t,n,o){const{rect:i,col:r,row:l,theme:s,ctx:a,imageLoader:d}=e,{x:u,y:g,height:m,width:f}=i,c=m-s.cellVerticalPadding*2,h=[];let b=0;for(let S=0;S<t.length;S++){const C=t[S];if(C.length===0)continue;const E=d.loadOrGetImage(C,r,l);if(E!==void 0){h[S]=E;const D=E.width*(c/E.height);b+=D+Bn}}if(b===0)return;b-=Bn;let v=u+s.cellHorizontalPadding;o==="right"?v=Math.floor(u+f-s.cellHorizontalPadding-b):o==="center"&&(v=Math.floor(u+f/2-b/2));for(const S of h){if(S===void 0)continue;const C=S.width*(c/S.height);n>0&&(a.beginPath(),at(a,v,g+s.cellVerticalPadding,C,c,n),a.save(),a.clip()),a.drawImage(S,v,g+s.cellVerticalPadding,C,c),n>0&&a.restore(),v+=C+Bn}}function ys(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const bs={getAccessibilityString:()=>"",kind:le.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:i,rect:r,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(ys(n,o)*t.skeletonWidthVariability));const a=l.cellHorizontalPadding,d=t.skeletonHeight??Math.min(18,r.height-2*l.cellVerticalPadding);at(i,r.x+a,r.y+(r.height-d)/2,s,d,l.roundingRadius??3),i.fillStyle=en(l.textDark,.1),i.fill()},onPaste:()=>{}},vs=mt("div")({name:"MarkdownContainer",class:"m1ec5h7p",propsAsIs:!1});class ps extends _n.PureComponent{constructor(){super(...arguments);ee(this,"targetElement",null);ee(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:i,createNode:r}=o,l=Ti(i),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let a=r==null?void 0:r(l);if(a===void 0){const u=document.createElement("template");u.innerHTML=l,a=u.content}n.append(a);const d=n.getElementsByTagName("a");for(const u of d)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Y(vs,{ref:this.containerRefHook})}}const ws=mt("textarea")({name:"InputBox",class:"iotb8b8",propsAsIs:!1}),ks=mt("div")({name:"ShadowBox",class:"s1xtsfdl",propsAsIs:!1}),xs=mt("div")({name:"GrowingEntryStyle",class:"g1d7u5bt",propsAsIs:!1});let Oo=0;const pn=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:i,altNewline:r,validatedSelection:l,...s}=e,{onChange:a,className:d}=s,u=M.useRef(null),g=n??"";ht(a!==void 0,"GrowingEntry must be a controlled input area");const[m]=M.useState(()=>"input-box-"+(Oo=(Oo+1)%1e7));M.useEffect(()=>{const c=u.current;if(c===null||c.disabled)return;const h=g.toString().length;c.focus(),c.setSelectionRange(i?0:h,h)},[]),M.useLayoutEffect(()=>{var c;if(l!==void 0){const h=typeof l=="number"?[l,null]:l;(c=u.current)==null||c.setSelectionRange(h[0],h[1])}},[l]);const f=M.useCallback(c=>{c.key==="Enter"&&c.shiftKey&&r===!0||o==null||o(c)},[r,o]);return Ge(xs,{className:"gdg-growing-entry",children:[Y(ks,{className:d,children:g+`
`}),Y(ws,{...s,className:(d??"")+" gdg-input",id:m,ref:u,onKeyDown:f,value:g,placeholder:t,dir:"auto"})]})},Cs=()=>e=>e.targetWidth,Xo=mt("div")({name:"MarkdownOverlayEditorStyle",class:"mmv7gx6",propsAsIs:!1,vars:{"mmv7gx6-0":[Cs(),"px"]}}),Ss=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:i,targetRect:r,onFinish:l,validatedSelection:s}=e,a=t.data,d=t.readonly===!0,[u,g]=M.useState(a===""||o),m=M.useCallback(()=>{g(c=>!c)},[]),f=a?"gdg-ml-6":"";return u?Ge(Xo,{targetWidth:r.width-20,children:[Y(pn,{autoFocus:!0,highlight:!1,validatedSelection:s,value:a,onKeyDown:c=>{c.key==="Enter"&&c.stopPropagation()},onChange:n}),Y("div",{className:`gdg-edit-icon gdg-checkmark-hover ${f}`,onClick:()=>l(t),children:Y(Ki,{})})]}):Ge(Xo,{targetWidth:r.width,children:[Y(ps,{contents:a,createNode:i}),!d&&Ge(Rn,{children:[Y("div",{className:"spacer"}),Y("div",{className:`gdg-edit-icon gdg-edit-hover ${f}`,onClick:m,children:Y(jn,{})})]}),Y("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0})]})},Ms={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:Zt,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>gt(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:i,markdownDivCreateNode:r,forceEditMode:l,validatedSelection:s}=e;return Y(Ss,{onFinish:i,targetRect:o,value:n,validatedSelection:s,onChange:a=>t({...n,data:a.target.value}),forceEditMode:l,createNode:r})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Is={getAccessibilityString:e=>e.row.toString(),kind:Gt.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Es,measure:()=>44,draw:e=>Ds(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:i}=e,{width:r,height:l}=t,s=n.drawHandle?7+(r-7)/2:r/2,a=l/2;if(Math.abs(o-s)<=10&&Math.abs(i-a)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Es(e,t){const{ctx:n,theme:o}=e,i=o.markerFontFull,r=t??{};return(r==null?void 0:r.font)!==i&&(n.font=i,r.font=i),r.deprep=Fs,n.textAlign="center",r}function Fs(e){const{ctx:t}=e;t.textAlign="start"}function Ds(e,t,n,o,i,r){const{ctx:l,rect:s,hoverAmount:a,theme:d}=e,{x:u,y:g,width:m,height:f}=s,c=n?1:o==="checkbox-visible"?.6+.4*a:a;if(o!=="number"&&c>0){l.globalAlpha=c;const h=7*(n?a:1);if(Zn(l,d,n,i?u+h:u,g,i?m-h:m,f,!0,void 0,void 0,18,"center",r),i){l.globalAlpha=a,l.beginPath();for(const b of[3,6])for(const v of[-5,-1,3])l.rect(u+b,g+f/2+v,2,2);l.fillStyle=d.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const h=t.toString(),b=d.markerFontFull,v=u+m/2;o==="both"&&a!==0&&(l.globalAlpha=1-a),l.fillStyle=d.textLight,l.font=b,l.fillText(h,v,g+f/2+kt(l,b)),a!==0&&(l.globalAlpha=1)}}const As={getAccessibilityString:()=>"",kind:Gt.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>Ps(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function Ps(e,t,n){const{ctx:o,rect:i,hoverAmount:r,theme:l,spriteManager:s}=e,{x:a,y:d,width:u,height:g}=i;o.beginPath(),o.globalAlpha=r,o.rect(a+1,d+1,u,g-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let f=0;if(n!==void 0){const h=g-8,b=a+8/2,v=d+8/2;s.drawSprite(n,"normal",o,b,v,h,l,m?1:r),f=h}else{f=24;const c=12,h=m?c:r*c,b=m?0:(1-r)*c*.5,v=l.cellHorizontalPadding+4;h>0&&(o.moveTo(a+v+b,d+g/2),o.lineTo(a+v+b+h,d+g/2),o.moveTo(a+v+b+h*.5,d+g/2-h*.5),o.lineTo(a+v+b+h*.5,d+g/2+h*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,f+a+l.cellHorizontalPadding+.5,d+g/2+kt(o,l)),o.beginPath()}const Hs=M.lazy(async()=>await Yi(()=>import("./number-overlay-editor-wZgFM_Mr.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),Bs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Number,needsHover:!1,needsHoverPosition:!1,useLabel:!0,drawPrep:Zt,draw:e=>gt(e,e.cell.displayData,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return Y(M.Suspense,{fallback:null,children:Y(Hs,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:i,onChange:r=>n({...o,data:Number.isNaN(r.floatValue??0)?0:r.floatValue})})})},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},Ts={getAccessibilityString:()=>"",measure:()=>108,kind:le.Protected,needsHover:!1,needsHoverPosition:!1,draw:Rs,onPaste:()=>{}};function Rs(e){const{ctx:t,theme:n,rect:o}=e,{x:i,y:r,height:l}=o;t.beginPath();const s=2.5;let a=i+n.cellHorizontalPadding+s;const d=r+l/2,u=Math.cos(wo(30))*s,g=Math.sin(wo(30))*s;for(let m=0;m<12;m++)t.moveTo(a,d-s),t.lineTo(a,d+s),t.moveTo(a+u,d-g),t.lineTo(a-u,d+g),t.moveTo(a-u,d-g),t.lineTo(a+u,d+g),a+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const Ls={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>Zt(e,t,e.theme.textLight),draw:e=>gt(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return Y(pn,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:i,onChange:r=>n({...o,data:r.target.value})})},onPaste:()=>{}},Ws={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:Zt,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:i,rect:r,theme:l,overrideCursor:s}=e,{displayData:a,contentAlign:d,hoverEffect:u,allowWrapping:g}=t;if(u===!0&&n>0){i.textBaseline="alphabetic";const m=l.cellHorizontalPadding,f=l.cellVerticalPadding,c=Qt(a,i,l.baseFontFull,"alphabetic"),h=r.height-f,b=Math.min(h,c.actualBoundingBoxAscent*2.5);i.beginPath(),at(i,r.x+m/2,r.y+(r.height-b)/2+1,c.width+m*3,b-1,l.roundingRadius??4),i.globalAlpha=n,i.fillStyle=en(l.textDark,.1),i.fill(),i.globalAlpha=1,i.fillStyle=l.textDark,i.textBaseline="middle",s==null||s("text")}gt(e,a,d,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let i=0;for(const r of o)i=Math.max(i,e.measureText(r).width);return i+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:i,validatedSelection:r}=t;return Y(pn,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:i.readonly!==!0,disabled:i.readonly===!0,altNewline:!0,value:i.data,validatedSelection:r,onChange:l=>o({...i,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Ns=mt("div")({name:"UriOverlayEditorStyle",class:"uwr6ffw",propsAsIs:!1}),zs=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:i,validatedSelection:r,preview:l}=e,[s,a]=M.useState(!i&&(t===""||o)),d=M.useCallback(()=>{a(!0)},[]);return s?Y(pn,{validatedSelection:r,highlight:!0,autoFocus:!0,value:t,onChange:n}):Ge(Ns,{children:[Y("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer",children:l}),!i&&Y("div",{className:"gdg-edit-icon",onClick:d,children:Y(jn,{})}),Y("textarea",{className:"gdg-input",autoFocus:!0})]})},Os=zs;function $o(e,t,n,o){let i=n.cellHorizontalPadding;const r=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?i=t.width-l-n.cellHorizontalPadding:o==="center"&&(i=t.width/2-l/2),{x:i,y:r,width:l,height:s}}const Xs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:Zt,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:i,hoverY:r,rect:l,ctx:s}=e,a=t.displayData??t.data,d=t.hoverEffect===!0;if(o!==void 0&&d&&i!==void 0&&r!==void 0){const u=Qt(a,s,n.baseFontFull),g=$o(u,l,n,t.contentAlign),{x:m,y:f,width:c,height:h}=g;if(i>=m-4&&i<=m-4+c+8&&r>=f-4&&r<=f-4+h+8){const b=kt(s,n.baseFontFull);o("pointer");const v=5,S=f-b;s.beginPath(),s.moveTo(l.x+m,Math.floor(l.y+S+h+v)+.5),s.lineTo(l.x+m+c,Math.floor(l.y+S+h+v)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,gt({...e,rect:{...l,x:l.x-1}},a,t.contentAlign),gt({...e,rect:{...l,x:l.x-2}},a,t.contentAlign),gt({...e,rect:{...l,x:l.x+1}},a,t.contentAlign),gt({...e,rect:{...l,x:l.x+2}},a,t.contentAlign),s.restore()}}s.fillStyle=d?n.linkColor:n.textDark,gt(e,a,t.contentAlign)},onClick:e=>{const{cell:t,bounds:n,posX:o,posY:i,theme:r}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return;const s=ar(l,r.baseFontFull);if(s===void 0)return;const a=$o(s,n,r,t.contentAlign);Qn({x:a.x-4,y:a.y-4,width:a.width+8,height:a.height+8},o,i)&&t.onClickUri(e)},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:i,validatedSelection:r}=t;return Y(Os,{forceEditMode:o.readonly!==!0&&(i||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:r,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},gl=[Is,As,Jr,ns,as,gs,bs,Ms,Bs,Ts,Ls,Ws,Xs],Tn=[];class $s extends ni{constructor(){super(...arguments);ee(this,"imageLoaded",()=>{});ee(this,"loadedLocations",[]);ee(this,"cache",{});ee(this,"sendLoaded",$i(()=>{this.imageLoaded(new Kt(this.loadedLocations)),this.loadedLocations=[]},20));ee(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const i=this.cache[o];let r=!1;for(let l=0;l<i.cells.length;l++){const s=i.cells[l];if(this.isInWindow(s)){r=!0;break}}r?i.cells=i.cells.filter(this.isInWindow):(i.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,i,r){let l=!1;const s=Tn.pop()??new Image;let a=!1;const d={img:void 0,cells:[rt(o,i)],url:n,cancel:()=>{a||(a=!0,Tn.length<12?Tn.unshift(s):l||(s.src=""))}},u=new Promise(g=>s.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{s.src=n,await u,await s.decode();const g=this.cache[r];if(g!==void 0&&!a){g.img=s;for(const m of g.cells)this.loadedLocations.push(Jn(m));l=!0,this.sendLoaded()}}catch{d.cancel()}}),this.cache[r]=d}loadOrGetImage(n,o,i){const r=n,l=this.cache[r];if(l!==void 0){const s=rt(o,i);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,i,r)}}const ml=$s;export{Xr as A,ll as B,Nn as C,Un as D,Ui as E,Zs as F,le as G,ol as H,Gt as I,dl as J,fl as K,ko as L,il as M,hl as N,ml as O,gl as P,cl as Q,Bo as R,zr as S,sl as T,Qs as U,_i as a,ht as b,al as c,nl as d,ul as e,tl as f,rl as g,en as h,Gs as i,Ks as j,Ot as k,Pt as l,Jt as m,zn as n,To as o,Qn as p,nr as q,Js as r,_o as s,Gr as t,Ke as u,qi as v,el as w,pr as x,hn as y,At as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./number-overlay-editor-wZgFM_Mr.js","./marked.esm-dbrxtycE.js","./index-BMVQvedj.js","./react-number-format.es-2Vaki8Uh.js","./number-overlay-editor-8QJ1sjy4.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}